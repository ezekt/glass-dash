(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const X_="modulepreload",Q_=function(n,t){return new URL(n,t).href},$u={},J_=function(t,e,i){let s=Promise.resolve();if(e&&e.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");s=u(e.map(h=>{if(h=Q_(h,i),h in $u)return;$u[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(i)for(let y=o.length-1;y>=0;y--){const v=o[y];if(v.href===h&&(!d||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":X_,d||(m.as="script"),m.crossOrigin="",m.href=h,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((y,v)=>{m.addEventListener("load",y),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})};function Qs(n){return n+.5|0}const cn=(n,t,e)=>Math.max(Math.min(n,e),t);function fs(n){return cn(Qs(n*2.55),0,255)}function gn(n){return cn(Qs(n*255),0,255)}function Me(n){return cn(Qs(n/2.55)/100,0,1)}function qu(n){return cn(Qs(n*100),0,100)}const te={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},tc=[..."0123456789ABCDEF"],Z_=n=>tc[n&15],ty=n=>tc[(n&240)>>4]+tc[n&15],wr=n=>(n&240)>>4===(n&15),ey=n=>wr(n.r)&&wr(n.g)&&wr(n.b)&&wr(n.a);function ny(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&te[n[1]]*17,g:255&te[n[2]]*17,b:255&te[n[3]]*17,a:t===5?te[n[4]]*17:255}:(t===7||t===9)&&(e={r:te[n[1]]<<4|te[n[2]],g:te[n[3]]<<4|te[n[4]],b:te[n[5]]<<4|te[n[6]],a:t===9?te[n[7]]<<4|te[n[8]]:255})),e}const iy=(n,t)=>n<255?t(n):"";function sy(n){var t=ey(n)?Z_:ty;return n?"#"+t(n.r)+t(n.g)+t(n.b)+iy(n.a,t):void 0}const ry=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Gf(n,t,e){const i=t*Math.min(e,1-e),s=(r,o=(r+n/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function oy(n,t,e){const i=(s,r=(s+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function ay(n,t,e){const i=Gf(n,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)i[s]*=1-t-e,i[s]+=t;return i}function cy(n,t,e,i,s){return n===s?(t-e)/i+(t<e?6:0):t===s?(e-n)/i+2:(n-t)/i+4}function Bc(n){const e=n.r/255,i=n.g/255,s=n.b/255,r=Math.max(e,i,s),o=Math.min(e,i,s),a=(r+o)/2;let c,u,h;return r!==o&&(h=r-o,u=a>.5?h/(2-r-o):h/(r+o),c=cy(e,i,s,h,r),c=c*60+.5),[c|0,u||0,a]}function Uc(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(gn)}function zc(n,t,e){return Uc(Gf,n,t,e)}function ly(n,t,e){return Uc(ay,n,t,e)}function uy(n,t,e){return Uc(oy,n,t,e)}function Yf(n){return(n%360+360)%360}function hy(n){const t=ry.exec(n);let e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?fs(+t[5]):gn(+t[5]));const s=Yf(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=ly(s,r,o):t[1]==="hsv"?i=uy(s,r,o):i=zc(s,r,o),{r:i[0],g:i[1],b:i[2],a:e}}function dy(n,t){var e=Bc(n);e[0]=Yf(e[0]+t),e=zc(e),n.r=e[0],n.g=e[1],n.b=e[2]}function fy(n){if(!n)return;const t=Bc(n),e=t[0],i=qu(t[1]),s=qu(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${s}%, ${Me(n.a)})`:`hsl(${e}, ${i}%, ${s}%)`}const Gu={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Yu={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function gy(){const n={},t=Object.keys(Yu),e=Object.keys(Gu);let i,s,r,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],s=0;s<e.length;s++)r=e[s],a=a.replace(r,Gu[r]);r=parseInt(Yu[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let Tr;function py(n){Tr||(Tr=gy(),Tr.transparent=[0,0,0,0]);const t=Tr[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const my=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function _y(n){const t=my.exec(n);let e=255,i,s,r;if(t){if(t[7]!==i){const o=+t[7];e=t[8]?fs(o):cn(o*255,0,255)}return i=+t[1],s=+t[3],r=+t[5],i=255&(t[2]?fs(i):cn(i,0,255)),s=255&(t[4]?fs(s):cn(s,0,255)),r=255&(t[6]?fs(r):cn(r,0,255)),{r:i,g:s,b:r,a:e}}}function yy(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Me(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const xa=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,fi=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function by(n,t,e){const i=fi(Me(n.r)),s=fi(Me(n.g)),r=fi(Me(n.b));return{r:gn(xa(i+e*(fi(Me(t.r))-i))),g:gn(xa(s+e*(fi(Me(t.g))-s))),b:gn(xa(r+e*(fi(Me(t.b))-r))),a:n.a+e*(t.a-n.a)}}function Er(n,t,e){if(n){let i=Bc(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=zc(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function Kf(n,t){return n&&Object.assign(t||{},n)}function Ku(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=gn(n[3]))):(t=Kf(n,{r:0,g:0,b:0,a:1}),t.a=gn(t.a)),t}function vy(n){return n.charAt(0)==="r"?_y(n):hy(n)}class Ms{constructor(t){if(t instanceof Ms)return t;const e=typeof t;let i;e==="object"?i=Ku(t):e==="string"&&(i=ny(t)||py(t)||vy(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Kf(this._rgb);return t&&(t.a=Me(t.a)),t}set rgb(t){this._rgb=Ku(t)}rgbString(){return this._valid?yy(this._rgb):void 0}hexString(){return this._valid?sy(this._rgb):void 0}hslString(){return this._valid?fy(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,c=i.a-s.a,u=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;r=1-u,i.r=255&u*i.r+r*s.r+.5,i.g=255&u*i.g+r*s.g+.5,i.b=255&u*i.b+r*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=by(this._rgb,t._rgb,e)),this}clone(){return new Ms(this.rgb)}alpha(t){return this._rgb.a=gn(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Qs(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Er(this._rgb,2,t),this}darken(t){return Er(this._rgb,2,-t),this}saturate(t){return Er(this._rgb,1,t),this}desaturate(t){return Er(this._rgb,1,-t),this}rotate(t){return dy(this._rgb,t),this}}function Re(){}const wy=(()=>{let n=0;return()=>n++})();function K(n){return n==null}function dt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Z(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function yt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Jt(n,t){return yt(n)?n:t}function $(n,t){return typeof n>"u"?t:n}const Ty=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,Xf=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function ct(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function ot(n,t,e,i){let s,r,o;if(dt(n))for(r=n.length,s=0;s<r;s++)t.call(e,n[s],s);else if(Z(n))for(o=Object.keys(n),r=o.length,s=0;s<r;s++)t.call(e,n[o[s]],o[s])}function to(n,t){let e,i,s,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(s=n[e],r=t[e],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function eo(n){if(dt(n))return n.map(eo);if(Z(n)){const t=Object.create(null),e=Object.keys(n),i=e.length;let s=0;for(;s<i;++s)t[e[s]]=eo(n[e[s]]);return t}return n}function Qf(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Ey(n,t,e,i){if(!Qf(n))return;const s=t[n],r=e[n];Z(s)&&Z(r)?Os(s,r,i):t[n]=eo(r)}function Os(n,t,e){const i=dt(t)?t:[t],s=i.length;if(!Z(n))return n;e=e||{};const r=e.merger||Ey;let o;for(let a=0;a<s;++a){if(o=i[a],!Z(o))continue;const c=Object.keys(o);for(let u=0,h=c.length;u<h;++u)r(c[u],n,o,e)}return n}function ws(n,t){return Os(n,t,{merger:Iy})}function Iy(n,t,e){if(!Qf(n))return;const i=t[n],s=e[n];Z(i)&&Z(s)?ws(i,s):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=eo(s))}const Xu={"":n=>n,x:n=>n.x,y:n=>n.y};function xy(n){const t=n.split("."),e=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function Sy(n){const t=xy(n);return e=>{for(const i of t){if(i==="")break;e=e&&e[i]}return e}}function wn(n,t){return(Xu[t]||(Xu[t]=Sy(t)))(n)}function Wc(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Vs=n=>typeof n<"u",Tn=n=>typeof n=="function",Qu=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function Ay(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const et=Math.PI,ht=2*et,Py=ht+et,no=Number.POSITIVE_INFINITY,Cy=et/180,wt=et/2,Ln=et/4,Ju=et*2/3,ln=Math.log10,be=Math.sign;function Ts(n,t,e){return Math.abs(n-t)<e}function Zu(n){const t=Math.round(n);n=Ts(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(ln(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function Ry(n){const t=[],e=Math.sqrt(n);let i;for(i=1;i<e;i++)n%i===0&&(t.push(i),t.push(n/i));return e===(e|0)&&t.push(e),t.sort((s,r)=>s-r).pop(),t}function ky(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Ai(n){return!ky(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function Dy(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function Jf(n,t,e){let i,s,r;for(i=0,s=n.length;i<s;i++)r=n[i][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function ce(n){return n*(et/180)}function jc(n){return n*(180/et)}function th(n){if(!yt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Zf(n,t){const e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);let r=Math.atan2(i,e);return r<-.5*et&&(r+=ht),{angle:r,distance:s}}function ec(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function My(n,t){return(n-t+Py)%ht-et}function Ut(n){return(n%ht+ht)%ht}function Ns(n,t,e,i){const s=Ut(n),r=Ut(t),o=Ut(e),a=Ut(r-s),c=Ut(o-s),u=Ut(s-r),h=Ut(s-o);return s===r||s===o||i&&r===o||a>c&&u<h}function Rt(n,t,e){return Math.max(t,Math.min(e,n))}function Oy(n){return Rt(n,-32768,32767)}function Ve(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function Hc(n,t,e){e=e||(o=>n[o]<t);let i=n.length-1,s=0,r;for(;i-s>1;)r=s+i>>1,e(r)?s=r:i=r;return{lo:s,hi:i}}const Ne=(n,t,e,i)=>Hc(n,e,i?s=>{const r=n[s][t];return r<e||r===e&&n[s+1][t]===e}:s=>n[s][t]<e),Vy=(n,t,e)=>Hc(n,e,i=>n[i][t]>=e);function Ny(n,t,e){let i=0,s=n.length;for(;i<s&&n[i]<t;)i++;for(;s>i&&n[s-1]>e;)s--;return i>0||s<n.length?n.slice(i,s):n}const tg=["push","pop","shift","splice","unshift"];function Ly(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),tg.forEach(e=>{const i="_onData"+Wc(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...r)}),o}})})}function eh(n,t){const e=n._chartjs;if(!e)return;const i=e.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(tg.forEach(r=>{delete n[r]}),delete n._chartjs)}function eg(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const ng=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function ig(n,t){let e=[],i=!1;return function(...s){e=s,i||(i=!0,ng.call(window,()=>{i=!1,n.apply(t,e)}))}}function Fy(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}const $c=n=>n==="start"?"left":n==="end"?"right":"center",Ft=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,By=(n,t,e,i)=>n===(i?"left":"right")?e:n==="center"?(t+e)/2:t;function sg(n,t,e){const i=t.length;let s=0,r=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:c}=n,u=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:d,max:g,minDefined:m,maxDefined:y}=o.getUserBounds();if(m){if(s=Math.min(Ne(c,h,d).lo,e?i:Ne(t,h,o.getPixelForValue(d)).lo),u){const v=c.slice(0,s+1).reverse().findIndex(w=>!K(w[a.axis]));s-=Math.max(0,v)}s=Rt(s,0,i-1)}if(y){let v=Math.max(Ne(c,o.axis,g,!0).hi+1,e?0:Ne(t,h,o.getPixelForValue(g),!0).hi+1);if(u){const w=c.slice(v-1).findIndex(P=>!K(P[a.axis]));v+=Math.max(0,w)}r=Rt(v,s,i)-s}else r=i-s}return{start:s,count:r}}function rg(n){const{xScale:t,yScale:e,_scaleRanges:i}=n,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=s,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,s),r}const Ir=n=>n===0||n===1,nh=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*ht/e)),ih=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*ht/e)+1,Es={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*wt)+1,easeOutSine:n=>Math.sin(n*wt),easeInOutSine:n=>-.5*(Math.cos(et*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Ir(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Ir(n)?n:nh(n,.075,.3),easeOutElastic:n=>Ir(n)?n:ih(n,.075,.3),easeInOutElastic(n){return Ir(n)?n:n<.5?.5*nh(n*2,.1125,.45):.5+.5*ih(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Es.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Es.easeInBounce(n*2)*.5:Es.easeOutBounce(n*2-1)*.5+.5};function qc(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function sh(n){return qc(n)?n:new Ms(n)}function Sa(n){return qc(n)?n:new Ms(n).saturate(.5).darken(.1).hexString()}const Uy=["x","y","borderWidth","radius","tension"],zy=["color","borderColor","backgroundColor"];function Wy(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:zy},numbers:{type:"number",properties:Uy}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function jy(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const rh=new Map;function Hy(n,t){t=t||{};const e=n+JSON.stringify(t);let i=rh.get(e);return i||(i=new Intl.NumberFormat(n,t),rh.set(e,i)),i}function Js(n,t,e){return Hy(t,e).format(n)}const og={values(n){return dt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const i=this.chart.options.locale;let s,r=n;if(e.length>1){const u=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(u<1e-4||u>1e15)&&(s="scientific"),r=$y(n,e)}const o=ln(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Js(n,i,c)},logarithmic(n,t,e){if(n===0)return"0";const i=e[t].significand||n/Math.pow(10,Math.floor(ln(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?og.numeric.call(this,n,t,e):""}};function $y(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var Ro={formatters:og};function qy(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ro.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Jn=Object.create(null),nc=Object.create(null);function Is(n,t){if(!t)return n;const e=t.split(".");for(let i=0,s=e.length;i<s;++i){const r=e[i];n=n[r]||(n[r]=Object.create(null))}return n}function Aa(n,t,e){return typeof t=="string"?Os(Is(n,t),e):Os(Is(n,""),t)}class Gy{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>Sa(s.backgroundColor),this.hoverBorderColor=(i,s)=>Sa(s.borderColor),this.hoverColor=(i,s)=>Sa(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Aa(this,t,e)}get(t){return Is(this,t)}describe(t,e){return Aa(nc,t,e)}override(t,e){return Aa(Jn,t,e)}route(t,e,i,s){const r=Is(this,t),o=Is(this,i),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const c=this[a],u=o[s];return Z(c)?Object.assign({},u,c):$(c,u)},set(c){this[a]=c}}})}apply(t){t.forEach(e=>e(this))}}var ft=new Gy({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Wy,jy,qy]);function Yy(n){return!n||K(n.size)||K(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function io(n,t,e,i,s){let r=t[s];return r||(r=t[s]=n.measureText(s).width,e.push(s)),r>i&&(i=r),i}function Ky(n,t,e,i){i=i||{};let s=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},r=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let o=0;const a=e.length;let c,u,h,d,g;for(c=0;c<a;c++)if(d=e[c],d!=null&&!dt(d))o=io(n,s,r,o,d);else if(dt(d))for(u=0,h=d.length;u<h;u++)g=d[u],g!=null&&!dt(g)&&(o=io(n,s,r,o,g));n.restore();const m=r.length/2;if(m>e.length){for(c=0;c<m;c++)delete s[r[c]];r.splice(0,m)}return o}function Fn(n,t,e){const i=n.currentDevicePixelRatio,s=e!==0?Math.max(e/2,.5):0;return Math.round((t-s)*i)/i+s}function oh(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function ic(n,t,e,i){ag(n,t,e,i,null)}function ag(n,t,e,i,s){let r,o,a,c,u,h,d,g;const m=t.pointStyle,y=t.rotation,v=t.radius;let w=(y||0)*Cy;if(m&&typeof m=="object"&&(r=m.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,i),n.rotate(w),n.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),m){default:s?n.ellipse(e,i,s/2,v,0,0,ht):n.arc(e,i,v,0,ht),n.closePath();break;case"triangle":h=s?s/2:v,n.moveTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=Ju,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=Ju,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),n.closePath();break;case"rectRounded":u=v*.516,c=v-u,o=Math.cos(w+Ln)*c,d=Math.cos(w+Ln)*(s?s/2-u:c),a=Math.sin(w+Ln)*c,g=Math.sin(w+Ln)*(s?s/2-u:c),n.arc(e-d,i-a,u,w-et,w-wt),n.arc(e+g,i-o,u,w-wt,w),n.arc(e+d,i+a,u,w,w+wt),n.arc(e-g,i+o,u,w+wt,w+et),n.closePath();break;case"rect":if(!y){c=Math.SQRT1_2*v,h=s?s/2:c,n.rect(e-h,i-c,2*h,2*c);break}w+=Ln;case"rectRot":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+g,i-o),n.lineTo(e+d,i+a),n.lineTo(e-g,i+o),n.closePath();break;case"crossRot":w+=Ln;case"cross":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"star":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o),w+=Ln,d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"line":o=s?s/2:Math.cos(w)*v,a=Math.sin(w)*v,n.moveTo(e-o,i-a),n.lineTo(e+o,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(w)*(s?s/2:v),i+Math.sin(w)*v);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function Le(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function ko(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Do(n){n.restore()}function Xy(n,t,e,i,s){if(!t)return n.lineTo(e.x,e.y);if(s==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else s==="after"!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function Qy(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function Jy(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),K(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function Zy(n,t,e,i,s){if(s.strikethrough||s.underline){const r=n.measureText(i),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,c=e-r.actualBoundingBoxAscent,u=e+r.actualBoundingBoxDescent,h=s.strikethrough?(c+u)/2:u;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function tb(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function Zn(n,t,e,i,s,r={}){const o=dt(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let c,u;for(n.save(),n.font=s.string,Jy(n,r),c=0;c<o.length;++c)u=o[c],r.backdrop&&tb(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),K(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(u,e,i,r.maxWidth)),n.fillText(u,e,i,r.maxWidth),Zy(n,e,i,u,r),i+=Number(s.lineHeight);n.restore()}function Ls(n,t){const{x:e,y:i,w:s,h:r,radius:o}=t;n.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*et,et,!0),n.lineTo(e,i+r-o.bottomLeft),n.arc(e+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,et,wt,!0),n.lineTo(e+s-o.bottomRight,i+r),n.arc(e+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,wt,0,!0),n.lineTo(e+s,i+o.topRight),n.arc(e+s-o.topRight,i+o.topRight,o.topRight,0,-wt,!0),n.lineTo(e+o.topLeft,i)}const eb=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,nb=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ib(n,t){const e=(""+n).match(eb);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const sb=n=>+n||0;function Gc(n,t){const e={},i=Z(t),s=i?Object.keys(t):t,r=Z(n)?i?o=>$(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of s)e[o]=sb(r(o));return e}function cg(n){return Gc(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Yn(n){return Gc(n,["topLeft","topRight","bottomLeft","bottomRight"])}function jt(n){const t=cg(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function St(n,t){n=n||{},t=t||ft.font;let e=$(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=$(n.style,t.style);i&&!(""+i).match(nb)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:$(n.family,t.family),lineHeight:ib($(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:$(n.weight,t.weight),string:""};return s.string=Yy(s),s}function gs(n,t,e,i){let s,r,o;for(s=0,r=n.length;s<r;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function rb(n,t,e){const{min:i,max:s}=n,r=Xf(t,(s-i)/2),o=(a,c)=>e&&a===0?0:a+c;return{min:o(i,-Math.abs(r)),max:o(s,r)}}function Cn(n,t){return Object.assign(Object.create(n),t)}function Yc(n,t=[""],e,i,s=()=>n[0]){const r=e||n;typeof i>"u"&&(i=dg("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:i,_getTarget:s,override:a=>Yc([a,...n],t,r,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return ug(a,c,()=>fb(c,t,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return ch(a).includes(c)},ownKeys(a){return ch(a)},set(a,c,u){const h=a._storage||(a._storage=s());return a[c]=h[c]=u,delete a._keys,!0}})}function Pi(n,t,e,i){const s={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:lg(n,i),setContext:r=>Pi(n,r,e,i),override:r=>Pi(n.override(r),t,e,i)};return new Proxy(s,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return ug(r,o,()=>ab(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function lg(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=n;return{allKeys:s,scriptable:e,indexable:i,isScriptable:Tn(e)?e:()=>e,isIndexable:Tn(i)?i:()=>i}}const ob=(n,t)=>n?n+Wc(t):t,Kc=(n,t)=>Z(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function ug(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const i=e();return n[t]=i,i}function ab(n,t,e){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=n;let a=i[t];return Tn(a)&&o.isScriptable(t)&&(a=cb(t,a,n,e)),dt(a)&&a.length&&(a=lb(t,a,n,o.isIndexable)),Kc(t,a)&&(a=Pi(a,s,r&&r[t],o)),a}function cb(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=t(r,o||i);return a.delete(n),Kc(n,c)&&(c=Xc(s._scopes,s,n,c)),c}function lb(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&i(n))return t[r.index%t.length];if(Z(t[0])){const c=t,u=s._scopes.filter(h=>h!==c);t=[];for(const h of c){const d=Xc(u,s,n,h);t.push(Pi(d,r,o&&o[n],a))}}return t}function hg(n,t,e){return Tn(n)?n(t,e):n}const ub=(n,t)=>n===!0?t:typeof n=="string"?wn(t,n):void 0;function hb(n,t,e,i,s){for(const r of t){const o=ub(e,r);if(o){n.add(o);const a=hg(o._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(o===!1&&typeof i<"u"&&e!==i)return null}return!1}function Xc(n,t,e,i){const s=t._rootScopes,r=hg(t._fallback,e,i),o=[...n,...s],a=new Set;a.add(i);let c=ah(a,o,e,r||e,i);return c===null||typeof r<"u"&&r!==e&&(c=ah(a,o,r,c,i),c===null)?!1:Yc(Array.from(a),[""],s,r,()=>db(t,e,i))}function ah(n,t,e,i,s){for(;e;)e=hb(n,t,e,i,s);return e}function db(n,t,e){const i=n._getTarget();t in i||(i[t]={});const s=i[t];return dt(s)&&Z(e)?e:s||{}}function fb(n,t,e,i){let s;for(const r of t)if(s=dg(ob(r,n),e),typeof s<"u")return Kc(n,s)?Xc(e,i,n,s):s}function dg(n,t){for(const e of t){if(!e)continue;const i=e[n];if(typeof i<"u")return i}}function ch(n){let t=n._keys;return t||(t=n._keys=gb(n._scopes)),t}function gb(n){const t=new Set;for(const e of n)for(const i of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function fg(n,t,e,i){const{iScale:s}=n,{key:r="r"}=this._parsing,o=new Array(i);let a,c,u,h;for(a=0,c=i;a<c;++a)u=a+e,h=t[u],o[a]={r:s.parse(wn(h,r),u)};return o}const pb=Number.EPSILON||1e-14,Ci=(n,t)=>t<n.length&&!n[t].skip&&n[t],gg=n=>n==="x"?"y":"x";function mb(n,t,e,i){const s=n.skip?t:n,r=t,o=e.skip?t:e,a=ec(r,s),c=ec(o,r);let u=a/(a+c),h=c/(a+c);u=isNaN(u)?0:u,h=isNaN(h)?0:h;const d=i*u,g=i*h;return{previous:{x:r.x-d*(o.x-s.x),y:r.y-d*(o.y-s.y)},next:{x:r.x+g*(o.x-s.x),y:r.y+g*(o.y-s.y)}}}function _b(n,t,e){const i=n.length;let s,r,o,a,c,u=Ci(n,0);for(let h=0;h<i-1;++h)if(c=u,u=Ci(n,h+1),!(!c||!u)){if(Ts(t[h],0,pb)){e[h]=e[h+1]=0;continue}s=e[h]/t[h],r=e[h+1]/t[h],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=s*o*t[h],e[h+1]=r*o*t[h])}}function yb(n,t,e="x"){const i=gg(e),s=n.length;let r,o,a,c=Ci(n,0);for(let u=0;u<s;++u){if(o=a,a=c,c=Ci(n,u+1),!a)continue;const h=a[e],d=a[i];o&&(r=(h-o[e])/3,a[`cp1${e}`]=h-r,a[`cp1${i}`]=d-r*t[u]),c&&(r=(c[e]-h)/3,a[`cp2${e}`]=h+r,a[`cp2${i}`]=d+r*t[u])}}function bb(n,t="x"){const e=gg(t),i=n.length,s=Array(i).fill(0),r=Array(i);let o,a,c,u=Ci(n,0);for(o=0;o<i;++o)if(a=c,c=u,u=Ci(n,o+1),!!c){if(u){const h=u[t]-c[t];s[o]=h!==0?(u[e]-c[e])/h:0}r[o]=a?u?be(s[o-1])!==be(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}_b(n,s,r),yb(n,r,t)}function xr(n,t,e){return Math.max(Math.min(n,e),t)}function vb(n,t){let e,i,s,r,o,a=Le(n[0],t);for(e=0,i=n.length;e<i;++e)o=r,r=a,a=e<i-1&&Le(n[e+1],t),r&&(s=n[e],o&&(s.cp1x=xr(s.cp1x,t.left,t.right),s.cp1y=xr(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=xr(s.cp2x,t.left,t.right),s.cp2y=xr(s.cp2y,t.top,t.bottom)))}function wb(n,t,e,i,s){let r,o,a,c;if(t.spanGaps&&(n=n.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")bb(n,s);else{let u=i?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],c=mb(u,a,n[Math.min(r+1,o-(i?0:1))%o],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,u=a}t.capBezierPoints&&vb(n,e)}function Qc(){return typeof window<"u"&&typeof document<"u"}function Jc(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function so(n,t,e){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=n,i}const Mo=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Tb(n,t){return Mo(n).getPropertyValue(t)}const Eb=["top","right","bottom","left"];function Kn(n,t,e){const i={};e=e?"-"+e:"";for(let s=0;s<4;s++){const r=Eb[s];i[r]=parseFloat(n[t+"-"+r+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Ib=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function xb(n,t){const e=n.touches,i=e&&e.length?e[0]:n,{offsetX:s,offsetY:r}=i;let o=!1,a,c;if(Ib(s,r,n.target))a=s,c=r;else{const u=t.getBoundingClientRect();a=i.clientX-u.left,c=i.clientY-u.top,o=!0}return{x:a,y:c,box:o}}function zn(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:i}=t,s=Mo(e),r=s.boxSizing==="border-box",o=Kn(s,"padding"),a=Kn(s,"border","width"),{x:c,y:u,box:h}=xb(n,e),d=o.left+(h&&a.left),g=o.top+(h&&a.top);let{width:m,height:y}=t;return r&&(m-=o.width+a.width,y-=o.height+a.height),{x:Math.round((c-d)/m*e.width/i),y:Math.round((u-g)/y*e.height/i)}}function Sb(n,t,e){let i,s;if(t===void 0||e===void 0){const r=n&&Jc(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=Mo(r),c=Kn(a,"border","width"),u=Kn(a,"padding");t=o.width-u.width-c.width,e=o.height-u.height-c.height,i=so(a.maxWidth,r,"clientWidth"),s=so(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:i||no,maxHeight:s||no}}const un=n=>Math.round(n*10)/10;function Ab(n,t,e,i){const s=Mo(n),r=Kn(s,"margin"),o=so(s.maxWidth,n,"clientWidth")||no,a=so(s.maxHeight,n,"clientHeight")||no,c=Sb(n,t,e);let{width:u,height:h}=c;if(s.boxSizing==="content-box"){const g=Kn(s,"border","width"),m=Kn(s,"padding");u-=m.width+g.width,h-=m.height+g.height}return u=Math.max(0,u-r.width),h=Math.max(0,i?u/i:h-r.height),u=un(Math.min(u,o,c.maxWidth)),h=un(Math.min(h,a,c.maxHeight)),u&&!h&&(h=un(u/2)),(t!==void 0||e!==void 0)&&i&&c.height&&h>c.height&&(h=c.height,u=un(Math.floor(h*i))),{width:u,height:h}}function lh(n,t,e){const i=t||1,s=un(n.height*i),r=un(n.width*i);n.height=un(n.height),n.width=un(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==s||o.width!==r?(n.currentDevicePixelRatio=i,o.height=s,o.width=r,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const Pb=(function(){let n=!1;try{const t={get passive(){return n=!0,!1}};Qc()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n})();function uh(n,t){const e=Tb(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Wn(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function Cb(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:i==="middle"?e<.5?n.y:t.y:i==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function Rb(n,t,e,i){const s={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Wn(n,s,e),a=Wn(s,r,e),c=Wn(r,t,e),u=Wn(o,a,e),h=Wn(a,c,e);return Wn(u,h,e)}const kb=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},Db=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function wi(n,t,e){return n?kb(t,e):Db()}function pg(n,t){let e,i;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function mg(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function _g(n){return n==="angle"?{between:Ns,compare:My,normalize:Ut}:{between:Ve,compare:(t,e)=>t-e,normalize:t=>t}}function hh({start:n,end:t,count:e,loop:i,style:s}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e===0,style:s}}function Mb(n,t,e){const{property:i,start:s,end:r}=e,{between:o,normalize:a}=_g(i),c=t.length;let{start:u,end:h,loop:d}=n,g,m;if(d){for(u+=c,h+=c,g=0,m=c;g<m&&o(a(t[u%c][i]),s,r);++g)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:d,style:n.style}}function yg(n,t,e){if(!e)return[n];const{property:i,start:s,end:r}=e,o=t.length,{compare:a,between:c,normalize:u}=_g(i),{start:h,end:d,loop:g,style:m}=Mb(n,t,e),y=[];let v=!1,w=null,P,C,D;const O=()=>c(s,D,P)&&a(s,D)!==0,M=()=>a(r,P)===0||c(r,D,P),L=()=>v||O(),E=()=>!v||M();for(let b=h,T=h;b<=d;++b)C=t[b%o],!C.skip&&(P=u(C[i]),P!==D&&(v=c(P,s,r),w===null&&L()&&(w=a(P,s)===0?b:T),w!==null&&E()&&(y.push(hh({start:w,end:b,loop:g,count:o,style:m})),w=null),T=b,D=P));return w!==null&&y.push(hh({start:w,end:d,loop:g,count:o,style:m})),y}function bg(n,t){const e=[],i=n.segments;for(let s=0;s<i.length;s++){const r=yg(i[s],n.points,t);r.length&&e.push(...r)}return e}function Ob(n,t,e,i){let s=0,r=t-1;if(e&&!i)for(;s<t&&!n[s].skip;)s++;for(;s<t&&n[s].skip;)s++;for(s%=t,e&&(r+=s);r>s&&n[r%t].skip;)r--;return r%=t,{start:s,end:r}}function Vb(n,t,e,i){const s=n.length,r=[];let o=t,a=n[t],c;for(c=t+1;c<=e;++c){const u=n[c%s];u.skip||u.stop?a.skip||(i=!1,r.push({start:t%s,end:(c-1)%s,loop:i}),t=o=u.stop?c:null):(o=c,a.skip&&(t=c)),a=u}return o!==null&&r.push({start:t%s,end:o%s,loop:i}),r}function Nb(n,t){const e=n.points,i=n.options.spanGaps,s=e.length;if(!s)return[];const r=!!n._loop,{start:o,end:a}=Ob(e,s,r,i);if(i===!0)return dh(n,[{start:o,end:a,loop:r}],e,t);const c=a<o?a+s:a,u=!!n._fullLoop&&o===0&&a===s-1;return dh(n,Vb(e,o,c,u),e,t)}function dh(n,t,e,i){return!i||!i.setContext||!e?t:Lb(n,t,e,i)}function Lb(n,t,e,i){const s=n._chart.getContext(),r=fh(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=e.length,u=[];let h=r,d=t[0].start,g=d;function m(y,v,w,P){const C=a?-1:1;if(y!==v){for(y+=c;e[y%c].skip;)y-=C;for(;e[v%c].skip;)v+=C;y%c!==v%c&&(u.push({start:y%c,end:v%c,loop:w,style:P}),h=P,d=v%c)}}for(const y of t){d=a?d:y.start;let v=e[d%c],w;for(g=d+1;g<=y.end;g++){const P=e[g%c];w=fh(i.setContext(Cn(s,{type:"segment",p0:v,p1:P,p0DataIndex:(g-1)%c,p1DataIndex:g%c,datasetIndex:o}))),Fb(w,h)&&m(d,g-1,y.loop,h),v=P,h=w}d<g-1&&m(d,g-1,y.loop,h)}return u}function fh(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Fb(n,t){if(!t)return!1;const e=[],i=function(s,r){return qc(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,i)!==JSON.stringify(t,i)}function Sr(n,t,e){return n.options.clip?n[e]:t[e]}function Bb(n,t){const{xScale:e,yScale:i}=n;return e&&i?{left:Sr(e,t,"left"),right:Sr(e,t,"right"),top:Sr(i,t,"top"),bottom:Sr(i,t,"bottom")}:t}function vg(n,t){const e=t._clip;if(e.disabled)return!1;const i=Bb(t,n.chartArea);return{left:e.left===!1?0:i.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:i.right+(e.right===!0?0:e.right),top:e.top===!1?0:i.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:i.bottom+(e.bottom===!0?0:e.bottom)}}class Ub{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const r=e.listeners[s],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=ng.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const r=i.items;let o=r.length-1,a=!1,c;for(;o>=0;--o)c=r[o],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),r.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var ke=new Ub;const gh="transparent",zb={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const i=sh(n||gh),s=i.valid&&sh(t||gh);return s&&s.valid?s.mix(i,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class Wb{constructor(t,e,i,s){const r=e[i];s=gs([t.to,s,r,t.from]);const o=gs([t.from,r,s]);this._active=!0,this._fn=t.fn||zb[t.type||typeof o],this._easing=Es[t.easing]||Es.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=gs([t.to,e,s,t.from]),this._from=gs([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let c;if(this._active=r!==a&&(o||e<i),!this._active){this._target[s]=a,this._notify(!0);return}if(e<0){this._target[s]=r;return}c=e/i%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(r,a,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][e]()}}class wg{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Z(t))return;const e=Object.keys(ft.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const r=t[s];if(!Z(r))return;const o={};for(const a of e)o[a]=r[a];(dt(r.properties)&&r.properties||[s]).forEach(a=>{(a===s||!i.has(a))&&i.set(a,o)})})}_animateOptions(t,e){const i=e.options,s=Hb(t,i);if(!s)return[];const r=this._createAnimations(s,i);return i.$shared&&jb(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,e){const i=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){s.push(...this._animateOptions(t,e));continue}const h=e[u];let d=r[u];const g=i.get(u);if(d)if(g&&d.active()){d.update(g,h,a);continue}else d.cancel();if(!g||!g.duration){t[u]=h;continue}r[u]=d=new Wb(g,t,u,h),s.push(d)}return s}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const i=this._createAnimations(t,e);if(i.length)return ke.add(this._chart,i),!0}}function jb(n,t){const e=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const r=n[i[s]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function Hb(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function ph(n,t){const e=n&&n.options||{},i=e.reverse,s=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:i?r:s,end:i?s:r}}function $b(n,t,e){if(e===!1)return!1;const i=ph(n,e),s=ph(t,e);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function qb(n){let t,e,i,s;return Z(n)?(t=n.top,e=n.right,i=n.bottom,s=n.left):t=e=i=s=n,{top:t,right:e,bottom:i,left:s,disabled:n===!1}}function Tg(n,t){const e=[],i=n._getSortedDatasetMetas(t);let s,r;for(s=0,r=i.length;s<r;++s)e.push(i[s].index);return e}function mh(n,t,e,i={}){const s=n.keys,r=i.mode==="single";let o,a,c,u;if(t===null)return;let h=!1;for(o=0,a=s.length;o<a;++o){if(c=+s[o],c===e){if(h=!0,i.all)continue;break}u=n.values[c],yt(u)&&(r||t===0||be(t)===be(u))&&(t+=u)}return!h&&!i.all?0:t}function Gb(n,t){const{iScale:e,vScale:i}=t,s=e.axis==="x"?"x":"y",r=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let c,u,h;for(c=0,u=o.length;c<u;++c)h=o[c],a[c]={[s]:h,[r]:n[h]};return a}function Pa(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function Yb(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function Kb(n){const{min:t,max:e,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}function Xb(n,t,e){const i=n[t]||(n[t]={});return i[e]||(i[e]={})}function _h(n,t,e,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const r=n[s.index];if(e&&r>0||!e&&r<0)return s.index}return null}function yh(n,t){const{chart:e,_cachedMeta:i}=n,s=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=i,c=r.axis,u=o.axis,h=Yb(r,o,i),d=t.length;let g;for(let m=0;m<d;++m){const y=t[m],{[c]:v,[u]:w}=y,P=y._stacks||(y._stacks={});g=P[u]=Xb(s,h,v),g[a]=w,g._top=_h(g,o,!0,i.type),g._bottom=_h(g,o,!1,i.type);const C=g._visualValues||(g._visualValues={});C[a]=w}}function Ca(n,t){const e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function Qb(n,t){return Cn(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Jb(n,t,e){return Cn(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function as(n,t){const e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(const s of t){const r=s._stacks;if(!r||r[i]===void 0||r[i][e]===void 0)return;delete r[i][e],r[i]._visualValues!==void 0&&r[i]._visualValues[e]!==void 0&&delete r[i]._visualValues[e]}}}const Ra=n=>n==="reset"||n==="none",bh=(n,t)=>t?n:Object.assign({},n),Zb=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:Tg(e,!0),values:null};class Rn{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Pa(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&as(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),s=(d,g,m,y)=>d==="x"?g:d==="r"?y:m,r=e.xAxisID=$(i.xAxisID,Ca(t,"x")),o=e.yAxisID=$(i.yAxisID,Ca(t,"y")),a=e.rAxisID=$(i.rAxisID,Ca(t,"r")),c=e.indexAxis,u=e.iAxisID=s(c,r,o,a),h=e.vAxisID=s(c,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(u),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&eh(this._data,this),t._stacked&&as(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(Z(e)){const s=this._cachedMeta;this._data=Gb(e,s)}else if(i!==e){if(i){eh(i,this);const s=this._cachedMeta;as(s),s._parsed=[]}e&&Object.isExtensible(e)&&Ly(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const r=e._stacked;e._stacked=Pa(e.vScale,e),e.stack!==i.stack&&(s=!0,as(e),e.stack=i.stack),this._resyncElements(t),(s||r!==e._stacked)&&(yh(this,e._parsed),e._stacked=Pa(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:s}=this,{iScale:r,_stacked:o}=i,a=r.axis;let c=t===0&&e===s.length?!0:i._sorted,u=t>0&&i._parsed[t-1],h,d,g;if(this._parsing===!1)i._parsed=s,i._sorted=!0,g=s;else{dt(s[t])?g=this.parseArrayData(i,s,t,e):Z(s[t])?g=this.parseObjectData(i,s,t,e):g=this.parsePrimitiveData(i,s,t,e);const m=()=>d[a]===null||u&&d[a]<u[a];for(h=0;h<e;++h)i._parsed[h+t]=d=g[h],c&&(m()&&(c=!1),u=d);i._sorted=c}o&&yh(this,g)}parsePrimitiveData(t,e,i,s){const{iScale:r,vScale:o}=t,a=r.axis,c=o.axis,u=r.getLabels(),h=r===o,d=new Array(s);let g,m,y;for(g=0,m=s;g<m;++g)y=g+i,d[g]={[a]:h||r.parse(u[y],y),[c]:o.parse(e[y],y)};return d}parseArrayData(t,e,i,s){const{xScale:r,yScale:o}=t,a=new Array(s);let c,u,h,d;for(c=0,u=s;c<u;++c)h=c+i,d=e[h],a[c]={x:r.parse(d[0],h),y:o.parse(d[1],h)};return a}parseObjectData(t,e,i,s){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,u=new Array(s);let h,d,g,m;for(h=0,d=s;h<d;++h)g=h+i,m=e[g],u[h]={x:r.parse(wn(m,a),g),y:o.parse(wn(m,c),g)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const s=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:Tg(s,!0),values:e._stacks[t.axis]._visualValues};return mh(a,o,r.index,{mode:i})}updateRangeFromParsed(t,e,i,s){const r=i[e.axis];let o=r===null?NaN:r;const a=s&&i._stacks[e.axis];s&&a&&(s.values=a,o=mh(s,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const i=this._cachedMeta,s=i._parsed,r=i._sorted&&t===i.iScale,o=s.length,a=this._getOtherScale(t),c=Zb(e,i,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=Kb(a);let g,m;function y(){m=s[g];const v=m[a.axis];return!yt(m[t.axis])||h>v||d<v}for(g=0;g<o&&!(!y()&&(this.updateRangeFromParsed(u,t,m,c),r));++g);if(r){for(g=o-1;g>=0;--g)if(!y()){this.updateRangeFromParsed(u,t,m,c);break}}return u}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let s,r,o;for(s=0,r=e.length;s<r;++s)o=e[s][t.axis],yt(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,s=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=qb($(this.options.clip,$b(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,s=i.data||[],r=e.chartArea,o=[],a=this._drawStart||0,c=this._drawCount||s.length-a,u=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,r,a,c),h=a;h<a+c;++h){const d=s[h];d.hidden||(d.active&&u?o.push(d):d.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const s=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=Jb(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=s.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=Qb(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const s=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],c=this.enableOptionSharing&&Vs(i);if(a)return bh(a,c);const u=this.chart.config,h=u.datasetElementScopeKeys(this._type,t),d=s?[`${t}Hover`,"hover",t,""]:[t,""],g=u.getOptionScopes(this.getDataset(),h),m=Object.keys(ft.elements[t]),y=()=>this.getContext(i,s,e),v=u.resolveNamedOptions(g,m,y,d);return v.$shared&&(v.$shared=c,r[o]=Object.freeze(bh(v,c))),v}_resolveAnimations(t,e,i){const s=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let c;if(s.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,e),g=h.getOptionScopes(this.getDataset(),d);c=h.createResolver(g,this.getContext(t,i,e))}const u=new wg(s,c&&c.animations);return c&&c._cacheable&&(r[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Ra(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),s=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(e,r)||r!==s;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:o}}updateElement(t,e,i,s){Ra(s)?Object.assign(t,i):this._resolveAnimations(e,s).update(t,i)}updateSharedOptions(t,e,i){t&&!Ra(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,s){t.active=s;const r=this.getStyle(e,s);this._resolveAnimations(e,i,s).update(t,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[a,c,u]of this._syncList)this[a](c,u);this._syncList=[];const s=i.length,r=e.length,o=Math.min(r,s);o&&this.parse(0,o),r>s?this._insertElements(s,r-s,t):r<s&&this._removeElements(r,s-r)}_insertElements(t,e,i=!0){const s=this._cachedMeta,r=s.data,o=t+e;let a;const c=u=>{for(u.length+=e,a=u.length-1;a>=o;a--)u[a]=u[a-e]};for(c(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,s){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,e);i._stacked&&as(i,s)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,s]=t;this[e](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function tv(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let i=[];for(let s=0,r=e.length;s<r;s++)i=i.concat(e[s].controller.getAllParsedValues(n));n._cache.$bar=eg(i.sort((s,r)=>s-r))}return n._cache.$bar}function ev(n){const t=n.iScale,e=tv(t,n.type);let i=t._length,s,r,o,a;const c=()=>{o===32767||o===-32768||(Vs(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(s=0,r=e.length;s<r;++s)o=t.getPixelForValue(e[s]),c();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),c();return i}function nv(n,t,e,i){const s=e.barThickness;let r,o;return K(s)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[n]-r/2}}function iv(n,t,e,i){const s=t.pixels,r=s[n];let o=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const c=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const u=r-(r-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:e.barPercentage,start:u}}function sv(n,t,e,i){const s=e.parse(n[0],i),r=e.parse(n[1],i),o=Math.min(s,r),a=Math.max(s,r);let c=o,u=a;Math.abs(o)>Math.abs(a)&&(c=a,u=o),t[e.axis]=u,t._custom={barStart:c,barEnd:u,start:s,end:r,min:o,max:a}}function Eg(n,t,e,i){return dt(n)?sv(n,t,e,i):t[e.axis]=e.parse(n,i),t}function vh(n,t,e,i){const s=n.iScale,r=n.vScale,o=s.getLabels(),a=s===r,c=[];let u,h,d,g;for(u=e,h=e+i;u<h;++u)g=t[u],d={},d[s.axis]=a||s.parse(o[u],u),c.push(Eg(g,d,r,u));return c}function ka(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function rv(n,t,e){return n!==0?be(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function ov(n){let t,e,i,s,r;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(s="end",r="start"):(s="start",r="end"),{start:e,end:i,reverse:t,top:s,bottom:r}}function av(n,t,e,i){let s=t.borderSkipped;const r={};if(!s){n.borderSkipped=r;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:c,top:u,bottom:h}=ov(n);s==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?s=u:(e._bottom||0)===i?s=h:(r[wh(h,o,a,c)]=!0,s=u)),r[wh(s,o,a,c)]=!0,n.borderSkipped=r}function wh(n,t,e,i){return i?(n=cv(n,t,e),n=Th(n,e,t)):n=Th(n,t,e),n}function cv(n,t,e){return n===t?e:n===e?t:n}function Th(n,t,e){return n==="start"?t:n==="end"?e:n}function lv(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class uv extends Rn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,s){return vh(t,e,i,s)}parseArrayData(t,e,i,s){return vh(t,e,i,s)}parseObjectData(t,e,i,s){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,u=r.axis==="x"?a:c,h=o.axis==="x"?a:c,d=[];let g,m,y,v;for(g=i,m=i+s;g<m;++g)v=e[g],y={},y[r.axis]=r.parse(wn(v,u),g),d.push(Eg(wn(v,h),y,o,g));return d}updateRangeFromParsed(t,e,i,s){super.updateRangeFromParsed(t,e,i,s);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:s}=e,r=this.getParsed(t),o=r._custom,a=ka(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(r[s.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,s){const r=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,c=a.getBasePixel(),u=a.isHorizontal(),h=this._getRuler(),{sharedOptions:d,includeOptions:g}=this._getSharedOptions(e,s);for(let m=e;m<e+i;m++){const y=this.getParsed(m),v=r||K(y[a.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),w=this._calculateBarIndexPixels(m,h),P=(y._stacks||{})[a.axis],C={horizontal:u,base:v.base,enableBorderRadius:!P||ka(y._custom)||o===P._top||o===P._bottom,x:u?v.head:w.center,y:u?w.center:v.head,height:u?w.size:Math.abs(v.size),width:u?Math.abs(v.size):w.size};g&&(C.options=d||this.resolveDataElementOptions(m,t[m].active?"active":s));const D=C.options||t[m].options;av(C,D,P,o),lv(C,D,h.ratio),this.updateElement(t[m],m,C,s)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),c=a&&a[i.axis],u=h=>{const d=h._parsed.find(m=>m[i.axis]===c),g=d&&d[h.vScale.axis];if(K(g)||isNaN(g))return!0};for(const h of s)if(!(e!==void 0&&u(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[$(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,i){const s=this._getStacks(t,i),r=e!==void 0?s.indexOf(e):-1;return r===-1?s.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,s=[];let r,o;for(r=0,o=e.data.length;r<o;++r)s.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||ev(e),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:s},options:{base:r,minBarLength:o}}=this,a=r||0,c=this.getParsed(t),u=c._custom,h=ka(u);let d=c[e.axis],g=0,m=i?this.applyStack(e,c,i):d,y,v;m!==d&&(g=m-d,m=d),h&&(d=u.barStart,m=u.barEnd-u.barStart,d!==0&&be(d)!==be(u.barEnd)&&(g=0),g+=d);const w=!K(r)&&!h?r:g;let P=e.getPixelForValue(w);if(this.chart.getDataVisibility(t)?y=e.getPixelForValue(g+m):y=P,v=y-P,Math.abs(v)<o){v=rv(v,e,a)*o,d===a&&(P-=v/2);const C=e.getPixelForDecimal(0),D=e.getPixelForDecimal(1),O=Math.min(C,D),M=Math.max(C,D);P=Math.max(Math.min(P,M),O),y=P+v,i&&!h&&(c._stacks[e.axis]._visualValues[s]=e.getValueForPixel(y)-e.getValueForPixel(P))}if(P===e.getPixelForValue(a)){const C=be(v)*e.getLineWidthForValue(a)/2;P+=C,v-=C}return{size:v,base:P,head:y,center:y+v/2}}_calculateBarIndexPixels(t,e){const i=e.scale,s=this.options,r=s.skipNull,o=$(s.maxBarThickness,1/0);let a,c;const u=this._getAxisCount();if(e.grouped){const h=r?this._getStackCount(t):e.stackCount,d=s.barThickness==="flex"?iv(t,e,s,h*u):nv(t,e,s,h*u),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf($(g,this.getFirstScaleIdForIndexAxis())),y=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+m;a=d.start+d.chunk*y+d.chunk/2,c=Math.min(o,d.chunk*d.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),c=Math.min(o,e.min*e.ratio);return{base:a-c/2,head:a+c/2,center:a,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,s=i.length;let r=0;for(;r<s;++r)this.getParsed(r)[e.axis]!==null&&!i[r].hidden&&i[r].draw(this._ctx)}}class hv extends Rn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,s){const r=super.parsePrimitiveData(t,e,i,s);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+i).radius;return r}parseArrayData(t,e,i,s){const r=super.parseArrayData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=$(a[2],this.resolveDataElementOptions(o+i).radius)}return r}parseObjectData(t,e,i,s){const r=super.parseObjectData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=$(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y),u=o._custom;return{label:i[t]||"",value:"("+a+", "+c+(u?", "+u:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(e,s),h=o.axis,d=a.axis;for(let g=e;g<e+i;g++){const m=t[g],y=!r&&this.getParsed(g),v={},w=v[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(y[h]),P=v[d]=r?a.getBasePixel():a.getPixelForValue(y[d]);v.skip=isNaN(w)||isNaN(P),u&&(v.options=c||this.resolveDataElementOptions(g,m.active?"active":s),r&&(v.options.radius=0)),this.updateElement(m,g,v,s)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const r=s.radius;return e!=="active"&&(s.radius=0),s.radius+=$(i&&i._custom,r),s}}function dv(n,t,e){let i=1,s=1,r=0,o=0;if(t<ht){const a=n,c=a+t,u=Math.cos(a),h=Math.sin(a),d=Math.cos(c),g=Math.sin(c),m=(D,O,M)=>Ns(D,a,c,!0)?1:Math.max(O,O*e,M,M*e),y=(D,O,M)=>Ns(D,a,c,!0)?-1:Math.min(O,O*e,M,M*e),v=m(0,u,d),w=m(wt,h,g),P=y(et,u,d),C=y(et+wt,h,g);i=(v-P)/2,s=(w-C)/2,r=-(v+P)/2,o=-(w+C)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}class Zc extends Rn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((c,u)=>{const d=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(u),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:s,pointStyle:i,borderRadius:o&&(a||d.borderRadius),index:u}}):[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let r=c=>+i[c];if(Z(i[t])){const{key:c="value"}=this._parsing;r=u=>+wn(i[u],c)}let o,a;for(o=t,a=t+e;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return ce(this.options.rotation-90)}_getCircumference(){return ce(this.options.circumference)}_getRotationExtents(){let t=ht,e=-ht;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const s=this.chart.getDatasetMeta(i).controller,r=s._getRotation(),o=s._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,s=this._cachedMeta,r=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),c=Math.min(Ty(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:g,ratioY:m,offsetX:y,offsetY:v}=dv(d,h,c),w=(i.width-o)/g,P=(i.height-o)/m,C=Math.max(Math.min(w,P)/2,0),D=Xf(this.options.radius,C),O=Math.max(D*c,0),M=(D-O)/this._getVisibleDatasetWeightTotal();this.offsetX=y*D,this.offsetY=v*D,s.total=this.calculateTotal(),this.outerRadius=D-M*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-M*u,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const i=this.options,s=this._cachedMeta,r=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*r/ht)}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,h=(a.left+a.right)/2,d=(a.top+a.bottom)/2,g=r&&u.animateScale,m=g?0:this.innerRadius,y=g?0:this.outerRadius,{sharedOptions:v,includeOptions:w}=this._getSharedOptions(e,s);let P=this._getRotation(),C;for(C=0;C<e;++C)P+=this._circumference(C,r);for(C=e;C<e+i;++C){const D=this._circumference(C,r),O=t[C],M={x:h+this.offsetX,y:d+this.offsetY,startAngle:P,endAngle:P+D,circumference:D,outerRadius:y,innerRadius:m};w&&(M.options=v||this.resolveDataElementOptions(C,O.active?"active":s)),P+=D,this.updateElement(O,C,M,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i=0,s;for(s=0;s<e.length;s++){const r=t._parsed[s];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(s)&&!e[s].hidden&&(i+=Math.abs(r))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?ht*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Js(e._parsed[t],i.options.locale);return{label:s[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const i=this.chart;let s,r,o,a,c;if(!t){for(s=0,r=i.data.datasets.length;s<r;++s)if(i.isDatasetVisible(s)){o=i.getDatasetMeta(s),t=o.data,a=o.controller;break}}if(!t)return 0;for(s=0,r=t.length;s<r;++s)c=a.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(e=Math.max(e,c.borderWidth||0,c.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,s=t.length;i<s;++i){const r=this.resolveDataElementOptions(i);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max($(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class fv extends Rn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:s=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:c}=sg(e,s,o);this._drawStart=a,this._drawCount=c,rg(e)&&(a=0,c=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=s;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:u},t),this.updateElements(s,a,c,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,s),g=o.axis,m=a.axis,{spanGaps:y,segment:v}=this.options,w=Ai(y)?y:Number.POSITIVE_INFINITY,P=this.chart._animationsDisabled||r||s==="none",C=e+i,D=t.length;let O=e>0&&this.getParsed(e-1);for(let M=0;M<D;++M){const L=t[M],E=P?L:{};if(M<e||M>=C){E.skip=!0;continue}const b=this.getParsed(M),T=K(b[m]),x=E[g]=o.getPixelForValue(b[g],M),S=E[m]=r||T?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,b,c):b[m],M);E.skip=isNaN(x)||isNaN(S)||T,E.stop=M>0&&Math.abs(b[g]-O[g])>w,v&&(E.parsed=b,E.raw=u.data[M]),d&&(E.options=h||this.resolveDataElementOptions(M,L.active?"active":s)),P||this.updateElement(L,M,E,s),O=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const r=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class Ig extends Rn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const c=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:s,lineWidth:c.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Js(e._parsed[t].r,i.options.locale);return{label:s[t]||"",value:r}}parseObjectData(t,e,i,s){return fg.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const r=this.getParsed(s).r;!isNaN(r)&&this.chart.getDataVisibility(s)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(s/2,0),o=Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,c=o.options.animation,u=this._cachedMeta.rScale,h=u.xCenter,d=u.yCenter,g=u.getIndexAngle(0)-.5*et;let m=g,y;const v=360/this.countVisibleElements();for(y=0;y<e;++y)m+=this._computeAngle(y,s,v);for(y=e;y<e+i;y++){const w=t[y];let P=m,C=m+this._computeAngle(y,s,v),D=o.getDataVisibility(y)?u.getDistanceFromCenterForValue(this.getParsed(y).r):0;m=C,r&&(c.animateScale&&(D=0),c.animateRotate&&(P=C=g));const O={x:h,y:d,innerRadius:0,outerRadius:D,startAngle:P,endAngle:C,options:this.resolveDataElementOptions(y,w.active?"active":s)};this.updateElement(w,y,O,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&e++}),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?ce(this.resolveDataElementOptions(t,e).angle||i):0}}class gv extends Zc{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class pv extends Rn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,s){return fg.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta,i=e.dataset,s=e.data||[],r=e.iScale.getLabels();if(i.points=s,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===s.length,options:o};this.updateElement(i,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,i,s){const r=this._cachedMeta.rScale,o=s==="reset";for(let a=e;a<e+i;a++){const c=t[a],u=this.resolveDataElementOptions(a,c.active?"active":s),h=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:h.x,g=o?r.yCenter:h.y,m={x:d,y:g,angle:h.angle,skip:isNaN(d)||isNaN(g),options:u};this.updateElement(c,a,m,s)}}}class mv extends Rn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y);return{label:i[t]||"",value:"("+a+", "+c+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,s=this.chart._animationsDisabled;let{start:r,count:o}=sg(e,i,s);if(this._drawStart=r,this._drawCount=o,rg(e)&&(r=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:c}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!c._decimated,a.points=i;const u=this.resolveDatasetElementOptions(t);u.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:u},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:u}=this._cachedMeta,h=this.resolveDataElementOptions(e,s),d=this.getSharedOptions(h),g=this.includeOptions(s,d),m=o.axis,y=a.axis,{spanGaps:v,segment:w}=this.options,P=Ai(v)?v:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||r||s==="none";let D=e>0&&this.getParsed(e-1);for(let O=e;O<e+i;++O){const M=t[O],L=this.getParsed(O),E=C?M:{},b=K(L[y]),T=E[m]=o.getPixelForValue(L[m],O),x=E[y]=r||b?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,L,c):L[y],O);E.skip=isNaN(T)||isNaN(x)||b,E.stop=O>0&&Math.abs(L[m]-D[m])>P,w&&(E.parsed=L,E.raw=u.data[O]),g&&(E.options=d||this.resolveDataElementOptions(O,M.active?"active":s)),C||this.updateElement(M,O,E,s),D=L}this.updateSharedOptions(d,s,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let c=e.length-1;c>=0;--c)a=Math.max(a,e[c].size(this.resolveDataElementOptions(c))/2);return a>0&&a}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!e.length)return s;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,r,o)/2}}var _v=Object.freeze({__proto__:null,BarController:uv,BubbleController:hv,DoughnutController:Zc,LineController:fv,PieController:gv,PolarAreaController:Ig,RadarController:pv,ScatterController:mv});function Bn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tl{static override(t){Object.assign(tl.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Bn()}parse(){return Bn()}format(){return Bn()}add(){return Bn()}diff(){return Bn()}startOf(){return Bn()}endOf(){return Bn()}}var yv={_date:tl};function bv(n,t,e,i){const{controller:s,data:r,_sorted:o}=n,a=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const u=a._reversePixels?Vy:Ne;if(i){if(s._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(t);if(d){const g=u(r,t,e-d),m=u(r,t,e+d);return{lo:g.lo,hi:m.hi}}}}else{const h=u(r,t,e);if(c){const{vScale:d}=s._cachedMeta,{_parsed:g}=n,m=g.slice(0,h.lo+1).reverse().findIndex(v=>!K(v[d.axis]));h.lo-=Math.max(0,m);const y=g.slice(h.hi).findIndex(v=>!K(v[d.axis]));h.hi+=Math.max(0,y)}return h}}return{lo:0,hi:r.length-1}}function Oo(n,t,e,i,s){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,c=r.length;a<c;++a){const{index:u,data:h}=r[a],{lo:d,hi:g}=bv(r[a],t,o,s);for(let m=d;m<=g;++m){const y=h[m];y.skip||i(y,u,m)}}}function vv(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(i,s){const r=t?Math.abs(i.x-s.x):0,o=e?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function Da(n,t,e,i,s){const r=[];return!s&&!n.isPointInArea(t)||Oo(n,e,t,function(a,c,u){!s&&!Le(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&r.push({element:a,datasetIndex:c,index:u})},!0),r}function wv(n,t,e,i){let s=[];function r(o,a,c){const{startAngle:u,endAngle:h}=o.getProps(["startAngle","endAngle"],i),{angle:d}=Zf(o,{x:t.x,y:t.y});Ns(d,u,h)&&s.push({element:o,datasetIndex:a,index:c})}return Oo(n,e,t,r),s}function Tv(n,t,e,i,s,r){let o=[];const a=vv(e);let c=Number.POSITIVE_INFINITY;function u(h,d,g){const m=h.inRange(t.x,t.y,s);if(i&&!m)return;const y=h.getCenterPoint(s);if(!(!!r||n.isPointInArea(y))&&!m)return;const w=a(t,y);w<c?(o=[{element:h,datasetIndex:d,index:g}],c=w):w===c&&o.push({element:h,datasetIndex:d,index:g})}return Oo(n,e,t,u),o}function Ma(n,t,e,i,s,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!i?wv(n,t,e,s):Tv(n,t,e,i,s,r)}function Eh(n,t,e,i,s){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return Oo(n,e,t,(c,u,h)=>{c[o]&&c[o](t[e],s)&&(r.push({element:c,datasetIndex:u,index:h}),a=a||c.inRange(t.x,t.y,s))}),i&&!a?[]:r}var Ev={modes:{index(n,t,e,i){const s=zn(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?Da(n,s,r,i,o):Ma(n,s,r,!1,i,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(u=>{const h=a[0].index,d=u.data[h];d&&!d.skip&&c.push({element:d,datasetIndex:u.index,index:h})}),c):[]},dataset(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?Da(n,s,r,i,o):Ma(n,s,r,!1,i,o);if(a.length>0){const c=a[0].datasetIndex,u=n.getDatasetMeta(c).data;a=[];for(let h=0;h<u.length;++h)a.push({element:u[h],datasetIndex:c,index:h})}return a},point(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Da(n,s,r,i,o)},nearest(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Ma(n,s,r,e.intersect,i,o)},x(n,t,e,i){const s=zn(t,n);return Eh(n,s,"x",e.intersect,i)},y(n,t,e,i){const s=zn(t,n);return Eh(n,s,"y",e.intersect,i)}}};const xg=["left","top","right","bottom"];function cs(n,t){return n.filter(e=>e.pos===t)}function Ih(n,t){return n.filter(e=>xg.indexOf(e.pos)===-1&&e.box.axis===t)}function ls(n,t){return n.sort((e,i)=>{const s=t?i:e,r=t?e:i;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function Iv(n){const t=[];let e,i,s,r,o,a;for(e=0,i=(n||[]).length;e<i;++e)s=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=s,t.push({index:e,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}function xv(n){const t={};for(const e of n){const{stack:i,pos:s,stackWeight:r}=e;if(!i||!xg.includes(s))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function Sv(n,t){const e=xv(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:c}=a.box,u=e[a.stack],h=u&&a.stackWeight/u.weight;a.horizontal?(a.width=h?h*i:c&&t.availableWidth,a.height=s):(a.width=i,a.height=h?h*s:c&&t.availableHeight)}return e}function Av(n){const t=Iv(n),e=ls(t.filter(u=>u.box.fullSize),!0),i=ls(cs(t,"left"),!0),s=ls(cs(t,"right")),r=ls(cs(t,"top"),!0),o=ls(cs(t,"bottom")),a=Ih(t,"x"),c=Ih(t,"y");return{fullSize:e,leftAndTop:i.concat(r),rightAndBottom:s.concat(c).concat(o).concat(a),chartArea:cs(t,"chartArea"),vertical:i.concat(s).concat(c),horizontal:r.concat(o).concat(a)}}function xh(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function Sg(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function Pv(n,t,e,i){const{pos:s,box:r}=e,o=n.maxPadding;if(!Z(s)){e.size&&(n[s]-=e.size);const d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[s]+=e.size}r.getPadding&&Sg(o,r.getPadding());const a=Math.max(0,t.outerWidth-xh(o,n,"left","right")),c=Math.max(0,t.outerHeight-xh(o,n,"top","bottom")),u=a!==n.w,h=c!==n.h;return n.w=a,n.h=c,e.horizontal?{same:u,other:h}:{same:h,other:u}}function Cv(n){const t=n.maxPadding;function e(i){const s=Math.max(t[i]-n[i],0);return n[i]+=s,s}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function Rv(n,t){const e=t.maxPadding;function i(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return i(n?["left","right"]:["top","bottom"])}function ps(n,t,e,i){const s=[];let r,o,a,c,u,h;for(r=0,o=n.length,u=0;r<o;++r){a=n[r],c=a.box,c.update(a.width||t.w,a.height||t.h,Rv(a.horizontal,t));const{same:d,other:g}=Pv(t,e,a,i);u|=d&&s.length,h=h||g,c.fullSize||s.push(a)}return u&&ps(s,t,e,i)||h}function Ar(n,t,e,i,s){n.top=e,n.left=t,n.right=t+i,n.bottom=e+s,n.width=i,n.height=s}function Sh(n,t,e,i){const s=e.padding;let{x:r,y:o}=t;for(const a of n){const c=a.box,u=i[a.stack]||{placed:0,weight:1},h=a.stackWeight/u.weight||1;if(a.horizontal){const d=t.w*h,g=u.size||c.height;Vs(u.start)&&(o=u.start),c.fullSize?Ar(c,s.left,o,e.outerWidth-s.right-s.left,g):Ar(c,t.left+u.placed,o,d,g),u.start=o,u.placed+=d,o=c.bottom}else{const d=t.h*h,g=u.size||c.width;Vs(u.start)&&(r=u.start),c.fullSize?Ar(c,r,s.top,g,e.outerHeight-s.bottom-s.top):Ar(c,r,t.top+u.placed,g,d),u.start=r,u.placed+=d,r=c.right}}t.x=r,t.y=o}var Wt={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;const s=jt(n.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(e-s.height,0),a=Av(n.boxes),c=a.vertical,u=a.horizontal;ot(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const h=c.reduce((v,w)=>w.box.options&&w.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),g=Object.assign({},s);Sg(g,jt(i));const m=Object.assign({maxPadding:g,w:r,h:o,x:s.left,y:s.top},s),y=Sv(c.concat(u),d);ps(a.fullSize,m,d,y),ps(c,m,d,y),ps(u,m,d,y)&&ps(c,m,d,y),Cv(m),Sh(a.leftAndTop,m,d,y),m.x+=m.w,m.y+=m.h,Sh(a.rightAndBottom,m,d,y),n.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},ot(a.chartArea,v=>{const w=v.box;Object.assign(w,n.chartArea),w.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Ag{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class kv extends Ag{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const zr="$chartjs",Dv={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ah=n=>n===null||n==="";function Mv(n,t){const e=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[zr]={initial:{height:i,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Ah(s)){const r=uh(n,"width");r!==void 0&&(n.width=r)}if(Ah(i))if(n.style.height==="")n.height=n.width/(t||2);else{const r=uh(n,"height");r!==void 0&&(n.height=r)}return n}const Pg=Pb?{passive:!0}:!1;function Ov(n,t,e){n&&n.addEventListener(t,e,Pg)}function Vv(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,Pg)}function Nv(n,t){const e=Dv[n.type]||n.type,{x:i,y:s}=zn(n,t);return{type:e,chart:t,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function ro(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function Lv(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||ro(a.addedNodes,i),o=o&&!ro(a.removedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function Fv(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||ro(a.removedNodes,i),o=o&&!ro(a.addedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const Fs=new Map;let Ph=0;function Cg(){const n=window.devicePixelRatio;n!==Ph&&(Ph=n,Fs.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function Bv(n,t){Fs.size||window.addEventListener("resize",Cg),Fs.set(n,t)}function Uv(n){Fs.delete(n),Fs.size||window.removeEventListener("resize",Cg)}function zv(n,t,e){const i=n.canvas,s=i&&Jc(i);if(!s)return;const r=ig((a,c)=>{const u=s.clientWidth;e(a,c),u<s.clientWidth&&e()},window),o=new ResizeObserver(a=>{const c=a[0],u=c.contentRect.width,h=c.contentRect.height;u===0&&h===0||r(u,h)});return o.observe(s),Bv(n,r),o}function Oa(n,t,e){e&&e.disconnect(),t==="resize"&&Uv(n)}function Wv(n,t,e){const i=n.canvas,s=ig(r=>{n.ctx!==null&&e(Nv(r,n))},n);return Ov(i,t,s),s}class jv extends Ag{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(Mv(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[zr])return!1;const i=e[zr].initial;["height","width"].forEach(r=>{const o=i[r];K(o)?e.removeAttribute(r):e.setAttribute(r,o)});const s=i.style||{};return Object.keys(s).forEach(r=>{e.style[r]=s[r]}),e.width=e.width,delete e[zr],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),o={attach:Lv,detach:Fv,resize:zv}[e]||Wv;s[e]=o(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];if(!s)return;({attach:Oa,detach:Oa,resize:Oa}[e]||Vv)(t,e,s),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return Ab(t,e,i,s)}isAttached(t){const e=t&&Jc(t);return!!(e&&e.isConnected)}}function Hv(n){return!Qc()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?kv:jv}class qe{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return Ai(this.x)&&Ai(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach(r=>{s[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),s}}function $v(n,t){const e=n.options.ticks,i=qv(n),s=Math.min(e.maxTicksLimit||i,i),r=e.major.enabled?Yv(t):[],o=r.length,a=r[0],c=r[o-1],u=[];if(o>s)return Kv(t,u,r,o/s),u;const h=Gv(r,t,s);if(o>0){let d,g;const m=o>1?Math.round((c-a)/(o-1)):null;for(Pr(t,u,h,K(m)?0:a-m,a),d=0,g=o-1;d<g;d++)Pr(t,u,h,r[d],r[d+1]);return Pr(t,u,h,c,K(m)?t.length:c+m),u}return Pr(t,u,h),u}function qv(n){const t=n.options.offset,e=n._tickSize(),i=n._length/e+(t?0:1),s=n._maxLength/e;return Math.floor(Math.min(i,s))}function Gv(n,t,e){const i=Xv(n),s=t.length/e;if(!i)return Math.max(s,1);const r=Ry(i);for(let o=0,a=r.length-1;o<a;o++){const c=r[o];if(c>s)return c}return Math.max(s,1)}function Yv(n){const t=[];let e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}function Kv(n,t,e,i){let s=0,r=e[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===r&&(t.push(n[o]),s++,r=e[s*i])}function Pr(n,t,e,i,s){const r=$(i,0),o=Math.min($(s,n.length),n.length);let a=0,c,u,h;for(e=Math.ceil(e),s&&(c=s-i,e=c/Math.floor(c/e)),h=r;h<0;)a++,h=Math.round(r+a*e);for(u=Math.max(r,0);u<o;u++)u===h&&(t.push(n[u]),a++,h=Math.round(r+a*e))}function Xv(n){const t=n.length;let e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}const Qv=n=>n==="left"?"right":n==="right"?"left":n,Ch=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,Rh=(n,t)=>Math.min(t||n,n);function kh(n,t){const e=[],i=n.length/t,s=n.length;let r=0;for(;r<s;r+=i)e.push(n[Math.floor(r)]);return e}function Jv(n,t,e){const i=n.ticks.length,s=Math.min(t,i-1),r=n._startPixel,o=n._endPixel,a=1e-6;let c=n.getPixelForTick(s),u;if(!(e&&(i===1?u=Math.max(c-r,o-c):t===0?u=(n.getPixelForTick(1)-c)/2:u=(c-n.getPixelForTick(s-1))/2,c+=s<t?u:-u,c<r-a||c>o+a)))return c}function Zv(n,t){ot(n,e=>{const i=e.gc,s=i.length/2;let r;if(s>t){for(r=0;r<s;++r)delete e.data[i[r]];i.splice(0,s)}})}function us(n){return n.drawTicks?n.tickLength:0}function Dh(n,t){if(!n.display)return 0;const e=St(n.font,t),i=jt(n.padding);return(dt(n.text)?n.text.length:1)*e.lineHeight+i.height}function tw(n,t){return Cn(n,{scale:t,type:"scale"})}function ew(n,t,e){return Cn(n,{tick:e,index:t,type:"tick"})}function nw(n,t,e){let i=$c(n);return(e&&t!=="right"||!e&&t==="right")&&(i=Qv(i)),i}function iw(n,t,e,i){const{top:s,left:r,bottom:o,right:a,chart:c}=n,{chartArea:u,scales:h}=c;let d=0,g,m,y;const v=o-s,w=a-r;if(n.isHorizontal()){if(m=Ft(i,r,a),Z(e)){const P=Object.keys(e)[0],C=e[P];y=h[P].getPixelForValue(C)+v-t}else e==="center"?y=(u.bottom+u.top)/2+v-t:y=Ch(n,e,t);g=a-r}else{if(Z(e)){const P=Object.keys(e)[0],C=e[P];m=h[P].getPixelForValue(C)-w+t}else e==="center"?m=(u.left+u.right)/2-w+t:m=Ch(n,e,t);y=Ft(i,o,s),d=e==="left"?-wt:wt}return{titleX:m,titleY:y,maxWidth:g,rotation:d}}class ri extends qe{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=Jt(t,Number.POSITIVE_INFINITY),e=Jt(e,Number.NEGATIVE_INFINITY),i=Jt(i,Number.POSITIVE_INFINITY),s=Jt(s,Number.NEGATIVE_INFINITY),{min:Jt(t,i),max:Jt(e,s),minDefined:yt(t),maxDefined:yt(e)}}getMinMax(t){let{min:e,max:i,minDefined:s,maxDefined:r}=this.getUserBounds(),o;if(s&&r)return{min:e,max:i};const a=this.getMatchingVisibleMetas();for(let c=0,u=a.length;c<u;++c)o=a[c].controller.getMinMax(this,t),s||(e=Math.min(e,o.min)),r||(i=Math.max(i,o.max));return e=r&&e>i?i:e,i=s&&e>i?e:i,{min:Jt(e,Jt(i,e)),max:Jt(i,Jt(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ct(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=rb(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=a<this.ticks.length;this._convertTicksToLabels(c?kh(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=$v(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ct(this.options.afterUpdate,[this])}beforeSetDimensions(){ct(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ct(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ct(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ct(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i],r.label=ct(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){ct(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ct(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Rh(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,r=e.maxRotation;let o=s,a,c,u;if(!this._isVisible()||!e.display||s>=r||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),d=h.widest.width,g=h.highest.height,m=Rt(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/i:m/(i-1),d+6>a&&(a=m/(i-(t.offset?.5:1)),c=this.maxHeight-us(t.grid)-e.padding-Dh(t.title,this.chart.options.font),u=Math.sqrt(d*d+g*g),o=jc(Math.min(Math.asin(Rt((h.highest.height+6)/a,-1,1)),Math.asin(Rt(c/u,-1,1))-Math.asin(Rt(g/u,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){ct(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ct(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const c=Dh(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=us(r)+c):(t.height=this.maxHeight,t.width=us(r)+c),i.display&&this.ticks.length){const{first:u,last:h,widest:d,highest:g}=this._getLabelSizes(),m=i.padding*2,y=ce(this.labelRotation),v=Math.cos(y),w=Math.sin(y);if(a){const P=i.mirror?0:w*d.width+v*g.height;t.height=Math.min(this.maxHeight,t.height+P+m)}else{const P=i.mirror?0:v*d.width+w*g.height;t.width=Math.min(this.maxWidth,t.width+P+m)}this._calculatePadding(u,h,w,v)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:r,padding:o},position:a}=this.options,c=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,m=0;c?u?(g=s*t.width,m=i*e.height):(g=i*t.height,m=s*e.width):r==="start"?m=e.width:r==="end"?g=t.width:r!=="inner"&&(g=t.width/2,m=e.width/2),this.paddingLeft=Math.max((g-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((m-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;r==="start"?(h=0,d=t.height):r==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ct(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)K(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=kh(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:r}=this,o=[],a=[],c=Math.floor(e/Rh(e,i));let u=0,h=0,d,g,m,y,v,w,P,C,D,O,M;for(d=0;d<e;d+=c){if(y=t[d].label,v=this._resolveTickFontOptions(d),s.font=w=v.string,P=r[w]=r[w]||{data:{},gc:[]},C=v.lineHeight,D=O=0,!K(y)&&!dt(y))D=io(s,P.data,P.gc,D,y),O=C;else if(dt(y))for(g=0,m=y.length;g<m;++g)M=y[g],!K(M)&&!dt(M)&&(D=io(s,P.data,P.gc,D,M),O+=C);o.push(D),a.push(O),u=Math.max(D,u),h=Math.max(O,h)}Zv(r,e);const L=o.indexOf(u),E=a.indexOf(h),b=T=>({width:o[T]||0,height:a[T]||0});return{first:b(0),last:b(e-1),widest:b(L),highest:b(E),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Oy(this._alignToPixels?Fn(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=ew(this.getContext(),t,i))}return this.$context||(this.$context=tw(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=ce(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,c=r?r.highest.height+o:0;return this.isHorizontal()?c*i>a*s?a/i:c/s:c*s<a*i?c/i:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:r,position:o,border:a}=s,c=r.offset,u=this.isHorizontal(),d=this.ticks.length+(c?1:0),g=us(r),m=[],y=a.setContext(this.getContext()),v=y.display?y.width:0,w=v/2,P=function(it){return Fn(i,it,v)};let C,D,O,M,L,E,b,T,x,S,A,I;if(o==="top")C=P(this.bottom),E=this.bottom-g,T=C-w,S=P(t.top)+w,I=t.bottom;else if(o==="bottom")C=P(this.top),S=t.top,I=P(t.bottom)-w,E=C+w,T=this.top+g;else if(o==="left")C=P(this.right),L=this.right-g,b=C-w,x=P(t.left)+w,A=t.right;else if(o==="right")C=P(this.left),x=t.left,A=P(t.right)-w,L=C+w,b=this.left+g;else if(e==="x"){if(o==="center")C=P((t.top+t.bottom)/2+.5);else if(Z(o)){const it=Object.keys(o)[0],gt=o[it];C=P(this.chart.scales[it].getPixelForValue(gt))}S=t.top,I=t.bottom,E=C+w,T=E+g}else if(e==="y"){if(o==="center")C=P((t.left+t.right)/2);else if(Z(o)){const it=Object.keys(o)[0],gt=o[it];C=P(this.chart.scales[it].getPixelForValue(gt))}L=C-w,b=L-g,x=t.left,A=t.right}const nt=$(s.ticks.maxTicksLimit,d),G=Math.max(1,Math.ceil(d/nt));for(D=0;D<d;D+=G){const it=this.getContext(D),gt=r.setContext(it),Vt=a.setContext(it),bt=gt.lineWidth,Ye=gt.color,kn=Vt.dash||[],Pe=Vt.dashOffset,Ke=gt.tickWidth,Zt=gt.tickColor,Ce=gt.tickBorderDash||[],oe=gt.tickBorderDashOffset;O=Jv(this,D,c),O!==void 0&&(M=Fn(i,O,bt),u?L=b=x=A=M:E=T=S=I=M,m.push({tx1:L,ty1:E,tx2:b,ty2:T,x1:x,y1:S,x2:A,y2:I,width:bt,color:Ye,borderDash:kn,borderDashOffset:Pe,tickWidth:Ke,tickColor:Zt,tickBorderDash:Ce,tickBorderDashOffset:oe}))}return this._ticksLength=d,this._borderValue=C,m}_computeLabelItems(t){const e=this.axis,i=this.options,{position:s,ticks:r}=i,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:u,padding:h,mirror:d}=r,g=us(i.grid),m=g+h,y=d?-h:m,v=-ce(this.labelRotation),w=[];let P,C,D,O,M,L,E,b,T,x,S,A,I="middle";if(s==="top")L=this.bottom-y,E=this._getXAxisLabelAlignment();else if(s==="bottom")L=this.top+y,E=this._getXAxisLabelAlignment();else if(s==="left"){const G=this._getYAxisLabelAlignment(g);E=G.textAlign,M=G.x}else if(s==="right"){const G=this._getYAxisLabelAlignment(g);E=G.textAlign,M=G.x}else if(e==="x"){if(s==="center")L=(t.top+t.bottom)/2+m;else if(Z(s)){const G=Object.keys(s)[0],it=s[G];L=this.chart.scales[G].getPixelForValue(it)+m}E=this._getXAxisLabelAlignment()}else if(e==="y"){if(s==="center")M=(t.left+t.right)/2-m;else if(Z(s)){const G=Object.keys(s)[0],it=s[G];M=this.chart.scales[G].getPixelForValue(it)}E=this._getYAxisLabelAlignment(g).textAlign}e==="y"&&(c==="start"?I="top":c==="end"&&(I="bottom"));const nt=this._getLabelSizes();for(P=0,C=a.length;P<C;++P){D=a[P],O=D.label;const G=r.setContext(this.getContext(P));b=this.getPixelForTick(P)+r.labelOffset,T=this._resolveTickFontOptions(P),x=T.lineHeight,S=dt(O)?O.length:1;const it=S/2,gt=G.color,Vt=G.textStrokeColor,bt=G.textStrokeWidth;let Ye=E;o?(M=b,E==="inner"&&(P===C-1?Ye=this.options.reverse?"left":"right":P===0?Ye=this.options.reverse?"right":"left":Ye="center"),s==="top"?u==="near"||v!==0?A=-S*x+x/2:u==="center"?A=-nt.highest.height/2-it*x+x:A=-nt.highest.height+x/2:u==="near"||v!==0?A=x/2:u==="center"?A=nt.highest.height/2-it*x:A=nt.highest.height-S*x,d&&(A*=-1),v!==0&&!G.showLabelBackdrop&&(M+=x/2*Math.sin(v))):(L=b,A=(1-S)*x/2);let kn;if(G.showLabelBackdrop){const Pe=jt(G.backdropPadding),Ke=nt.heights[P],Zt=nt.widths[P];let Ce=A-Pe.top,oe=0-Pe.left;switch(I){case"middle":Ce-=Ke/2;break;case"bottom":Ce-=Ke;break}switch(E){case"center":oe-=Zt/2;break;case"right":oe-=Zt;break;case"inner":P===C-1?oe-=Zt:P>0&&(oe-=Zt/2);break}kn={left:oe,top:Ce,width:Zt+Pe.width,height:Ke+Pe.height,color:G.backdropColor}}w.push({label:O,font:T,textOffset:A,options:{rotation:v,color:gt,strokeColor:Vt,strokeWidth:bt,textAlign:Ye,textBaseline:I,translation:[M,L],backdrop:kn}})}return w}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-ce(this.labelRotation))return t==="top"?"left":"right";let s="center";return e.align==="start"?s="left":e.align==="end"?s="right":e.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,c=o.widest.width;let u,h;return e==="left"?s?(h=this.right+r,i==="near"?u="left":i==="center"?(u="center",h+=c/2):(u="right",h+=c)):(h=this.right-a,i==="near"?u="right":i==="center"?(u="center",h-=c/2):(u="left",h=this.left)):e==="right"?s?(h=this.left+r,i==="near"?u="right":i==="center"?(u="center",h-=c/2):(u="left",h-=c)):(h=this.left+a,i==="near"?u="left":i==="center"?(u="center",h+=c/2):(u="right",h=this.right)):u="right",{textAlign:u,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(c,u,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(u.x,u.y),i.stroke(),i.restore())};if(e.display)for(r=0,o=s.length;r<o;++r){const c=s[r];e.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),e.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:s}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,h,d,g;this.isHorizontal()?(u=Fn(t,this.left,o)-o/2,h=Fn(t,this.right,a)+a/2,d=g=c):(d=Fn(t,this.top,o)-o/2,g=Fn(t,this.bottom,a)+a/2,u=h=c),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(u,d),e.lineTo(h,g),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&ko(i,s);const r=this.getLabelItems(t);for(const o of r){const a=o.options,c=o.font,u=o.label,h=o.textOffset;Zn(i,u,0,h,c,a)}s&&Do(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:s}}=this;if(!i.display)return;const r=St(i.font),o=jt(i.padding),a=i.align;let c=r.lineHeight/2;e==="bottom"||e==="center"||Z(e)?(c+=o.bottom,dt(i.text)&&(c+=r.lineHeight*(i.text.length-1))):c+=o.top;const{titleX:u,titleY:h,maxWidth:d,rotation:g}=iw(this,c,e,a);Zn(t,i.text,0,0,r,{color:i.color,maxWidth:d,rotation:g,textAlign:nw(a,e,s),textBaseline:"middle",translation:[u,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=$(t.grid&&t.grid.z,-1),s=$(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==ri.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return St(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Cr{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;ow(e)&&(i=this.register(e));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,sw(t,o,i),this.override&&ft.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in ft[s]&&(delete ft[s][i],this.override&&delete Jn[i])}}function sw(n,t,e){const i=Os(Object.create(null),[e?ft.get(e):{},ft.get(t),n.defaults]);ft.set(t,i),n.defaultRoutes&&rw(t,n.defaultRoutes),n.descriptors&&ft.describe(t,n.descriptors)}function rw(n,t){Object.keys(t).forEach(e=>{const i=e.split("."),s=i.pop(),r=[n].concat(i).join("."),o=t[e].split("."),a=o.pop(),c=o.join(".");ft.route(r,s,c,a)})}function ow(n){return"id"in n&&"defaults"in n}class aw{constructor(){this.controllers=new Cr(Rn,"datasets",!0),this.elements=new Cr(qe,"elements"),this.plugins=new Cr(Object,"plugins"),this.scales=new Cr(ri,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(s=>{const r=i||this._getRegistryForType(s);i||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):ot(s,o=>{const a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,i){const s=Wc(t);ct(i["before"+s],[],i),e[t](i),ct(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var pe=new aw;class cw{constructor(){this._init=void 0}notify(t,e,i,s){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,e,i);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,i,s){s=s||{};for(const r of t){const o=r.plugin,a=o[i],c=[e,s,r.options];if(ct(a,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){K(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=$(i.options&&i.options.plugins,{}),r=lw(i);return s===!1&&!e?[]:hw(t,r,s,e)}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(r,o)=>r.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function lw(n){const t={},e=[],i=Object.keys(pe.plugins.items);for(let r=0;r<i.length;r++)e.push(pe.getPlugin(i[r]));const s=n.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function uw(n,t){return!t&&n===!1?null:n===!0?{}:n}function hw(n,{plugins:t,localIds:e},i,s){const r=[],o=n.getContext();for(const a of t){const c=a.id,u=uw(i[c],s);u!==null&&r.push({plugin:a,options:dw(n.config,{plugin:a,local:e[c]},u,o)})}return r}function dw(n,{plugin:t,local:e},i,s){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(i,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function sc(n,t){const e=ft.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function fw(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function gw(n,t){return n===t?"_index_":"_value_"}function Mh(n){if(n==="x"||n==="y"||n==="r")return n}function pw(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function rc(n,...t){if(Mh(n))return n;for(const e of t){const i=e.axis||pw(e.position)||n.length>1&&Mh(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Oh(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function mw(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return Oh(n,"x",e[0])||Oh(n,"y",e[0])}return{}}function _w(n,t){const e=Jn[n.type]||{scales:{}},i=t.scales||{},s=sc(n.type,t),r=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!Z(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=rc(o,a,mw(o,n),ft.scales[a.type]),u=gw(c,s),h=e.scales||{};r[o]=ws(Object.create(null),[{axis:c},a,h[c],h[u]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,c=o.indexAxis||sc(a,t),h=(Jn[a]||{}).scales||{};Object.keys(h).forEach(d=>{const g=fw(d,c),m=o[g+"AxisID"]||g;r[m]=r[m]||Object.create(null),ws(r[m],[{axis:g},i[m],h[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];ws(a,[ft.scales[a.type],ft.scale])}),r}function Rg(n){const t=n.options||(n.options={});t.plugins=$(t.plugins,{}),t.scales=_w(n,t)}function kg(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function yw(n){return n=n||{},n.data=kg(n.data),Rg(n),n}const Vh=new Map,Dg=new Set;function Rr(n,t){let e=Vh.get(n);return e||(e=t(),Vh.set(n,e),Dg.add(e)),e}const hs=(n,t,e)=>{const i=wn(t,e);i!==void 0&&n.add(i)};class bw{constructor(t){this._config=yw(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=kg(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Rg(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Rr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Rr(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Rr(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,i=this.type;return Rr(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return(!s||e)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:r}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const c=new Set;e.forEach(h=>{t&&(c.add(t),h.forEach(d=>hs(c,t,d))),h.forEach(d=>hs(c,s,d)),h.forEach(d=>hs(c,Jn[r]||{},d)),h.forEach(d=>hs(c,ft,d)),h.forEach(d=>hs(c,nc,d))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),Dg.has(e)&&o.set(e,u),u}chartOptionScopes(){const{options:t,type:e}=this;return[t,Jn[e]||{},ft.datasets[e]||{},{type:e},ft,nc]}resolveNamedOptions(t,e,i,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=Nh(this._resolverCache,t,s);let c=o;if(ww(o,e)){r.$shared=!1,i=Tn(i)?i():i;const u=this.createResolver(t,i,a);c=Pi(o,i,u)}for(const u of e)r[u]=c[u];return r}createResolver(t,e,i=[""],s){const{resolver:r}=Nh(this._resolverCache,t,i);return Z(e)?Pi(r,e,void 0,s):r}}function Nh(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));const s=e.join();let r=i.get(s);return r||(r={resolver:Yc(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,r)),r}const vw=n=>Z(n)&&Object.getOwnPropertyNames(n).some(t=>Tn(n[t]));function ww(n,t){const{isScriptable:e,isIndexable:i}=lg(n);for(const s of t){const r=e(s),o=i(s),a=(o||r)&&n[s];if(r&&(Tn(a)||vw(a))||o&&dt(a))return!0}return!1}var Tw="4.5.1";const Ew=["top","bottom","left","right","chartArea"];function Lh(n,t){return n==="top"||n==="bottom"||Ew.indexOf(n)===-1&&t==="x"}function Fh(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function Bh(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),ct(e&&e.onComplete,[n],t)}function Iw(n){const t=n.chart,e=t.options.animation;ct(e&&e.onProgress,[n],t)}function Mg(n){return Qc()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Wr={},Uh=n=>{const t=Mg(n);return Object.values(Wr).filter(e=>e.canvas===t).pop()};function xw(n,t,e){const i=Object.keys(n);for(const s of i){const r=+s;if(r>=t){const o=n[s];delete n[s],(e>0||r>t)&&(n[r+e]=o)}}}function Sw(n,t,e,i){return!e||n.type==="mouseout"?null:i?t:n}class Vo{static defaults=ft;static instances=Wr;static overrides=Jn;static registry=pe;static version=Tw;static getChart=Uh;static register(...t){pe.add(...t),zh()}static unregister(...t){pe.remove(...t),zh()}constructor(t,e){const i=this.config=new bw(e),s=Mg(t),r=Uh(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Hv(s)),this.platform.updateConfig(i);const a=this.platform.acquireContext(s,o.aspectRatio),c=a&&a.canvas,u=c&&c.height,h=c&&c.width;if(this.id=wy(),this.ctx=a,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new cw,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Fy(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Wr[this.id]=this,!a||!c){console.error("Failed to create chart: can't acquire context from the given item");return}ke.listen(this,"complete",Bh),ke.listen(this,"progress",Iw),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:s,_aspectRatio:r}=this;return K(t)?e&&r?r:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return pe}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():lh(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return oh(this.canvas,this.ctx),this}stop(){return ke.stop(this),this}resize(t,e){ke.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,s=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,e,r),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,lh(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),ct(i.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};ot(e,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,s=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],c=rc(o,a),u=c==="r",h=c==="x";return{options:a,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),ot(r,o=>{const a=o.options,c=a.id,u=rc(c,a),h=$(a.type,o.dtype);(a.position===void 0||Lh(a.position,u)!==Lh(o.dposition))&&(a.position=o.dposition),s[c]=!0;let d=null;if(c in i&&i[c].type===h)d=i[c];else{const g=pe.getScale(h);d=new g({id:c,type:h,ctx:this.ctx,chart:this}),i[d.id]=d}d.init(a,t)}),ot(s,(o,a)=>{o||delete i[a]}),ot(i,o=>{Wt.configure(this,o,o.options),Wt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((s,r)=>s.index-r.index),i>e){for(let s=e;s<i;++s)this._destroyDatasetMeta(s);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(Fh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((i,s)=>{e.filter(r=>r===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=e.length;i<s;i++){const r=e[i];let o=this.getDatasetMeta(i);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=r.indexAxis||sc(a,this.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const c=pe.getController(a),{datasetElementType:u,dataElementType:h}=ft.datasets[a];Object.assign(c,{dataElementType:pe.getElement(h),datasetElementType:u&&pe.getElement(u)}),o.controller=new c(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){ot(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){const{controller:d}=this.getDatasetMeta(u),g=!s&&r.indexOf(d)===-1;d.buildOrUpdateElements(g),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),s||ot(r,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Fh("z","_idx"));const{_active:a,_lastEvent:c}=this;c?this._eventHandler(c,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){ot(this.scales,t=>{Wt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Qu(e,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:r}of e){const o=i==="_removeElements"?-r:r;xw(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),s=i(0);for(let r=1;r<e;r++)if(!Qu(s,i(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Wt.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],ot(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,i=this.data.datasets.length;e<i;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,Tn(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ke.has(this)?this.attached&&!ke.running(this)&&ke.start(this):(this.draw(),Bh({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let s,r;for(s=0,r=e.length;s<r;++s){const o=e[s];(!t||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i={meta:t,index:t.index,cancelable:!0},s=vg(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(s&&ko(e,s),t.controller.draw(),s&&Do(e),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return Le(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,s){const r=Ev.modes[e];return typeof r=="function"?r(this,t,i,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let s=i.filter(r=>r&&r._dataset===e).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=Cn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!e.hidden}setDatasetVisibility(t,e){const i=this.getDatasetMeta(t);i.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const s=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,s);Vs(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),ke.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),oh(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Wr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},s=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};ot(this.options.events,r=>i(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(c,u)=>{e.addEventListener(this,c,u),t[c]=u},s=(c,u)=>{t[c]&&(e.removeEventListener(this,c,u),delete t[c])},r=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",r),i("detach",o)};o=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){ot(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},ot(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const s=i?"set":"remove";let r,o,a,c;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),a=0,c=t.length;a<c;++a){o=t[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!to(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,i){const s=this.options.hover,r=(c,u)=>c.filter(h=>!u.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),o=r(e,t),a=i?t:r(t,e);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:s=[],options:r}=this,o=e,a=this._getActiveElements(t,s,i,o),c=Ay(t),u=Sw(t,this._lastEvent,i,c);i&&(this._lastEvent=null,ct(r.onHover,[t,a,this],this),c&&ct(r.onClick,[t,a,this],this));const h=!to(a,s);return(h||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=u,h}_getActiveElements(t,e,i,s){if(t.type==="mouseout")return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,s)}}function zh(){return ot(Vo.instances,n=>n._plugins.invalidate())}function Aw(n,t,e){const{startAngle:i,x:s,y:r,outerRadius:o,innerRadius:a,options:c}=t,{borderWidth:u,borderJoinStyle:h}=c,d=Math.min(u/o,Ut(i-e));if(n.beginPath(),n.arc(s,r,o-u/2,i+d/2,e-d/2),a>0){const g=Math.min(u/a,Ut(i-e));n.arc(s,r,a+u/2,e-g/2,i+g/2,!0)}else{const g=Math.min(u/2,o*Ut(i-e));if(h==="round")n.arc(s,r,g,e-et/2,i+et/2,!0);else if(h==="bevel"){const m=2*g*g,y=-m*Math.cos(e+et/2)+s,v=-m*Math.sin(e+et/2)+r,w=m*Math.cos(i+et/2)+s,P=m*Math.sin(i+et/2)+r;n.lineTo(y,v),n.lineTo(w,P)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function Pw(n,t,e){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:c}=t;let u=s/a;n.beginPath(),n.arc(r,o,a,i-u,e+u),c>s?(u=s/c,n.arc(r,o,c,e+u,i-u,!0)):n.arc(r,o,s,e+wt,i-wt),n.closePath(),n.clip()}function Cw(n){return Gc(n,["outerStart","outerEnd","innerStart","innerEnd"])}function Rw(n,t,e,i){const s=Cw(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,i*t/2),a=c=>{const u=(e-Math.min(r,c))*i/2;return Rt(c,0,Math.min(r,u))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Rt(s.innerStart,0,o),innerEnd:Rt(s.innerEnd,0,o)}}function gi(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function oo(n,t,e,i,s,r){const{x:o,y:a,startAngle:c,pixelMargin:u,innerRadius:h}=t,d=Math.max(t.outerRadius+i+e-u,0),g=h>0?h+i+e+u:0;let m=0;const y=s-c;if(i){const G=h>0?h-i:0,it=d>0?d-i:0,gt=(G+it)/2,Vt=gt!==0?y*gt/(gt+i):y;m=(y-Vt)/2}const v=Math.max(.001,y*d-e/et)/d,w=(y-v)/2,P=c+w+m,C=s-w-m,{outerStart:D,outerEnd:O,innerStart:M,innerEnd:L}=Rw(t,g,d,C-P),E=d-D,b=d-O,T=P+D/E,x=C-O/b,S=g+M,A=g+L,I=P+M/S,nt=C-L/A;if(n.beginPath(),r){const G=(T+x)/2;if(n.arc(o,a,d,T,G),n.arc(o,a,d,G,x),O>0){const bt=gi(b,x,o,a);n.arc(bt.x,bt.y,O,x,C+wt)}const it=gi(A,C,o,a);if(n.lineTo(it.x,it.y),L>0){const bt=gi(A,nt,o,a);n.arc(bt.x,bt.y,L,C+wt,nt+Math.PI)}const gt=(C-L/g+(P+M/g))/2;if(n.arc(o,a,g,C-L/g,gt,!0),n.arc(o,a,g,gt,P+M/g,!0),M>0){const bt=gi(S,I,o,a);n.arc(bt.x,bt.y,M,I+Math.PI,P-wt)}const Vt=gi(E,P,o,a);if(n.lineTo(Vt.x,Vt.y),D>0){const bt=gi(E,T,o,a);n.arc(bt.x,bt.y,D,P-wt,T)}}else{n.moveTo(o,a);const G=Math.cos(T)*d+o,it=Math.sin(T)*d+a;n.lineTo(G,it);const gt=Math.cos(x)*d+o,Vt=Math.sin(x)*d+a;n.lineTo(gt,Vt)}n.closePath()}function kw(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let c=t.endAngle;if(r){oo(n,t,e,i,c,s);for(let u=0;u<r;++u)n.fill();isNaN(a)||(c=o+(a%ht||ht))}return oo(n,t,e,i,c,s),n.fill(),c}function Dw(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a,options:c}=t,{borderWidth:u,borderJoinStyle:h,borderDash:d,borderDashOffset:g,borderRadius:m}=c,y=c.borderAlign==="inner";if(!u)return;n.setLineDash(d||[]),n.lineDashOffset=g,y?(n.lineWidth=u*2,n.lineJoin=h||"round"):(n.lineWidth=u,n.lineJoin=h||"bevel");let v=t.endAngle;if(r){oo(n,t,e,i,v,s);for(let w=0;w<r;++w)n.stroke();isNaN(a)||(v=o+(a%ht||ht))}y&&Pw(n,t,v),c.selfJoin&&v-o>=et&&m===0&&h!=="miter"&&Aw(n,t,v),r||(oo(n,t,e,i,v,s),n.stroke())}class Mw extends qe{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.getProps(["x","y"],i),{angle:r,distance:o}=Zf(s,{x:t,y:e}),{startAngle:a,endAngle:c,innerRadius:u,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),g=(this.options.spacing+this.options.borderWidth)/2,m=$(d,c-a),y=Ns(r,a,c)&&a!==c,v=m>=ht||y,w=Ve(o,u+g,h+g);return v&&w}getCenterPoint(t){const{x:e,y:i,startAngle:s,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,h=(s+r)/2,d=(o+a+u+c)/2;return{x:e+Math.cos(h)*d,y:i+Math.sin(h)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,s=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=i>ht?Math.floor(i/ht):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*s,Math.sin(a)*s);const c=1-Math.sin(Math.min(et,i||0)),u=s*c;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,kw(t,this,u,r,o),Dw(t,this,u,r,o),t.restore()}}function Og(n,t,e=t){n.lineCap=$(e.borderCapStyle,t.borderCapStyle),n.setLineDash($(e.borderDash,t.borderDash)),n.lineDashOffset=$(e.borderDashOffset,t.borderDashOffset),n.lineJoin=$(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=$(e.borderWidth,t.borderWidth),n.strokeStyle=$(e.borderColor,t.borderColor)}function Ow(n,t,e){n.lineTo(e.x,e.y)}function Vw(n){return n.stepped?Xy:n.tension||n.cubicInterpolationMode==="monotone"?Qy:Ow}function Vg(n,t,e={}){const i=n.length,{start:s=0,end:r=i-1}=e,{start:o,end:a}=t,c=Math.max(s,o),u=Math.min(r,a),h=s<o&&r<o||s>a&&r>a;return{count:i,start:c,loop:t.loop,ilen:u<c&&!h?i+u-c:u-c}}function Nw(n,t,e,i){const{points:s,options:r}=t,{count:o,start:a,loop:c,ilen:u}=Vg(s,e,i),h=Vw(r);let{move:d=!0,reverse:g}=i||{},m,y,v;for(m=0;m<=u;++m)y=s[(a+(g?u-m:m))%o],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):h(n,v,y,g,r.stepped),v=y);return c&&(y=s[(a+(g?u:0))%o],h(n,v,y,g,r.stepped)),!!c}function Lw(n,t,e,i){const s=t.points,{count:r,start:o,ilen:a}=Vg(s,e,i),{move:c=!0,reverse:u}=i||{};let h=0,d=0,g,m,y,v,w,P;const C=O=>(o+(u?a-O:O))%r,D=()=>{v!==w&&(n.lineTo(h,w),n.lineTo(h,v),n.lineTo(h,P))};for(c&&(m=s[C(0)],n.moveTo(m.x,m.y)),g=0;g<=a;++g){if(m=s[C(g)],m.skip)continue;const O=m.x,M=m.y,L=O|0;L===y?(M<v?v=M:M>w&&(w=M),h=(d*h+O)/++d):(D(),n.lineTo(O,M),y=L,d=0,v=w=M),P=M}D()}function oc(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?Lw:Nw}function Fw(n){return n.stepped?Cb:n.tension||n.cubicInterpolationMode==="monotone"?Rb:Wn}function Bw(n,t,e,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,i)&&s.closePath()),Og(n,t.options),n.stroke(s)}function Uw(n,t,e,i){const{segments:s,options:r}=t,o=oc(t);for(const a of s)Og(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}const zw=typeof Path2D=="function";function Ww(n,t,e,i){zw&&!t.options.segment?Bw(n,t,e,i):Uw(n,t,e,i)}class No extends qe{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;wb(this._points,i,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Nb(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,s=t[e],r=this.points,o=bg(this,{property:e,start:s,end:s});if(!o.length)return;const a=[],c=Fw(i);let u,h;for(u=0,h=o.length;u<h;++u){const{start:d,end:g}=o[u],m=r[d],y=r[g];if(m===y){a.push(m);continue}const v=Math.abs((s-m[e])/(y[e]-m[e])),w=c(m,y,v,i.stepped);w[e]=t[e],a.push(w)}return a.length===1?a[0]:a}pathSegment(t,e,i){return oc(this)(t,this,e,i)}path(t,e,i){const s=this.segments,r=oc(this);let o=this._loop;e=e||0,i=i||this.points.length-e;for(const a of s)o&=r(t,this,a,{start:e,end:e+i-1});return!!o}draw(t,e,i,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),Ww(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Wh(n,t,e,i){const s=n.options,{[e]:r}=n.getProps([e],i);return Math.abs(t-r)<s.radius+s.hitRadius}class jw extends qe{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.options,{x:r,y:o}=this.getProps(["x","y"],i);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,e){return Wh(this,t,"x",e)}inYRange(t,e){return Wh(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const i=e&&t.borderWidth||0;return(e+i)*2}draw(t,e){const i=this.options;this.skip||i.radius<.1||!Le(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,ic(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function Ng(n,t){const{x:e,y:i,base:s,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,c,u,h,d;return n.horizontal?(d=o/2,a=Math.min(e,s),c=Math.max(e,s),u=i-d,h=i+d):(d=r/2,a=e-d,c=e+d,u=Math.min(i,s),h=Math.max(i,s)),{left:a,top:u,right:c,bottom:h}}function hn(n,t,e,i){return n?0:Rt(t,e,i)}function Hw(n,t,e){const i=n.options.borderWidth,s=n.borderSkipped,r=cg(i);return{t:hn(s.top,r.top,0,e),r:hn(s.right,r.right,0,t),b:hn(s.bottom,r.bottom,0,e),l:hn(s.left,r.left,0,t)}}function $w(n,t,e){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,r=Yn(s),o=Math.min(t,e),a=n.borderSkipped,c=i||Z(s);return{topLeft:hn(!c||a.top||a.left,r.topLeft,0,o),topRight:hn(!c||a.top||a.right,r.topRight,0,o),bottomLeft:hn(!c||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:hn(!c||a.bottom||a.right,r.bottomRight,0,o)}}function qw(n){const t=Ng(n),e=t.right-t.left,i=t.bottom-t.top,s=Hw(n,e/2,i/2),r=$w(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function Va(n,t,e,i){const s=t===null,r=e===null,a=n&&!(s&&r)&&Ng(n,i);return a&&(s||Ve(t,a.left,a.right))&&(r||Ve(e,a.top,a.bottom))}function Gw(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Yw(n,t){n.rect(t.x,t.y,t.w,t.h)}function Na(n,t,e={}){const i=n.x!==e.x?-t:0,s=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-i,o=(n.y+n.h!==e.y+e.h?t:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+r,h:n.h+o,radius:n.radius}}class Kw extends qe{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:r,outer:o}=qw(this),a=Gw(o.radius)?Ls:Yw;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,Na(o,e,r)),t.clip(),a(t,Na(r,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,Na(r,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return Va(this,t,e,i)}inXRange(t,e){return Va(this,t,null,e)}inYRange(t,e){return Va(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+s)/2:e,y:r?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var Xw=Object.freeze({__proto__:null,ArcElement:Mw,BarElement:Kw,LineElement:No,PointElement:jw});const ac=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],jh=ac.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function Lg(n){return ac[n%ac.length]}function Fg(n){return jh[n%jh.length]}function Qw(n,t){return n.borderColor=Lg(t),n.backgroundColor=Fg(t),++t}function Jw(n,t){return n.backgroundColor=n.data.map(()=>Lg(t++)),t}function Zw(n,t){return n.backgroundColor=n.data.map(()=>Fg(t++)),t}function t0(n){let t=0;return(e,i)=>{const s=n.getDatasetMeta(i).controller;s instanceof Zc?t=Jw(e,t):s instanceof Ig?t=Zw(e,t):s&&(t=Qw(e,t))}}function Hh(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function e0(n){return n&&(n.borderColor||n.backgroundColor)}function n0(){return ft.borderColor!=="rgba(0,0,0,0.1)"||ft.backgroundColor!=="rgba(0,0,0,0.1)"}var i0={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:i},options:s}=n.config,{elements:r}=s,o=Hh(i)||e0(s)||r&&Hh(r)||n0();if(!e.forceOverride&&o)return;const a=t0(n);i.forEach(a)}};function s0(n,t,e,i,s){const r=s.samples||i;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let c=0;const u=t+e-1;let h=t,d,g,m,y,v;for(o[c++]=n[h],d=0;d<r-2;d++){let w=0,P=0,C;const D=Math.floor((d+1)*a)+1+t,O=Math.min(Math.floor((d+2)*a)+1,e)+t,M=O-D;for(C=D;C<O;C++)w+=n[C].x,P+=n[C].y;w/=M,P/=M;const L=Math.floor(d*a)+1+t,E=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:b,y:T}=n[h];for(m=y=-1,C=L;C<E;C++)y=.5*Math.abs((b-w)*(n[C].y-T)-(b-n[C].x)*(P-T)),y>m&&(m=y,g=n[C],v=C);o[c++]=g,h=v}return o[c++]=n[u],o}function r0(n,t,e,i){let s=0,r=0,o,a,c,u,h,d,g,m,y,v;const w=[],P=t+e-1,C=n[t].x,O=n[P].x-C;for(o=t;o<t+e;++o){a=n[o],c=(a.x-C)/O*i,u=a.y;const M=c|0;if(M===h)u<y?(y=u,d=o):u>v&&(v=u,g=o),s=(r*s+a.x)/++r;else{const L=o-1;if(!K(d)&&!K(g)){const E=Math.min(d,g),b=Math.max(d,g);E!==m&&E!==L&&w.push({...n[E],x:s}),b!==m&&b!==L&&w.push({...n[b],x:s})}o>0&&L!==m&&w.push(n[L]),w.push(a),h=M,r=0,y=v=u,d=g=m=o}}return w}function Bg(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function $h(n){n.data.datasets.forEach(t=>{Bg(t)})}function o0(n,t){const e=t.length;let i=0,s;const{iScale:r}=n,{min:o,max:a,minDefined:c,maxDefined:u}=r.getUserBounds();return c&&(i=Rt(Ne(t,r.axis,o).lo,0,e-1)),u?s=Rt(Ne(t,r.axis,a).hi+1,i,e)-i:s=e-i,{start:i,count:s}}var a0={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){$h(n);return}const i=n.width;n.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,c=n.getDatasetMeta(r),u=o||s.data;if(gs([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const h=n.scales[c.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:g}=o0(c,u);const m=e.threshold||4*i;if(g<=m){Bg(s);return}K(o)&&(s._data=u,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(v){this._data=v}}));let y;switch(e.algorithm){case"lttb":y=s0(u,d,g,i,e);break;case"min-max":y=r0(u,d,g,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=y})},destroy(n){$h(n)}};function c0(n,t,e){const i=n.segments,s=n.points,r=t.points,o=[];for(const a of i){let{start:c,end:u}=a;u=Lo(c,u,s);const h=cc(e,s[c],s[u],a.loop);if(!t.segments){o.push({source:a,target:h,start:s[c],end:s[u]});continue}const d=bg(t,h);for(const g of d){const m=cc(e,r[g.start],r[g.end],g.loop),y=yg(a,s,m);for(const v of y)o.push({source:v,target:g,start:{[e]:qh(h,m,"start",Math.max)},end:{[e]:qh(h,m,"end",Math.min)}})}}return o}function cc(n,t,e,i){if(i)return;let s=t[n],r=e[n];return n==="angle"&&(s=Ut(s),r=Ut(r)),{property:n,start:s,end:r}}function l0(n,t){const{x:e=null,y:i=null}=n||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=Lo(o,a,s);const c=s[o],u=s[a];i!==null?(r.push({x:c.x,y:i}),r.push({x:u.x,y:i})):e!==null&&(r.push({x:e,y:c.y}),r.push({x:e,y:u.y}))}),r}function Lo(n,t,e){for(;t>n;t--){const i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function qh(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function Ug(n,t){let e=[],i=!1;return dt(n)?(i=!0,e=n):e=l0(n,t),e.length?new No({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function Gh(n){return n&&n.fill!==!1}function u0(n,t,e){let s=n[t].fill;const r=[t];let o;if(!e)return s;for(;s!==!1&&r.indexOf(s)===-1;){if(!yt(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function h0(n,t,e){const i=p0(n);if(Z(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return yt(s)&&Math.floor(s)===s?d0(i[0],t,s,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function d0(n,t,e,i){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=i?!1:e}function f0(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Z(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function g0(n,t,e){let i;return n==="start"?i=e:n==="end"?i=t.options.reverse?t.min:t.max:Z(n)?i=n.value:i=t.getBaseValue(),i}function p0(n){const t=n.options,e=t.fill;let i=$(e&&e.target,e);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function m0(n){const{scale:t,index:e,line:i}=n,s=[],r=i.segments,o=i.points,a=_0(t,e);a.push(Ug({x:null,y:t.bottom},i));for(let c=0;c<r.length;c++){const u=r[c];for(let h=u.start;h<=u.end;h++)y0(s,o[h],a)}return new No({points:s,options:{}})}function _0(n,t){const e=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const r=i[s];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function y0(n,t,e){const i=[];for(let s=0;s<e.length;s++){const r=e[s],{first:o,last:a,point:c}=b0(r,t,"x");if(!(!c||o&&a)){if(o)i.unshift(c);else if(n.push(c),!a)break}}n.push(...i)}function b0(n,t,e){const i=n.interpolate(t,e);if(!i)return{};const s=i[e],r=n.segments,o=n.points;let a=!1,c=!1;for(let u=0;u<r.length;u++){const h=r[u],d=o[h.start][e],g=o[h.end][e];if(Ve(s,d,g)){a=s===d,c=s===g;break}}return{first:a,last:c,point:i}}class zg{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:r,radius:o}=this;return e=e||{start:0,end:ht},t.arc(s,r,o,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,r=t.angle;return{x:e+Math.cos(r)*s,y:i+Math.sin(r)*s,angle:r}}}function v0(n){const{chart:t,fill:e,line:i}=n;if(yt(e))return w0(t,e);if(e==="stack")return m0(n);if(e==="shape")return!0;const s=T0(n);return s instanceof zg?s:Ug(s,i)}function w0(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function T0(n){return(n.scale||{}).getPointPositionForValue?I0(n):E0(n)}function E0(n){const{scale:t={},fill:e}=n,i=f0(e,t);if(yt(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function I0(n){const{scale:t,fill:e}=n,i=t.options,s=t.getLabels().length,r=i.reverse?t.max:t.min,o=g0(e,t,r),a=[];if(i.grid.circular){const c=t.getPointPositionForValue(0,r);return new zg({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)a.push(t.getPointPositionForValue(c,o));return a}function La(n,t,e){const i=v0(t),{chart:s,index:r,line:o,scale:a,axis:c}=t,u=o.options,h=u.fill,d=u.backgroundColor,{above:g=d,below:m=d}=h||{},y=s.getDatasetMeta(r),v=vg(s,y);i&&o.points.length&&(ko(n,e),x0(n,{line:o,target:i,above:g,below:m,area:e,scale:a,axis:c,clip:v}),Do(n))}function x0(n,t){const{line:e,target:i,above:s,below:r,area:o,scale:a,clip:c}=t,u=e._loop?"angle":t.axis;n.save();let h=r;r!==s&&(u==="x"?(Yh(n,i,o.top),Fa(n,{line:e,target:i,color:s,scale:a,property:u,clip:c}),n.restore(),n.save(),Yh(n,i,o.bottom)):u==="y"&&(Kh(n,i,o.left),Fa(n,{line:e,target:i,color:r,scale:a,property:u,clip:c}),n.restore(),n.save(),Kh(n,i,o.right),h=s)),Fa(n,{line:e,target:i,color:h,scale:a,property:u,clip:c}),n.restore()}function Yh(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:u}=a,h=s[c],d=s[Lo(c,u,s)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function Kh(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:u}=a,h=s[c],d=s[Lo(c,u,s)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(e,h.y),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function Fa(n,t){const{line:e,target:i,property:s,color:r,scale:o,clip:a}=t,c=c0(e,i,s);for(const{source:u,target:h,start:d,end:g}of c){const{style:{backgroundColor:m=r}={}}=u,y=i!==!0;n.save(),n.fillStyle=m,S0(n,o,a,y&&cc(s,d,g)),n.beginPath();const v=!!e.pathSegment(n,u);let w;if(y){v?n.closePath():Xh(n,i,g,s);const P=!!i.pathSegment(n,h,{move:v,reverse:!0});w=v&&P,w||Xh(n,i,d,s)}n.closePath(),n.fill(w?"evenodd":"nonzero"),n.restore()}}function S0(n,t,e,i){const s=t.chart.chartArea,{property:r,start:o,end:a}=i||{};if(r==="x"||r==="y"){let c,u,h,d;r==="x"?(c=o,u=s.top,h=a,d=s.bottom):(c=s.left,u=o,h=s.right,d=a),n.beginPath(),e&&(c=Math.max(c,e.left),h=Math.min(h,e.right),u=Math.max(u,e.top),d=Math.min(d,e.bottom)),n.rect(c,u,h-c,d-u),n.clip()}}function Xh(n,t,e,i){const s=t.interpolate(e,i);s&&n.lineTo(s.x,s.y)}var A0={id:"filler",afterDatasetsUpdate(n,t,e){const i=(n.data.datasets||[]).length,s=[];let r,o,a,c;for(o=0;o<i;++o)r=n.getDatasetMeta(o),a=r.dataset,c=null,a&&a.options&&a instanceof No&&(c={visible:n.isDatasetVisible(o),index:o,fill:h0(a,o,i),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=c,s.push(c);for(o=0;o<i;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=u0(s,o,e.propagate))},beforeDraw(n,t,e){const i=e.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),i&&a.fill&&La(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const r=i[s].$filler;Gh(r)&&La(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const i=t.meta.$filler;!Gh(i)||e.drawTime!=="beforeDatasetDraw"||La(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Qh=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},P0=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class Jh extends qe{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=ct(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=St(i.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=Qh(i,r);let u,h;e.font=s.string,this.isHorizontal()?(u=this.maxWidth,h=this._fitRows(o,r,a,c)+10):(h=this.maxHeight,u=this._fitCols(o,s,a,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],h=s+a;let d=t;r.textAlign="left",r.textBaseline="middle";let g=-1,m=-h;return this.legendItems.forEach((y,v)=>{const w=i+e/2+r.measureText(y.text).width;(v===0||u[u.length-1]+w+2*a>o)&&(d+=h,u[u.length-(v>0?0:1)]=0,m+=h,g++),c[v]={left:0,top:m,row:g,width:w,height:s},u[u.length-1]+=w+a}),d}_fitCols(t,e,i,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],h=o-t;let d=a,g=0,m=0,y=0,v=0;return this.legendItems.forEach((w,P)=>{const{itemWidth:C,itemHeight:D}=C0(i,e,r,w,s);P>0&&m+D+2*a>h&&(d+=g+a,u.push({width:g,height:m}),y+=g+a,v++,g=m=0),c[P]={left:y,top:m,col:v,width:C,height:D},g=Math.max(g,C),m+=D+a}),d+=g,u.push({width:g,height:m}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:r}}=this,o=wi(r,this.left,this.width);if(this.isHorizontal()){let a=0,c=Ft(i,this.left+s,this.right-this.lineWidths[a]);for(const u of e)a!==u.row&&(a=u.row,c=Ft(i,this.left+s,this.right-this.lineWidths[a])),u.top+=this.top+t+s,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+s}else{let a=0,c=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const u of e)u.col!==a&&(a=u.col,c=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),u.top=c,u.left+=this.left+s,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;ko(t,this),this._draw(),Do(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:r,labels:o}=t,a=ft.color,c=wi(t.rtl,this.left,this.width),u=St(o.font),{padding:h}=o,d=u.size,g=d/2;let m;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=u.string;const{boxWidth:y,boxHeight:v,itemHeight:w}=Qh(o,d),P=function(L,E,b){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;s.save();const T=$(b.lineWidth,1);if(s.fillStyle=$(b.fillStyle,a),s.lineCap=$(b.lineCap,"butt"),s.lineDashOffset=$(b.lineDashOffset,0),s.lineJoin=$(b.lineJoin,"miter"),s.lineWidth=T,s.strokeStyle=$(b.strokeStyle,a),s.setLineDash($(b.lineDash,[])),o.usePointStyle){const x={radius:v*Math.SQRT2/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:T},S=c.xPlus(L,y/2),A=E+g;ag(s,x,S,A,o.pointStyleWidth&&y)}else{const x=E+Math.max((d-v)/2,0),S=c.leftForLtr(L,y),A=Yn(b.borderRadius);s.beginPath(),Object.values(A).some(I=>I!==0)?Ls(s,{x:S,y:x,w:y,h:v,radius:A}):s.rect(S,x,y,v),s.fill(),T!==0&&s.stroke()}s.restore()},C=function(L,E,b){Zn(s,b.text,L,E+w/2,u,{strikethrough:b.hidden,textAlign:c.textAlign(b.textAlign)})},D=this.isHorizontal(),O=this._computeTitleHeight();D?m={x:Ft(r,this.left+h,this.right-i[0]),y:this.top+h+O,line:0}:m={x:this.left+h,y:Ft(r,this.top+O+h,this.bottom-e[0].height),line:0},pg(this.ctx,t.textDirection);const M=w+h;this.legendItems.forEach((L,E)=>{s.strokeStyle=L.fontColor,s.fillStyle=L.fontColor;const b=s.measureText(L.text).width,T=c.textAlign(L.textAlign||(L.textAlign=o.textAlign)),x=y+g+b;let S=m.x,A=m.y;c.setWidth(this.width),D?E>0&&S+x+h>this.right&&(A=m.y+=M,m.line++,S=m.x=Ft(r,this.left+h,this.right-i[m.line])):E>0&&A+M>this.bottom&&(S=m.x=S+e[m.line].width+h,m.line++,A=m.y=Ft(r,this.top+O+h,this.bottom-e[m.line].height));const I=c.x(S);if(P(I,A,L),S=By(T,S+y+g,D?S+x:this.right,t.rtl),C(c.x(S),A,L),D)m.x+=x+h;else if(typeof L.text!="string"){const nt=u.lineHeight;m.y+=Wg(L,nt)+h}else m.y+=M}),mg(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=St(e.font),s=jt(e.padding);if(!e.display)return;const r=wi(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=i.size/2,u=s.top+c;let h,d=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),h=this.top+u,d=Ft(t.align,d,this.right-g);else{const y=this.columnSizes.reduce((v,w)=>Math.max(v,w.height),0);h=u+Ft(t.align,this.top,this.bottom-y-t.labels.padding-this._computeTitleHeight())}const m=Ft(a,d,d+g);o.textAlign=r.textAlign($c(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,Zn(o,e.text,m,h,i)}_computeTitleHeight(){const t=this.options.title,e=St(t.font),i=jt(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,r;if(Ve(t,this.left,this.right)&&Ve(e,this.top,this.bottom)){for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(s=r[i],Ve(t,s.left,s.left+s.width)&&Ve(e,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const e=this.options;if(!D0(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,r=P0(s,i);s&&!r&&ct(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!r&&ct(e.onHover,[t,i,this],this)}else i&&ct(e.onClick,[t,i,this],this)}}function C0(n,t,e,i,s){const r=R0(i,n,t,e),o=k0(s,i,t.lineHeight);return{itemWidth:r,itemHeight:o}}function R0(n,t,e,i){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+i.measureText(s).width}function k0(n,t,e){let i=n;return typeof t.text!="string"&&(i=Wg(t,e)),i}function Wg(n,t){const e=n.text?n.text.length:0;return t*e}function D0(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var M0={id:"legend",_element:Jh,start(n,t,e){const i=n.legend=new Jh({ctx:n.ctx,options:e,chart:n});Wt.configure(n,i,e),Wt.addBox(n,i)},stop(n){Wt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const i=n.legend;Wt.configure(n,i,e),i.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const i=t.datasetIndex,s=e.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(e?0:void 0),h=jt(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:r,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:u.borderColor,pointStyle:i||u.pointStyle,rotation:u.rotation,textAlign:s||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class el extends qe{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const s=dt(i.text)?i.text.length:1;this._padding=jt(i.padding);const r=s*St(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:i,bottom:s,right:r,options:o}=this,a=o.align;let c=0,u,h,d;return this.isHorizontal()?(h=Ft(a,i,r),d=e+t,u=r-i):(o.position==="left"?(h=i+t,d=Ft(a,s,e),c=et*-.5):(h=r-t,d=Ft(a,e,s),c=et*.5),u=s-e),{titleX:h,titleY:d,maxWidth:u,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=St(e.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:u}=this._drawArgs(r);Zn(t,e.text,0,0,i,{color:e.color,maxWidth:c,rotation:u,textAlign:$c(e.align),textBaseline:"middle",translation:[o,a]})}}function O0(n,t){const e=new el({ctx:n.ctx,options:t,chart:n});Wt.configure(n,e,t),Wt.addBox(n,e),n.titleBlock=e}var V0={id:"title",_element:el,start(n,t,e){O0(n,e)},stop(n){const t=n.titleBlock;Wt.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const i=n.titleBlock;Wt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const kr=new WeakMap;var N0={id:"subtitle",start(n,t,e){const i=new el({ctx:n.ctx,options:e,chart:n});Wt.configure(n,i,e),Wt.addBox(n,i),kr.set(n,i)},stop(n){Wt.removeBox(n,kr.get(n)),kr.delete(n)},beforeUpdate(n,t,e){const i=kr.get(n);Wt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ms={average(n){if(!n.length)return!1;let t,e,i=new Set,s=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const c=a.tooltipPosition();i.add(c.x),s+=c.y,++r}}return r===0||i.size===0?!1:{x:[...i].reduce((a,c)=>a+c)/i.size,y:s/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,i=t.y,s=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const c=n[r].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),h=ec(t,u);h<s&&(s=h,a=c)}}if(a){const c=a.tooltipPosition();e=c.x,i=c.y}return{x:e,y:i}}};function ge(n,t){return t&&(dt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function De(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function L0(n,t){const{element:e,datasetIndex:i,index:s}=t,r=n.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:n,label:o,parsed:r.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:e}}function Zh(n,t){const e=n.chart.ctx,{body:i,footer:s,title:r}=n,{boxWidth:o,boxHeight:a}=t,c=St(t.bodyFont),u=St(t.titleFont),h=St(t.footerFont),d=r.length,g=s.length,m=i.length,y=jt(t.padding);let v=y.height,w=0,P=i.reduce((O,M)=>O+M.before.length+M.lines.length+M.after.length,0);if(P+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*u.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),P){const O=t.displayColors?Math.max(a,c.lineHeight):c.lineHeight;v+=m*O+(P-m)*c.lineHeight+(P-1)*t.bodySpacing}g&&(v+=t.footerMarginTop+g*h.lineHeight+(g-1)*t.footerSpacing);let C=0;const D=function(O){w=Math.max(w,e.measureText(O).width+C)};return e.save(),e.font=u.string,ot(n.title,D),e.font=c.string,ot(n.beforeBody.concat(n.afterBody),D),C=t.displayColors?o+2+t.boxPadding:0,ot(i,O=>{ot(O.before,D),ot(O.lines,D),ot(O.after,D)}),C=0,e.font=h.string,ot(n.footer,D),e.restore(),w+=y.width,{width:w,height:v}}function F0(n,t){const{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}function B0(n,t,e,i){const{x:s,width:r}=i,o=e.caretSize+e.caretPadding;if(n==="left"&&s+r+o>t.width||n==="right"&&s-r-o<0)return!0}function U0(n,t,e,i){const{x:s,width:r}=e,{width:o,chartArea:{left:a,right:c}}=n;let u="center";return i==="center"?u=s<=(a+c)/2?"left":"right":s<=r/2?u="left":s>=o-r/2&&(u="right"),B0(u,n,t,e)&&(u="center"),u}function td(n,t,e){const i=e.yAlign||t.yAlign||F0(n,e);return{xAlign:e.xAlign||t.xAlign||U0(n,t,e,i),yAlign:i}}function z0(n,t){let{x:e,width:i}=n;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function W0(n,t,e){let{y:i,height:s}=n;return t==="top"?i+=e:t==="bottom"?i-=s+e:i-=s/2,i}function ed(n,t,e,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:c}=e,u=s+r,{topLeft:h,topRight:d,bottomLeft:g,bottomRight:m}=Yn(o);let y=z0(t,a);const v=W0(t,c,u);return c==="center"?a==="left"?y+=u:a==="right"&&(y-=u):a==="left"?y-=Math.max(h,g)+s:a==="right"&&(y+=Math.max(d,m)+s),{x:Rt(y,0,i.width-t.width),y:Rt(v,0,i.height-t.height)}}function Dr(n,t,e){const i=jt(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-i.right:n.x+i.left}function nd(n){return ge([],De(n))}function j0(n,t,e){return Cn(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function id(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const jg={beforeTitle:Re,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:Re,beforeBody:Re,beforeLabel:Re,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return K(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Re,afterBody:Re,beforeFooter:Re,footer:Re,afterFooter:Re};function Gt(n,t,e,i){const s=n[t].call(e,i);return typeof s>"u"?jg[t].call(e,i):s}class sd extends qe{static positioners=ms;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&e.options.animation&&i.animations,r=new wg(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=j0(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:i}=e,s=Gt(i,"beforeTitle",this,t),r=Gt(i,"title",this,t),o=Gt(i,"afterTitle",this,t);let a=[];return a=ge(a,De(s)),a=ge(a,De(r)),a=ge(a,De(o)),a}getBeforeBody(t,e){return nd(Gt(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,s=[];return ot(t,r=>{const o={before:[],lines:[],after:[]},a=id(i,r);ge(o.before,De(Gt(a,"beforeLabel",this,r))),ge(o.lines,Gt(a,"label",this,r)),ge(o.after,De(Gt(a,"afterLabel",this,r))),s.push(o)}),s}getAfterBody(t,e){return nd(Gt(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,s=Gt(i,"beforeFooter",this,t),r=Gt(i,"footer",this,t),o=Gt(i,"afterFooter",this,t);let a=[];return a=ge(a,De(s)),a=ge(a,De(r)),a=ge(a,De(o)),a}_createItems(t){const e=this._active,i=this.chart.data,s=[],r=[],o=[];let a=[],c,u;for(c=0,u=e.length;c<u;++c)a.push(L0(this.chart,e[c]));return t.filter&&(a=a.filter((h,d,g)=>t.filter(h,d,g,i))),t.itemSort&&(a=a.sort((h,d)=>t.itemSort(h,d,i))),ot(a,h=>{const d=id(t.callbacks,h);s.push(Gt(d,"labelColor",this,h)),r.push(Gt(d,"labelPointStyle",this,h)),o.push(Gt(d,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const i=this.options.setContext(this.getContext()),s=this._active;let r,o=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const a=ms[i.position].call(this,s,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const c=this._size=Zh(this,i),u=Object.assign({},a,c),h=td(this.chart,i,u),d=ed(i,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:c.width,height:c.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,s){const r=this.getCaretPosition(t,i,s);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:s,yAlign:r}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:d}=Yn(a),{x:g,y:m}=t,{width:y,height:v}=e;let w,P,C,D,O,M;return r==="center"?(O=m+v/2,s==="left"?(w=g,P=w-o,D=O+o,M=O-o):(w=g+y,P=w+o,D=O-o,M=O+o),C=w):(s==="left"?P=g+Math.max(c,h)+o:s==="right"?P=g+y-Math.max(u,d)-o:P=this.caretX,r==="top"?(D=m,O=D-o,w=P-o,C=P+o):(D=m+v,O=D+o,w=P+o,C=P-o),M=D),{x1:w,x2:P,x3:C,y1:D,y2:O,y3:M}}drawTitle(t,e,i){const s=this.title,r=s.length;let o,a,c;if(r){const u=wi(i.rtl,this.x,this.width);for(t.x=Dr(this,i.titleAlign,i),e.textAlign=u.textAlign(i.titleAlign),e.textBaseline="middle",o=St(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,c=0;c<r;++c)e.fillText(s[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,c+1===r&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,s,r){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:c,boxWidth:u}=r,h=St(r.bodyFont),d=Dr(this,"left",r),g=s.x(d),m=c<h.lineHeight?(h.lineHeight-c)/2:0,y=e.y+m;if(r.usePointStyle){const v={radius:Math.min(u,c)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},w=s.leftForLtr(g,u)+u/2,P=y+c/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,ic(t,v,w,P),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,ic(t,v,w,P)}else{t.lineWidth=Z(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const v=s.leftForLtr(g,u),w=s.leftForLtr(s.xPlus(g,1),u-2),P=Yn(o.borderRadius);Object.values(P).some(C=>C!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Ls(t,{x:v,y,w:u,h:c,radius:P}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Ls(t,{x:w,y:y+1,w:u-2,h:c-2,radius:P}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(v,y,u,c),t.strokeRect(v,y,u,c),t.fillStyle=o.backgroundColor,t.fillRect(w,y+1,u-2,c-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:s}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:c,boxWidth:u,boxPadding:h}=i,d=St(i.bodyFont);let g=d.lineHeight,m=0;const y=wi(i.rtl,this.x,this.width),v=function(b){e.fillText(b,y.x(t.x+m),t.y+g/2),t.y+=g+r},w=y.textAlign(o);let P,C,D,O,M,L,E;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=Dr(this,w,i),e.fillStyle=i.bodyColor,ot(this.beforeBody,v),m=a&&w!=="right"?o==="center"?u/2+h:u+2+h:0,O=0,L=s.length;O<L;++O){for(P=s[O],C=this.labelTextColors[O],e.fillStyle=C,ot(P.before,v),D=P.lines,a&&D.length&&(this._drawColorBox(e,t,O,y,i),g=Math.max(d.lineHeight,c)),M=0,E=D.length;M<E;++M)v(D[M]),g=d.lineHeight;ot(P.after,v)}m=0,g=d.lineHeight,ot(this.afterBody,v),t.y-=r}drawFooter(t,e,i){const s=this.footer,r=s.length;let o,a;if(r){const c=wi(i.rtl,this.x,this.width);for(t.x=Dr(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=c.textAlign(i.footerAlign),e.textBaseline="middle",o=St(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(s[a],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,s){const{xAlign:r,yAlign:o}=this,{x:a,y:c}=t,{width:u,height:h}=i,{topLeft:d,topRight:g,bottomLeft:m,bottomRight:y}=Yn(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+d,c),o==="top"&&this.drawCaret(t,e,i,s),e.lineTo(a+u-g,c),e.quadraticCurveTo(a+u,c,a+u,c+g),o==="center"&&r==="right"&&this.drawCaret(t,e,i,s),e.lineTo(a+u,c+h-y),e.quadraticCurveTo(a+u,c+h,a+u-y,c+h),o==="bottom"&&this.drawCaret(t,e,i,s),e.lineTo(a+m,c+h),e.quadraticCurveTo(a,c+h,a,c+h-m),o==="center"&&r==="left"&&this.drawCaret(t,e,i,s),e.lineTo(a,c+d),e.quadraticCurveTo(a,c,a+d,c),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,s=i&&i.x,r=i&&i.y;if(s||r){const o=ms[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Zh(this,t),c=Object.assign({},o,this._size),u=td(e,t,c),h=ed(t,c,u,e);(s._to!==h.x||r._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=jt(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,s,e),pg(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),mg(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,s=t.map(({datasetIndex:a,index:c})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[c],index:c}}),r=!to(i,s),o=this._positionChanged(s,e);(r||o)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,i),a=this._positionChanged(o,t),c=e||!to(o,r)||a;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),c}_getActiveElements(t,e,i,s){const r=this.options;if(t.type==="mouseout")return[];if(!s)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:i,caretY:s,options:r}=this,o=ms[r.position].call(this,t,e);return o!==!1&&(i!==o.x||s!==o.y)}}var H0={id:"tooltip",_element:sd,positioners:ms,afterInit(n,t,e){e&&(n.tooltip=new sd({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:jg},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},$0=Object.freeze({__proto__:null,Colors:i0,Decimation:a0,Filler:A0,Legend:M0,SubTitle:N0,Title:V0,Tooltip:H0});const q0=(n,t,e,i)=>(typeof t=="string"?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function G0(n,t,e,i){const s=n.indexOf(t);if(s===-1)return q0(n,t,e,i);const r=n.lastIndexOf(t);return s!==r?e:s}const Y0=(n,t)=>n===null?null:Rt(Math.round(n),0,t);function rd(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class K0 extends ri{static id="category";static defaults={ticks:{callback:rd}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const i=this.getLabels();for(const{index:s,label:r}of e)i[s]===r&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(K(t))return null;const i=this.getLabels();return e=isFinite(e)&&i[e]===t?e:G0(i,t,$(e,t),this._addedLabels),Y0(e,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),e||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,s=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=t;o<=e;o++)s.push({value:o});return s}getLabelForValue(t){return rd.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function X0(n,t){const e=[],{bounds:s,step:r,min:o,max:a,precision:c,count:u,maxTicks:h,maxDigits:d,includeBounds:g}=n,m=r||1,y=h-1,{min:v,max:w}=t,P=!K(o),C=!K(a),D=!K(u),O=(w-v)/(d+1);let M=Zu((w-v)/y/m)*m,L,E,b,T;if(M<1e-14&&!P&&!C)return[{value:v},{value:w}];T=Math.ceil(w/M)-Math.floor(v/M),T>y&&(M=Zu(T*M/y/m)*m),K(c)||(L=Math.pow(10,c),M=Math.ceil(M*L)/L),s==="ticks"?(E=Math.floor(v/M)*M,b=Math.ceil(w/M)*M):(E=v,b=w),P&&C&&r&&Dy((a-o)/r,M/1e3)?(T=Math.round(Math.min((a-o)/M,h)),M=(a-o)/T,E=o,b=a):D?(E=P?o:E,b=C?a:b,T=u-1,M=(b-E)/T):(T=(b-E)/M,Ts(T,Math.round(T),M/1e3)?T=Math.round(T):T=Math.ceil(T));const x=Math.max(th(M),th(E));L=Math.pow(10,K(c)?x:c),E=Math.round(E*L)/L,b=Math.round(b*L)/L;let S=0;for(P&&(g&&E!==o?(e.push({value:o}),E<o&&S++,Ts(Math.round((E+S*M)*L)/L,o,od(o,O,n))&&S++):E<o&&S++);S<T;++S){const A=Math.round((E+S*M)*L)/L;if(C&&A>a)break;e.push({value:A})}return C&&g&&b!==a?e.length&&Ts(e[e.length-1].value,a,od(a,O,n))?e[e.length-1].value=a:e.push({value:a}):(!C||b===a)&&e.push({value:b}),e}function od(n,t,{horizontal:e,minRotation:i}){const s=ce(i),r=(e?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class ao extends ri{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return K(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this;const o=c=>s=e?s:c,a=c=>r=i?r:c;if(t){const c=be(s),u=be(r);c<0&&u<0?a(0):c>0&&u>0&&o(0)}if(s===r){let c=r===0?1:Math.abs(r*.05);a(r+c),t||o(s-c)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=X0(s,r);return t.bounds==="ticks"&&Jf(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Js(t,this.chart.options.locale,this.options.ticks.format)}}class Q0 extends ao{static id="linear";static defaults={ticks:{callback:Ro.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=yt(t)?t:0,this.max=yt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=ce(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const Bs=n=>Math.floor(ln(n)),Un=(n,t)=>Math.pow(10,Bs(n)+t);function ad(n){return n/Math.pow(10,Bs(n))===1}function cd(n,t,e){const i=Math.pow(10,e),s=Math.floor(n/i);return Math.ceil(t/i)-s}function J0(n,t){const e=t-n;let i=Bs(e);for(;cd(n,t,i)>10;)i++;for(;cd(n,t,i)<10;)i--;return Math.min(i,Bs(n))}function Z0(n,{min:t,max:e}){t=Jt(n.min,t);const i=[],s=Bs(t);let r=J0(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),c=s>r?Math.pow(10,s):0,u=Math.round((t-c)*o)/o,h=Math.floor((t-c)/a/10)*a*10;let d=Math.floor((u-h)/Math.pow(10,r)),g=Jt(n.min,Math.round((c+h+d*Math.pow(10,r))*o)/o);for(;g<e;)i.push({value:g,major:ad(g),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),g=Math.round((c+h+d*Math.pow(10,r))*o)/o;const m=Jt(n.max,g);return i.push({value:m,major:ad(m),significand:d}),i}class tT extends ri{static id="logarithmic";static defaults={ticks:{callback:Ro.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=ao.prototype.parse.apply(this,[t,e]);if(i===0){this._zero=!0;return}return yt(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=yt(t)?Math.max(0,t):null,this.max=yt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!yt(this._userMin)&&(this.min=t===Un(this.min,0)?Un(this.min,-1):Un(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const r=a=>i=t?i:a,o=a=>s=e?s:a;i===s&&(i<=0?(r(1),o(10)):(r(Un(i,-1)),o(Un(s,1)))),i<=0&&r(Un(s,-1)),s<=0&&o(Un(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},i=Z0(e,this);return t.bounds==="ticks"&&Jf(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Js(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=ln(t),this._valueRange=ln(this.max)-ln(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(ln(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function lc(n){const t=n.ticks;if(t.display&&n.display){const e=jt(t.backdropPadding);return $(t.font&&t.font.size,ft.font.size)+e.height}return 0}function eT(n,t,e){return e=dt(e)?e:[e],{w:Ky(n,t.string,e),h:e.length*t.lineHeight}}function ld(n,t,e,i,s){return n===i||n===s?{start:t-e/2,end:t+e/2}:n<i||n>s?{start:t-e,end:t}:{start:t,end:t+e}}function nT(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],s=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?et/r:0;for(let c=0;c<r;c++){const u=o.setContext(n.getPointLabelContext(c));s[c]=u.padding;const h=n.getPointPosition(c,n.drawingArea+s[c],a),d=St(u.font),g=eT(n.ctx,d,n._pointLabels[c]);i[c]=g;const m=Ut(n.getIndexAngle(c)+a),y=Math.round(jc(m)),v=ld(y,h.x,g.w,0,180),w=ld(y,h.y,g.h,90,270);iT(e,t,m,v,w)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=oT(n,i,s)}function iT(n,t,e,i,s){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,c=0;i.start<t.l?(a=(t.l-i.start)/r,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),s.start<t.t?(c=(t.t-s.start)/o,n.t=Math.min(n.t,t.t-c)):s.end>t.b&&(c=(s.end-t.b)/o,n.b=Math.max(n.b,t.b+c))}function sT(n,t,e){const i=n.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=e,c=n.getPointPosition(t,i+s+o,r),u=Math.round(jc(Ut(c.angle+wt))),h=lT(c.y,a.h,u),d=aT(u),g=cT(c.x,a.w,d);return{visible:!0,x:c.x,y:h,textAlign:d,left:g,top:h,right:g+a.w,bottom:h+a.h}}function rT(n,t){if(!t)return!0;const{left:e,top:i,right:s,bottom:r}=n;return!(Le({x:e,y:i},t)||Le({x:e,y:r},t)||Le({x:s,y:i},t)||Le({x:s,y:r},t))}function oT(n,t,e){const i=[],s=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,c={extra:lc(r)/2,additionalAngle:o?et/s:0};let u;for(let h=0;h<s;h++){c.padding=e[h],c.size=t[h];const d=sT(n,h,c);i.push(d),a==="auto"&&(d.visible=rT(d,u),d.visible&&(u=d))}return i}function aT(n){return n===0||n===180?"center":n<180?"left":"right"}function cT(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function lT(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function uT(n,t,e){const{left:i,top:s,right:r,bottom:o}=e,{backdropColor:a}=t;if(!K(a)){const c=Yn(t.borderRadius),u=jt(t.backdropPadding);n.fillStyle=a;const h=i-u.left,d=s-u.top,g=r-i+u.width,m=o-s+u.height;Object.values(c).some(y=>y!==0)?(n.beginPath(),Ls(n,{x:h,y:d,w:g,h:m,radius:c}),n.fill()):n.fillRect(h,d,g,m)}}function hT(n,t){const{ctx:e,options:{pointLabels:i}}=n;for(let s=t-1;s>=0;s--){const r=n._pointLabelItems[s];if(!r.visible)continue;const o=i.setContext(n.getPointLabelContext(s));uT(e,o,r);const a=St(o.font),{x:c,y:u,textAlign:h}=r;Zn(e,n._pointLabels[s],c,u+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function Hg(n,t,e,i){const{ctx:s}=n;if(e)s.arc(n.xCenter,n.yCenter,t,0,ht);else{let r=n.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<i;o++)r=n.getPointPosition(o,t),s.lineTo(r.x,r.y)}}function dT(n,t,e,i,s){const r=n.ctx,o=t.circular,{color:a,lineWidth:c}=t;!o&&!i||!a||!c||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=c,r.setLineDash(s.dash||[]),r.lineDashOffset=s.dashOffset,r.beginPath(),Hg(n,e,o,i),r.closePath(),r.stroke(),r.restore())}function fT(n,t,e){return Cn(n,{label:e,index:t,type:"pointLabel"})}class gT extends ao{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ro.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=jt(lc(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=yt(t)&&!isNaN(t)?t:0,this.max=yt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/lc(this.options))}generateTickLabels(t){ao.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{const s=ct(this.options.pointLabels.callback,[e,i],this);return s||s===0?s:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?nT(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){const e=ht/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ut(t*e+ce(i))}getDistanceFromCenterForValue(t){if(K(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(K(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return fT(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-wt+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:r}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),Hg(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:s,border:r}=e,o=this._pointLabels.length;let a,c,u;if(e.pointLabels.display&&hT(this,o),s.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);const g=this.getContext(d),m=s.setContext(g),y=r.setContext(g);dT(this,m,c,o,y)}}),i.display){for(t.save(),a=o-1;a>=0;a--){const h=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:g}=h;!g||!d||(t.lineWidth=g,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),u=this.getPointPosition(a,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(u.x,u.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!e.reverse)return;const u=i.setContext(this.getContext(c)),h=St(u.font);if(r=this.getDistanceFromCenterForValue(this.ticks[c].value),u.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=u.backdropColor;const d=jt(u.backdropPadding);t.fillRect(-o/2-d.left,-r-h.size/2-d.top,o+d.width,h.size+d.height)}Zn(t,a.label,0,-r,h,{color:u.color,strokeColor:u.textStrokeColor,strokeWidth:u.textStrokeWidth})}),t.restore()}drawTitle(){}}const Fo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Kt=Object.keys(Fo);function ud(n,t){return n-t}function hd(n,t){if(K(t))return null;const e=n._adapter,{parser:i,round:s,isoWeekday:r}=n._parseOpts;let o=t;return typeof i=="function"&&(o=i(o)),yt(o)||(o=typeof i=="string"?e.parse(o,i):e.parse(o)),o===null?null:(s&&(o=s==="week"&&(Ai(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,s)),+o)}function dd(n,t,e,i){const s=Kt.length;for(let r=Kt.indexOf(n);r<s-1;++r){const o=Fo[Kt[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=i)return Kt[r]}return Kt[s-1]}function pT(n,t,e,i,s){for(let r=Kt.length-1;r>=Kt.indexOf(e);r--){const o=Kt[r];if(Fo[o].common&&n._adapter.diff(s,i,o)>=t-1)return o}return Kt[e?Kt.indexOf(e):0]}function mT(n){for(let t=Kt.indexOf(n)+1,e=Kt.length;t<e;++t)if(Fo[Kt[t]].common)return Kt[t]}function fd(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:i,hi:s}=Hc(e,t),r=e[i]>=t?e[i]:e[s];n[r]=!0}}function _T(n,t,e,i){const s=n._adapter,r=+s.startOf(t[0].value,i),o=t[t.length-1].value;let a,c;for(a=r;a<=o;a=+s.add(a,1,i))c=e[a],c>=0&&(t[c].major=!0);return t}function gd(n,t,e){const i=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,i.push({value:a,major:!1});return r===0||!e?i:_T(n,i,s,e)}class uc extends ri{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),s=this._adapter=new yv._date(t.adapters.date);s.init(e),ws(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:hd(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:s,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(s=Math.min(s,u.min)),!a&&!isNaN(u.max)&&(r=Math.max(r,u.max))}(!o||!a)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=yt(s)&&!isNaN(s)?s:+e.startOf(Date.now(),i),r=yt(r)&&!isNaN(r)?r:+e.endOf(Date.now(),i)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,o=this.max,a=Ny(s,r,o);return this._unit=e.unit||(i.autoSkip?dd(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):pT(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:mT(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),gd(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,i=0,s,r;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?e=1-s:e=(this.getDecimalForValue(t[1])-s)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?i=r:i=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=Rt(e,0,o),i=Rt(i,0,o),this._offsets={start:e,end:i,factor:1/(e+1+i)}}_generate(){const t=this._adapter,e=this.min,i=this.max,s=this.options,r=s.time,o=r.unit||dd(r.minUnit,e,i,this._getLabelCapacity(e)),a=$(s.ticks.stepSize,1),c=o==="week"?r.isoWeekday:!1,u=Ai(c)||c===!0,h={};let d=e,g,m;if(u&&(d=+t.startOf(d,"isoWeek",c)),d=+t.startOf(d,u?"day":o),t.diff(i,e,o)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+o);const y=s.ticks.source==="data"&&this.getDataTimestamps();for(g=d,m=0;g<i;g=+t.add(g,a,o),m++)fd(h,g,y);return(g===i||s.bounds==="ticks"||m===1)&&fd(h,g,y),Object.keys(h).sort(ud).map(v=>+v)}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const s=this.options.time.displayFormats,r=this._unit,o=e||s[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,i,s){const r=this.options,o=r.ticks.callback;if(o)return ct(o,[t,e,i],this);const a=r.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&a[c],d=u&&a[u],g=i[e],m=u&&d&&g&&g.major;return this._adapter.format(t,s||(m?d:h))}generateTickLabels(t){let e,i,s;for(e=0,i=t.length;e<i;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,s=ce(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*r+a*o,h:i*o+a*r}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,s=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,gd(this,[t],this._majorUnit),s),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(e=0,i=s.length;e<i;++e)t=t.concat(s[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const s=this.getLabels();for(e=0,i=s.length;e<i;++e)t.push(hd(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return eg(t.sort(ud))}}function Mr(n,t,e){let i=0,s=n.length-1,r,o,a,c;e?(t>=n[i].pos&&t<=n[s].pos&&({lo:i,hi:s}=Ne(n,"pos",t)),{pos:r,time:a}=n[i],{pos:o,time:c}=n[s]):(t>=n[i].time&&t<=n[s].time&&({lo:i,hi:s}=Ne(n,"time",t)),{time:r,pos:a}=n[i],{time:o,pos:c}=n[s]);const u=o-r;return u?a+(c-a)*(t-r)/u:a}class yT extends uc{static id="timeseries";static defaults=uc.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Mr(e,this.min),this._tableRange=Mr(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],r=[];let o,a,c,u,h;for(o=0,a=t.length;o<a;++o)u=t[o],u>=e&&u<=i&&s.push(u);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)h=s[o+1],c=s[o-1],u=s[o],Math.round((h+c)/2)!==u&&r.push({time:u,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((s,r)=>s-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Mr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return Mr(this._table,i*this._tableRange+this._minPos,!0)}}var bT=Object.freeze({__proto__:null,CategoryScale:K0,LinearScale:Q0,LogarithmicScale:tT,RadialLinearScale:gT,TimeScale:uc,TimeSeriesScale:yT});const vT=[_v,Xw,$0,bT];Vo.register(...vT);const $g=6048e5,wT=864e5,qg=6e4,Gg=36e5,pd=Symbol.for("constructDateFrom");function se(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&pd in n?n[pd](t):n instanceof Date?new n.constructor(t):new Date(t)}function Xt(n,t){return se(t||n,n)}function TT(n,t,e){const i=Xt(n,e?.in);if(isNaN(t))return se(n,NaN);if(!t)return i;const s=i.getDate(),r=se(n,i.getTime());r.setMonth(i.getMonth()+t+1,0);const o=r.getDate();return s>=o?r:(i.setFullYear(r.getFullYear(),r.getMonth(),s),i)}let ET={};function Bo(){return ET}function Us(n,t){const e=Bo(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,s=Xt(n,t?.in),r=s.getDay(),o=(r<i?7:0)+r-i;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function co(n,t){return Us(n,{...t,weekStartsOn:1})}function Yg(n,t){const e=Xt(n,t?.in),i=e.getFullYear(),s=se(e,0);s.setFullYear(i+1,0,4),s.setHours(0,0,0,0);const r=co(s),o=se(e,0);o.setFullYear(i,0,4),o.setHours(0,0,0,0);const a=co(o);return e.getTime()>=r.getTime()?i+1:e.getTime()>=a.getTime()?i:i-1}function md(n){const t=Xt(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function nl(n,...t){const e=se.bind(null,t.find(i=>typeof i=="object"));return t.map(e)}function _d(n,t){const e=Xt(n,t?.in);return e.setHours(0,0,0,0),e}function IT(n,t,e){const[i,s]=nl(e?.in,n,t),r=_d(i),o=_d(s),a=+r-md(r),c=+o-md(o);return Math.round((a-c)/wT)}function xT(n,t){const e=Yg(n,t),i=se(n,0);return i.setFullYear(e,0,4),i.setHours(0,0,0,0),co(i)}function ST(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function AT(n){return!(!ST(n)&&typeof n!="number"||isNaN(+Xt(n)))}function PT(n,t){const[e,i]=nl(n,t.start,t.end);return{start:e,end:i}}function CT(n,t){const{start:e,end:i}=PT(t?.in,n);let s=+e>+i;const r=s?+e:+i,o=s?i:e;o.setHours(0,0,0,0),o.setDate(1);let a=1;const c=[];for(;+o<=r;)c.push(se(e,o)),o.setMonth(o.getMonth()+a);return s?c.reverse():c}function RT(n,t){const e=Xt(n,t?.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}const kT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},DT=(n,t,e)=>{let i;const s=kT[n];return typeof s=="string"?i=s:t===1?i=s.one:i=s.other.replace("{{count}}",t.toString()),e?.addSuffix?e.comparison&&e.comparison>0?"in "+i:i+" ago":i};function Ti(n){return(t={})=>{const e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}const MT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},OT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},VT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},NT={date:Ti({formats:MT,defaultWidth:"full"}),time:Ti({formats:OT,defaultWidth:"full"}),dateTime:Ti({formats:VT,defaultWidth:"full"})},LT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},FT=(n,t,e,i)=>LT[n];function _e(n){return(t,e)=>{const i=e?.context?String(e.context):"standalone";let s;if(i==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=e?.width?String(e.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=e?.width?String(e.width):n.defaultWidth;s=n.values[a]||n.values[o]}const r=n.argumentCallback?n.argumentCallback(t):t;return s[r]}}const BT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},zT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},WT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$T=(n,t)=>{const e=Number(n),i=e%100;if(i>20||i<10)switch(i%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},qT={ordinalNumber:$T,era:_e({values:BT,defaultWidth:"wide"}),quarter:_e({values:UT,defaultWidth:"wide",argumentCallback:n=>n-1}),month:_e({values:zT,defaultWidth:"wide"}),day:_e({values:WT,defaultWidth:"wide"}),dayPeriod:_e({values:jT,defaultWidth:"wide",formattingValues:HT,defaultFormattingWidth:"wide"})};function ye(n){return(t,e={})=>{const i=e.width,s=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],r=t.match(s);if(!r)return null;const o=r[0],a=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?YT(a,d=>d.test(o)):GT(a,d=>d.test(o));let u;u=n.valueCallback?n.valueCallback(c):c,u=e.valueCallback?e.valueCallback(u):u;const h=t.slice(o.length);return{value:u,rest:h}}}function GT(n,t){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function YT(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function Kg(n){return(t,e={})=>{const i=t.match(n.matchPattern);if(!i)return null;const s=i[0],r=t.match(n.parsePattern);if(!r)return null;let o=n.valueCallback?n.valueCallback(r[0]):r[0];o=e.valueCallback?e.valueCallback(o):o;const a=t.slice(s.length);return{value:o,rest:a}}}const KT=/^(\d+)(th|st|nd|rd)?/i,XT=/\d+/i,QT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},JT={any:[/^b/i,/^(a|c)/i]},ZT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},tE={any:[/1/i,/2/i,/3/i,/4/i]},eE={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},nE={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},iE={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sE={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},rE={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},oE={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},aE={ordinalNumber:Kg({matchPattern:KT,parsePattern:XT,valueCallback:n=>parseInt(n,10)}),era:ye({matchPatterns:QT,defaultMatchWidth:"wide",parsePatterns:JT,defaultParseWidth:"any"}),quarter:ye({matchPatterns:ZT,defaultMatchWidth:"wide",parsePatterns:tE,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ye({matchPatterns:eE,defaultMatchWidth:"wide",parsePatterns:nE,defaultParseWidth:"any"}),day:ye({matchPatterns:iE,defaultMatchWidth:"wide",parsePatterns:sE,defaultParseWidth:"any"}),dayPeriod:ye({matchPatterns:rE,defaultMatchWidth:"any",parsePatterns:oE,defaultParseWidth:"any"})},cE={code:"en-US",formatDistance:DT,formatLong:NT,formatRelative:FT,localize:qT,match:aE,options:{weekStartsOn:0,firstWeekContainsDate:1}};function lE(n,t){const e=Xt(n,t?.in);return IT(e,RT(e))+1}function uE(n,t){const e=Xt(n,t?.in),i=+co(e)-+xT(e);return Math.round(i/$g)+1}function Xg(n,t){const e=Xt(n,t?.in),i=e.getFullYear(),s=Bo(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=se(t?.in||n,0);o.setFullYear(i+1,0,r),o.setHours(0,0,0,0);const a=Us(o,t),c=se(t?.in||n,0);c.setFullYear(i,0,r),c.setHours(0,0,0,0);const u=Us(c,t);return+e>=+a?i+1:+e>=+u?i:i-1}function hE(n,t){const e=Bo(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??e.firstWeekContainsDate??e.locale?.options?.firstWeekContainsDate??1,s=Xg(n,t),r=se(t?.in||n,0);return r.setFullYear(s,0,i),r.setHours(0,0,0,0),Us(r,t)}function dE(n,t){const e=Xt(n,t?.in),i=+Us(e,t)-+hE(e,t);return Math.round(i/$g)+1}function rt(n,t){const e=n<0?"-":"",i=Math.abs(n).toString().padStart(t,"0");return e+i}const nn={y(n,t){const e=n.getFullYear(),i=e>0?e:1-e;return rt(t==="yy"?i%100:i,t.length)},M(n,t){const e=n.getMonth();return t==="M"?String(e+1):rt(e+1,2)},d(n,t){return rt(n.getDate(),t.length)},a(n,t){const e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(n,t){return rt(n.getHours()%12||12,t.length)},H(n,t){return rt(n.getHours(),t.length)},m(n,t){return rt(n.getMinutes(),t.length)},s(n,t){return rt(n.getSeconds(),t.length)},S(n,t){const e=t.length,i=n.getMilliseconds(),s=Math.trunc(i*Math.pow(10,e-3));return rt(s,t.length)}},pi={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},yd={G:function(n,t,e){const i=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(i,{width:"abbreviated"});case"GGGGG":return e.era(i,{width:"narrow"});case"GGGG":default:return e.era(i,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){const i=n.getFullYear(),s=i>0?i:1-i;return e.ordinalNumber(s,{unit:"year"})}return nn.y(n,t)},Y:function(n,t,e,i){const s=Xg(n,i),r=s>0?s:1-s;if(t==="YY"){const o=r%100;return rt(o,2)}return t==="Yo"?e.ordinalNumber(r,{unit:"year"}):rt(r,t.length)},R:function(n,t){const e=Yg(n);return rt(e,t.length)},u:function(n,t){const e=n.getFullYear();return rt(e,t.length)},Q:function(n,t,e){const i=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return rt(i,2);case"Qo":return e.ordinalNumber(i,{unit:"quarter"});case"QQQ":return e.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(i,{width:"wide",context:"formatting"})}},q:function(n,t,e){const i=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return rt(i,2);case"qo":return e.ordinalNumber(i,{unit:"quarter"});case"qqq":return e.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(i,{width:"wide",context:"standalone"})}},M:function(n,t,e){const i=n.getMonth();switch(t){case"M":case"MM":return nn.M(n,t);case"Mo":return e.ordinalNumber(i+1,{unit:"month"});case"MMM":return e.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(i,{width:"wide",context:"formatting"})}},L:function(n,t,e){const i=n.getMonth();switch(t){case"L":return String(i+1);case"LL":return rt(i+1,2);case"Lo":return e.ordinalNumber(i+1,{unit:"month"});case"LLL":return e.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(i,{width:"wide",context:"standalone"})}},w:function(n,t,e,i){const s=dE(n,i);return t==="wo"?e.ordinalNumber(s,{unit:"week"}):rt(s,t.length)},I:function(n,t,e){const i=uE(n);return t==="Io"?e.ordinalNumber(i,{unit:"week"}):rt(i,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):nn.d(n,t)},D:function(n,t,e){const i=lE(n);return t==="Do"?e.ordinalNumber(i,{unit:"dayOfYear"}):rt(i,t.length)},E:function(n,t,e){const i=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(i,{width:"short",context:"formatting"});case"EEEE":default:return e.day(i,{width:"wide",context:"formatting"})}},e:function(n,t,e,i){const s=n.getDay(),r=(s-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return rt(r,2);case"eo":return e.ordinalNumber(r,{unit:"day"});case"eee":return e.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(s,{width:"short",context:"formatting"});case"eeee":default:return e.day(s,{width:"wide",context:"formatting"})}},c:function(n,t,e,i){const s=n.getDay(),r=(s-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return rt(r,t.length);case"co":return e.ordinalNumber(r,{unit:"day"});case"ccc":return e.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(s,{width:"narrow",context:"standalone"});case"cccccc":return e.day(s,{width:"short",context:"standalone"});case"cccc":default:return e.day(s,{width:"wide",context:"standalone"})}},i:function(n,t,e){const i=n.getDay(),s=i===0?7:i;switch(t){case"i":return String(s);case"ii":return rt(s,t.length);case"io":return e.ordinalNumber(s,{unit:"day"});case"iii":return e.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(i,{width:"short",context:"formatting"});case"iiii":default:return e.day(i,{width:"wide",context:"formatting"})}},a:function(n,t,e){const s=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,t,e){const i=n.getHours();let s;switch(i===12?s=pi.noon:i===0?s=pi.midnight:s=i/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,t,e){const i=n.getHours();let s;switch(i>=17?s=pi.evening:i>=12?s=pi.afternoon:i>=4?s=pi.morning:s=pi.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let i=n.getHours()%12;return i===0&&(i=12),e.ordinalNumber(i,{unit:"hour"})}return nn.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):nn.H(n,t)},K:function(n,t,e){const i=n.getHours()%12;return t==="Ko"?e.ordinalNumber(i,{unit:"hour"}):rt(i,t.length)},k:function(n,t,e){let i=n.getHours();return i===0&&(i=24),t==="ko"?e.ordinalNumber(i,{unit:"hour"}):rt(i,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):nn.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):nn.s(n,t)},S:function(n,t){return nn.S(n,t)},X:function(n,t,e){const i=n.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return vd(i);case"XXXX":case"XX":return jn(i);case"XXXXX":case"XXX":default:return jn(i,":")}},x:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"x":return vd(i);case"xxxx":case"xx":return jn(i);case"xxxxx":case"xxx":default:return jn(i,":")}},O:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+bd(i,":");case"OOOO":default:return"GMT"+jn(i,":")}},z:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+bd(i,":");case"zzzz":default:return"GMT"+jn(i,":")}},t:function(n,t,e){const i=Math.trunc(+n/1e3);return rt(i,t.length)},T:function(n,t,e){return rt(+n,t.length)}};function bd(n,t=""){const e=n>0?"-":"+",i=Math.abs(n),s=Math.trunc(i/60),r=i%60;return r===0?e+String(s):e+String(s)+t+rt(r,2)}function vd(n,t){return n%60===0?(n>0?"-":"+")+rt(Math.abs(n)/60,2):jn(n,t)}function jn(n,t=""){const e=n>0?"-":"+",i=Math.abs(n),s=rt(Math.trunc(i/60),2),r=rt(i%60,2);return e+s+t+r}const wd=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Qg=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},fE=(n,t)=>{const e=n.match(/(P+)(p+)?/)||[],i=e[1],s=e[2];if(!s)return wd(n,t);let r;switch(i){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;case"PPPP":default:r=t.dateTime({width:"full"});break}return r.replace("{{date}}",wd(i,t)).replace("{{time}}",Qg(s,t))},gE={p:Qg,P:fE},pE=/^D+$/,mE=/^Y+$/,_E=["D","DD","YY","YYYY"];function yE(n){return pE.test(n)}function bE(n){return mE.test(n)}function vE(n,t,e){const i=wE(n,t,e);if(console.warn(i),_E.includes(n))throw new RangeError(i)}function wE(n,t,e){const i=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${i} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const TE=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,EE=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,IE=/^'([^]*?)'?$/,xE=/''/g,SE=/[a-zA-Z]/;function Fe(n,t,e){const i=Bo(),s=e?.locale??i.locale??cE,r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=Xt(n,e?.in);if(!AT(a))throw new RangeError("Invalid time value");let c=t.match(EE).map(h=>{const d=h[0];if(d==="p"||d==="P"){const g=gE[d];return g(h,s.formatLong)}return h}).join("").match(TE).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const d=h[0];if(d==="'")return{isToken:!1,value:AE(h)};if(yd[d])return{isToken:!0,value:h};if(d.match(SE))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(a,c));const u={firstWeekContainsDate:r,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const d=h.value;(!e?.useAdditionalWeekYearTokens&&bE(d)||!e?.useAdditionalDayOfYearTokens&&yE(d))&&vE(d,t,String(n));const g=yd[d[0]];return g(a,d,s.localize,u)}).join("")}function AE(n){const t=n.match(IE);return t?t[1].replace(xE,"'"):n}function Ba(n,t,e){const[i,s]=nl(e?.in,n,t);return i.getFullYear()===s.getFullYear()&&i.getMonth()===s.getMonth()}function xs(n,t){const e=()=>se(t?.in,NaN),s=kE(n);let r;if(s.date){const u=DE(s.date,2);r=ME(u.restDateString,u.year)}if(!r||isNaN(+r))return e();const o=+r;let a=0,c;if(s.time&&(a=OE(s.time),isNaN(a)))return e();if(s.timezone){if(c=VE(s.timezone),isNaN(c))return e()}else{const u=new Date(o+a),h=Xt(0,t?.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Xt(o+a+c,t?.in)}const Or={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},PE=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,CE=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,RE=/^([+-])(\d{2})(?::?(\d{2}))?$/;function kE(n){const t={},e=n.split(Or.dateTimeDelimiter);let i;if(e.length>2)return t;if(/:/.test(e[0])?i=e[0]:(t.date=e[0],i=e[1],Or.timeZoneDelimiter.test(t.date)&&(t.date=n.split(Or.timeZoneDelimiter)[0],i=n.substr(t.date.length,n.length))),i){const s=Or.timezone.exec(i);s?(t.time=i.replace(s[1],""),t.timezone=s[1]):t.time=i}return t}function DE(n,t){const e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=n.match(e);if(!i)return{year:NaN,restDateString:""};const s=i[1]?parseInt(i[1]):null,r=i[2]?parseInt(i[2]):null;return{year:r===null?s:r*100,restDateString:n.slice((i[1]||i[2]).length)}}function ME(n,t){if(t===null)return new Date(NaN);const e=n.match(PE);if(!e)return new Date(NaN);const i=!!e[4],s=ds(e[1]),r=ds(e[2])-1,o=ds(e[3]),a=ds(e[4]),c=ds(e[5])-1;if(i)return UE(t,a,c)?NE(t,a,c):new Date(NaN);{const u=new Date(0);return!FE(t,r,o)||!BE(t,s)?new Date(NaN):(u.setUTCFullYear(t,r,Math.max(s,o)),u)}}function ds(n){return n?parseInt(n):1}function OE(n){const t=n.match(CE);if(!t)return NaN;const e=Ua(t[1]),i=Ua(t[2]),s=Ua(t[3]);return zE(e,i,s)?e*Gg+i*qg+s*1e3:NaN}function Ua(n){return n&&parseFloat(n.replace(",","."))||0}function VE(n){if(n==="Z")return 0;const t=n.match(RE);if(!t)return 0;const e=t[1]==="+"?-1:1,i=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return WE(i,s)?e*(i*Gg+s*qg):NaN}function NE(n,t,e){const i=new Date(0);i.setUTCFullYear(n,0,4);const s=i.getUTCDay()||7,r=(t-1)*7+e+1-s;return i.setUTCDate(i.getUTCDate()+r),i}const LE=[31,null,31,30,31,30,31,31,30,31,30,31];function Jg(n){return n%400===0||n%4===0&&n%100!==0}function FE(n,t,e){return t>=0&&t<=11&&e>=1&&e<=(LE[t]||(Jg(n)?29:28))}function BE(n,t){return t>=1&&t<=(Jg(n)?366:365)}function UE(n,t,e){return t>=1&&t<=53&&e>=0&&e<=6}function zE(n,t,e){return n===24?t===0&&e===0:e>=0&&e<60&&t>=0&&t<60&&n>=0&&n<25}function WE(n,t){return t>=0&&t<=59}function Td(n,t,e){return TT(n,-t,e)}const jE={lessThanXSeconds:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:"1",other:"{{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:"1",other:"{{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:"1",other:"{{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:"1",other:"{{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1",other:"{{count}}"},almostXYears:{one:"1",other:"{{count}}"}},HE=(n,t,e)=>{e=e||{};let i;const s=jE[n];return typeof s=="string"?i=s:t===1?e.addSuffix&&s.oneWithSuffix?i=s.oneWithSuffix:i=s.one:e.addSuffix&&s.otherWithSuffix?i=s.otherWithSuffix.replace("{{count}}",String(t)):i=s.other.replace("{{count}}",String(t)),e.addSuffix?e.comparison&&e.comparison>0?i+"":i+"":i},$E={full:"yMdEEEE",long:"yMd",medium:"y/MM/dd",short:"y/MM/dd"},qE={full:"Hmmss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},GE={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},YE={date:Ti({formats:$E,defaultWidth:"full"}),time:Ti({formats:qE,defaultWidth:"full"}),dateTime:Ti({formats:GE,defaultWidth:"full"})},KE={lastWeek:"eeeep",yesterday:"p",today:"p",tomorrow:"p",nextWeek:"eeeep",other:"P"},XE=(n,t,e,i)=>KE[n],QE={narrow:["BC","AC"],abbreviated:["",""],wide:["",""]},JE={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},ZE={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},tI={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},eI={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},nI={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},iI=(n,t)=>{const e=Number(n);switch(String(t?.unit)){case"year":return`${e}`;case"quarter":return`${e}`;case"month":return`${e}`;case"week":return`${e}`;case"date":return`${e}`;case"hour":return`${e}`;case"minute":return`${e}`;case"second":return`${e}`;default:return`${e}`}},sI={ordinalNumber:iI,era:_e({values:QE,defaultWidth:"wide"}),quarter:_e({values:JE,defaultWidth:"wide",argumentCallback:n=>Number(n)-1}),month:_e({values:ZE,defaultWidth:"wide"}),day:_e({values:tI,defaultWidth:"wide"}),dayPeriod:_e({values:eI,defaultWidth:"wide",formattingValues:nI,defaultFormattingWidth:"wide"})},rI=/^?\d+(|||||||)?/i,oI=/\d+/i,aI={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^([]|)/i,wide:/^([]|)/i},cI={narrow:[/^B/i,/^A/i],any:[/^()/i,/^(|)/i]},lI={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^[1234]/i},uI={any:[/(1||)/i,/(2||)/i,/(3||)/i,/(4||)/i]},hI={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])/i,wide:/^([123456789]|1[012])/i},dI={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},fI={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},gI={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},pI={any:/^(AM|PM|||||||)/i},mI={any:{am:/^(A|)/i,pm:/^(P|)/i,midnight:/^|/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},_I={ordinalNumber:Kg({matchPattern:rI,parsePattern:oI,valueCallback:function(n){return parseInt(n,10)}}),era:ye({matchPatterns:aI,defaultMatchWidth:"wide",parsePatterns:cI,defaultParseWidth:"any"}),quarter:ye({matchPatterns:lI,defaultMatchWidth:"wide",parsePatterns:uI,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ye({matchPatterns:hI,defaultMatchWidth:"wide",parsePatterns:dI,defaultParseWidth:"any"}),day:ye({matchPatterns:fI,defaultMatchWidth:"wide",parsePatterns:gI,defaultParseWidth:"any"}),dayPeriod:ye({matchPatterns:pI,defaultMatchWidth:"any",parsePatterns:mI,defaultParseWidth:"any"})},yI={code:"ja",formatDistance:HE,formatLong:YE,formatRelative:XE,localize:sI,match:_I,options:{weekStartsOn:0,firstWeekContainsDate:1}},bI=()=>{};var Ed={};const Zg=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},vI=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[e++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[e++],o=n[e++],a=n[e++],c=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(c&1023))}else{const r=n[e++],o=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},tp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let g=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(g=64)),i.push(e[h],e[d],e[g],e[m])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Zg(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):vI(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=e[n.charAt(s++)],a=s<n.length?e[n.charAt(s)]:0;++s;const u=s<n.length?e[n.charAt(s)]:64;++s;const d=s<n.length?e[n.charAt(s)]:64;if(++s,r==null||a==null||u==null||d==null)throw new wI;const g=r<<2|a>>4;if(i.push(g),u!==64){const m=a<<4&240|u>>2;if(i.push(m),d!==64){const y=u<<6&192|d;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class wI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TI=function(n){const t=Zg(n);return tp.encodeByteArray(t,!0)},lo=function(n){return TI(n).replace(/\./g,"")},ep=function(n){try{return tp.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function EI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const II=()=>EI().__FIREBASE_DEFAULTS__,xI=()=>{if(typeof process>"u"||typeof Ed>"u")return;const n=Ed.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&ep(n[1]);return t&&JSON.parse(t)},Uo=()=>{try{return bI()||II()||xI()||SI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},np=n=>Uo()?.emulatorHosts?.[n],AI=n=>{const t=np(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},ip=()=>Uo()?.config,sp=n=>Uo()?.[`_${n}`];class PI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function Fi(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rp(n){return(await fetch(n,{credentials:"include"})).ok}function CI(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[lo(JSON.stringify(e)),lo(JSON.stringify(o)),""].join(".")}const Ss={};function RI(){const n={prod:[],emulator:[]};for(const t of Object.keys(Ss))Ss[t]?n.emulator.push(t):n.prod.push(t);return n}function kI(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let Id=!1;function op(n,t){if(typeof window>"u"||typeof document>"u"||!Fi(window.location.host)||Ss[n]===t||Ss[n]||Id)return;Ss[n]=t;function e(g){return`__firebase__banner__${g}`}const i="__firebase__banner",r=RI().prod.length>0;function o(){const g=document.getElementById(i);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Id=!0,o()},g}function h(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function d(){const g=kI(i),m=e("text"),y=document.getElementById(m)||document.createElement("span"),v=e("learnmore"),w=document.getElementById(v)||document.createElement("a"),P=e("preprendIcon"),C=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const D=g.element;a(D),h(w,v);const O=u();c(C,P),D.append(C,y,w,O),document.body.appendChild(D)}r?(y.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function DI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function MI(){const n=Uo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function OI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function NI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LI(){const n=Ht();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function FI(){return!MI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function BI(){try{return typeof indexedDB=="object"}catch{return!1}}function UI(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}const zI="FirebaseError";class Ge extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=zI,Object.setPrototypeOf(this,Ge.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zs.prototype.create)}}class Zs{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?WI(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ge(s,a,i)}}function WI(n,t){return n.replace(jI,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const jI=/\{\$([^}]+)}/g;function HI(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function ti(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const r=n[s],o=t[s];if(xd(r)&&xd(o)){if(!ti(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function xd(n){return n!==null&&typeof n=="object"}function tr(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function $I(n,t){const e=new qI(n,t);return e.subscribe.bind(e)}class qI{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let s;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");GI(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:i},s.next===void 0&&(s.next=za),s.error===void 0&&(s.error=za),s.complete===void 0&&(s.complete=za);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GI(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function za(){}function re(n){return n&&n._delegate?n._delegate:n}class ei{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Hn="[DEFAULT]";class YI{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new PI;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(XI(t))try{this.getOrInitializeService({instanceIdentifier:Hn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Hn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Hn){return this.instances.has(t)}getOptions(t=Hn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(i)??new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:KI(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Hn){return this.component?this.component.multipleInstances?t:Hn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function KI(n){return n===Hn?void 0:n}function XI(n){return n.instantiationMode==="EAGER"}class QI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new YI(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var X;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(X||(X={}));const JI={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},ZI=X.INFO,tx={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},ex=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=tx[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class il{constructor(t){this.name=t,this._logLevel=ZI,this._logHandler=ex,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in X))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?JI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...t),this._logHandler(this,X.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...t),this._logHandler(this,X.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,X.INFO,...t),this._logHandler(this,X.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,X.WARN,...t),this._logHandler(this,X.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...t),this._logHandler(this,X.ERROR,...t)}}const nx=(n,t)=>t.some(e=>n instanceof e);let Sd,Ad;function ix(){return Sd||(Sd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sx(){return Ad||(Ad=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ap=new WeakMap,hc=new WeakMap,cp=new WeakMap,Wa=new WeakMap,sl=new WeakMap;function rx(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(pn(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&ap.set(e,n)}).catch(()=>{}),sl.set(t,n),t}function ox(n){if(hc.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});hc.set(n,t)}let dc={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return hc.get(n);if(t==="objectStoreNames")return n.objectStoreNames||cp.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return pn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function ax(n){dc=n(dc)}function cx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(ja(this),t,...e);return cp.set(i,t.sort?t.sort():[t]),pn(i)}:sx().includes(n)?function(...t){return n.apply(ja(this),t),pn(ap.get(this))}:function(...t){return pn(n.apply(ja(this),t))}}function lx(n){return typeof n=="function"?cx(n):(n instanceof IDBTransaction&&ox(n),nx(n,ix())?new Proxy(n,dc):n)}function pn(n){if(n instanceof IDBRequest)return rx(n);if(Wa.has(n))return Wa.get(n);const t=lx(n);return t!==n&&(Wa.set(n,t),sl.set(t,n)),t}const ja=n=>sl.get(n);function ux(n,t,{blocked:e,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,t),a=pn(o);return i&&o.addEventListener("upgradeneeded",c=>{i(pn(o.result),c.oldVersion,c.newVersion,pn(o.transaction),c)}),e&&o.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),a.then(c=>{r&&c.addEventListener("close",()=>r()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const hx=["get","getKey","getAll","getAllKeys","count"],dx=["put","add","delete","clear"],Ha=new Map;function Pd(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Ha.get(t))return Ha.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=dx.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||hx.includes(e)))return;const r=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[e](...a),s&&c.done]))[0]};return Ha.set(t,r),r}ax(n=>({...n,get:(t,e,i)=>Pd(t,e)||n.get(t,e,i),has:(t,e)=>!!Pd(t,e)||n.has(t,e)}));class fx{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(gx(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function gx(n){return n.getComponent()?.type==="VERSION"}const fc="@firebase/app",Cd="0.14.6";const We=new il("@firebase/app"),px="@firebase/app-compat",mx="@firebase/analytics-compat",_x="@firebase/analytics",yx="@firebase/app-check-compat",bx="@firebase/app-check",vx="@firebase/auth",wx="@firebase/auth-compat",Tx="@firebase/database",Ex="@firebase/data-connect",Ix="@firebase/database-compat",xx="@firebase/functions",Sx="@firebase/functions-compat",Ax="@firebase/installations",Px="@firebase/installations-compat",Cx="@firebase/messaging",Rx="@firebase/messaging-compat",kx="@firebase/performance",Dx="@firebase/performance-compat",Mx="@firebase/remote-config",Ox="@firebase/remote-config-compat",Vx="@firebase/storage",Nx="@firebase/storage-compat",Lx="@firebase/firestore",Fx="@firebase/ai",Bx="@firebase/firestore-compat",Ux="firebase",zx="12.6.0";const gc="[DEFAULT]",Wx={[fc]:"fire-core",[px]:"fire-core-compat",[_x]:"fire-analytics",[mx]:"fire-analytics-compat",[bx]:"fire-app-check",[yx]:"fire-app-check-compat",[vx]:"fire-auth",[wx]:"fire-auth-compat",[Tx]:"fire-rtdb",[Ex]:"fire-data-connect",[Ix]:"fire-rtdb-compat",[xx]:"fire-fn",[Sx]:"fire-fn-compat",[Ax]:"fire-iid",[Px]:"fire-iid-compat",[Cx]:"fire-fcm",[Rx]:"fire-fcm-compat",[kx]:"fire-perf",[Dx]:"fire-perf-compat",[Mx]:"fire-rc",[Ox]:"fire-rc-compat",[Vx]:"fire-gcs",[Nx]:"fire-gcs-compat",[Lx]:"fire-fst",[Bx]:"fire-fst-compat",[Fx]:"fire-vertex","fire-js":"fire-js",[Ux]:"fire-js-all"};const uo=new Map,jx=new Map,pc=new Map;function Rd(n,t){try{n.container.addComponent(t)}catch(e){We.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Ri(n){const t=n.name;if(pc.has(t))return We.debug(`There were multiple attempts to register component ${t}.`),!1;pc.set(t,n);for(const e of uo.values())Rd(e,n);for(const e of jx.values())Rd(e,n);return!0}function rl(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function ae(n){return n==null?!1:n.settings!==void 0}const Hx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},mn=new Zs("app","Firebase",Hx);class $x{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw mn.create("app-deleted",{appName:this._name})}}const Bi=zx;function lp(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i={name:gc,automaticDataCollectionEnabled:!0,...t},s=i.name;if(typeof s!="string"||!s)throw mn.create("bad-app-name",{appName:String(s)});if(e||(e=ip()),!e)throw mn.create("no-options");const r=uo.get(s);if(r){if(ti(e,r.options)&&ti(i,r.config))return r;throw mn.create("duplicate-app",{appName:s})}const o=new QI(s);for(const c of pc.values())o.addComponent(c);const a=new $x(e,i,o);return uo.set(s,a),a}function up(n=gc){const t=uo.get(n);if(!t&&n===gc&&ip())return lp();if(!t)throw mn.create("no-app",{appName:n});return t}function _n(n,t,e){let i=Wx[n]??n;e&&(i+=`-${e}`);const s=i.match(/\s|\//),r=t.match(/\s|\//);if(s||r){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),We.warn(o.join(" "));return}Ri(new ei(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const qx="firebase-heartbeat-database",Gx=1,zs="firebase-heartbeat-store";let $a=null;function hp(){return $a||($a=ux(qx,Gx,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(zs)}catch(e){console.warn(e)}}}}).catch(n=>{throw mn.create("idb-open",{originalErrorMessage:n.message})})),$a}async function Yx(n){try{const e=(await hp()).transaction(zs),i=await e.objectStore(zs).get(dp(n));return await e.done,i}catch(t){if(t instanceof Ge)We.warn(t.message);else{const e=mn.create("idb-get",{originalErrorMessage:t?.message});We.warn(e.message)}}}async function kd(n,t){try{const i=(await hp()).transaction(zs,"readwrite");await i.objectStore(zs).put(t,dp(n)),await i.done}catch(e){if(e instanceof Ge)We.warn(e.message);else{const i=mn.create("idb-set",{originalErrorMessage:e?.message});We.warn(i.message)}}}function dp(n){return`${n.name}!${n.options.appId}`}const Kx=1024,Xx=30;class Qx{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Zx(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Dd();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>Xx){const s=tS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){We.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Dd(),{heartbeatsToSend:e,unsentEntries:i}=Jx(this._heartbeatsCache.heartbeats),s=lo(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return We.warn(t),""}}}function Dd(){return new Date().toISOString().substring(0,10)}function Jx(n,t=Kx){const e=[];let i=n.slice();for(const s of n){const r=e.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Md(e)>t){r.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Md(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class Zx{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return BI()?UI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Yx(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return kd(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return kd(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Md(n){return lo(JSON.stringify({version:2,heartbeats:n})).length}function tS(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function eS(n){Ri(new ei("platform-logger",t=>new fx(t),"PRIVATE")),Ri(new ei("heartbeat",t=>new Qx(t),"PRIVATE")),_n(fc,Cd,n),_n(fc,Cd,"esm2020"),_n("fire-js","")}eS("");var nS="firebase",iS="12.6.0";_n(nS,iS,"app");function fp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sS=fp,gp=new Zs("auth","Firebase",fp());const ho=new il("@firebase/auth");function rS(n,...t){ho.logLevel<=X.WARN&&ho.warn(`Auth (${Bi}): ${n}`,...t)}function jr(n,...t){ho.logLevel<=X.ERROR&&ho.error(`Auth (${Bi}): ${n}`,...t)}function xe(n,...t){throw al(n,...t)}function he(n,...t){return al(n,...t)}function ol(n,t,e){const i={...sS(),[t]:e};return new Zs("auth","Firebase",i).create(t,{appName:n.name})}function Xn(n){return ol(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oS(n,t,e){const i=e;if(!(t instanceof i))throw i.name!==t.constructor.name&&xe(n,"argument-error"),ol(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function al(n,...t){if(typeof n!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(e,...i)}return gp.create(n,...t)}function j(n,t,...e){if(!n)throw al(t,...e)}function Be(n){const t="INTERNAL ASSERTION FAILED: "+n;throw jr(t),new Error(t)}function je(n,t){n||Be(t)}function mc(){return typeof self<"u"&&self.location?.href||""}function aS(){return Od()==="http:"||Od()==="https:"}function Od(){return typeof self<"u"&&self.location?.protocol||null}function cS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aS()||VI()||"connection"in navigator)?navigator.onLine:!0}function lS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class er{constructor(t,e){this.shortDelay=t,this.longDelay=e,je(e>t,"Short delay should be less than long delay!"),this.isMobile=DI()||NI()}get(){return cS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cl(n,t){je(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class pp{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Be("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Be("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Be("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const uS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const hS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dS=new er(3e4,6e4);function ll(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Ui(n,t,e,i,s={}){return mp(n,s,async()=>{let r={},o={};i&&(t==="GET"?o=i:r={body:JSON.stringify(i)});const a=tr({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u={method:t,headers:c,...r};return OI()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Fi(n.emulatorConfig.host)&&(u.credentials="include"),pp.fetch()(await _p(n,n.config.apiHost,e,a),u)})}async function mp(n,t,e){n._canInitEmulator=!1;const i={...uS,...t};try{const s=new gS(n),r=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Vr(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vr(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Vr(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Vr(n,"user-disabled",o);const h=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw ol(n,h,u);xe(n,h)}}catch(s){if(s instanceof Ge)throw s;xe(n,"network-request-failed",{message:String(s)})}}async function fS(n,t,e,i,s={}){const r=await Ui(n,t,e,i,s);return"mfaPendingCredential"in r&&xe(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function _p(n,t,e,i){const s=`${t}${e}?${i}`,r=n,o=r.config.emulator?cl(n.config,s):`${n.config.apiScheme}://${s}`;return hS.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class gS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(he(this.auth,"network-request-failed")),dS.get())})}}function Vr(n,t,e){const i={appName:n.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const s=he(n,t,i);return s.customData._tokenResponse=e,s}async function pS(n,t){return Ui(n,"POST","/v1/accounts:delete",t)}async function fo(n,t){return Ui(n,"POST","/v1/accounts:lookup",t)}function As(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function mS(n,t=!1){const e=re(n),i=await e.getIdToken(t),s=ul(i);j(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:i,authTime:As(qa(s.auth_time)),issuedAtTime:As(qa(s.iat)),expirationTime:As(qa(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function qa(n){return Number(n)*1e3}function ul(n){const[t,e,i]=n.split(".");if(t===void 0||e===void 0||i===void 0)return jr("JWT malformed, contained fewer than 3 sections"),null;try{const s=ep(e);return s?JSON.parse(s):(jr("Failed to decode base64 JWT payload"),null)}catch(s){return jr("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Vd(n){const t=ul(n);return j(t,"internal-error"),j(typeof t.exp<"u","internal-error"),j(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Ws(n,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof Ge&&_S(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function _S({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class yS{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class _c{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=As(this.lastLoginAt),this.creationTime=As(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function go(n){const t=n.auth,e=await n.getIdToken(),i=await Ws(n,fo(t,{idToken:e}));j(i?.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const r=s.providerUserInfo?.length?yp(s.providerUserInfo):[],o=vS(n.providerData,r),a=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!o?.length,u=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new _c(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function bS(n){const t=re(n);await go(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function vS(n,t){return[...n.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function yp(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function wS(n,t){const e=await mp(n,{},async()=>{const i=tr({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=await _p(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&Fi(n.emulatorConfig.host)&&(c.credentials="include"),pp.fetch()(o,c)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function TS(n,t){return Ui(n,"POST","/v2/accounts:revokeToken",ll(n,t))}class Ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){j(t.idToken,"internal-error"),j(typeof t.idToken<"u","internal-error"),j(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Vd(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){j(t.length!==0,"internal-error");const e=Vd(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:s,expiresIn:r}=await wS(t,e);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:s,expirationTime:r}=e,o=new Ei;return i&&(j(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),s&&(j(typeof s=="string","internal-error",{appName:t}),o.accessToken=s),r&&(j(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ei,this.toJSON())}_performRefresh(){return Be("not implemented")}}function sn(n,t){j(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class le{constructor({uid:t,auth:e,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new yS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _c(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ws(this,this.stsTokenManager.getToken(this.auth,t));return j(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return mS(this,t)}reload(){return bS(this)}_assign(t){this!==t&&(j(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new le({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await go(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ae(this.auth.app))return Promise.reject(Xn(this.auth));const t=await this.getIdToken();return await Ws(this,pS(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const i=e.displayName??void 0,s=e.email??void 0,r=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,c=e._redirectEventId??void 0,u=e.createdAt??void 0,h=e.lastLoginAt??void 0,{uid:d,emailVerified:g,isAnonymous:m,providerData:y,stsTokenManager:v}=e;j(d&&v,t,"internal-error");const w=Ei.fromJSON(this.name,v);j(typeof d=="string",t,"internal-error"),sn(i,t.name),sn(s,t.name),j(typeof g=="boolean",t,"internal-error"),j(typeof m=="boolean",t,"internal-error"),sn(r,t.name),sn(o,t.name),sn(a,t.name),sn(c,t.name),sn(u,t.name),sn(h,t.name);const P=new le({uid:d,auth:t,email:s,emailVerified:g,displayName:i,isAnonymous:m,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:w,createdAt:u,lastLoginAt:h});return y&&Array.isArray(y)&&(P.providerData=y.map(C=>({...C}))),c&&(P._redirectEventId=c),P}static async _fromIdTokenResponse(t,e,i=!1){const s=new Ei;s.updateFromServerResponse(e);const r=new le({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await go(r),r}static async _fromGetAccountInfoResponse(t,e,i){const s=e.users[0];j(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?yp(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,a=new Ei;a.updateFromIdToken(i);const c=new le({uid:s.localId,auth:t,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new _c(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(c,u),c}}const Nd=new Map;function Ue(n){je(n instanceof Function,"Expected a class definition");let t=Nd.get(n);return t?(je(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Nd.set(n,t),t)}class bp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}bp.type="NONE";const Ld=bp;function Hr(n,t,e){return`firebase:${n}:${t}:${e}`}class Ii{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=Hr(this.userKey,s.apiKey,r),this.fullPersistenceKey=Hr("persistence",s.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await fo(this.auth,{idToken:t}).catch(()=>{});return e?le._fromGetAccountInfoResponse(this.auth,e,t):null}return le._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new Ii(Ue(Ld),t,i);const s=(await Promise.all(e.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=s[0]||Ue(Ld);const o=Hr(i,t.config.apiKey,t.name);let a=null;for(const u of e)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const g=await fo(t,{idToken:h}).catch(()=>{});if(!g)break;d=await le._fromGetAccountInfoResponse(t,g,h)}else d=le._fromJSON(t,h);u!==r&&(a=d),r=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new Ii(r,t,i):(r=c[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new Ii(r,t,i))}}function Fd(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ep(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(vp(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(xp(t))return"Blackberry";if(Sp(t))return"Webos";if(wp(t))return"Safari";if((t.includes("chrome/")||Tp(t))&&!t.includes("edge/"))return"Chrome";if(Ip(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(e);if(i?.length===2)return i[1]}return"Other"}function vp(n=Ht()){return/firefox\//i.test(n)}function wp(n=Ht()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Tp(n=Ht()){return/crios\//i.test(n)}function Ep(n=Ht()){return/iemobile/i.test(n)}function Ip(n=Ht()){return/android/i.test(n)}function xp(n=Ht()){return/blackberry/i.test(n)}function Sp(n=Ht()){return/webos/i.test(n)}function hl(n=Ht()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ES(n=Ht()){return hl(n)&&!!window.navigator?.standalone}function IS(){return LI()&&document.documentMode===10}function Ap(n=Ht()){return hl(n)||Ip(n)||Sp(n)||xp(n)||/windows phone/i.test(n)||Ep(n)}function Pp(n,t=[]){let e;switch(n){case"Browser":e=Fd(Ht());break;case"Worker":e=`${Fd(Ht())}-${n}`;break;default:e=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Bi}/${i}`}class xS{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=r=>new Promise((o,a)=>{try{const c=t(r);o(c)}catch(c){a(c)}});i.onAbort=e,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function SS(n,t={}){return Ui(n,"GET","/v2/passwordPolicy",ll(n,t))}const AS=6;class PS{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??AS,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class CS{constructor(t,e,i,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bd(this),this.idTokenSubscription=new Bd(this),this.beforeStateQueue=new xS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Ue(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ii.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await fo(this,{idToken:t}),i=await le._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(ae(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let i=e,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(t);(!r||r===o)&&a?.user&&(i=a.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await go(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=lS()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ae(this.app))return Promise.reject(Xn(this));const e=t?re(t):null;return e&&j(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&j(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return ae(this.app)?Promise.reject(Xn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ae(this.app)?Promise.reject(Xn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ue(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await SS(this),e=new PS(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Zs("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await TS(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Ue(t)||this._popupRedirectResolver;j(e,this,"argument-error"),this.redirectPersistenceManager=await Ii.create(this,[Ue(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,s){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const c=t.addObserver(e,i,s);return()=>{o=!0,c()}}else{const c=t.addObserver(e);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Pp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){if(ae(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&rS(`Error while retrieving App Check token: ${t.error}`),t?.token}}function zo(n){return re(n)}class Bd{constructor(t){this.auth=t,this.observer=null,this.addObserver=$I(e=>this.observer=e)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let dl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RS(n){dl=n}function kS(n){return dl.loadJS(n)}function DS(){return dl.gapiScript}function MS(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function OS(n,t){const e=rl(n,"auth");if(e.isInitialized()){const s=e.getImmediate(),r=e.getOptions();if(ti(r,t??{}))return s;xe(s,"already-initialized")}return e.initialize({options:t})}function VS(n,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(Ue);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t?.popupRedirectResolver)}function NS(n,t,e){const i=zo(n);j(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,r=Cp(t),{host:o,port:a}=LS(t),c=a===null?"":`:${a}`,u={url:`${r}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){j(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),j(ti(u,i.config.emulator)&&ti(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,Fi(o)?(rp(`${r}//${o}${c}`),op("Auth",!0)):FS()}function Cp(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function LS(n){const t=Cp(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:Ud(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:Ud(o)}}}function Ud(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function FS(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Rp{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Be("not implemented")}_getIdTokenResponse(t){return Be("not implemented")}_linkToIdToken(t,e){return Be("not implemented")}_getReauthenticationResolver(t){return Be("not implemented")}}async function xi(n,t){return fS(n,"POST","/v1/accounts:signInWithIdp",ll(n,t))}const BS="http://localhost";class ni extends Rp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new ni(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):xe("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s,...r}=e;if(!i||!s)return null;const o=new ni(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return xi(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,xi(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,xi(t,e)}buildRequest(){const t={requestUri:BS,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=tr(e)}return t}}class fl{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class nr extends fl{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class rn extends nr{constructor(){super("facebook.com")}static credential(t){return ni._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return rn.credentialFromTaggedObject(t)}static credentialFromError(t){return rn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return rn.credential(t.oauthAccessToken)}catch{return null}}}rn.FACEBOOK_SIGN_IN_METHOD="facebook.com";rn.PROVIDER_ID="facebook.com";class Oe extends nr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return ni._fromParams({providerId:Oe.PROVIDER_ID,signInMethod:Oe.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Oe.credentialFromTaggedObject(t)}static credentialFromError(t){return Oe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return Oe.credential(e,i)}catch{return null}}}Oe.GOOGLE_SIGN_IN_METHOD="google.com";Oe.PROVIDER_ID="google.com";class on extends nr{constructor(){super("github.com")}static credential(t){return ni._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return on.credentialFromTaggedObject(t)}static credentialFromError(t){return on.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return on.credential(t.oauthAccessToken)}catch{return null}}}on.GITHUB_SIGN_IN_METHOD="github.com";on.PROVIDER_ID="github.com";class an extends nr{constructor(){super("twitter.com")}static credential(t,e){return ni._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return an.credentialFromTaggedObject(t)}static credentialFromError(t){return an.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return an.credential(e,i)}catch{return null}}}an.TWITTER_SIGN_IN_METHOD="twitter.com";an.PROVIDER_ID="twitter.com";class ki{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,s=!1){const r=await le._fromIdTokenResponse(t,i,s),o=zd(i);return new ki({user:r,providerId:o,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const s=zd(i);return new ki({user:t,providerId:s,_tokenResponse:i,operationType:e})}}function zd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class po extends Ge{constructor(t,e,i,s){super(e.code,e.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,po.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,s){return new po(t,e,i,s)}}function kp(n,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?po._fromErrorAndOperation(n,r,t,i):r})}async function US(n,t,e=!1){const i=await Ws(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return ki._forOperation(n,"link",i)}async function zS(n,t,e=!1){const{auth:i}=n;if(ae(i.app))return Promise.reject(Xn(i));const s="reauthenticate";try{const r=await Ws(n,kp(i,s,t,n),e);j(r.idToken,i,"internal-error");const o=ul(r.idToken);j(o,i,"internal-error");const{sub:a}=o;return j(n.uid===a,i,"user-mismatch"),ki._forOperation(n,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&xe(i,"user-mismatch"),r}}async function WS(n,t,e=!1){if(ae(n.app))return Promise.reject(Xn(n));const i="signIn",s=await kp(n,i,t),r=await ki._fromIdTokenResponse(n,i,s);return e||await n._updateCurrentUser(r.user),r}function jS(n,t,e,i){return re(n).onIdTokenChanged(t,e,i)}function HS(n,t,e){return re(n).beforeAuthStateChanged(t,e)}function $S(n,t,e,i){return re(n).onAuthStateChanged(t,e,i)}function qS(n){return re(n).signOut()}const mo="__sak";class Dp{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(mo,"1"),this.storage.removeItem(mo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const GS=1e3,YS=10;class Mp extends Dp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ap(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),s=this.localCache[e];i!==s&&t(e,s,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!e&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);IS()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,YS):s()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},GS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Mp.type="LOCAL";const KS=Mp;class Op extends Dp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Op.type="SESSION";const Vp=Op;function XS(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Wo{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const i=new Wo(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:s,data:r}=e.data,o=this.handlersMap[s];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async u=>u(e.origin,r)),c=await XS(a);e.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wo.receivers=[];function gl(n="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return n+e}class QS{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,c)=>{const u=gl("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(d){const g=d;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(g.data.response);break;default:clearTimeout(h),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:u,data:e},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ve(){return window}function JS(n){ve().location.href=n}function Np(){return typeof ve().WorkerGlobalScope<"u"&&typeof ve().importScripts=="function"}async function ZS(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tA(){return navigator?.serviceWorker?.controller||null}function eA(){return Np()?self:null}const Lp="firebaseLocalStorageDb",nA=1,_o="firebaseLocalStorage",Fp="fbase_key";class ir{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function jo(n,t){return n.transaction([_o],t?"readwrite":"readonly").objectStore(_o)}function iA(){const n=indexedDB.deleteDatabase(Lp);return new ir(n).toPromise()}function yc(){const n=indexedDB.open(Lp,nA);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(_o,{keyPath:Fp})}catch(s){e(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(_o)?t(i):(i.close(),await iA(),t(await yc()))})})}async function Wd(n,t,e){const i=jo(n,!0).put({[Fp]:t,value:e});return new ir(i).toPromise()}async function sA(n,t){const e=jo(n,!1).get(t),i=await new ir(e).toPromise();return i===void 0?null:i.value}function jd(n,t){const e=jo(n,!0).delete(t);return new ir(e).toPromise()}const rA=800,oA=3;class Bp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yc(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>oA)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Np()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wo._getInstance(eA()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await ZS(),!this.activeServiceWorker)return;this.sender=new QS(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||tA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await yc();return await Wd(t,mo,"1"),await jd(t,mo),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>Wd(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>sA(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>jd(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const r=jo(s,!1).getAll();return new ir(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:r}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Bp.type="LOCAL";const aA=Bp;new er(3e4,6e4);function Up(n,t){return t?Ue(t):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class pl extends Rp{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return xi(t,this._buildIdpRequest())}_linkToIdToken(t,e){return xi(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return xi(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function cA(n){return WS(n.auth,new pl(n),n.bypassAuthState)}function lA(n){const{auth:t,user:e}=n;return j(e,t,"internal-error"),zS(e,new pl(n),n.bypassAuthState)}async function uA(n){const{auth:t,user:e}=n;return j(e,t,"internal-error"),US(e,new pl(n),n.bypassAuthState)}class zp{constructor(t,e,i,s,r=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:e,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return cA;case"linkViaPopup":case"linkViaRedirect":return uA;case"reauthViaPopup":case"reauthViaRedirect":return lA;default:xe(this.auth,"internal-error")}}resolve(t){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const hA=new er(2e3,1e4);async function dA(n,t,e){if(ae(n.app))return Promise.reject(he(n,"operation-not-supported-in-this-environment"));const i=zo(n);oS(n,t,fl);const s=Up(i,e);return new $n(i,"signInViaPopup",t,s).executeNotNull()}class $n extends zp{constructor(t,e,i,s,r){super(t,e,s,r),this.provider=i,this.authWindow=null,this.pollId=null,$n.currentPopupAction&&$n.currentPopupAction.cancel(),$n.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return j(t,this.auth,"internal-error"),t}async onExecution(){je(this.filter.length===1,"Popup operations only handle one event");const t=gl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(he(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(he(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$n.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(he(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,hA.get())};t()}}$n.currentPopupAction=null;const fA="pendingRedirect",$r=new Map;class gA extends zp{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=$r.get(this.auth._key());if(!t){try{const i=await pA(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}$r.set(this.auth._key(),t)}return this.bypassAuthState||$r.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pA(n,t){const e=yA(t),i=_A(n);if(!await i._isAvailable())return!1;const s=await i._get(e)==="true";return await i._remove(e),s}function mA(n,t){$r.set(n._key(),t)}function _A(n){return Ue(n._redirectPersistence)}function yA(n){return Hr(fA,n.config.apiKey,n.name)}async function bA(n,t,e=!1){if(ae(n.app))return Promise.reject(Xn(n));const i=zo(n),s=Up(i,t),o=await new gA(i,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}const vA=600*1e3;class wA{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!TA(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!Wp(t)){const i=t.error.code?.split("auth/")[1]||"internal-error";e.onError(he(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=vA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hd(t))}saveEventToCache(t){this.cachedEventUids.add(Hd(t)),this.lastProcessedEventTime=Date.now()}}function Hd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Wp({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function TA(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wp(n);default:return!1}}async function EA(n,t={}){return Ui(n,"GET","/v1/projects",t)}const IA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xA=/^https?/;async function SA(n){if(n.config.emulator)return;const{authorizedDomains:t}=await EA(n);for(const e of t)try{if(AA(e))return}catch{}xe(n,"unauthorized-domain")}function AA(n){const t=mc(),{protocol:e,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===i}if(!xA.test(e))return!1;if(IA.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const PA=new er(3e4,6e4);function $d(){const n=ve().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function CA(n){return new Promise((t,e)=>{function i(){$d(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$d(),e(he(n,"network-request-failed"))},timeout:PA.get()})}if(ve().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(ve().gapi?.load)i();else{const s=MS("iframefcb");return ve()[s]=()=>{gapi.load?i():e(he(n,"network-request-failed"))},kS(`${DS()}?onload=${s}`).catch(r=>e(r))}}).catch(t=>{throw qr=null,t})}let qr=null;function RA(n){return qr=qr||CA(n),qr}const kA=new er(5e3,15e3),DA="__/auth/iframe",MA="emulator/auth/iframe",OA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},VA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NA(n){const t=n.config;j(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?cl(t,MA):`https://${n.config.authDomain}/${DA}`,i={apiKey:t.apiKey,appName:n.name,v:Bi},s=VA.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${e}?${tr(i).slice(1)}`}async function LA(n){const t=await RA(n),e=ve().gapi;return j(e,n,"internal-error"),t.open({where:document.body,url:NA(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OA,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=he(n,"network-request-failed"),a=ve().setTimeout(()=>{r(o)},kA.get());function c(){ve().clearTimeout(a),s(i)}i.ping(c).then(c,()=>{r(o)})}))}const FA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},BA=500,UA=600,zA="_blank",WA="http://localhost";class qd{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jA(n,t,e,i=BA,s=UA){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...FA,width:i.toString(),height:s.toString(),top:r,left:o},u=Ht().toLowerCase();e&&(a=Tp(u)?zA:e),vp(u)&&(t=t||WA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(ES(u)&&a!=="_self")return HA(t||"",a),new qd(null);const d=window.open(t||"",a,h);j(d,n,"popup-blocked");try{d.focus()}catch{}return new qd(d)}function HA(n,t){const e=document.createElement("a");e.href=n,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const $A="__/auth/handler",qA="emulator/auth/handler",GA=encodeURIComponent("fac");async function Gd(n,t,e,i,s,r){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:i,v:Bi,eventId:s};if(t instanceof fl){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",HI(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(t instanceof nr){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await n._getAppCheckToken(),u=c?`#${GA}=${encodeURIComponent(c)}`:"";return`${YA(n)}?${tr(a).slice(1)}${u}`}function YA({config:n}){return n.emulator?cl(n,qA):`https://${n.authDomain}/${$A}`}const Ga="webStorageSupport";class KA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Vp,this._completeRedirectFn=bA,this._overrideRedirectResult=mA}async _openPopup(t,e,i,s){je(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const r=await Gd(t,e,i,mc(),s);return jA(t,r,gl())}async _openRedirect(t,e,i,s){await this._originValidation(t);const r=await Gd(t,e,i,mc(),s);return JS(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:r}=this.eventManagers[e];return s?Promise.resolve(s):(je(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await LA(t),i=new wA(t);return e.register("authEvent",s=>(j(s?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ga,{type:Ga},s=>{const r=s?.[0]?.[Ga];r!==void 0&&e(!!r),xe(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=SA(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Ap()||wp()||hl()}}const XA=KA;var Yd="@firebase/auth",Kd="1.11.1";class QA{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function JA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZA(n){Ri(new ei("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;j(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pp(n)},u=new CS(i,s,r,c);return VS(u,e),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),Ri(new ei("auth-internal",t=>{const e=zo(t.getProvider("auth").getImmediate());return(i=>new QA(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),_n(Yd,Kd,JA(n)),_n(Yd,Kd,"esm2020")}const tP=300,eP=sp("authIdTokenMaxAge")||tP;let Xd=null;const nP=n=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>eP)return;const s=e?.token;Xd!==s&&(Xd=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function iP(n=up()){const t=rl(n,"auth");if(t.isInitialized())return t.getImmediate();const e=OS(n,{popupRedirectResolver:XA,persistence:[aA,KS,Vp]}),i=sp("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=nP(r.toString());HS(e,o,()=>o(e.currentUser)),jS(e,a=>o(a))}}const s=np("auth");return s&&NS(e,`http://${s}`),e}function sP(){return document.getElementsByTagName("head")?.[0]??document}RS({loadJS(n){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=s=>{const r=he("internal-error");r.customData=s,e(r)},i.type="text/javascript",i.charset="UTF-8",sP().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZA("Browser");var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var yn,jp;(function(){var n;function t(E,b){function T(){}T.prototype=b.prototype,E.F=b.prototype,E.prototype=new T,E.prototype.constructor=E,E.D=function(x,S,A){for(var I=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)I[nt-2]=arguments[nt];return b.prototype[S].apply(x,I)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,e),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,b,T){T||(T=0);const x=Array(16);if(typeof b=="string")for(var S=0;S<16;++S)x[S]=b.charCodeAt(T++)|b.charCodeAt(T++)<<8|b.charCodeAt(T++)<<16|b.charCodeAt(T++)<<24;else for(S=0;S<16;++S)x[S]=b[T++]|b[T++]<<8|b[T++]<<16|b[T++]<<24;b=E.g[0],T=E.g[1],S=E.g[2];let A=E.g[3],I;I=b+(A^T&(S^A))+x[0]+3614090360&4294967295,b=T+(I<<7&4294967295|I>>>25),I=A+(S^b&(T^S))+x[1]+3905402710&4294967295,A=b+(I<<12&4294967295|I>>>20),I=S+(T^A&(b^T))+x[2]+606105819&4294967295,S=A+(I<<17&4294967295|I>>>15),I=T+(b^S&(A^b))+x[3]+3250441966&4294967295,T=S+(I<<22&4294967295|I>>>10),I=b+(A^T&(S^A))+x[4]+4118548399&4294967295,b=T+(I<<7&4294967295|I>>>25),I=A+(S^b&(T^S))+x[5]+1200080426&4294967295,A=b+(I<<12&4294967295|I>>>20),I=S+(T^A&(b^T))+x[6]+2821735955&4294967295,S=A+(I<<17&4294967295|I>>>15),I=T+(b^S&(A^b))+x[7]+4249261313&4294967295,T=S+(I<<22&4294967295|I>>>10),I=b+(A^T&(S^A))+x[8]+1770035416&4294967295,b=T+(I<<7&4294967295|I>>>25),I=A+(S^b&(T^S))+x[9]+2336552879&4294967295,A=b+(I<<12&4294967295|I>>>20),I=S+(T^A&(b^T))+x[10]+4294925233&4294967295,S=A+(I<<17&4294967295|I>>>15),I=T+(b^S&(A^b))+x[11]+2304563134&4294967295,T=S+(I<<22&4294967295|I>>>10),I=b+(A^T&(S^A))+x[12]+1804603682&4294967295,b=T+(I<<7&4294967295|I>>>25),I=A+(S^b&(T^S))+x[13]+4254626195&4294967295,A=b+(I<<12&4294967295|I>>>20),I=S+(T^A&(b^T))+x[14]+2792965006&4294967295,S=A+(I<<17&4294967295|I>>>15),I=T+(b^S&(A^b))+x[15]+1236535329&4294967295,T=S+(I<<22&4294967295|I>>>10),I=b+(S^A&(T^S))+x[1]+4129170786&4294967295,b=T+(I<<5&4294967295|I>>>27),I=A+(T^S&(b^T))+x[6]+3225465664&4294967295,A=b+(I<<9&4294967295|I>>>23),I=S+(b^T&(A^b))+x[11]+643717713&4294967295,S=A+(I<<14&4294967295|I>>>18),I=T+(A^b&(S^A))+x[0]+3921069994&4294967295,T=S+(I<<20&4294967295|I>>>12),I=b+(S^A&(T^S))+x[5]+3593408605&4294967295,b=T+(I<<5&4294967295|I>>>27),I=A+(T^S&(b^T))+x[10]+38016083&4294967295,A=b+(I<<9&4294967295|I>>>23),I=S+(b^T&(A^b))+x[15]+3634488961&4294967295,S=A+(I<<14&4294967295|I>>>18),I=T+(A^b&(S^A))+x[4]+3889429448&4294967295,T=S+(I<<20&4294967295|I>>>12),I=b+(S^A&(T^S))+x[9]+568446438&4294967295,b=T+(I<<5&4294967295|I>>>27),I=A+(T^S&(b^T))+x[14]+3275163606&4294967295,A=b+(I<<9&4294967295|I>>>23),I=S+(b^T&(A^b))+x[3]+4107603335&4294967295,S=A+(I<<14&4294967295|I>>>18),I=T+(A^b&(S^A))+x[8]+1163531501&4294967295,T=S+(I<<20&4294967295|I>>>12),I=b+(S^A&(T^S))+x[13]+2850285829&4294967295,b=T+(I<<5&4294967295|I>>>27),I=A+(T^S&(b^T))+x[2]+4243563512&4294967295,A=b+(I<<9&4294967295|I>>>23),I=S+(b^T&(A^b))+x[7]+1735328473&4294967295,S=A+(I<<14&4294967295|I>>>18),I=T+(A^b&(S^A))+x[12]+2368359562&4294967295,T=S+(I<<20&4294967295|I>>>12),I=b+(T^S^A)+x[5]+4294588738&4294967295,b=T+(I<<4&4294967295|I>>>28),I=A+(b^T^S)+x[8]+2272392833&4294967295,A=b+(I<<11&4294967295|I>>>21),I=S+(A^b^T)+x[11]+1839030562&4294967295,S=A+(I<<16&4294967295|I>>>16),I=T+(S^A^b)+x[14]+4259657740&4294967295,T=S+(I<<23&4294967295|I>>>9),I=b+(T^S^A)+x[1]+2763975236&4294967295,b=T+(I<<4&4294967295|I>>>28),I=A+(b^T^S)+x[4]+1272893353&4294967295,A=b+(I<<11&4294967295|I>>>21),I=S+(A^b^T)+x[7]+4139469664&4294967295,S=A+(I<<16&4294967295|I>>>16),I=T+(S^A^b)+x[10]+3200236656&4294967295,T=S+(I<<23&4294967295|I>>>9),I=b+(T^S^A)+x[13]+681279174&4294967295,b=T+(I<<4&4294967295|I>>>28),I=A+(b^T^S)+x[0]+3936430074&4294967295,A=b+(I<<11&4294967295|I>>>21),I=S+(A^b^T)+x[3]+3572445317&4294967295,S=A+(I<<16&4294967295|I>>>16),I=T+(S^A^b)+x[6]+76029189&4294967295,T=S+(I<<23&4294967295|I>>>9),I=b+(T^S^A)+x[9]+3654602809&4294967295,b=T+(I<<4&4294967295|I>>>28),I=A+(b^T^S)+x[12]+3873151461&4294967295,A=b+(I<<11&4294967295|I>>>21),I=S+(A^b^T)+x[15]+530742520&4294967295,S=A+(I<<16&4294967295|I>>>16),I=T+(S^A^b)+x[2]+3299628645&4294967295,T=S+(I<<23&4294967295|I>>>9),I=b+(S^(T|~A))+x[0]+4096336452&4294967295,b=T+(I<<6&4294967295|I>>>26),I=A+(T^(b|~S))+x[7]+1126891415&4294967295,A=b+(I<<10&4294967295|I>>>22),I=S+(b^(A|~T))+x[14]+2878612391&4294967295,S=A+(I<<15&4294967295|I>>>17),I=T+(A^(S|~b))+x[5]+4237533241&4294967295,T=S+(I<<21&4294967295|I>>>11),I=b+(S^(T|~A))+x[12]+1700485571&4294967295,b=T+(I<<6&4294967295|I>>>26),I=A+(T^(b|~S))+x[3]+2399980690&4294967295,A=b+(I<<10&4294967295|I>>>22),I=S+(b^(A|~T))+x[10]+4293915773&4294967295,S=A+(I<<15&4294967295|I>>>17),I=T+(A^(S|~b))+x[1]+2240044497&4294967295,T=S+(I<<21&4294967295|I>>>11),I=b+(S^(T|~A))+x[8]+1873313359&4294967295,b=T+(I<<6&4294967295|I>>>26),I=A+(T^(b|~S))+x[15]+4264355552&4294967295,A=b+(I<<10&4294967295|I>>>22),I=S+(b^(A|~T))+x[6]+2734768916&4294967295,S=A+(I<<15&4294967295|I>>>17),I=T+(A^(S|~b))+x[13]+1309151649&4294967295,T=S+(I<<21&4294967295|I>>>11),I=b+(S^(T|~A))+x[4]+4149444226&4294967295,b=T+(I<<6&4294967295|I>>>26),I=A+(T^(b|~S))+x[11]+3174756917&4294967295,A=b+(I<<10&4294967295|I>>>22),I=S+(b^(A|~T))+x[2]+718787259&4294967295,S=A+(I<<15&4294967295|I>>>17),I=T+(A^(S|~b))+x[9]+3951481745&4294967295,E.g[0]=E.g[0]+b&4294967295,E.g[1]=E.g[1]+(S+(I<<21&4294967295|I>>>11))&4294967295,E.g[2]=E.g[2]+S&4294967295,E.g[3]=E.g[3]+A&4294967295}i.prototype.v=function(E,b){b===void 0&&(b=E.length);const T=b-this.blockSize,x=this.C;let S=this.h,A=0;for(;A<b;){if(S==0)for(;A<=T;)s(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<b;)if(x[S++]=E.charCodeAt(A++),S==this.blockSize){s(this,x),S=0;break}}else for(;A<b;)if(x[S++]=E[A++],S==this.blockSize){s(this,x),S=0;break}}this.h=S,this.o+=b},i.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var b=1;b<E.length-8;++b)E[b]=0;b=this.o*8;for(var T=E.length-8;T<E.length;++T)E[T]=b&255,b/=256;for(this.v(E),E=Array(16),b=0,T=0;T<4;++T)for(let x=0;x<32;x+=8)E[b++]=this.g[T]>>>x&255;return E};function r(E,b){var T=a;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=b(E)}function o(E,b){this.h=b;const T=[];let x=!0;for(let S=E.length-1;S>=0;S--){const A=E[S]|0;x&&A==b||(T[S]=A,x=!1)}this.g=T}var a={};function c(E){return-128<=E&&E<128?r(E,function(b){return new o([b|0],b<0?-1:0)}):new o([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return d;if(E<0)return w(u(-E));const b=[];let T=1;for(let x=0;E>=T;x++)b[x]=E/T|0,T*=4294967296;return new o(b,0)}function h(E,b){if(E.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(E.charAt(0)=="-")return w(h(E.substring(1),b));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=u(Math.pow(b,8));let x=d;for(let A=0;A<E.length;A+=8){var S=Math.min(8,E.length-A);const I=parseInt(E.substring(A,A+S),b);S<8?(S=u(Math.pow(b,S)),x=x.j(S).add(u(I))):(x=x.j(T),x=x.add(u(I)))}return x}var d=c(0),g=c(1),m=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let E=0,b=1;for(let T=0;T<this.g.length;T++){const x=this.i(T);E+=(x>=0?x:4294967296+x)*b,b*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(y(this))return"0";if(v(this))return"-"+w(this).toString(E);const b=u(Math.pow(E,6));var T=this;let x="";for(;;){const S=O(T,b).g;T=P(T,S.j(b));let A=((T.g.length>0?T.g[0]:T.h)>>>0).toString(E);if(T=S,y(T))return A+x;for(;A.length<6;)A="0"+A;x=A+x}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function y(E){if(E.h!=0)return!1;for(let b=0;b<E.g.length;b++)if(E.g[b]!=0)return!1;return!0}function v(E){return E.h==-1}n.l=function(E){return E=P(this,E),v(E)?-1:y(E)?0:1};function w(E){const b=E.g.length,T=[];for(let x=0;x<b;x++)T[x]=~E.g[x];return new o(T,~E.h).add(g)}n.abs=function(){return v(this)?w(this):this},n.add=function(E){const b=Math.max(this.g.length,E.g.length),T=[];let x=0;for(let S=0;S<=b;S++){let A=x+(this.i(S)&65535)+(E.i(S)&65535),I=(A>>>16)+(this.i(S)>>>16)+(E.i(S)>>>16);x=I>>>16,A&=65535,I&=65535,T[S]=I<<16|A}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(E,b){return E.add(w(b))}n.j=function(E){if(y(this)||y(E))return d;if(v(this))return v(E)?w(this).j(w(E)):w(w(this).j(E));if(v(E))return w(this.j(w(E)));if(this.l(m)<0&&E.l(m)<0)return u(this.m()*E.m());const b=this.g.length+E.g.length,T=[];for(var x=0;x<2*b;x++)T[x]=0;for(x=0;x<this.g.length;x++)for(let S=0;S<E.g.length;S++){const A=this.i(x)>>>16,I=this.i(x)&65535,nt=E.i(S)>>>16,G=E.i(S)&65535;T[2*x+2*S]+=I*G,C(T,2*x+2*S),T[2*x+2*S+1]+=A*G,C(T,2*x+2*S+1),T[2*x+2*S+1]+=I*nt,C(T,2*x+2*S+1),T[2*x+2*S+2]+=A*nt,C(T,2*x+2*S+2)}for(E=0;E<b;E++)T[E]=T[2*E+1]<<16|T[2*E];for(E=b;E<2*b;E++)T[E]=0;return new o(T,0)};function C(E,b){for(;(E[b]&65535)!=E[b];)E[b+1]+=E[b]>>>16,E[b]&=65535,b++}function D(E,b){this.g=E,this.h=b}function O(E,b){if(y(b))throw Error("division by zero");if(y(E))return new D(d,d);if(v(E))return b=O(w(E),b),new D(w(b.g),w(b.h));if(v(b))return b=O(E,w(b)),new D(w(b.g),b.h);if(E.g.length>30){if(v(E)||v(b))throw Error("slowDivide_ only works with positive integers.");for(var T=g,x=b;x.l(E)<=0;)T=M(T),x=M(x);var S=L(T,1),A=L(x,1);for(x=L(x,2),T=L(T,2);!y(x);){var I=A.add(x);I.l(E)<=0&&(S=S.add(T),A=I),x=L(x,1),T=L(T,1)}return b=P(E,S.j(b)),new D(S,b)}for(S=d;E.l(b)>=0;){for(T=Math.max(1,Math.floor(E.m()/b.m())),x=Math.ceil(Math.log(T)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),A=u(T),I=A.j(b);v(I)||I.l(E)>0;)T-=x,A=u(T),I=A.j(b);y(A)&&(A=g),S=S.add(A),E=P(E,I)}return new D(S,E)}n.B=function(E){return O(this,E).h},n.and=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)&E.i(x);return new o(T,this.h&E.h)},n.or=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)|E.i(x);return new o(T,this.h|E.h)},n.xor=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)^E.i(x);return new o(T,this.h^E.h)};function M(E){const b=E.g.length+1,T=[];for(let x=0;x<b;x++)T[x]=E.i(x)<<1|E.i(x-1)>>>31;return new o(T,E.h)}function L(E,b){const T=b>>5;b%=32;const x=E.g.length-T,S=[];for(let A=0;A<x;A++)S[A]=b>0?E.i(A+T)>>>b|E.i(A+T+1)<<32-b:E.i(A+T);return new o(S,E.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,jp=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,yn=o}).apply(typeof Qd<"u"?Qd:typeof self<"u"?self:typeof window<"u"?window:{});var Nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Hp,_s,$p,Gr,bc,qp,Gp,Yp;(function(){var n,t=Object.defineProperty;function e(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nr=="object"&&Nr];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var i=e(this);function s(l,f){if(f)t:{var p=i;l=l.split(".");for(var _=0;_<l.length-1;_++){var R=l[_];if(!(R in p))break t;p=p[R]}l=l[l.length-1],_=p[l],f=f(_),f!=_&&f!=null&&t(p,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});var r=r||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,p){return l.call.apply(l.bind,arguments)}function u(l,f,p){return u=c,u.apply(null,arguments)}function h(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function d(l,f){function p(){}p.prototype=f.prototype,l.Z=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(_,R,k){for(var F=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)F[Y-2]=arguments[Y];return f.prototype[R].apply(_,F)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function m(l){const f=l.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=l[_];return p}return[]}function y(l,f){for(let _=1;_<arguments.length;_++){const R=arguments[_];var p=typeof R;if(p=p!="object"?p:R?Array.isArray(R)?"array":p:"null",p=="array"||p=="object"&&typeof R.length=="number"){p=l.length||0;const k=R.length||0;l.length=p+k;for(let F=0;F<k;F++)l[p+F]=R[F]}else l.push(R)}}class v{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function w(l){o.setTimeout(()=>{throw l},0)}function P(){var l=E;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class C{constructor(){this.h=this.g=null}add(f,p){const _=D.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var D=new v(()=>new O,l=>l.reset());class O{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let M,L=!1,E=new C,b=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(T)}};function T(){for(var l;l=P();){try{l.h.call(l.g)}catch(p){w(p)}var f=D;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}L=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function S(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}S.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return l})();function I(l){return/^[\s\xa0]*$/.test(l)}function nt(l,f){S.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}d(nt,S),nt.prototype.init=function(l,f){const p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&nt.Z.h.call(this)},nt.prototype.h=function(){nt.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var G="closure_listenable_"+(Math.random()*1e6|0),it=0;function gt(l,f,p,_,R){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=R,this.key=++it,this.da=this.fa=!1}function Vt(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function bt(l,f,p){for(const _ in l)f.call(p,l[_],_,l)}function Ye(l,f){for(const p in l)f.call(void 0,l[p],p,l)}function kn(l){const f={};for(const p in l)f[p]=l[p];return f}const Pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ke(l,f){let p,_;for(let R=1;R<arguments.length;R++){_=arguments[R];for(p in _)l[p]=_[p];for(let k=0;k<Pe.length;k++)p=Pe[k],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function Zt(l){this.src=l,this.g={},this.h=0}Zt.prototype.add=function(l,f,p,_,R){const k=l.toString();l=this.g[k],l||(l=this.g[k]=[],this.h++);const F=oe(l,f,_,R);return F>-1?(f=l[F],p||(f.fa=!1)):(f=new gt(f,this.src,k,!!_,R),f.fa=p,l.push(f)),f};function Ce(l,f){const p=f.type;if(p in l.g){var _=l.g[p],R=Array.prototype.indexOf.call(_,f,void 0),k;(k=R>=0)&&Array.prototype.splice.call(_,R,1),k&&(Vt(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function oe(l,f,p,_){for(let R=0;R<l.length;++R){const k=l[R];if(!k.da&&k.listener==f&&k.capture==!!p&&k.ha==_)return R}return-1}var ia="closure_lm_"+(Math.random()*1e6|0),sa={};function Gl(l,f,p,_,R){if(Array.isArray(f)){for(let k=0;k<f.length;k++)Gl(l,f[k],p,_,R);return null}return p=Xl(p),l&&l[G]?l.J(f,p,a(_)?!!_.capture:!1,R):w_(l,f,p,!1,_,R)}function w_(l,f,p,_,R,k){if(!f)throw Error("Invalid event type");const F=a(R)?!!R.capture:!!R;let Y=oa(l);if(Y||(l[ia]=Y=new Zt(l)),p=Y.add(f,p,_,F,k),p.proxy)return p;if(_=T_(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)A||(R=F),R===void 0&&(R=!1),l.addEventListener(f.toString(),_,R);else if(l.attachEvent)l.attachEvent(Kl(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function T_(){function l(p){return f.call(l.src,l.listener,p)}const f=E_;return l}function Yl(l,f,p,_,R){if(Array.isArray(f))for(var k=0;k<f.length;k++)Yl(l,f[k],p,_,R);else _=a(_)?!!_.capture:!!_,p=Xl(p),l&&l[G]?(l=l.i,k=String(f).toString(),k in l.g&&(f=l.g[k],p=oe(f,p,_,R),p>-1&&(Vt(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete l.g[k],l.h--)))):l&&(l=oa(l))&&(f=l.g[f.toString()],l=-1,f&&(l=oe(f,p,_,R)),(p=l>-1?f[l]:null)&&ra(p))}function ra(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[G])Ce(f.i,l);else{var p=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(p,_,l.capture):f.detachEvent?f.detachEvent(Kl(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=oa(f))?(Ce(p,l),p.h==0&&(p.src=null,f[ia]=null)):Vt(l)}}}function Kl(l){return l in sa?sa[l]:sa[l]="on"+l}function E_(l,f){if(l.da)l=!0;else{f=new nt(f,this);const p=l.listener,_=l.ha||l.src;l.fa&&ra(l),l=p.call(_,f)}return l}function oa(l){return l=l[ia],l instanceof Zt?l:null}var aa="__closure_events_fn_"+(Math.random()*1e9>>>0);function Xl(l){return typeof l=="function"?l:(l[aa]||(l[aa]=function(f){return l.handleEvent(f)}),l[aa])}function Nt(){x.call(this),this.i=new Zt(this),this.M=this,this.G=null}d(Nt,x),Nt.prototype[G]=!0,Nt.prototype.removeEventListener=function(l,f,p,_){Yl(this,l,f,p,_)};function $t(l,f){var p,_=l.G;if(_)for(p=[];_;_=_.G)p.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new S(f,l);else if(f instanceof S)f.target=f.target||l;else{var R=f;f=new S(_,l),Ke(f,R)}R=!0;let k,F;if(p)for(F=p.length-1;F>=0;F--)k=f.g=p[F],R=lr(k,_,!0,f)&&R;if(k=f.g=l,R=lr(k,_,!0,f)&&R,R=lr(k,_,!1,f)&&R,p)for(F=0;F<p.length;F++)k=f.g=p[F],R=lr(k,_,!1,f)&&R}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const p=l.g[f];for(let _=0;_<p.length;_++)Vt(p[_]);delete l.g[f],l.h--}}this.G=null},Nt.prototype.J=function(l,f,p,_){return this.i.add(String(l),f,!1,p,_)},Nt.prototype.K=function(l,f,p,_){return this.i.add(String(l),f,!0,p,_)};function lr(l,f,p,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let R=!0;for(let k=0;k<f.length;++k){const F=f[k];if(F&&!F.da&&F.capture==p){const Y=F.listener,It=F.ha||F.src;F.fa&&Ce(l.i,F),R=Y.call(It,_)!==!1&&R}}return R&&!_.defaultPrevented}function I_(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function Ql(l){l.g=I_(()=>{l.g=null,l.i&&(l.i=!1,Ql(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class x_ extends x{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ql(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $i(l){x.call(this),this.h=l,this.g={}}d($i,x);var Jl=[];function Zl(l){bt(l.g,function(f,p){this.g.hasOwnProperty(p)&&ra(f)},l),l.g={}}$i.prototype.N=function(){$i.Z.N.call(this),Zl(this)},$i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ca=o.JSON.stringify,S_=o.JSON.parse,A_=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function tu(){}function eu(){}var qi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function la(){S.call(this,"d")}d(la,S);function ua(){S.call(this,"c")}d(ua,S);var Dn={},nu=null;function ur(){return nu=nu||new Nt}Dn.Ia="serverreachability";function iu(l){S.call(this,Dn.Ia,l)}d(iu,S);function Gi(l){const f=ur();$t(f,new iu(f))}Dn.STAT_EVENT="statevent";function su(l,f){S.call(this,Dn.STAT_EVENT,l),this.stat=f}d(su,S);function qt(l){const f=ur();$t(f,new su(f,l))}Dn.Ja="timingevent";function ru(l,f){S.call(this,Dn.Ja,l),this.size=f}d(ru,S);function Yi(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function Ki(){this.g=!0}Ki.prototype.ua=function(){this.g=!1};function P_(l,f,p,_,R,k){l.info(function(){if(l.g)if(k){var F="",Y=k.split("&");for(let at=0;at<Y.length;at++){var It=Y[at].split("=");if(It.length>1){const Pt=It[0];It=It[1];const fe=Pt.split("_");F=fe.length>=2&&fe[1]=="type"?F+(Pt+"="+It+"&"):F+(Pt+"=redacted&")}}}else F=null;else F=k;return"XMLHTTP REQ ("+_+") [attempt "+R+"]: "+f+`
`+p+`
`+F})}function C_(l,f,p,_,R,k,F){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+R+"]: "+f+`
`+p+`
`+k+" "+F})}function ui(l,f,p,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+k_(l,p)+(_?" "+_:"")})}function R_(l,f){l.info(function(){return"TIMEOUT: "+f})}Ki.prototype.info=function(){};function k_(l,f){if(!l.g)return f;if(!f)return null;try{const k=JSON.parse(f);if(k){for(l=0;l<k.length;l++)if(Array.isArray(k[l])){var p=k[l];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var R=_[0];if(R!="noop"&&R!="stop"&&R!="close")for(let F=1;F<_.length;F++)_[F]=""}}}}return ca(k)}catch{return f}}var hr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ou={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},au;function ha(){}d(ha,tu),ha.prototype.g=function(){return new XMLHttpRequest},au=new ha;function Xi(l){return encodeURIComponent(String(l))}function D_(l){var f=1;l=l.split(":");const p=[];for(;f>0&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function Xe(l,f,p,_){this.j=l,this.i=f,this.l=p,this.S=_||1,this.V=new $i(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cu}function cu(){this.i=null,this.g="",this.h=!1}var lu={},da={};function fa(l,f,p){l.M=1,l.A=fr(de(f)),l.u=p,l.R=!0,uu(l,null)}function uu(l,f){l.F=Date.now(),dr(l),l.B=de(l.A);var p=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),Eu(p.i,"t",_),l.C=0,p=l.j.L,l.h=new cu,l.g=zu(l.j,p?f:null,!l.u),l.P>0&&(l.O=new x_(u(l.Y,l,l.g),l.P)),f=l.V,p=l.g,_=l.ba;var R="readystatechange";Array.isArray(R)||(R&&(Jl[0]=R.toString()),R=Jl);for(let k=0;k<R.length;k++){const F=Gl(p,R[k],_||f.handleEvent,!1,f.h||f);if(!F)break;f.g[F.key]=F}f=l.J?kn(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),Gi(),P_(l.i,l.v,l.B,l.l,l.S,l.u)}Xe.prototype.ba=function(l){l=l.target;const f=this.O;f&&Ze(l)==3?f.j():this.Y(l)},Xe.prototype.Y=function(l){try{if(l==this.g)t:{const Y=Ze(this.g),It=this.g.ya(),at=this.g.ca();if(!(Y<3)&&(Y!=3||this.g&&(this.h.h||this.g.la()||Ru(this.g)))){this.K||Y!=4||It==7||(It==8||at<=0?Gi(3):Gi(2)),ga(this);var f=this.g.ca();this.X=f;var p=M_(this);if(this.o=f==200,C_(this.i,this.v,this.B,this.l,this.S,Y,f),this.o){if(this.U&&!this.L){e:{if(this.g){var _,R=this.g;if((_=R.g?R.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(_)){var k=_;break e}}k=null}if(l=k)ui(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,pa(this,l);else{this.o=!1,this.m=3,qt(12),Mn(this),Qi(this);break t}}if(this.R){l=!0;let Pt;for(;!this.K&&this.C<p.length;)if(Pt=O_(this,p),Pt==da){Y==4&&(this.m=4,qt(14),l=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(Pt==lu){this.m=4,qt(15),ui(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else ui(this.i,this.l,Pt,null),pa(this,Pt);if(hu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Y!=4||p.length!=0||this.h.h||(this.m=1,qt(16),l=!1),this.o=this.o&&l,!l)ui(this.i,this.l,p,"[Invalid Chunked Response]"),Mn(this),Qi(this);else if(p.length>0&&!this.W){this.W=!0;var F=this.j;F.g==this&&F.aa&&!F.P&&(F.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Ea(F),F.P=!0,qt(11))}}else ui(this.i,this.l,p,null),pa(this,p);Y==4&&Mn(this),this.o&&!this.K&&(Y==4?Lu(this.j,this):(this.o=!1,dr(this)))}else Y_(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),Mn(this),Qi(this)}}}catch{}finally{}};function M_(l){if(!hu(l))return l.g.la();const f=Ru(l.g);if(f==="")return"";let p="";const _=f.length,R=Ze(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Mn(l),Qi(l),"";l.h.i=new o.TextDecoder}for(let k=0;k<_;k++)l.h.h=!0,p+=l.h.i.decode(f[k],{stream:!(R&&k==_-1)});return f.length=0,l.h.g+=p,l.C=0,l.h.g}function hu(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function O_(l,f){var p=l.C,_=f.indexOf(`
`,p);return _==-1?da:(p=Number(f.substring(p,_)),isNaN(p)?lu:(_+=1,_+p>f.length?da:(f=f.slice(_,_+p),l.C=_+p,f)))}Xe.prototype.cancel=function(){this.K=!0,Mn(this)};function dr(l){l.T=Date.now()+l.H,du(l,l.H)}function du(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Yi(u(l.aa,l),f)}function ga(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Xe.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(R_(this.i,this.B),this.M!=2&&(Gi(),qt(17)),Mn(this),this.m=2,Qi(this)):du(this,this.T-l)};function Qi(l){l.j.I==0||l.K||Lu(l.j,l)}function Mn(l){ga(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Zl(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function pa(l,f){try{var p=l.j;if(p.I!=0&&(p.g==l||ma(p.h,l))){if(!l.L&&ma(p.h,l)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var R=_;if(R[0]==0){t:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)yr(p),mr(p);else break t;Ta(p),qt(18)}}else p.xa=R[1],0<p.xa-p.K&&R[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Yi(u(p.Va,p),6e3));pu(p.h)<=1&&p.ta&&(p.ta=void 0)}else Vn(p,11)}else if((l.L||p.g==l)&&yr(p),!I(f))for(R=p.Ba.g.parse(f),f=0;f<R.length;f++){let at=R[f];const Pt=at[0];if(!(Pt<=p.K))if(p.K=Pt,at=at[1],p.I==2)if(at[0]=="c"){p.M=at[1],p.ba=at[2];const fe=at[3];fe!=null&&(p.ka=fe,p.j.info("VER="+p.ka));const Nn=at[4];Nn!=null&&(p.za=Nn,p.j.info("SVER="+p.za));const tn=at[5];tn!=null&&typeof tn=="number"&&tn>0&&(_=1.5*tn,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const en=l.g;if(en){const vr=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vr){var k=_.h;k.g||vr.indexOf("spdy")==-1&&vr.indexOf("quic")==-1&&vr.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(_a(k,k.h),k.h=null))}if(_.G){const Ia=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;Ia&&(_.wa=Ia,lt(_.J,_.G,Ia))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var F=l;if(_.na=Uu(_,_.L?_.ba:null,_.W),F.L){mu(_.h,F);var Y=F,It=_.O;It&&(Y.H=It),Y.D&&(ga(Y),dr(Y)),_.g=F}else Vu(_);p.i.length>0&&_r(p)}else at[0]!="stop"&&at[0]!="close"||Vn(p,7);else p.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?Vn(p,7):wa(p):at[0]!="noop"&&p.l&&p.l.qa(at),p.A=0)}}Gi(4)}catch{}}var V_=class{constructor(l,f){this.g=l,this.map=f}};function fu(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function gu(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function pu(l){return l.h?1:l.g?l.g.size:0}function ma(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function _a(l,f){l.g?l.g.add(f):l.h=f}function mu(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}fu.prototype.cancel=function(){if(this.i=_u(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function _u(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const p of l.g.values())f=f.concat(p.G);return f}return m(l.i)}var yu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function N_(l,f){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const _=l[p].indexOf("=");let R,k=null;_>=0?(R=l[p].substring(0,_),k=l[p].substring(_+1)):R=l[p],f(R,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function Qe(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Qe?(this.l=l.l,Ji(this,l.j),this.o=l.o,this.g=l.g,Zi(this,l.u),this.h=l.h,ya(this,Iu(l.i)),this.m=l.m):l&&(f=String(l).match(yu))?(this.l=!1,Ji(this,f[1]||"",!0),this.o=ts(f[2]||""),this.g=ts(f[3]||"",!0),Zi(this,f[4]),this.h=ts(f[5]||"",!0),ya(this,f[6]||"",!0),this.m=ts(f[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Qe.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(es(f,bu,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(es(f,bu,!0),"@"),l.push(Xi(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(es(p,p.charAt(0)=="/"?B_:F_,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",es(p,z_)),l.join("")},Qe.prototype.resolve=function(l){const f=de(this);let p=!!l.j;p?Ji(f,l.j):p=!!l.o,p?f.o=l.o:p=!!l.g,p?f.g=l.g:p=l.u!=null;var _=l.h;if(p)Zi(f,l.u);else if(p=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var R=f.h.lastIndexOf("/");R!=-1&&(_=f.h.slice(0,R+1)+_)}if(R=_,R==".."||R==".")_="";else if(R.indexOf("./")!=-1||R.indexOf("/.")!=-1){_=R.lastIndexOf("/",0)==0,R=R.split("/");const k=[];for(let F=0;F<R.length;){const Y=R[F++];Y=="."?_&&F==R.length&&k.push(""):Y==".."?((k.length>1||k.length==1&&k[0]!="")&&k.pop(),_&&F==R.length&&k.push("")):(k.push(Y),_=!0)}_=k.join("/")}else _=R}return p?f.h=_:p=l.i.toString()!=="",p?ya(f,Iu(l.i)):p=!!l.m,p&&(f.m=l.m),f};function de(l){return new Qe(l)}function Ji(l,f,p){l.j=p?ts(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Zi(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function ya(l,f,p){f instanceof ns?(l.i=f,W_(l.i,l.l)):(p||(f=es(f,U_)),l.i=new ns(f,l.l))}function lt(l,f,p){l.i.set(f,p)}function fr(l){return lt(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ts(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function es(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,L_),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function L_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var bu=/[#\/\?@]/g,F_=/[#\?:]/g,B_=/[#\?]/g,U_=/[#\?@]/g,z_=/#/g;function ns(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function On(l){l.g||(l.g=new Map,l.h=0,l.i&&N_(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=ns.prototype,n.add=function(l,f){On(this),this.i=null,l=hi(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function vu(l,f){On(l),f=hi(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function wu(l,f){return On(l),f=hi(l,f),l.g.has(f)}n.forEach=function(l,f){On(this),this.g.forEach(function(p,_){p.forEach(function(R){l.call(f,R,_,this)},this)},this)};function Tu(l,f){On(l);let p=[];if(typeof f=="string")wu(l,f)&&(p=p.concat(l.g.get(hi(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)p=p.concat(l[f]);return p}n.set=function(l,f){return On(this),this.i=null,l=hi(this,l),wu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=Tu(this,l),l.length>0?String(l[0]):f):f};function Eu(l,f,p){vu(l,f),p.length>0&&(l.i=null,l.g.set(hi(l,f),m(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const R=Xi(p);p=Tu(this,p);for(let k=0;k<p.length;k++){let F=R;p[k]!==""&&(F+="="+Xi(p[k])),l.push(F)}}return this.i=l.join("&")};function Iu(l){const f=new ns;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function hi(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function W_(l,f){f&&!l.j&&(On(l),l.i=null,l.g.forEach(function(p,_){const R=_.toLowerCase();_!=R&&(vu(this,_),Eu(this,R,p))},l)),l.j=f}function j_(l,f){const p=new Ki;if(o.Image){const _=new Image;_.onload=h(Je,p,"TestLoadImage: loaded",!0,f,_),_.onerror=h(Je,p,"TestLoadImage: error",!1,f,_),_.onabort=h(Je,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=h(Je,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function H_(l,f){const p=new Ki,_=new AbortController,R=setTimeout(()=>{_.abort(),Je(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(k=>{clearTimeout(R),k.ok?Je(p,"TestPingServer: ok",!0,f):Je(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(R),Je(p,"TestPingServer: error",!1,f)})}function Je(l,f,p,_,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),_(p)}catch{}}function $_(){this.g=new A_}function ba(l){this.i=l.Sb||null,this.h=l.ab||!1}d(ba,tu),ba.prototype.g=function(){return new gr(this.i,this.h)};function gr(l,f){Nt.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(gr,Nt),n=gr.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,ss(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,is(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ss(this)),this.g&&(this.readyState=3,ss(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xu(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function xu(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?is(this):ss(this),this.readyState==3&&xu(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,is(this))},n.Na=function(l){this.g&&(this.response=l,is(this))},n.ga=function(){this.g&&is(this)};function is(l){l.readyState=4,l.l=null,l.j=null,l.B=null,ss(l)}n.setRequestHeader=function(l,f){this.A.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function ss(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(gr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Su(l){let f="";return bt(l,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function va(l,f,p){t:{for(_ in p){var _=!1;break t}_=!0}_||(p=Su(p),typeof l=="string"?p!=null&&Xi(p):lt(l,f,p))}function _t(l){Nt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(_t,Nt);var q_=/^https?$/i,G_=["POST","PUT"];n=_t.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():au.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(k){Au(this,k);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var R in _)p.set(R,_[R]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const k of _.keys())p.set(k,_.get(k));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(k=>k.toLowerCase()=="content-type"),R=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(G_,f,void 0)>=0)||_||R||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,F]of p)this.g.setRequestHeader(k,F);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(k){Au(this,k)}};function Au(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Pu(l),pr(l)}function Pu(l){l.A||(l.A=!0,$t(l,"complete"),$t(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,$t(this,"complete"),$t(this,"abort"),pr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pr(this,!0)),_t.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Cu(this):this.Xa())},n.Xa=function(){Cu(this)};function Cu(l){if(l.h&&typeof r<"u"){if(l.v&&Ze(l)==4)setTimeout(l.Ca.bind(l),0);else if($t(l,"readystatechange"),Ze(l)==4){l.h=!1;try{const k=l.ca();t:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var p;if(!(p=f)){var _;if(_=k===0){let F=String(l.D).match(yu)[1]||null;!F&&o.self&&o.self.location&&(F=o.self.location.protocol.slice(0,-1)),_=!q_.test(F?F.toLowerCase():"")}p=_}if(p)$t(l,"complete"),$t(l,"success");else{l.o=6;try{var R=Ze(l)>2?l.g.statusText:""}catch{R=""}l.l=R+" ["+l.ca()+"]",Pu(l)}}finally{pr(l)}}}}function pr(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,f||$t(l,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ze(l){return l.g?l.g.readyState:0}n.ca=function(){try{return Ze(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),S_(f)}};function Ru(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Y_(l){const f={};l=(l.g&&Ze(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(I(l[_]))continue;var p=D_(l[_]);const R=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const k=f[R]||[];f[R]=k,k.push(p)}Ye(f,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function rs(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function ku(l){this.za=0,this.i=[],this.j=new Ki,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=rs("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=rs("baseRetryDelayMs",5e3,l),this.Za=rs("retryDelaySeedMs",1e4,l),this.Ta=rs("forwardChannelMaxRetries",2,l),this.va=rs("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new fu(l&&l.concurrentRequestLimit),this.Ba=new $_,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ku.prototype,n.ka=8,n.I=1,n.connect=function(l,f,p,_){qt(0),this.W=l,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=Uu(this,null,this.W),_r(this)};function wa(l){if(Du(l),l.I==3){var f=l.V++,p=de(l.J);if(lt(p,"SID",l.M),lt(p,"RID",f),lt(p,"TYPE","terminate"),os(l,p),f=new Xe(l,l.j,f),f.M=2,f.A=fr(de(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=zu(f.j,null),f.g.ea(f.A)),f.F=Date.now(),dr(f)}Bu(l)}function mr(l){l.g&&(Ea(l),l.g.cancel(),l.g=null)}function Du(l){mr(l),l.v&&(o.clearTimeout(l.v),l.v=null),yr(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function _r(l){if(!gu(l.h)&&!l.m){l.m=!0;var f=l.Ea;M||b(),L||(M(),L=!0),E.add(f,l),l.D=0}}function K_(l,f){return pu(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Yi(u(l.Ea,l,f),Fu(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const R=new Xe(this,this.j,l);let k=this.o;if(this.U&&(k?(k=kn(k),Ke(k,this.U)):k=this.U),this.u!==null||this.R||(R.J=k,k=null),this.S)t:{for(var f=0,p=0;p<this.i.length;p++){e:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break e}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break t}if(f===4096||p===this.i.length-1){f=p+1;break t}}f=1e3}else f=1e3;f=Ou(this,R,f),p=de(this.J),lt(p,"RID",l),lt(p,"CVER",22),this.G&&lt(p,"X-HTTP-Session-Id",this.G),os(this,p),k&&(this.R?f="headers="+Xi(Su(k))+"&"+f:this.u&&va(p,this.u,k)),_a(this.h,R),this.Ra&&lt(p,"TYPE","init"),this.S?(lt(p,"$req",f),lt(p,"SID","null"),R.U=!0,fa(R,p,null)):fa(R,p,f),this.I=2}}else this.I==3&&(l?Mu(this,l):this.i.length==0||gu(this.h)||Mu(this))};function Mu(l,f){var p;f?p=f.l:p=l.V++;const _=de(l.J);lt(_,"SID",l.M),lt(_,"RID",p),lt(_,"AID",l.K),os(l,_),l.u&&l.o&&va(_,l.u,l.o),p=new Xe(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Ou(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),_a(l.h,p),fa(p,_,f)}function os(l,f){l.H&&bt(l.H,function(p,_){lt(f,_,p)}),l.l&&bt({},function(p,_){lt(f,_,p)})}function Ou(l,f,p){p=Math.min(l.i.length,p);const _=l.l?u(l.l.Ka,l.l,l):null;t:{var R=l.i;let Y=-1;for(;;){const It=["count="+p];Y==-1?p>0?(Y=R[0].g,It.push("ofs="+Y)):Y=0:It.push("ofs="+Y);let at=!0;for(let Pt=0;Pt<p;Pt++){var k=R[Pt].g;const fe=R[Pt].map;if(k-=Y,k<0)Y=Math.max(0,R[Pt].g-100),at=!1;else try{k="req"+k+"_"||"";try{var F=fe instanceof Map?fe:Object.entries(fe);for(const[Nn,tn]of F){let en=tn;a(tn)&&(en=ca(tn)),It.push(k+Nn+"="+encodeURIComponent(en))}}catch(Nn){throw It.push(k+"type="+encodeURIComponent("_badmap")),Nn}}catch{_&&_(fe)}}if(at){F=It.join("&");break t}}F=void 0}return l=l.i.splice(0,p),f.G=l,F}function Vu(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;M||b(),L||(M(),L=!0),E.add(f,l),l.A=0}}function Ta(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Yi(u(l.Da,l),Fu(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,Nu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Yi(u(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),mr(this),Nu(this))};function Ea(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Nu(l){l.g=new Xe(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=de(l.na);lt(f,"RID","rpc"),lt(f,"SID",l.M),lt(f,"AID",l.K),lt(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&lt(f,"TO",l.ia),lt(f,"TYPE","xmlhttp"),os(l,f),l.u&&l.o&&va(f,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=fr(de(f)),p.u=null,p.R=!0,uu(p,l)}n.Va=function(){this.C!=null&&(this.C=null,mr(this),Ta(this),qt(19))};function yr(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Lu(l,f){var p=null;if(l.g==f){yr(l),Ea(l),l.g=null;var _=2}else if(ma(l.h,f))p=f.G,mu(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var R=l.D;_=ur(),$t(_,new ru(_,p)),_r(l)}else Vu(l);else if(R=f.m,R==3||R==0&&f.X>0||!(_==1&&K_(l,f)||_==2&&Ta(l)))switch(p&&p.length>0&&(f=l.h,f.i=f.i.concat(p)),R){case 1:Vn(l,5);break;case 4:Vn(l,10);break;case 3:Vn(l,6);break;default:Vn(l,2)}}}function Fu(l,f){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*f}function Vn(l,f){if(l.j.info("Error code "+f),f==2){var p=u(l.bb,l),_=l.Ua;const R=!_;_=new Qe(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ji(_,"https"),fr(_),R?j_(_.toString(),p):H_(_.toString(),p)}else qt(2);l.I=0,l.l&&l.l.pa(f),Bu(l),Du(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function Bu(l){if(l.I=0,l.ja=[],l.l){const f=_u(l.h);(f.length!=0||l.i.length!=0)&&(y(l.ja,f),y(l.ja,l.i),l.h.i.length=0,m(l.i),l.i.length=0),l.l.oa()}}function Uu(l,f,p){var _=p instanceof Qe?de(p):new Qe(p);if(_.g!="")f&&(_.g=f+"."+_.g),Zi(_,_.u);else{var R=o.location;_=R.protocol,f=f?f+"."+R.hostname:R.hostname,R=+R.port;const k=new Qe(null);_&&Ji(k,_),f&&(k.g=f),R&&Zi(k,R),p&&(k.h=p),_=k}return p=l.G,f=l.wa,p&&f&&lt(_,p,f),lt(_,"VER",l.ka),os(l,_),_}function zu(l,f,p){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new _t(new ba({ab:p})):new _t(l.ma),f.Fa(l.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wu(){}n=Wu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function br(){}br.prototype.g=function(l,f){return new Qt(l,f)};function Qt(l,f){Nt.call(this),this.g=new ku(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!I(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!I(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new di(this)}d(Qt,Nt),Qt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){wa(this.g)},Qt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=ca(l),l=p);f.i.push(new V_(f.Ya++,l)),f.I==3&&_r(f)},Qt.prototype.N=function(){this.g.l=null,delete this.j,wa(this.g),delete this.g,Qt.Z.N.call(this)};function ju(l){la.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){t:{for(const p in f){l=p;break t}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}d(ju,la);function Hu(){ua.call(this),this.status=1}d(Hu,ua);function di(l){this.g=l}d(di,Wu),di.prototype.ra=function(){$t(this.g,"a")},di.prototype.qa=function(l){$t(this.g,new ju(l))},di.prototype.pa=function(l){$t(this.g,new Hu)},di.prototype.oa=function(){$t(this.g,"b")},br.prototype.createWebChannel=br.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,Yp=function(){return new br},Gp=function(){return ur()},qp=Dn,bc={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},hr.NO_ERROR=0,hr.TIMEOUT=8,hr.HTTP_ERROR=6,Gr=hr,ou.COMPLETE="complete",$p=ou,eu.EventType=qi,qi.OPEN="a",qi.CLOSE="b",qi.ERROR="c",qi.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,_s=eu,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,Hp=_t}).apply(typeof Nr<"u"?Nr:typeof self<"u"?self:typeof window<"u"?window:{});const Jd="@firebase/firestore",Zd="4.9.2";class Bt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");let zi="12.3.0";const ii=new il("@firebase/firestore");function mi(){return ii.logLevel}function B(n,...t){if(ii.logLevel<=X.DEBUG){const e=t.map(ml);ii.debug(`Firestore (${zi}): ${n}`,...e)}}function He(n,...t){if(ii.logLevel<=X.ERROR){const e=t.map(ml);ii.error(`Firestore (${zi}): ${n}`,...e)}}function Di(n,...t){if(ii.logLevel<=X.WARN){const e=t.map(ml);ii.warn(`Firestore (${zi}): ${n}`,...e)}}function ml(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function W(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,Kp(n,i,e)}function Kp(n,t,e){let i=`FIRESTORE (${zi}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw He(i),new Error(i)}function st(n,t,e,i){let s="Unexpected state";typeof e=="string"?s=e:i=e,n||Kp(t,s,i)}function q(n,t){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends Ge{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class bn{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Xp{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class rP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Bt.UNAUTHENTICATED)))}shutdown(){}}class oP{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class aP{constructor(t){this.t=t,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){st(this.o===void 0,42304);let i=this.i;const s=c=>this.i!==i?(i=this.i,e(c)):Promise.resolve();let r=new bn;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new bn,t.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const c=r;t.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new bn)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((i=>this.i!==t?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(st(typeof i.accessToken=="string",31837,{l:i}),new Xp(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return st(t===null||typeof t=="string",2055,{h:t}),new Bt(t)}}class cP{constructor(t,e,i){this.P=t,this.T=e,this.I=i,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class lP{constructor(t,e,i){this.P=t,this.T=e,this.I=i}getToken(){return Promise.resolve(new cP(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Bt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uP{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ae(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){st(this.o===void 0,3512);const i=r=>{r.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable((()=>i(r)))};const s=r=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(st(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new tf(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function hP(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class _l{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=hP(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<e&&(i+=t.charAt(s[r]%62))}return i}}function Q(n,t){return n<t?-1:n>t?1:0}function vc(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++){const s=n.charAt(i),r=t.charAt(i);if(s!==r)return Ya(s)===Ya(r)?Q(s,r):Ya(s)?1:-1}return Q(n.length,t.length)}const dP=55296,fP=57343;function Ya(n){const t=n.charCodeAt(0);return t>=dP&&t<=fP}function Mi(n,t,e){return n.length===t.length&&n.every(((i,s)=>e(i,t[s])))}const ef="__name__";class me{constructor(t,e,i){e===void 0?e=0:e>t.length&&W(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&W(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return me.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof me?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let s=0;s<i;s++){const r=me.compareSegments(t.get(s),e.get(s));if(r!==0)return r}return Q(t.length,e.length)}static compareSegments(t,e){const i=me.isNumericId(t),s=me.isNumericId(e);return i&&!s?-1:!i&&s?1:i&&s?me.extractNumericId(t).compare(me.extractNumericId(e)):vc(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return yn.fromString(t.substring(4,t.length-2))}}class pt extends me{construct(t,e,i){return new pt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new U(N.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((s=>s.length>0)))}return new pt(e)}static emptyPath(){return new pt([])}}const gP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mt extends me{construct(t,e,i){return new Mt(t,e,i)}static isValidIdentifier(t){return gP.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mt.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ef}static keyField(){return new Mt([ef])}static fromServerFormat(t){const e=[];let i="",s=0;const r=()=>{if(i.length===0)throw new U(N.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new U(N.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new U(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new U(N.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Mt(e)}static emptyPath(){return new Mt([])}}class z{constructor(t){this.path=t}static fromPath(t){return new z(pt.fromString(t))}static fromName(t){return new z(pt.fromString(t).popFirst(5))}static empty(){return new z(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&pt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return pt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new z(new pt(t.slice()))}}function pP(n,t,e){if(!e)throw new U(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function mP(n,t,e,i){if(t===!0&&i===!0)throw new U(N.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function nf(n){if(!z.isDocumentKey(n))throw new U(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Qp(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function yl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":W(12329,{type:typeof n})}function js(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new U(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=yl(n);throw new U(N.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function Et(n,t){const e={typeString:n};return t&&(e.value=t),e}function sr(n,t){if(!Qp(n))throw new U(N.INVALID_ARGUMENT,"JSON must be an object");let e;for(const i in t)if(t[i]){const s=t[i].typeString,r="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const o=n[i];if(s&&typeof o!==s){e=`JSON field '${i}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){e=`Expected '${i}' field to equal '${r.value}'`;break}}if(e)throw new U(N.INVALID_ARGUMENT,e);return!0}const sf=-62135596800,rf=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(t){return ut.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*rf);return new ut(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<sf)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rf}_compareTo(t){return this.seconds===t.seconds?Q(this.nanoseconds,t.nanoseconds):Q(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(sr(t,ut._jsonSchema))return new ut(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-sf;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Et("string",ut._jsonSchemaVersion),seconds:Et("number"),nanoseconds:Et("number")};class H{static fromTimestamp(t){return new H(t)}static min(){return new H(new ut(0,0))}static max(){return new H(new ut(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Hs=-1;function _P(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=H.fromTimestamp(i===1e9?new ut(e+1,0):new ut(e,i));return new En(s,z.empty(),t)}function yP(n){return new En(n.readTime,n.key,Hs)}class En{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new En(H.min(),z.empty(),Hs)}static max(){return new En(H.max(),z.empty(),Hs)}}function bP(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=z.comparator(n.documentKey,t.documentKey),e!==0?e:Q(n.largestBatchId,t.largestBatchId))}const vP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Wi(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==vP)throw n;B("LocalStore","Unexpectedly lost primary lease")}class V{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&W(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new V(((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(e,r).next(i,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof V?e:V.resolve(e)}catch(e){return V.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):V.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):V.reject(e)}static resolve(t){return new V(((e,i)=>{e(t)}))}static reject(t){return new V(((e,i)=>{i(t)}))}static waitFor(t){return new V(((e,i)=>{let s=0,r=0,o=!1;t.forEach((a=>{++s,a.next((()=>{++r,o&&r===s&&e()}),(c=>i(c)))})),o=!0,r===s&&e()}))}static or(t){let e=V.resolve(!1);for(const i of t)e=e.next((s=>s?V.resolve(s):i()));return e}static forEach(t,e){const i=[];return t.forEach(((s,r)=>{i.push(e.call(this,s,r))})),this.waitFor(i)}static mapArray(t,e){return new V(((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let c=0;c<r;c++){const u=c;e(t[u]).next((h=>{o[u]=h,++a,a===r&&i(o)}),(h=>s(h)))}}))}static doWhile(t,e){return new V(((i,s)=>{const r=()=>{t()===!0?e().next((()=>{r()}),s):i()};r()}))}}function TP(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function ji(n){return n.name==="IndexedDbTransactionError"}class Ho{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>e.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Ho.ce=-1;const bl=-1;function $o(n){return n==null}function yo(n){return n===0&&1/n==-1/0}function EP(n){return typeof n=="number"&&Number.isInteger(n)&&!yo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Jp="";function IP(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=of(t)),t=xP(n.get(e),t);return of(t)}function xP(n,t){let e=t;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":e+="";break;case Jp:e+="";break;default:e+=r}}return e}function of(n){return n+Jp+""}function af(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function oi(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Zp(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class mt{constructor(t,e){this.comparator=t,this.root=e||Dt.EMPTY}insert(t,e){return new mt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Dt.BLACK,null,null))}remove(t){return new mt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Dt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return e+i.left.size;s<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Lr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Lr(this.root,t,this.comparator,!1)}getReverseIterator(){return new Lr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Lr(this.root,t,this.comparator,!0)}}class Lr{constructor(t,e,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?i(t.key,e):1,e&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Dt{constructor(t,e,i,s,r){this.key=t,this.value=e,this.color=i??Dt.RED,this.left=s??Dt.EMPTY,this.right=r??Dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,s,r){return new Dt(t??this.key,e??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,e,i),null):r===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Dt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return Dt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw W(43730,{key:this.key,value:this.value});if(this.right.isRed())throw W(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw W(27949);return t+(this.isRed()?0:1)}}Dt.EMPTY=null,Dt.RED=!0,Dt.BLACK=!1;Dt.EMPTY=new class{constructor(){this.size=0}get key(){throw W(57766)}get value(){throw W(16141)}get color(){throw W(16727)}get left(){throw W(29726)}get right(){throw W(36894)}copy(t,e,i,s,r){return this}insert(t,e,i){return new Dt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class At{constructor(t){this.comparator=t,this.data=new mt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new cf(this.data.getIterator())}getIteratorFrom(t){return new cf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof At)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new At(this.comparator);return e.data=t,e}}class cf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ue{constructor(t){this.fields=t,t.sort(Mt.comparator)}static empty(){return new ue([])}unionWith(t){let e=new At(Mt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new ue(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Mi(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class tm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ot{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new tm("Invalid base64 string: "+r):r}})(t);return new Ot(e)}static fromUint8Array(t){const e=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(t);return new Ot(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Q(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const SP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function In(n){if(st(!!n,39018),typeof n=="string"){let t=0;const e=SP.exec(n);if(st(!!e,46558,{timestamp:n}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xn(n){return typeof n=="string"?Ot.fromBase64String(n):Ot.fromUint8Array(n)}const em="server_timestamp",nm="__type__",im="__previous_value__",sm="__local_write_time__";function vl(n){return(n?.mapValue?.fields||{})[nm]?.stringValue===em}function qo(n){const t=n.mapValue.fields[im];return vl(t)?qo(t):t}function $s(n){const t=In(n.mapValue.fields[sm].timestampValue);return new ut(t.seconds,t.nanos)}class AP{constructor(t,e,i,s,r,o,a,c,u,h){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const bo="(default)";class qs{constructor(t,e){this.projectId=t,this.database=e||bo}static empty(){return new qs("","")}get isDefaultDatabase(){return this.database===bo}isEqual(t){return t instanceof qs&&t.projectId===this.projectId&&t.database===this.database}}const rm="__type__",PP="__max__",Fr={mapValue:{}},om="__vector__",vo="value";function Sn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vl(n)?4:RP(n)?9007199254740991:CP(n)?10:11:W(28295,{value:n})}function Se(n,t){if(n===t)return!0;const e=Sn(n);if(e!==Sn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return $s(n).isEqual($s(t));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=In(s.timestampValue),a=In(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(s,r){return xn(s.bytesValue).isEqual(xn(r.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(s,r){return vt(s.geoPointValue.latitude)===vt(r.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(r.geoPointValue.longitude)})(n,t);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return vt(s.integerValue)===vt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=vt(s.doubleValue),a=vt(r.doubleValue);return o===a?yo(o)===yo(a):isNaN(o)&&isNaN(a)}return!1})(n,t);case 9:return Mi(n.arrayValue.values||[],t.arrayValue.values||[],Se);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(af(o)!==af(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Se(o[c],a[c])))return!1;return!0})(n,t);default:return W(52216,{left:n})}}function Gs(n,t){return(n.values||[]).find((e=>Se(e,t)))!==void 0}function Oi(n,t){if(n===t)return 0;const e=Sn(n),i=Sn(t);if(e!==i)return Q(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return Q(n.booleanValue,t.booleanValue);case 2:return(function(r,o){const a=vt(r.integerValue||r.doubleValue),c=vt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,t);case 3:return lf(n.timestampValue,t.timestampValue);case 4:return lf($s(n),$s(t));case 5:return vc(n.stringValue,t.stringValue);case 6:return(function(r,o){const a=xn(r),c=xn(o);return a.compareTo(c)})(n.bytesValue,t.bytesValue);case 7:return(function(r,o){const a=r.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const h=Q(a[u],c[u]);if(h!==0)return h}return Q(a.length,c.length)})(n.referenceValue,t.referenceValue);case 8:return(function(r,o){const a=Q(vt(r.latitude),vt(o.latitude));return a!==0?a:Q(vt(r.longitude),vt(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return uf(n.arrayValue,t.arrayValue);case 10:return(function(r,o){const a=r.fields||{},c=o.fields||{},u=a[vo]?.arrayValue,h=c[vo]?.arrayValue,d=Q(u?.values?.length||0,h?.values?.length||0);return d!==0?d:uf(u,h)})(n.mapValue,t.mapValue);case 11:return(function(r,o){if(r===Fr.mapValue&&o===Fr.mapValue)return 0;if(r===Fr.mapValue)return 1;if(o===Fr.mapValue)return-1;const a=r.fields||{},c=Object.keys(a),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const g=vc(c[d],h[d]);if(g!==0)return g;const m=Oi(a[c[d]],u[h[d]]);if(m!==0)return m}return Q(c.length,h.length)})(n.mapValue,t.mapValue);default:throw W(23264,{he:e})}}function lf(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Q(n,t);const e=In(n),i=In(t),s=Q(e.seconds,i.seconds);return s!==0?s:Q(e.nanos,i.nanos)}function uf(n,t){const e=n.values||[],i=t.values||[];for(let s=0;s<e.length&&s<i.length;++s){const r=Oi(e[s],i[s]);if(r)return r}return Q(e.length,i.length)}function Vi(n){return wc(n)}function wc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const i=In(e);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return xn(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return z.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let i="[",s=!0;for(const r of e.values||[])s?s=!1:i+=",",i+=wc(r);return i+"]"})(n.arrayValue):"mapValue"in n?(function(e){const i=Object.keys(e.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${wc(e.fields[o])}`;return s+"}"})(n.mapValue):W(61005,{value:n})}function Yr(n){switch(Sn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=qo(n);return t?16+Yr(t):16;case 5:return 2*n.stringValue.length;case 6:return xn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,r)=>s+Yr(r)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return oi(i.fields,((r,o)=>{s+=r.length+Yr(o)})),s})(n.mapValue);default:throw W(13486,{value:n})}}function Tc(n){return!!n&&"integerValue"in n}function wl(n){return!!n&&"arrayValue"in n}function hf(n){return!!n&&"nullValue"in n}function df(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Kr(n){return!!n&&"mapValue"in n}function CP(n){return(n?.mapValue?.fields||{})[rm]?.stringValue===om}function Ps(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return oi(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=Ps(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Ps(n.arrayValue.values[e]);return t}return{...n}}function RP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===PP}class ee{constructor(t){this.value=t}static empty(){return new ee({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Kr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ps(e)}setAll(t){let e=Mt.emptyPath(),i={},s=[];t.forEach(((o,a)=>{if(!e.isImmediateParentOf(a)){const c=this.getFieldsMap(e);this.applyChanges(c,i,s),i={},s=[],e=a.popLast()}o?i[a.lastSegment()]=Ps(o):s.push(a.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,i,s)}delete(t){const e=this.field(t.popLast());Kr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Se(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=e.mapValue.fields[t.get(i)];Kr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,i){oi(e,((s,r)=>t[s]=r));for(const s of i)delete t[s]}clone(){return new ee(Ps(this.value))}}function am(n){const t=[];return oi(n.fields,((e,i)=>{const s=new Mt([e]);if(Kr(i)){const r=am(i.mapValue).fields;if(r.length===0)t.push(s);else for(const o of r)t.push(s.child(o))}else t.push(s)})),new ue(t)}class zt{constructor(t,e,i,s,r,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new zt(t,0,H.min(),H.min(),H.min(),ee.empty(),0)}static newFoundDocument(t,e,i,s){return new zt(t,1,e,H.min(),i,s,0)}static newNoDocument(t,e){return new zt(t,2,e,H.min(),H.min(),ee.empty(),0)}static newUnknownDocument(t,e){return new zt(t,3,e,H.min(),H.min(),ee.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ee.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ee.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof zt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class wo{constructor(t,e){this.position=t,this.inclusive=e}}function ff(n,t,e){let i=0;for(let s=0;s<n.position.length;s++){const r=t[s],o=n.position[s];if(r.field.isKeyField()?i=z.comparator(z.fromName(o.referenceValue),e.key):i=Oi(o,e.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function gf(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Se(n.position[e],t.position[e]))return!1;return!0}class To{constructor(t,e="asc"){this.field=t,this.dir=e}}function kP(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class cm{}class xt extends cm{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new MP(t,e,i):e==="array-contains"?new NP(t,i):e==="in"?new LP(t,i):e==="not-in"?new FP(t,i):e==="array-contains-any"?new BP(t,i):new xt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new OP(t,i):new VP(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Oi(e,this.value)):e!==null&&Sn(this.value)===Sn(e)&&this.matchesComparison(Oi(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return W(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ae extends cm{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Ae(t,e)}matches(t){return lm(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function lm(n){return n.op==="and"}function um(n){return DP(n)&&lm(n)}function DP(n){for(const t of n.filters)if(t instanceof Ae)return!1;return!0}function Ec(n){if(n instanceof xt)return n.field.canonicalString()+n.op.toString()+Vi(n.value);if(um(n))return n.filters.map((t=>Ec(t))).join(",");{const t=n.filters.map((e=>Ec(e))).join(",");return`${n.op}(${t})`}}function hm(n,t){return n instanceof xt?(function(i,s){return s instanceof xt&&i.op===s.op&&i.field.isEqual(s.field)&&Se(i.value,s.value)})(n,t):n instanceof Ae?(function(i,s){return s instanceof Ae&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((r,o,a)=>r&&hm(o,s.filters[a])),!0):!1})(n,t):void W(19439)}function dm(n){return n instanceof xt?(function(e){return`${e.field.canonicalString()} ${e.op} ${Vi(e.value)}`})(n):n instanceof Ae?(function(e){return e.op.toString()+" {"+e.getFilters().map(dm).join(" ,")+"}"})(n):"Filter"}class MP extends xt{constructor(t,e,i){super(t,e,i),this.key=z.fromName(i.referenceValue)}matches(t){const e=z.comparator(t.key,this.key);return this.matchesComparison(e)}}class OP extends xt{constructor(t,e){super(t,"in",e),this.keys=fm("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class VP extends xt{constructor(t,e){super(t,"not-in",e),this.keys=fm("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function fm(n,t){return(t.arrayValue?.values||[]).map((e=>z.fromName(e.referenceValue)))}class NP extends xt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return wl(e)&&Gs(e.arrayValue,this.value)}}class LP extends xt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Gs(this.value.arrayValue,e)}}class FP extends xt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Gs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Gs(this.value.arrayValue,e)}}class BP extends xt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!wl(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>Gs(this.value.arrayValue,i)))}}class UP{constructor(t,e=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function pf(n,t=null,e=[],i=[],s=null,r=null,o=null){return new UP(n,t,e,i,s,r,o)}function Tl(n){const t=q(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((i=>Ec(i))).join(","),e+="|ob:",e+=t.orderBy.map((i=>(function(r){return r.field.canonicalString()+r.dir})(i))).join(","),$o(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((i=>Vi(i))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((i=>Vi(i))).join(",")),t.Te=e}return t.Te}function El(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!kP(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!hm(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!gf(n.startAt,t.startAt)&&gf(n.endAt,t.endAt)}function Ic(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Go{constructor(t,e=null,i=[],s=[],r=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zP(n,t,e,i,s,r,o,a){return new Go(n,t,e,i,s,r,o,a)}function Il(n){return new Go(n)}function mf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function WP(n){return n.collectionGroup!==null}function Cs(n){const t=q(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new At(Mt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(a=a.add(u.field))}))})),a})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new To(r,i))})),e.has(Mt.keyField().canonicalString())||t.Ie.push(new To(Mt.keyField(),i))}return t.Ie}function we(n){const t=q(n);return t.Ee||(t.Ee=jP(t,Cs(n))),t.Ee}function jP(n,t){if(n.limitType==="F")return pf(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new To(s.field,r)}));const e=n.endAt?new wo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new wo(n.startAt.position,n.startAt.inclusive):null;return pf(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function xc(n,t,e){return new Go(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Yo(n,t){return El(we(n),we(t))&&n.limitType===t.limitType}function gm(n){return`${Tl(we(n))}|lt:${n.limitType}`}function _i(n){return`Query(target=${(function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map((s=>dm(s))).join(", ")}]`),$o(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((s=>Vi(s))).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((s=>Vi(s))).join(",")),`Target(${i})`})(we(n))}; limitType=${n.limitType})`}function Ko(n,t){return t.isFoundDocument()&&(function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):z.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)})(n,t)&&(function(i,s){for(const r of Cs(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(n,t)&&(function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0})(n,t)&&(function(i,s){return!(i.startAt&&!(function(o,a,c){const u=ff(o,a,c);return o.inclusive?u<=0:u<0})(i.startAt,Cs(i),s)||i.endAt&&!(function(o,a,c){const u=ff(o,a,c);return o.inclusive?u>=0:u>0})(i.endAt,Cs(i),s))})(n,t)}function HP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pm(n){return(t,e)=>{let i=!1;for(const s of Cs(n)){const r=$P(s,t,e);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function $P(n,t,e){const i=n.field.isKeyField()?z.comparator(t.key,e.key):(function(r,o,a){const c=o.data.field(r),u=a.data.field(r);return c!==null&&u!==null?Oi(c,u):W(42886)})(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return W(19790,{direction:n.dir})}}class ai{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[e]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){oi(this.inner,((e,i)=>{for(const[s,r]of i)t(s,r)}))}isEmpty(){return Zp(this.inner)}size(){return this.innerSize}}const qP=new mt(z.comparator);function $e(){return qP}const mm=new mt(z.comparator);function ys(...n){let t=mm;for(const e of n)t=t.insert(e.key,e);return t}function _m(n){let t=mm;return n.forEach(((e,i)=>t=t.insert(e,i.overlayedDocument))),t}function qn(){return Rs()}function ym(){return Rs()}function Rs(){return new ai((n=>n.toString()),((n,t)=>n.isEqual(t)))}const GP=new mt(z.comparator),YP=new At(z.comparator);function J(...n){let t=YP;for(const e of n)t=t.add(e);return t}const KP=new At(Q);function XP(){return KP}function xl(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yo(t)?"-0":t}}function bm(n){return{integerValue:""+n}}function QP(n,t){return EP(t)?bm(t):xl(n,t)}class Xo{constructor(){this._=void 0}}function JP(n,t,e){return n instanceof Eo?(function(s,r){const o={fields:{[nm]:{stringValue:em},[sm]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&vl(r)&&(r=qo(r)),r&&(o.fields[im]=r),{mapValue:o}})(e,t):n instanceof Ys?wm(n,t):n instanceof Ks?Tm(n,t):(function(s,r){const o=vm(s,r),a=_f(o)+_f(s.Ae);return Tc(o)&&Tc(s.Ae)?bm(a):xl(s.serializer,a)})(n,t)}function ZP(n,t,e){return n instanceof Ys?wm(n,t):n instanceof Ks?Tm(n,t):e}function vm(n,t){return n instanceof Io?(function(i){return Tc(i)||(function(r){return!!r&&"doubleValue"in r})(i)})(t)?t:{integerValue:0}:null}class Eo extends Xo{}class Ys extends Xo{constructor(t){super(),this.elements=t}}function wm(n,t){const e=Em(t);for(const i of n.elements)e.some((s=>Se(s,i)))||e.push(i);return{arrayValue:{values:e}}}class Ks extends Xo{constructor(t){super(),this.elements=t}}function Tm(n,t){let e=Em(t);for(const i of n.elements)e=e.filter((s=>!Se(s,i)));return{arrayValue:{values:e}}}class Io extends Xo{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function _f(n){return vt(n.integerValue||n.doubleValue)}function Em(n){return wl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function tC(n,t){return n.field.isEqual(t.field)&&(function(i,s){return i instanceof Ys&&s instanceof Ys||i instanceof Ks&&s instanceof Ks?Mi(i.elements,s.elements,Se):i instanceof Io&&s instanceof Io?Se(i.Ae,s.Ae):i instanceof Eo&&s instanceof Eo})(n.transform,t.transform)}class eC{constructor(t,e){this.version=t,this.transformResults=e}}class ze{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ze}static exists(t){return new ze(void 0,t)}static updateTime(t){return new ze(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Xr(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Qo{}function Im(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Sm(n.key,ze.none()):new rr(n.key,n.data,ze.none());{const e=n.data,i=ee.empty();let s=new At(Mt.comparator);for(let r of t.fields)if(!s.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new ci(n.key,i,new ue(s.toArray()),ze.none())}}function nC(n,t,e){n instanceof rr?(function(s,r,o){const a=s.value.clone(),c=bf(s.fieldTransforms,r,o.transformResults);a.setAll(c),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,t,e):n instanceof ci?(function(s,r,o){if(!Xr(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=bf(s.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(xm(s)),c.setAll(a),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,t,e):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function ks(n,t,e,i){return n instanceof rr?(function(r,o,a,c){if(!Xr(r.precondition,o))return a;const u=r.value.clone(),h=vf(r.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(n,t,e,i):n instanceof ci?(function(r,o,a,c){if(!Xr(r.precondition,o))return a;const u=vf(r.fieldTransforms,c,o),h=o.data;return h.setAll(xm(r)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((d=>d.field)))})(n,t,e,i):(function(r,o,a){return Xr(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,t,e)}function iC(n,t){let e=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),r=vm(i.transform,s||null);r!=null&&(e===null&&(e=ee.empty()),e.set(i.field,r))}return e||null}function yf(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Mi(i,s,((r,o)=>tC(r,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class rr extends Qo{constructor(t,e,i,s=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ci extends Qo{constructor(t,e,i,s,r=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function xm(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}})),t}function bf(n,t,e){const i=new Map;st(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let s=0;s<e.length;s++){const r=n[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,ZP(o,a,e[s]))}return i}function vf(n,t,e){const i=new Map;for(const s of n){const r=s.transform,o=e.data.field(s.field);i.set(s.field,JP(r,o,t))}return i}class Sm extends Qo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sC extends Qo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class rC{constructor(t,e,i,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&nC(r,t,i[s])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=ks(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=ks(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=ym();return this.mutations.forEach((s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(s.key)?null:a;const c=Im(o,a);c!==null&&i.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(H.min())})),i}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),J())}isEqual(t){return this.batchId===t.batchId&&Mi(this.mutations,t.mutations,((e,i)=>yf(e,i)))&&Mi(this.baseMutations,t.baseMutations,((e,i)=>yf(e,i)))}}class Sl{constructor(t,e,i,s){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=s}static from(t,e,i){st(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let s=(function(){return GP})();const r=t.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new Sl(t,e,i,s)}}class oC{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class aC{constructor(t,e){this.count=t,this.unchangedNames=e}}var Tt,tt;function cC(n){switch(n){case N.OK:return W(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return W(15467,{code:n})}}function Am(n){if(n===void 0)return He("GRPC error has no .code"),N.UNKNOWN;switch(n){case Tt.OK:return N.OK;case Tt.CANCELLED:return N.CANCELLED;case Tt.UNKNOWN:return N.UNKNOWN;case Tt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Tt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Tt.INTERNAL:return N.INTERNAL;case Tt.UNAVAILABLE:return N.UNAVAILABLE;case Tt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Tt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Tt.NOT_FOUND:return N.NOT_FOUND;case Tt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Tt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Tt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Tt.ABORTED:return N.ABORTED;case Tt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Tt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Tt.DATA_LOSS:return N.DATA_LOSS;default:return W(39323,{code:n})}}(tt=Tt||(Tt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";function lC(){return new TextEncoder}const uC=new yn([4294967295,4294967295],0);function wf(n){const t=lC().encode(n),e=new jp;return e.update(t),new Uint8Array(e.digest())}function Tf(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new yn([e,i],0),new yn([s,r],0)]}class Al{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new bs(`Invalid padding: ${e}`);if(i<0)throw new bs(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new bs(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new bs(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=yn.fromNumber(this.ge)}ye(t,e,i){let s=t.add(e.multiply(yn.fromNumber(i)));return s.compare(uC)===1&&(s=new yn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=wf(t),[i,s]=Tf(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);if(!this.we(o))return!1}return!0}static create(t,e,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new Al(r,s,e);return i.forEach((a=>o.insert(a))),o}insert(t){if(this.ge===0)return;const e=wf(t),[i,s]=Tf(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class bs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Jo{constructor(t,e,i,s,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const s=new Map;return s.set(t,or.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new Jo(H.min(),s,new mt(Q),$e(),J())}}class or{constructor(t,e,i,s,r){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new or(i,e,J(),J(),J())}}class Qr{constructor(t,e,i,s){this.be=t,this.removedTargetIds=e,this.key=i,this.De=s}}class Pm{constructor(t,e){this.targetId=t,this.Ce=e}}class Cm{constructor(t,e,i=Ot.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=s}}class Ef{constructor(){this.ve=0,this.Fe=If(),this.Me=Ot.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=J(),e=J(),i=J();return this.Fe.forEach(((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:i=i.add(s);break;default:W(38017,{changeType:r})}})),new or(this.Me,this.xe,t,e,i)}qe(){this.Oe=!1,this.Fe=If()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,st(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class hC{constructor(t){this.Ge=t,this.ze=new Map,this.je=$e(),this.Je=Br(),this.He=Br(),this.Ye=new mt(Q)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const i=this.nt(e);switch(t.state){case 0:this.rt(e)&&i.Le(t.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(t.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(i.We(),i.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),i.Le(t.resumeToken));break;default:W(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((i,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,i=t.Ce.count,s=this.ot(e);if(s){const r=s.target;if(Ic(r))if(i===0){const o=new z(r.path);this.et(e,o,zt.newNoDocument(o,H.min()))}else st(i===1,20013,{expectedCount:i});else{const o=this._t(e);if(o!==i){const a=this.ut(t),c=a?this.ct(a,t,o):1;if(c!==0){this.it(e);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,u)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=e;let o,a;try{o=xn(i).toUint8Array()}catch(c){if(c instanceof tm)return Di("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Al(o,s,r)}catch(c){return Di(c instanceof bs?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(t,e,i){return e.Ce.count===i-this.Pt(t,e.targetId)?0:2}Pt(t,e){const i=this.Ge.getRemoteKeysForTarget(e);let s=0;return i.forEach((r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.et(e,r,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((r,o)=>{const a=this.ot(o);if(a){if(r.current&&Ic(a.target)){const c=new z(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,zt.newNoDocument(c,t))}r.Be&&(e.set(o,r.ke()),r.qe())}}));let i=J();this.He.forEach(((r,o)=>{let a=!0;o.forEachWhile((c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(t)));const s=new Jo(t,e,this.Ye,this.je,i);return this.je=$e(),this.Je=Br(),this.He=Br(),this.Ye=new mt(Q),s}Xe(t,e){if(!this.rt(t))return;const i=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,i),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,i){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),i&&(this.je=this.je.insert(e,i))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Ef,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new At(Q),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new At(Q),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||B("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Ef),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function Br(){return new mt(z.comparator)}function If(){return new mt(z.comparator)}const dC={asc:"ASCENDING",desc:"DESCENDING"},fC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gC={and:"AND",or:"OR"};class pC{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Sc(n,t){return n.useProto3Json||$o(t)?t:{value:t}}function xo(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Rm(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function mC(n,t){return xo(n,t.toTimestamp())}function Te(n){return st(!!n,49232),H.fromTimestamp((function(e){const i=In(e);return new ut(i.seconds,i.nanos)})(n))}function Pl(n,t){return Ac(n,t).canonicalString()}function Ac(n,t){const e=(function(s){return new pt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return t===void 0?e:e.child(t)}function km(n){const t=pt.fromString(n);return st(Nm(t),10190,{key:t.toString()}),t}function Pc(n,t){return Pl(n.databaseId,t.path)}function Ka(n,t){const e=km(t);if(e.get(1)!==n.databaseId.projectId)throw new U(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new U(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new z(Mm(e))}function Dm(n,t){return Pl(n.databaseId,t)}function _C(n){const t=km(n);return t.length===4?pt.emptyPath():Mm(t)}function Cc(n){return new pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Mm(n){return st(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function xf(n,t,e){return{name:Pc(n,t),fields:e.value.mapValue.fields}}function yC(n,t){let e;if("targetChange"in t){t.targetChange;const i=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:W(39313,{state:u})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=(function(u,h){return u.useProto3Json?(st(h===void 0||typeof h=="string",58123),Ot.fromBase64String(h||"")):(st(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ot.fromUint8Array(h||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&(function(u){const h=u.code===void 0?N.UNKNOWN:Am(u.code);return new U(h,u.message||"")})(o);e=new Cm(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=Ka(n,i.document.name),r=Te(i.document.updateTime),o=i.document.createTime?Te(i.document.createTime):H.min(),a=new ee({mapValue:{fields:i.document.fields}}),c=zt.newFoundDocument(s,r,o,a),u=i.targetIds||[],h=i.removedTargetIds||[];e=new Qr(u,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=Ka(n,i.document),r=i.readTime?Te(i.readTime):H.min(),o=zt.newNoDocument(s,r),a=i.removedTargetIds||[];e=new Qr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=Ka(n,i.document),r=i.removedTargetIds||[];e=new Qr([],r,s,null)}else{if(!("filter"in t))return W(11601,{Rt:t});{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new aC(s,r),a=i.targetId;e=new Pm(a,o)}}return e}function bC(n,t){let e;if(t instanceof rr)e={update:xf(n,t.key,t.value)};else if(t instanceof Sm)e={delete:Pc(n,t.key)};else if(t instanceof ci)e={update:xf(n,t.key,t.data),updateMask:PC(t.fieldMask)};else{if(!(t instanceof sC))return W(16599,{Vt:t.type});e={verify:Pc(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(r,o){const a=o.transform;if(a instanceof Eo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ys)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ks)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Io)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw W(20930,{transform:o.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:mC(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:W(27497)})(n,t.precondition)),e}function vC(n,t){return n&&n.length>0?(st(t!==void 0,14353),n.map((e=>(function(s,r){let o=s.updateTime?Te(s.updateTime):Te(r);return o.isEqual(H.min())&&(o=Te(r)),new eC(o,s.transformResults||[])})(e,t)))):[]}function wC(n,t){return{documents:[Dm(n,t.path)]}}function TC(n,t){const e={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=Dm(n,s);const r=(function(u){if(u.length!==0)return Vm(Ae.create(u,"and"))})(t.filters);r&&(e.structuredQuery.where=r);const o=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:yi(g.field),direction:xC(g.dir)}})(h)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=Sc(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(t.endAt)),{ft:e,parent:s}}function EC(n){let t=_C(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let s=null;if(i>0){st(i===1,65062);const h=e.from[0];h.allDescendants?s=h.collectionId:t=t.child(h.collectionId)}let r=[];e.where&&(r=(function(d){const g=Om(d);return g instanceof Ae&&um(g)?g.getFilters():[g]})(e.where));let o=[];e.orderBy&&(o=(function(d){return d.map((g=>(function(y){return new To(bi(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(g)))})(e.orderBy));let a=null;e.limit&&(a=(function(d){let g;return g=typeof d=="object"?d.value:d,$o(g)?null:g})(e.limit));let c=null;e.startAt&&(c=(function(d){const g=!!d.before,m=d.values||[];return new wo(m,g)})(e.startAt));let u=null;return e.endAt&&(u=(function(d){const g=!d.before,m=d.values||[];return new wo(m,g)})(e.endAt)),zP(t,s,o,r,a,"F",c,u)}function IC(n,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function Om(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=bi(e.unaryFilter.field);return xt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=bi(e.unaryFilter.field);return xt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=bi(e.unaryFilter.field);return xt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bi(e.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return W(61313);default:return W(60726)}})(n):n.fieldFilter!==void 0?(function(e){return xt.create(bi(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return W(58110);default:return W(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return Ae.create(e.compositeFilter.filters.map((i=>Om(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return W(1026)}})(e.compositeFilter.op))})(n):W(30097,{filter:n})}function xC(n){return dC[n]}function SC(n){return fC[n]}function AC(n){return gC[n]}function yi(n){return{fieldPath:n.canonicalString()}}function bi(n){return Mt.fromServerFormat(n.fieldPath)}function Vm(n){return n instanceof xt?(function(e){if(e.op==="=="){if(df(e.value))return{unaryFilter:{field:yi(e.field),op:"IS_NAN"}};if(hf(e.value))return{unaryFilter:{field:yi(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(df(e.value))return{unaryFilter:{field:yi(e.field),op:"IS_NOT_NAN"}};if(hf(e.value))return{unaryFilter:{field:yi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yi(e.field),op:SC(e.op),value:e.value}}})(n):n instanceof Ae?(function(e){const i=e.getFilters().map((s=>Vm(s)));return i.length===1?i[0]:{compositeFilter:{op:AC(e.op),filters:i}}})(n):W(54877,{filter:n})}function PC(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Nm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class dn{constructor(t,e,i,s,r=H.min(),o=H.min(),a=Ot.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new dn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class CC{constructor(t){this.yt=t}}function RC(n){const t=EC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xc(t,t.limit,"L"):t}class kC{constructor(){this.Cn=new DC}addToCollectionParentIndex(t,e){return this.Cn.add(e),V.resolve()}getCollectionParents(t,e){return V.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return V.resolve()}deleteFieldIndex(t,e){return V.resolve()}deleteAllFieldIndexes(t){return V.resolve()}createTargetIndexes(t,e){return V.resolve()}getDocumentsMatchingTarget(t,e){return V.resolve(null)}getIndexType(t,e){return V.resolve(0)}getFieldIndexes(t,e){return V.resolve([])}getNextCollectionGroupToUpdate(t){return V.resolve(null)}getMinOffset(t,e){return V.resolve(En.min())}getMinOffsetFromCollectionGroup(t,e){return V.resolve(En.min())}updateCollectionGroup(t,e,i){return V.resolve()}updateIndexEntries(t,e){return V.resolve()}}class DC{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e]||new At(pt.comparator),r=!s.has(i);return this.index[e]=s.add(i),r}has(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e];return s&&s.has(i)}getEntries(t){return(this.index[t]||new At(pt.comparator)).toArray()}}const Sf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Lm=41943040;class Yt{static withCacheSize(t){return new Yt(t,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}}Yt.DEFAULT_COLLECTION_PERCENTILE=10,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yt.DEFAULT=new Yt(Lm,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yt.DISABLED=new Yt(-1,0,0);class Ni{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Ni(0)}static cr(){return new Ni(-1)}}const Af="LruGarbageCollector",MC=1048576;function Pf([n,t],[e,i]){const s=Q(n,e);return s===0?Q(t,i):s}class OC{constructor(t){this.Ir=t,this.buffer=new At(Pf),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();Pf(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class VC{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){B(Af,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ji(e)?B(Af,"Ignoring IndexedDB error during garbage collection: ",e):await Wi(e)}await this.Vr(3e5)}))}}class NC{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((i=>Math.floor(e/100*i)))}nthSequenceNumber(t,e){if(e===0)return V.resolve(Ho.ce);const i=new OC(e);return this.mr.forEachTarget(t,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(t,e,i){return this.mr.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Sf)):this.getCacheSize(t).next((i=>i<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sf):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let i,s,r,o,a,c,u;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(t,s)))).next((d=>(i=d,a=Date.now(),this.removeTargets(t,i,e)))).next((d=>(r=d,c=Date.now(),this.removeOrphanedDocuments(t,i)))).next((d=>(u=Date.now(),mi()<=X.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:d}))))}}function LC(n,t){return new NC(n,t)}class FC{constructor(){this.changes=new ai((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,zt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?V.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class BC{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class UC{constructor(t,e,i,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(i=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(i!==null&&ks(i.mutation,s,ue.empty(),ut.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.getLocalViewOfDocuments(t,i,J()).next((()=>i))))}getLocalViewOfDocuments(t,e,i=J()){const s=qn();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,i).next((r=>{let o=ys();return r.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const i=qn();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,J())))}populateOverlays(t,e,i){const s=[];return i.forEach((r=>{e.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(t,s).next((r=>{r.forEach(((o,a)=>{e.set(o,a)}))}))}computeViews(t,e,i,s){let r=$e();const o=Rs(),a=(function(){return Rs()})();return e.forEach(((c,u)=>{const h=i.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof ci)?r=r.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),ks(h.mutation,u,h.mutation.getFieldMask(),ut.now())):o.set(u.key,ue.empty())})),this.recalculateAndSaveOverlays(t,r).next((c=>(c.forEach(((u,h)=>o.set(u,h))),e.forEach(((u,h)=>a.set(u,new BC(h,o.get(u)??null)))),a)))}recalculateAndSaveOverlays(t,e){const i=Rs();let s=new mt(((o,a)=>o-a)),r=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const a of o)a.keys().forEach((c=>{const u=e.get(c);if(u===null)return;let h=i.get(c)||ue.empty();h=a.applyToLocalView(u,h),i.set(c,h);const d=(s.get(a.batchId)||J()).add(c);s=s.insert(a.batchId,d)}))})).next((()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,d=ym();h.forEach((g=>{if(!r.has(g)){const m=Im(e.get(g),i.get(g));m!==null&&d.set(g,m),r=r.add(g)}})),o.push(this.documentOverlayCache.saveOverlays(t,u,d))}return V.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.recalculateAndSaveOverlays(t,i)))}getDocumentsMatchingQuery(t,e,i,s){return(function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):WP(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,s):this.getDocumentsMatchingCollectionQuery(t,e,i,s)}getNextDocuments(t,e,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,s-r.size):V.resolve(qn());let a=Hs,c=r;return o.next((u=>V.forEach(u,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(h)?V.resolve():this.remoteDocumentCache.getEntry(t,h).next((g=>{c=c.insert(h,g)}))))).next((()=>this.populateOverlays(t,u,r))).next((()=>this.computeViews(t,c,u,J()))).next((h=>({batchId:a,changes:_m(h)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new z(e)).next((i=>{let s=ys();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,i,s){const r=e.collectionGroup;let o=ys();return this.indexManager.getCollectionParents(t,r).next((a=>V.forEach(a,(c=>{const u=(function(d,g){return new Go(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(e,c.child(r));return this.getDocumentsMatchingCollectionQuery(t,u,i,s).next((h=>{h.forEach(((d,g)=>{o=o.insert(d,g)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,r,s)))).next((o=>{r.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,zt.newInvalidDocument(h)))}));let a=ys();return o.forEach(((c,u)=>{const h=r.get(c);h!==void 0&&ks(h.mutation,u,ue.empty(),ut.now()),Ko(e,u)&&(a=a.insert(c,u))})),a}))}}class zC{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return V.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:Te(s.createTime)}})(e)),V.resolve()}getNamedQuery(t,e){return V.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:RC(s.bundledQuery),readTime:Te(s.readTime)}})(e)),V.resolve()}}class WC{constructor(){this.overlays=new mt(z.comparator),this.qr=new Map}getOverlay(t,e){return V.resolve(this.overlays.get(e))}getOverlays(t,e){const i=qn();return V.forEach(e,(s=>this.getOverlay(t,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(t,e,i){return i.forEach(((s,r)=>{this.St(t,e,r)})),V.resolve()}removeOverlaysForBatchId(t,e,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.qr.delete(i)),V.resolve()}getOverlaysForCollection(t,e,i){const s=qn(),r=e.length+1,o=new z(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!e.isPrefixOf(u.path))break;u.path.length===r&&c.largestBatchId>i&&s.set(c.getKey(),c)}return V.resolve(s)}getOverlaysForCollectionGroup(t,e,i,s){let r=new mt(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===e&&u.largestBatchId>i){let h=r.get(u.largestBatchId);h===null&&(h=qn(),r=r.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=qn(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>a.set(u,h))),!(a.size()>=s)););return V.resolve(a)}St(t,e,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new oC(e,i));let r=this.qr.get(e);r===void 0&&(r=J(),this.qr.set(e,r)),this.qr.set(e,r.add(i.key))}}class jC{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(t){return V.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,V.resolve()}}class Cl{constructor(){this.Qr=new At(Ct.$r),this.Ur=new At(Ct.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const i=new Ct(t,e);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(t,e){t.forEach((i=>this.addReference(i,e)))}removeReference(t,e){this.Gr(new Ct(t,e))}zr(t,e){t.forEach((i=>this.removeReference(i,e)))}jr(t){const e=new z(new pt([])),i=new Ct(e,t),s=new Ct(e,t+1),r=[];return this.Ur.forEachInRange([i,s],(o=>{this.Gr(o),r.push(o.key)})),r}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new z(new pt([])),i=new Ct(e,t),s=new Ct(e,t+1);let r=J();return this.Ur.forEachInRange([i,s],(o=>{r=r.add(o.key)})),r}containsKey(t){const e=new Ct(t,0),i=this.Qr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Ct{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return z.comparator(t.key,e.key)||Q(t.Yr,e.Yr)}static Kr(t,e){return Q(t.Yr,e.Yr)||z.comparator(t.key,e.key)}}class HC{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new At(Ct.$r)}checkEmpty(t){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rC(r,e,i,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Ct(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(t,e){return V.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,s=this.ei(i),r=s<0?0:s;return V.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?bl:this.tr-1)}getAllMutationBatches(t){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Ct(e,0),s=new Ct(e,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([i,s],(o=>{const a=this.Xr(o.Yr);r.push(a)})),V.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new At(Q);return e.forEach((s=>{const r=new Ct(s,0),o=new Ct(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],(a=>{i=i.add(a.Yr)}))})),V.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,s=i.length+1;let r=i;z.isDocumentKey(r)||(r=r.child(""));const o=new Ct(new z(r),0);let a=new At(Q);return this.Zr.forEachWhile((c=>{const u=c.key.path;return!!i.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.Yr)),!0)}),o),V.resolve(this.ti(a))}ti(t){const e=[];return t.forEach((i=>{const s=this.Xr(i);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){st(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return V.forEach(e.mutations,(s=>{const r=new Ct(s.key,e.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=i}))}ir(t){}containsKey(t,e){const i=new Ct(e,0),s=this.Zr.firstAfterOrEqual(i);return V.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,V.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class $C{constructor(t){this.ri=t,this.docs=(function(){return new mt(z.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,s=this.docs.get(i),r=s?s.size:0,o=this.ri(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return V.resolve(i?i.document.mutableCopy():zt.newInvalidDocument(e))}getEntries(t,e){let i=$e();return e.forEach((s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():zt.newInvalidDocument(s))})),V.resolve(i)}getDocumentsMatchingQuery(t,e,i,s){let r=$e();const o=e.path,a=new z(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||bP(yP(h),i)<=0||(s.has(h.key)||Ko(e,h))&&(r=r.insert(h.key,h.mutableCopy()))}return V.resolve(r)}getAllFromCollectionGroup(t,e,i,s){W(9500)}ii(t,e){return V.forEach(this.docs,(i=>e(i)))}newChangeBuffer(t){return new qC(this)}getSize(t){return V.resolve(this.size)}}class qC extends FC{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(i)})),V.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class GC{constructor(t){this.persistence=t,this.si=new ai((e=>Tl(e)),El),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.oi=0,this._i=new Cl,this.targetCount=0,this.ai=Ni.ur()}forEachTarget(t,e){return this.si.forEach(((i,s)=>e(s))),V.resolve()}getLastRemoteSnapshotVersion(t){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return V.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.oi&&(this.oi=e),V.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Ni(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,V.resolve()}updateTargetData(t,e){return this.Pr(e),V.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,V.resolve()}removeTargets(t,e,i){let s=0;const r=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=e&&i.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)})),V.waitFor(r).next((()=>s))}getTargetCount(t){return V.resolve(this.targetCount)}getTargetData(t,e){const i=this.si.get(e)||null;return V.resolve(i)}addMatchingKeys(t,e,i){return this._i.Wr(e,i),V.resolve()}removeMatchingKeys(t,e,i){this._i.zr(e,i);const s=this.persistence.referenceDelegate,r=[];return s&&e.forEach((o=>{r.push(s.markPotentiallyOrphaned(t,o))})),V.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),V.resolve()}getMatchingKeysForTargetId(t,e){const i=this._i.Hr(e);return V.resolve(i)}containsKey(t,e){return V.resolve(this._i.containsKey(e))}}class Fm{constructor(t,e){this.ui={},this.overlays={},this.ci=new Ho(0),this.li=!1,this.li=!0,this.hi=new jC,this.referenceDelegate=t(this),this.Pi=new GC(this),this.indexManager=new kC,this.remoteDocumentCache=(function(s){return new $C(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new CC(e),this.Ii=new zC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new WC,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.ui[t.toKey()];return i||(i=new HC(e,this.referenceDelegate),this.ui[t.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,i){B("MemoryPersistence","Starting transaction:",t);const s=new YC(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((r=>this.referenceDelegate.di(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ai(t,e){return V.or(Object.values(this.ui).map((i=>()=>i.containsKey(t,e))))}}class YC extends wP{constructor(t){super(),this.currentSequenceNumber=t}}class Rl{constructor(t){this.persistence=t,this.Ri=new Cl,this.Vi=null}static mi(t){return new Rl(t)}get fi(){if(this.Vi)return this.Vi;throw W(60996)}addReference(t,e,i){return this.Ri.addReference(i,e),this.fi.delete(i.toString()),V.resolve()}removeReference(t,e,i){return this.Ri.removeReference(i,e),this.fi.add(i.toString()),V.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),V.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((r=>this.fi.add(r.toString())))})).next((()=>i.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.fi,(i=>{const s=z.fromPath(i);return this.gi(t,s).next((r=>{r||e.removeEntry(s,H.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((i=>{i?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return V.or([()=>V.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class So{constructor(t,e){this.persistence=t,this.pi=new ai((i=>IP(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=LC(this,e)}static mi(t,e){return new So(t,e)}Ei(){}di(t){return V.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((i=>e.next((s=>i+s))))}wr(t){let e=0;return this.pr(t,(i=>{e++})).next((()=>e))}pr(t,e){return V.forEach(this.pi,((i,s)=>this.br(t,i,s).next((r=>r?V.resolve():e(s)))))}removeTargets(t,e,i){return this.persistence.getTargetCache().removeTargets(t,e,i)}removeOrphanedDocuments(t,e){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(t,(o=>this.br(t,o,e).next((a=>{a||(i++,r.removeEntry(o,H.min()))})))).next((()=>r.apply(t))).next((()=>i))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),V.resolve()}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),V.resolve()}removeReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),V.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),V.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Yr(t.data.value)),e}br(t,e,i){return V.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return V.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class kl{constructor(t,e,i,s){this.targetId=t,this.fromCache=e,this.Es=i,this.ds=s}static As(t,e){let i=J(),s=J();for(const r of e.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new kl(t,e.fromCache,i,s)}}class KC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class XC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return FI()?8:TP(Ht())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,i,s){const r={result:null};return this.ys(t,e).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ws(t,e,s,i).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new KC;return this.Ss(t,e,o).next((a=>{if(r.result=a,this.Vs)return this.bs(t,e,o,a.size)}))})).next((()=>r.result))}bs(t,e,i,s){return i.documentReadCount<this.fs?(mi()<=X.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",_i(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),V.resolve()):(mi()<=X.DEBUG&&B("QueryEngine","Query:",_i(e),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(mi()<=X.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",_i(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,we(e))):V.resolve())}ys(t,e){if(mf(e))return V.resolve(null);let i=we(e);return this.indexManager.getIndexType(t,i).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=xc(e,null,"F"),i=we(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next((r=>{const o=J(...r);return this.ps.getDocuments(t,o).next((a=>this.indexManager.getMinOffset(t,i).next((c=>{const u=this.Ds(e,a);return this.Cs(e,u,o,c.readTime)?this.ys(t,xc(e,null,"F")):this.vs(t,u,e,c)}))))})))))}ws(t,e,i,s){return mf(e)||s.isEqual(H.min())?V.resolve(null):this.ps.getDocuments(t,i).next((r=>{const o=this.Ds(e,r);return this.Cs(e,o,i,s)?V.resolve(null):(mi()<=X.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),_i(e)),this.vs(t,o,e,_P(s,Hs)).next((a=>a)))}))}Ds(t,e){let i=new At(pm(t));return e.forEach(((s,r)=>{Ko(t,r)&&(i=i.add(r))})),i}Cs(t,e,i,s){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(t,e,i){return mi()<=X.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",_i(e)),this.ps.getDocumentsMatchingQuery(t,e,En.min(),i)}vs(t,e,i,s){return this.ps.getDocumentsMatchingQuery(t,i,s).next((r=>(e.forEach((o=>{r=r.insert(o.key,o)})),r)))}}const Dl="LocalStore",QC=3e8;class JC{constructor(t,e,i,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new mt(Q),this.xs=new ai((r=>Tl(r)),El),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(i)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new UC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function ZC(n,t,e,i){return new JC(n,t,e,i)}async function Bm(n,t){const e=q(n);return await e.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return e.mutationQueue.getAllMutationBatches(i).next((r=>(s=r,e.Bs(t),e.mutationQueue.getAllMutationBatches(i)))).next((r=>{const o=[],a=[];let c=J();for(const u of s){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of r){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return e.localDocuments.getDocuments(i,c).next((u=>({Ls:u,removedBatchIds:o,addedBatchIds:a})))}))}))}function tR(n,t){const e=q(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=t.batch.keys(),r=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,u,h){const d=u.batch,g=d.keys();let m=V.resolve();return g.forEach((y=>{m=m.next((()=>h.getEntry(c,y))).next((v=>{const w=u.docVersions.get(y);st(w!==null,48541),v.version.compareTo(w)<0&&(d.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),h.addEntry(v)))}))})),m.next((()=>a.mutationQueue.removeMutationBatch(c,d)))})(e,i,t,r).next((()=>r.apply(i))).next((()=>e.mutationQueue.performConsistencyCheck(i))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=J();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c})(t)))).next((()=>e.localDocuments.getDocuments(i,s)))}))}function Um(n){const t=q(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function eR(n,t){const e=q(n),i=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const a=[];t.targetChanges.forEach(((h,d)=>{const g=s.get(d);if(!g)return;a.push(e.Pi.removeMatchingKeys(r,h.removedDocuments,d).next((()=>e.Pi.addMatchingKeys(r,h.addedDocuments,d))));let m=g.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Ot.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,i)),s=s.insert(d,m),(function(v,w,P){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=QC?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(g,m,h)&&a.push(e.Pi.updateTargetData(r,m))}));let c=$e(),u=J();if(t.documentUpdates.forEach((h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,h))})),a.push(nR(r,o,t.documentUpdates).next((h=>{c=h.ks,u=h.qs}))),!i.isEqual(H.min())){const h=e.Pi.getLastRemoteSnapshotVersion(r).next((d=>e.Pi.setTargetsMetadata(r,r.currentSequenceNumber,i)));a.push(h)}return V.waitFor(a).next((()=>o.apply(r))).next((()=>e.localDocuments.getLocalViewOfDocuments(r,c,u))).next((()=>c))})).then((r=>(e.Ms=s,r)))}function nR(n,t,e){let i=J(),s=J();return e.forEach((r=>i=i.add(r))),t.getEntries(n,i).next((r=>{let o=$e();return e.forEach(((a,c)=>{const u=r.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(H.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):B(Dl,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)})),{ks:o,qs:s}}))}function iR(n,t){const e=q(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(i=>(t===void 0&&(t=bl),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t))))}function sR(n,t){const e=q(n);return e.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return e.Pi.getTargetData(i,t).next((r=>r?(s=r,V.resolve(s)):e.Pi.allocateTargetId(i).next((o=>(s=new dn(t,o,"TargetPurposeListen",i.currentSequenceNumber),e.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=e.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(i.targetId,i),e.xs.set(t,i.targetId)),i}))}async function Rc(n,t,e){const i=q(n),s=i.Ms.get(t),r=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",r,(o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!ji(o))throw o;B(Dl,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ms=i.Ms.remove(t),i.xs.delete(s.target)}function Cf(n,t,e){const i=q(n);let s=H.min(),r=J();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,u,h){const d=q(c),g=d.xs.get(h);return g!==void 0?V.resolve(d.Ms.get(g)):d.Pi.getTargetData(u,h)})(i,o,we(t)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{r=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,t,e?s:H.min(),e?r:J()))).next((a=>(rR(i,HP(t),a),{documents:a,Qs:r})))))}function rR(n,t,e){let i=n.Os.get(t)||H.min();e.forEach(((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)})),n.Os.set(t,i)}class Rf{constructor(){this.activeTargetIds=XP()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class oR{constructor(){this.Mo=new Rf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,i){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Rf,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class aR{Oo(t){}shutdown(){}}const kf="ConnectivityMonitor";class Df{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){B(kf,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){B(kf,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Ur=null;function kc(){return Ur===null?Ur=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ur++,"0x"+Ur.toString(16)}const Xa="RestConnection",cR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lR{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===bo?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(t,e,i,s,r){const o=kc(),a=this.zo(t,e.toUriEncodedString());B(Xa,`Sending RPC '${t}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,r);const{host:u}=new URL(a),h=Fi(u);return this.Jo(t,a,c,i,h).then((d=>(B(Xa,`Received RPC '${t}' ${o}: `,d),d)),(d=>{throw Di(Xa,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",i),d}))}Ho(t,e,i,s,r,o){return this.Go(t,e,i,s,r)}jo(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zi})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,r)=>t[r]=s)),i&&i.headers.forEach(((s,r)=>t[r]=s))}zo(t,e){const i=cR[t];return`${this.Uo}/v1/${e}:${i}`}terminate(){}}class uR{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const Lt="WebChannelConnection";class hR extends lR{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,i,s,r){const o=kc();return new Promise(((a,c)=>{const u=new Hp;u.setWithCredentials(!0),u.listenOnce($p.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case Gr.NO_ERROR:const d=u.getResponseJson();B(Lt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Gr.TIMEOUT:B(Lt,`RPC '${t}' ${o} timed out`),c(new U(N.DEADLINE_EXCEEDED,"Request time out"));break;case Gr.HTTP_ERROR:const g=u.getStatus();if(B(Lt,`RPC '${t}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const v=(function(P){const C=P.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(C)>=0?C:N.UNKNOWN})(y.status);c(new U(v,y.message))}else c(new U(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new U(N.UNAVAILABLE,"Connection failed."));break;default:W(9055,{l_:t,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{B(Lt,`RPC '${t}' ${o} completed.`)}}));const h=JSON.stringify(s);B(Lt,`RPC '${t}' ${o} sending request:`,s),u.send(e,"POST",h,i,15)}))}T_(t,e,i){const s=kc(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Yp(),a=Gp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,e,i),c.encodeInitMessageHeaders=!0;const h=r.join("");B(Lt,`Creating RPC '${t}' stream ${s}: ${h}`,c);const d=o.createWebChannel(h,c);this.I_(d);let g=!1,m=!1;const y=new uR({Yo:w=>{m?B(Lt,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(g||(B(Lt,`Opening RPC '${t}' stream ${s} transport.`),d.open(),g=!0),B(Lt,`RPC '${t}' stream ${s} sending:`,w),d.send(w))},Zo:()=>d.close()}),v=(w,P,C)=>{w.listen(P,(D=>{try{C(D)}catch(O){setTimeout((()=>{throw O}),0)}}))};return v(d,_s.EventType.OPEN,(()=>{m||(B(Lt,`RPC '${t}' stream ${s} transport opened.`),y.o_())})),v(d,_s.EventType.CLOSE,(()=>{m||(m=!0,B(Lt,`RPC '${t}' stream ${s} transport closed`),y.a_(),this.E_(d))})),v(d,_s.EventType.ERROR,(w=>{m||(m=!0,Di(Lt,`RPC '${t}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new U(N.UNAVAILABLE,"The operation could not be completed")))})),v(d,_s.EventType.MESSAGE,(w=>{if(!m){const P=w.data[0];st(!!P,16349);const C=P,D=C?.error||C[0]?.error;if(D){B(Lt,`RPC '${t}' stream ${s} received error:`,D);const O=D.status;let M=(function(b){const T=Tt[b];if(T!==void 0)return Am(T)})(O),L=D.message;M===void 0&&(M=N.INTERNAL,L="Unknown error status: "+O+" with message "+D.message),m=!0,y.a_(new U(M,L)),d.close()}else B(Lt,`RPC '${t}' stream ${s} received:`,P),y.u_(P)}})),v(a,qp.STAT_EVENT,(w=>{w.stat===bc.PROXY?B(Lt,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===bc.NOPROXY&&B(Lt,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Qa(){return typeof document<"u"?document:null}function Zo(n){return new pC(n,!0)}class zm{constructor(t,e,i=1e3,s=1.5,r=6e4){this.Mi=t,this.timerId=e,this.d_=i,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-i);s>0&&B("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Mf="PersistentStream";class Wm{constructor(t,e,i,s,r,o,a,c){this.Mi=t,this.S_=i,this.b_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zm(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===N.RESOURCE_EXHAUSTED?(He(e.toString()),He("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===e&&this.G_(i,s)}),(i=>{t((()=>{const s=new U(N.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(t,e){const i=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return B(Mf,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(B(Mf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dR extends Wm{constructor(t,e,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=yC(this.serializer,t),i=(function(r){if(!("targetChange"in r))return H.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?Te(o.readTime):H.min()})(t);return this.listener.H_(e,i)}Y_(t){const e={};e.database=Cc(this.serializer),e.addTarget=(function(r,o){let a;const c=o.target;if(a=Ic(c)?{documents:wC(r,c)}:{query:TC(r,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Rm(r,o.resumeToken);const u=Sc(r,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=xo(r,o.snapshotVersion.toTimestamp());const u=Sc(r,o.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,t);const i=IC(this.serializer,t);i&&(e.labels=i),this.q_(e)}Z_(t){const e={};e.database=Cc(this.serializer),e.removeTarget=t,this.q_(e)}}class fR extends Wm{constructor(t,e,i,s,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return st(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,st(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){st(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=vC(t.writeResults,t.commitTime),i=Te(t.commitTime);return this.listener.na(i,e)}ra(){const t={};t.database=Cc(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((i=>bC(this.serializer,i)))};this.q_(e)}}class gR{}class pR extends gR{constructor(t,e,i,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Go(t,Ac(e,i),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new U(N.UNKNOWN,r.toString())}))}Ho(t,e,i,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(t,Ac(e,i),s,o,a,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(N.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class mR{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(He(e),this.aa=!1):B("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const si="RemoteStore";class _R{constructor(t,e,i,s,r){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{li(this)&&(B(si,"Restarting streams for network reachability change."),await(async function(c){const u=q(c);u.Ea.add(4),await ar(u),u.Ra.set("Unknown"),u.Ea.delete(4),await ta(u)})(this))}))})),this.Ra=new mR(i,s)}}async function ta(n){if(li(n))for(const t of n.da)await t(!0)}async function ar(n){for(const t of n.da)await t(!1)}function jm(n,t){const e=q(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Nl(e)?Vl(e):Hi(e).O_()&&Ol(e,t))}function Ml(n,t){const e=q(n),i=Hi(e);e.Ia.delete(t),i.O_()&&Hm(e,t),e.Ia.size===0&&(i.O_()?i.L_():li(e)&&e.Ra.set("Unknown"))}function Ol(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(H.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Hi(n).Y_(t)}function Hm(n,t){n.Va.Ue(t),Hi(n).Z_(t)}function Vl(n){n.Va=new hC({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Hi(n).start(),n.Ra.ua()}function Nl(n){return li(n)&&!Hi(n).x_()&&n.Ia.size>0}function li(n){return q(n).Ea.size===0}function $m(n){n.Va=void 0}async function yR(n){n.Ra.set("Online")}async function bR(n){n.Ia.forEach(((t,e)=>{Ol(n,t)}))}async function vR(n,t){$m(n),Nl(n)?(n.Ra.ha(t),Vl(n)):n.Ra.set("Unknown")}async function wR(n,t,e){if(n.Ra.set("Online"),t instanceof Cm&&t.state===2&&t.cause)try{await(async function(s,r){const o=r.cause;for(const a of r.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))})(n,t)}catch(i){B(si,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Ao(n,i)}else if(t instanceof Qr?n.Va.Ze(t):t instanceof Pm?n.Va.st(t):n.Va.tt(t),!e.isEqual(H.min()))try{const i=await Um(n.localStore);e.compareTo(i)>=0&&await(function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach(((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=r.Ia.get(u);h&&r.Ia.set(u,h.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,u)=>{const h=r.Ia.get(c);if(!h)return;r.Ia.set(c,h.withResumeToken(Ot.EMPTY_BYTE_STRING,h.snapshotVersion)),Hm(r,c);const d=new dn(h.target,c,u,h.sequenceNumber);Ol(r,d)})),r.remoteSyncer.applyRemoteEvent(a)})(n,e)}catch(i){B(si,"Failed to raise snapshot:",i),await Ao(n,i)}}async function Ao(n,t,e){if(!ji(t))throw t;n.Ea.add(1),await ar(n),n.Ra.set("Offline"),e||(e=()=>Um(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{B(si,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await ta(n)}))}function qm(n,t){return t().catch((e=>Ao(n,e,t)))}async function ea(n){const t=q(n),e=An(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:bl;for(;TR(t);)try{const s=await iR(t.localStore,i);if(s===null){t.Ta.length===0&&e.L_();break}i=s.batchId,ER(t,s)}catch(s){await Ao(t,s)}Gm(t)&&Ym(t)}function TR(n){return li(n)&&n.Ta.length<10}function ER(n,t){n.Ta.push(t);const e=An(n);e.O_()&&e.X_&&e.ea(t.mutations)}function Gm(n){return li(n)&&!An(n).x_()&&n.Ta.length>0}function Ym(n){An(n).start()}async function IR(n){An(n).ra()}async function xR(n){const t=An(n);for(const e of n.Ta)t.ea(e.mutations)}async function SR(n,t,e){const i=n.Ta.shift(),s=Sl.from(i,t,e);await qm(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await ea(n)}async function AR(n,t){t&&An(n).X_&&await(async function(i,s){if((function(o){return cC(o)&&o!==N.ABORTED})(s.code)){const r=i.Ta.shift();An(i).B_(),await qm(i,(()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s))),await ea(i)}})(n,t),Gm(n)&&Ym(n)}async function Of(n,t){const e=q(n);e.asyncQueue.verifyOperationInProgress(),B(si,"RemoteStore received new credentials");const i=li(e);e.Ea.add(3),await ar(e),i&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await ta(e)}async function PR(n,t){const e=q(n);t?(e.Ea.delete(2),await ta(e)):t||(e.Ea.add(2),await ar(e),e.Ra.set("Unknown"))}function Hi(n){return n.ma||(n.ma=(function(e,i,s){const r=q(e);return r.sa(),new dR(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:yR.bind(null,n),t_:bR.bind(null,n),r_:vR.bind(null,n),H_:wR.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),Nl(n)?Vl(n):n.Ra.set("Unknown")):(await n.ma.stop(),$m(n))}))),n.ma}function An(n){return n.fa||(n.fa=(function(e,i,s){const r=q(e);return r.sa(),new fR(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:IR.bind(null,n),r_:AR.bind(null,n),ta:xR.bind(null,n),na:SR.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await ea(n)):(await n.fa.stop(),n.Ta.length>0&&(B(si,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Ll{constructor(t,e,i,s,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,s,r){const o=Date.now()+i,a=new Ll(t,e,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(N.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fl(n,t){if(He("AsyncQueue",`${t}: ${n}`),ji(n))return new U(N.UNAVAILABLE,`${t}: ${n}`);throw n}class Si{static emptySet(t){return new Si(t.comparator)}constructor(t){this.comparator=t?(e,i)=>t(e,i)||z.comparator(e.key,i.key):(e,i)=>z.comparator(e.key,i.key),this.keyedMap=ys(),this.sortedSet=new mt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,i)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Si)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Si;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class Vf{constructor(){this.ga=new mt(z.comparator)}track(t){const e=t.doc.key,i=this.ga.get(e);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(e,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(e):t.type===1&&i.type===2?this.ga=this.ga.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):W(63341,{Rt:t,pa:i}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,i)=>{t.push(i)})),t}}class Li{constructor(t,e,i,s,r,o,a,c,u){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(t,e,i,s,r){const o=[];return e.forEach((a=>{o.push({type:0,doc:a})})),new Li(t,e,Si.emptySet(e),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Yo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==i[s].type||!e[s].doc.isEqual(i[s].doc))return!1;return!0}}class CR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class RR{constructor(){this.queries=Nf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,i){const s=q(e),r=s.queries;s.queries=Nf(),r.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new U(N.ABORTED,"Firestore shutting down"))}}function Nf(){return new ai((n=>gm(n)),Yo)}async function kR(n,t){const e=q(n);let i=3;const s=t.query;let r=e.queries.get(s);r?!r.ba()&&t.Da()&&(i=2):(r=new CR,i=t.Da()?0:1);try{switch(i){case 0:r.wa=await e.onListen(s,!0);break;case 1:r.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(o){const a=Fl(o,`Initialization of query '${_i(t.query)}' failed`);return void t.onError(a)}e.queries.set(s,r),r.Sa.push(t),t.va(e.onlineState),r.wa&&t.Fa(r.wa)&&Bl(e)}async function DR(n,t){const e=q(n),i=t.query;let s=3;const r=e.queries.get(i);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?s=t.Da()?0:1:!r.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function MR(n,t){const e=q(n);let i=!1;for(const s of t){const r=s.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Fa(s)&&(i=!0);o.wa=s}}i&&Bl(e)}function OR(n,t,e){const i=q(n),s=i.queries.get(t);if(s)for(const r of s.Sa)r.onError(e);i.queries.delete(t)}function Bl(n){n.Ca.forEach((t=>{t.next()}))}var Dc,Lf;(Lf=Dc||(Dc={})).Ma="default",Lf.Cache="cache";class VR{constructor(t,e,i){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Li(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const i=e!=="Offline";return(!this.options.qa||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Li.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Dc.Cache}}class Km{constructor(t){this.key=t}}class Xm{constructor(t){this.key=t}}class NR{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=J(),this.mutatedKeys=J(),this.eu=pm(t),this.tu=new Si(this.eu)}get nu(){return this.Ya}ru(t,e){const i=e?e.iu:new Vf,s=e?e.tu:this.tu;let r=e?e.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((h,d)=>{const g=s.get(h),m=Ko(this.query,d)?d:null,y=!!g&&this.mutatedKeys.has(g.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;g&&m?g.data.isEqual(m.data)?y!==v&&(i.track({type:3,doc:m}),w=!0):this.su(g,m)||(i.track({type:2,doc:m}),w=!0,(c&&this.eu(m,c)>0||u&&this.eu(m,u)<0)&&(a=!0)):!g&&m?(i.track({type:0,doc:m}),w=!0):g&&!m&&(i.track({type:1,doc:g}),w=!0,(c||u)&&(a=!0)),w&&(m?(o=o.add(m),r=v?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),i.track({type:1,doc:h})}return{tu:o,iu:i,Cs:a,mutatedKeys:r}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,s){const r=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((h,d)=>(function(m,y){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W(20277,{Rt:w})}};return v(m)-v(y)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(i),s=s??!1;const a=e&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new Li(this.query,t.tu,r,o,t.mutatedKeys,c===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Vf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=J(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const e=[];return t.forEach((i=>{this.Xa.has(i)||e.push(new Xm(i))})),this.Xa.forEach((i=>{t.has(i)||e.push(new Km(i))})),e}cu(t){this.Ya=t.Qs,this.Xa=J();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Li.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ul="SyncEngine";class LR{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class FR{constructor(t){this.key=t,this.hu=!1}}class BR{constructor(t,e,i,s,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ai((a=>gm(a)),Yo),this.Iu=new Map,this.Eu=new Set,this.du=new mt(z.comparator),this.Au=new Map,this.Ru=new Cl,this.Vu={},this.mu=new Map,this.fu=Ni.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function UR(n,t,e=!0){const i=n_(n);let s;const r=i.Tu.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await Qm(i,t,e,!0),s}async function zR(n,t){const e=n_(n);await Qm(e,t,!0,!1)}async function Qm(n,t,e,i){const s=await sR(n.localStore,we(t)),r=s.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return i&&(a=await WR(n,t,r,o==="current",s.resumeToken)),n.isPrimaryClient&&e&&jm(n.remoteStore,s),a}async function WR(n,t,e,i,s){n.pu=(d,g,m)=>(async function(v,w,P,C){let D=w.view.ru(P);D.Cs&&(D=await Cf(v.localStore,w.query,!1).then((({documents:E})=>w.view.ru(E,D))));const O=C&&C.targetChanges.get(w.targetId),M=C&&C.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(D,v.isPrimaryClient,O,M);return Bf(v,w.targetId,L.au),L.snapshot})(n,d,g,m);const r=await Cf(n.localStore,t,!0),o=new NR(t,r.Qs),a=o.ru(r.documents),c=or.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,c);Bf(n,e,u.au);const h=new LR(t,e,o);return n.Tu.set(t,h),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),u.snapshot}async function jR(n,t,e){const i=q(n),s=i.Tu.get(t),r=i.Iu.get(s.targetId);if(r.length>1)return i.Iu.set(s.targetId,r.filter((o=>!Yo(o,t)))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Rc(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),e&&Ml(i.remoteStore,s.targetId),Mc(i,s.targetId)})).catch(Wi)):(Mc(i,s.targetId),await Rc(i.localStore,s.targetId,!0))}async function HR(n,t){const e=q(n),i=e.Tu.get(t),s=e.Iu.get(i.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),Ml(e.remoteStore,i.targetId))}async function $R(n,t,e){const i=JR(n);try{const s=await(function(o,a){const c=q(o),u=ut.now(),h=a.reduce(((m,y)=>m.add(y.key)),J());let d,g;return c.persistence.runTransaction("Locally write mutations","readwrite",(m=>{let y=$e(),v=J();return c.Ns.getEntries(m,h).next((w=>{y=w,y.forEach(((P,C)=>{C.isValidDocument()||(v=v.add(P))}))})).next((()=>c.localDocuments.getOverlayedDocuments(m,y))).next((w=>{d=w;const P=[];for(const C of a){const D=iC(C,d.get(C.key).overlayedDocument);D!=null&&P.push(new ci(C.key,D,am(D.value.mapValue),ze.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,P,a)})).next((w=>{g=w;const P=w.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(m,w.batchId,P)}))})).then((()=>({batchId:g.batchId,changes:_m(d)})))})(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),(function(o,a,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new mt(Q)),u=u.insert(a,c),o.Vu[o.currentUser.toKey()]=u})(i,s.batchId,e),await cr(i,s.changes),await ea(i.remoteStore)}catch(s){const r=Fl(s,"Failed to persist write");e.reject(r)}}async function Jm(n,t){const e=q(n);try{const i=await eR(e.localStore,t);t.targetChanges.forEach(((s,r)=>{const o=e.Au.get(r);o&&(st(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?st(o.hu,14607):s.removedDocuments.size>0&&(st(o.hu,42227),o.hu=!1))})),await cr(e,i,t)}catch(i){await Wi(i)}}function Ff(n,t,e){const i=q(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const s=[];i.Tu.forEach(((r,o)=>{const a=o.view.va(t);a.snapshot&&s.push(a.snapshot)})),(function(o,a){const c=q(o);c.onlineState=a;let u=!1;c.queries.forEach(((h,d)=>{for(const g of d.Sa)g.va(a)&&(u=!0)})),u&&Bl(c)})(i.eventManager,t),s.length&&i.Pu.H_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function qR(n,t,e){const i=q(n);i.sharedClientState.updateQueryState(t,"rejected",e);const s=i.Au.get(t),r=s&&s.key;if(r){let o=new mt(z.comparator);o=o.insert(r,zt.newNoDocument(r,H.min()));const a=J().add(r),c=new Jo(H.min(),new Map,new mt(Q),o,a);await Jm(i,c),i.du=i.du.remove(r),i.Au.delete(t),zl(i)}else await Rc(i.localStore,t,!1).then((()=>Mc(i,t,e))).catch(Wi)}async function GR(n,t){const e=q(n),i=t.batch.batchId;try{const s=await tR(e.localStore,t);t_(e,i,null),Zm(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await cr(e,s)}catch(s){await Wi(s)}}async function YR(n,t,e){const i=q(n);try{const s=await(function(o,a){const c=q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,a).next((d=>(st(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(u,d)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(i.localStore,t);t_(i,t,e),Zm(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await cr(i,s)}catch(s){await Wi(s)}}function Zm(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function t_(n,t,e){const i=q(n);let s=i.Vu[i.currentUser.toKey()];if(s){const r=s.get(t);r&&(e?r.reject(e):r.resolve(),s=s.remove(t)),i.Vu[i.currentUser.toKey()]=s}}function Mc(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Iu.get(t))n.Tu.delete(i),e&&n.Pu.yu(i,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((i=>{n.Ru.containsKey(i)||e_(n,i)}))}function e_(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Ml(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),zl(n))}function Bf(n,t,e){for(const i of e)i instanceof Km?(n.Ru.addReference(i.key,t),KR(n,i)):i instanceof Xm?(B(Ul,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,t),n.Ru.containsKey(i.key)||e_(n,i.key)):W(19791,{wu:i})}function KR(n,t){const e=t.key,i=e.path.canonicalString();n.du.get(e)||n.Eu.has(i)||(B(Ul,"New document in limbo: "+e),n.Eu.add(i),zl(n))}function zl(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new z(pt.fromString(t)),i=n.fu.next();n.Au.set(i,new FR(e)),n.du=n.du.insert(e,i),jm(n.remoteStore,new dn(we(Il(e.path)),i,"TargetPurposeLimboResolution",Ho.ce))}}async function cr(n,t,e){const i=q(n),s=[],r=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,t,e).then((u=>{if((u||e)&&i.isPrimaryClient){const h=u?!u.fromCache:e?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=kl.As(c.targetId,u);r.push(h)}})))})),await Promise.all(o),i.Pu.H_(s),await(async function(c,u){const h=q(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>V.forEach(u,(g=>V.forEach(g.Es,(m=>h.persistence.referenceDelegate.addReference(d,g.targetId,m))).next((()=>V.forEach(g.ds,(m=>h.persistence.referenceDelegate.removeReference(d,g.targetId,m)))))))))}catch(d){if(!ji(d))throw d;B(Dl,"Failed to update sequence numbers: "+d)}for(const d of u){const g=d.targetId;if(!d.fromCache){const m=h.Ms.get(g),y=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(y);h.Ms=h.Ms.insert(g,v)}}})(i.localStore,r))}async function XR(n,t){const e=q(n);if(!e.currentUser.isEqual(t)){B(Ul,"User change. New user:",t.toKey());const i=await Bm(e.localStore,t);e.currentUser=t,(function(r,o){r.mu.forEach((a=>{a.forEach((c=>{c.reject(new U(N.CANCELLED,o))}))})),r.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await cr(e,i.Ls)}}function QR(n,t){const e=q(n),i=e.Au.get(t);if(i&&i.hu)return J().add(i.key);{let s=J();const r=e.Iu.get(t);if(!r)return s;for(const o of r){const a=e.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function n_(n){const t=q(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Jm.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=QR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qR.bind(null,t),t.Pu.H_=MR.bind(null,t.eventManager),t.Pu.yu=OR.bind(null,t.eventManager),t}function JR(n){const t=q(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=GR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=YR.bind(null,t),t}class Po{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Zo(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return ZC(this.persistence,new XC,t.initialUser,this.serializer)}Cu(t){return new Fm(Rl.mi,this.serializer)}Du(t){return new oR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Po.provider={build:()=>new Po};class ZR extends Po{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){st(this.persistence.referenceDelegate instanceof So,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new VC(i,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Yt.withCacheSize(this.cacheSizeBytes):Yt.DEFAULT;return new Fm((i=>So.mi(i,e)),this.serializer)}}class Oc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ff(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=XR.bind(null,this.syncEngine),await PR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new RR})()}createDatastore(t){const e=Zo(t.databaseInfo.databaseId),i=(function(r){return new hR(r)})(t.databaseInfo);return(function(r,o,a,c){return new pR(r,o,a,c)})(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return(function(i,s,r,o,a){return new _R(i,s,r,o,a)})(this.localStore,this.datastore,t.asyncQueue,(e=>Ff(this.syncEngine,e,0)),(function(){return Df.v()?new Df:new aR})())}createSyncEngine(t,e){return(function(s,r,o,a,c,u,h){const d=new BR(s,r,o,a,c,u);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const i=q(e);B(si,"RemoteStore shutting down."),i.Ea.add(5),await ar(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Oc.provider={build:()=>new Oc};class tk{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):He("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const Pn="FirestoreClient";class ek{constructor(t,e,i,s,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=s,this.user=Bt.UNAUTHENTICATED,this.clientId=_l.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,(async o=>{B(Pn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(B(Pn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=Fl(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}async function Ja(n,t){n.asyncQueue.verifyOperationInProgress(),B(Pn,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await Bm(t.localStore,s),i=s)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function Uf(n,t){n.asyncQueue.verifyOperationInProgress();const e=await nk(n);B(Pn,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((i=>Of(t.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>Of(t.remoteStore,s))),n._onlineComponents=t}async function nk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(Pn,"Using user provided OfflineComponentProvider");try{await Ja(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;Di("Error using user provided cache. Falling back to memory cache: "+e),await Ja(n,new Po)}}else B(Pn,"Using default OfflineComponentProvider"),await Ja(n,new ZR(void 0));return n._offlineComponents}async function i_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(Pn,"Using user provided OnlineComponentProvider"),await Uf(n,n._uninitializedComponentsProvider._online)):(B(Pn,"Using default OnlineComponentProvider"),await Uf(n,new Oc))),n._onlineComponents}function ik(n){return i_(n).then((t=>t.syncEngine))}async function sk(n){const t=await i_(n),e=t.eventManager;return e.onListen=UR.bind(null,t.syncEngine),e.onUnlisten=jR.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=zR.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=HR.bind(null,t.syncEngine),e}function rk(n,t,e={}){const i=new bn;return n.asyncQueue.enqueueAndForget((async()=>(function(r,o,a,c,u){const h=new tk({next:g=>{h.Nu(),o.enqueueAndForget((()=>DR(r,d)));const m=g.docs.has(a);!m&&g.fromCache?u.reject(new U(N.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&c&&c.source==="server"?u.reject(new U(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),d=new VR(Il(a.path),h,{includeMetadataChanges:!0,qa:!0});return kR(r,d)})(await sk(n),n.asyncQueue,t,e,i))),i.promise}function s_(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const zf=new Map;const r_="firestore.googleapis.com",Wf=!0;class jf{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new U(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=r_,this.ssl=Wf}else this.host=t.host,this.ssl=t.ssl??Wf;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Lm;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<MC)throw new U(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}mP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=s_(t.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Wl{constructor(t,e,i,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new U(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jf(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new rP;switch(i.type){case"firstParty":return new lP(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new U(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=zf.get(e);i&&(B("ComponentProvider","Removing Datastore"),zf.delete(e),i.terminate())})(this),Promise.resolve()}}function ok(n,t,e,i={}){n=js(n,Wl);const s=Fi(t),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;s&&(rp(`https://${a}`),op("Firestore",!0)),r.host!==r_&&r.host!==a&&Di("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...r,host:a,ssl:s,emulatorOptions:i};if(!ti(c,o)&&(n._setSettings(c),i.mockUserToken)){let u,h;if(typeof i.mockUserToken=="string")u=i.mockUserToken,h=Bt.MOCK_USER;else{u=CI(i.mockUserToken,n._app?.options.projectId);const d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new U(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Bt(d)}n._authCredentials=new oP(new Xp(u,h))}}class jl{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new jl(this.firestore,t,this._query)}}class kt{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new kt(this.firestore,t,this._key)}toJSON(){return{type:kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(sr(e,kt._jsonSchema))return new kt(t,i||null,new z(pt.fromString(e.referencePath)))}}kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:Et("string",kt._jsonSchemaVersion),referencePath:Et("string")};class Xs extends jl{constructor(t,e,i){super(t,e,Il(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new kt(this.firestore,null,new z(t))}withConverter(t){return new Xs(this.firestore,t,this._path)}}function o_(n,t,...e){if(n=re(n),arguments.length===1&&(t=_l.newId()),pP("doc","path",t),n instanceof Wl){const i=pt.fromString(t,...e);return nf(i),new kt(n,null,new z(i))}{if(!(n instanceof kt||n instanceof Xs))throw new U(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(pt.fromString(t,...e));return nf(i),new kt(n.firestore,n instanceof Xs?n.converter:null,new z(i))}}const Hf="AsyncQueue";class $f{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zm(this,"async_queue_retry"),this._c=()=>{const i=Qa();i&&B(Hf,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const e=Qa();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Qa();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new bn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!ji(t))throw t;B(Hf,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((i=>{throw this.nc=i,this.rc=!1,He("INTERNAL UNHANDLED ERROR: ",qf(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=e,e}enqueueAfterDelay(t,e,i){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=Ll.createAndSchedule(this,t,e,i,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&W(47125,{Pc:qf(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,i)=>e.targetTimeMs-i.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function qf(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class Hl extends Wl{constructor(t,e,i,s){super(t,e,i,s),this.type="firestore",this._queue=new $f,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new $f(t),this._firestoreClient=void 0,await t}}}function ak(n,t){const e=typeof n=="object"?n:up(),i=typeof n=="string"?n:bo,s=rl(e,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=AI("firestore");r&&ok(s,...r)}return s}function a_(n){if(n._terminated)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ck(n),n._firestoreClient}function ck(n){const t=n._freezeSettings(),e=(function(s,r,o,a){return new AP(s,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,s_(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new ek(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}})(n._componentsProvider))}class ne{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ne(Ot.fromBase64String(t))}catch(e){throw new U(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new ne(Ot.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:ne._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(sr(t,ne._jsonSchema))return ne.fromBase64String(t.bytes)}}ne._jsonSchemaVersion="firestore/bytes/1.0",ne._jsonSchema={type:Et("string",ne._jsonSchemaVersion),bytes:Et("string")};class $l{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new U(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class c_{constructor(t){this._methodName=t}}class Ee{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new U(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new U(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Q(this._lat,t._lat)||Q(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ee._jsonSchemaVersion}}static fromJSON(t){if(sr(t,Ee._jsonSchema))return new Ee(t.latitude,t.longitude)}}Ee._jsonSchemaVersion="firestore/geoPoint/1.0",Ee._jsonSchema={type:Et("string",Ee._jsonSchemaVersion),latitude:Et("number"),longitude:Et("number")};class Ie{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Ie._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(sr(t,Ie._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Ie(t.vectorValues);throw new U(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ie._jsonSchemaVersion="firestore/vectorValue/1.0",Ie._jsonSchema={type:Et("string",Ie._jsonSchemaVersion),vectorValues:Et("object")};const lk=/^__.*__$/;class uk{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new ci(t,this.data,this.fieldMask,e,this.fieldTransforms):new rr(t,this.data,e,this.fieldTransforms)}}function l_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W(40011,{Ac:n})}}class ql{constructor(t,e,i,s,r,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new ql({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.gc(t),i}yc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.Rc(),i}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Co(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(l_(this.Ac)&&lk.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class hk{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||Zo(t)}Cc(t,e,i,s=!1){return new ql({Ac:t,methodName:e,Dc:i,path:Mt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dk(n){const t=n._freezeSettings(),e=Zo(n._databaseId);return new hk(n._databaseId,!!t.ignoreUndefinedProperties,e)}function fk(n,t,e,i,s,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,t,e,s);f_("Data must be an object, but it was:",o,i);const a=h_(i,o);let c,u;if(r.merge)c=new ue(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const d of r.mergeFields){const g=gk(t,d,e);if(!o.contains(g))throw new U(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);mk(h,g)||h.push(g)}c=new ue(h),u=o.fieldTransforms.filter((d=>c.covers(d.field)))}else c=null,u=o.fieldTransforms;return new uk(new ee(a),c,u)}function u_(n,t){if(d_(n=re(n)))return f_("Unsupported field value:",t,n),h_(n,t);if(n instanceof c_)return(function(i,s){if(!l_(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(i,s){const r=[];let o=0;for(const a of i){let c=u_(a,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}})(n,t)}return(function(i,s){if((i=re(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return QP(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=ut.fromDate(i);return{timestampValue:xo(s.serializer,r)}}if(i instanceof ut){const r=new ut(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:xo(s.serializer,r)}}if(i instanceof Ee)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ne)return{bytesValue:Rm(s.serializer,i._byteString)};if(i instanceof kt){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Pl(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof Ie)return(function(o,a){return{mapValue:{fields:{[rm]:{stringValue:om},[vo]:{arrayValue:{values:o.toArray().map((u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return xl(a.serializer,u)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${yl(i)}`)})(n,t)}function h_(n,t){const e={};return Zp(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):oi(n,((i,s)=>{const r=u_(s,t.mc(i));r!=null&&(e[i]=r)})),{mapValue:{fields:e}}}function d_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ut||n instanceof Ee||n instanceof ne||n instanceof kt||n instanceof c_||n instanceof Ie)}function f_(n,t,e){if(!d_(e)||!Qp(e)){const i=yl(e);throw i==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+i)}}function gk(n,t,e){if((t=re(t))instanceof $l)return t._internalPath;if(typeof t=="string")return g_(n,t);throw Co("Field path arguments must be of type string or ",n,!1,void 0,e)}const pk=new RegExp("[~\\*/\\[\\]]");function g_(n,t,e){if(t.search(pk)>=0)throw Co(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new $l(...t.split("."))._internalPath}catch{throw Co(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Co(n,t,e,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new U(N.INVALID_ARGUMENT,a+n+c)}function mk(n,t){return n.some((e=>e.isEqual(t)))}class p_{constructor(t,e,i,s,r){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new _k(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(m_("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class _k extends p_{data(){return super.data()}}function m_(n,t){return typeof t=="string"?g_(n,t):t instanceof $l?t._internalPath:t._delegate._internalPath}class yk{convertValue(t,e="none"){switch(Sn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(xn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw W(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return oi(t,((s,r)=>{i[s]=this.convertValue(r,e)})),i}convertVectorValue(t){const e=t.fields?.[vo].arrayValue?.values?.map((i=>vt(i.doubleValue)));return new Ie(e)}convertGeoPoint(t){return new Ee(vt(t.latitude),vt(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=qo(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp($s(t));default:return null}}convertTimestamp(t){const e=In(t);return new ut(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=pt.fromString(t);st(Nm(i),9688,{name:t});const s=new qs(i.get(1),i.get(3)),r=new z(i.popFirst(5));return s.isEqual(e)||He(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function bk(n,t,e){let i;return i=n?n.toFirestore(t):t,i}class vs{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Qn extends p_{constructor(t,e,i,s,r,o){super(t,e,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Jr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(m_("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Qn._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Qn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qn._jsonSchema={type:Et("string",Qn._jsonSchemaVersion),bundleSource:Et("string","DocumentSnapshot"),bundleName:Et("string"),bundle:Et("string")};class Jr extends Qn{data(t={}){return super.data(t)}}class Ds{constructor(t,e,i,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new vs(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((i=>{t.call(e,new Jr(this._firestore,this._userDataWriter,i.key,i,new vs(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new U(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((a=>{const c=new Jr(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>r||a.type!==3)).map((a=>{const c=new Jr(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:vk(a.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ds._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=_l.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],i=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(e.push(r._document),i.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function vk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W(61501,{type:n})}}function wk(n){n=js(n,kt);const t=js(n.firestore,Hl);return rk(a_(t),n._key).then((e=>xk(t,n,e)))}Ds._jsonSchemaVersion="firestore/querySnapshot/1.0",Ds._jsonSchema={type:Et("string",Ds._jsonSchemaVersion),bundleSource:Et("string","QuerySnapshot"),bundleName:Et("string"),bundle:Et("string")};class Tk extends yk{constructor(t){super(),this.firestore=t}convertBytes(t){return new ne(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new kt(this.firestore,null,e)}}function Ek(n,t,e){n=js(n,kt);const i=js(n.firestore,Hl),s=bk(n.converter,t);return Ik(i,[fk(dk(i),"setDoc",n._key,s,n.converter!==null,e).toMutation(n._key,ze.none())])}function Ik(n,t){return(function(i,s){const r=new bn;return i.asyncQueue.enqueueAndForget((async()=>$R(await ik(i),s,r))),r.promise})(a_(n),t)}function xk(n,t,e){const i=e.docs.get(t._key),s=new Tk(n);return new Qn(n,s,t._key,i,new vs(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(s){zi=s})(Bi),Ri(new ei("firestore",((i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new Hl(new aP(i.getProvider("auth-internal")),new uP(o,i.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new U(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qs(u.options.projectId,h)})(o,s),o);return r={useFetchStreams:e,...r},a._setSettings(r),a}),"PUBLIC").setMultipleInstances(!0)),_n(Jd,Zd,t),_n(Jd,Zd,"esm2020")})();const Sk={apiKey:"AIzaSyDc1-GKX0g26tazdRCFt9dvEjOwQzOQZFk",authDomain:"glassdash-20266.firebaseapp.com",projectId:"glassdash-20266",storageBucket:"glassdash-20266.firebasestorage.app",messagingSenderId:"926827534866",appId:"1:926827534866:web:142b30e53f31e8697716cb",measurementId:"G-8ZNTQEFQZ1"},__=lp(Sk),Za=iP(__),y_=ak(__),Ak=new Oe;let Vc=null;async function na(){if(Vc){console.log("Saving to cloud...");try{const n={transactions:ie.transactions,subscriptions:Gn.subscriptions,debts:fn.debts,lastUpdated:new Date().toISOString()};await Ek(o_(y_,"users",Vc.uid),n),console.log("Cloud save complete")}catch(n){console.error("Error saving to cloud:",n)}}}class Pk{constructor(){this.transactions=JSON.parse(localStorage.getItem("transactions"))||[],this.transactions.length===0&&(this.transactions.push({id:crypto.randomUUID(),date:Fe(new Date,"yyyy-MM-dd"),title:": ",amount:3e5,type:"income",category:"salary"}),this.transactions.push({id:crypto.randomUUID(),date:Fe(new Date,"yyyy-MM-dd"),title:": ",amount:8e4,type:"expense",category:"fixed"}),localStorage.setItem("transactions",JSON.stringify(this.transactions)))}addTransaction(t){this.transactions.unshift(t),this.save()}removeTransaction(t){this.transactions=this.transactions.filter(e=>e.id!==t),this.save()}clearAll(){this.transactions=[],this.save()}save(){localStorage.setItem("transactions",JSON.stringify(this.transactions)),Lc(),na()}getTransactions(){return this.transactions.sort((t,e)=>new Date(e.date)-new Date(t.date))}getMonthlyStats(){const t=new Date,e=this.transactions.filter(o=>Ba(xs(o.date),t)),i=e.filter(o=>o.type==="income").reduce((o,a)=>o+Number(a.amount),0),s=e.filter(o=>o.type==="expense").reduce((o,a)=>o+Number(a.amount),0),r=this.transactions.reduce((o,a)=>a.type==="income"?o+Number(a.amount):o-Number(a.amount),0);return{income:i,expense:s,totalBalance:r}}getChartData(t=6){const e=new Date,i=Td(e,t-1),s=CT({start:i,end:e}),r=s.map(a=>Fe(a,"M",{locale:yI})),o=s.map(a=>{const c=this.transactions.filter(d=>Ba(xs(d.date),a)),u=c.filter(d=>d.type==="income").reduce((d,g)=>d+Number(g.amount),0),h=c.filter(d=>d.type==="expense").reduce((d,g)=>d+Number(g.amount),0);return u-h});return{labels:r,data:o}}getCategoryStats(t="current"){const e=new Date;let i=e;t==="last"&&(i=Td(e,1));const s=this.transactions.filter(u=>Ba(xs(u.date),i)&&u.type==="expense"),r={};s.forEach(u=>{r[u.category]||(r[u.category]=0),r[u.category]+=Number(u.amount)});const o=Object.keys(r).map(u=>v_(u)),a=Object.values(r),c=Object.keys(r).map(u=>kk(u));return{labels:o,data:a,bgColors:c}}}const ie=new Pk;class Ck{constructor(t){this.subscriptions=JSON.parse(localStorage.getItem("subscriptions"))||[],this.transactionStore=t,this.lastCheck=localStorage.getItem("lastSubscriptionCheck")||Fe(new Date,"yyyy-MM-dd"),this.subscriptions.length===0&&(this.subscriptions.push({id:crypto.randomUUID(),title:"",amount:8e4,day:27}),this.subscriptions.push({id:crypto.randomUUID(),title:"Netflix",amount:1490,day:15}),localStorage.setItem("subscriptions",JSON.stringify(this.subscriptions)))}addSubscription(t){this.subscriptions.push(t),this.save()}removeSubscription(t){this.subscriptions=this.subscriptions.filter(e=>e.id!==t),this.save()}save(){localStorage.setItem("subscriptions",JSON.stringify(this.subscriptions)),Fc(),na()}checkAndGenerate(){const t=new Date,e=xs(this.lastCheck);if(Fe(t,"yyyy-MM-dd")===this.lastCheck)return;let i=e;for(i.setDate(i.getDate()+1);i<=t;){const s=i.getDate();this.subscriptions.forEach(r=>{Number(r.day)===s&&this.transactionStore.addTransaction({id:crypto.randomUUID(),date:Fe(i,"yyyy-MM-dd"),title:r.title+" ()",amount:r.amount,type:"expense",category:"fixed"})}),i.setDate(i.getDate()+1)}this.lastCheck=Fe(t,"yyyy-MM-dd"),localStorage.setItem("lastSubscriptionCheck",this.lastCheck)}getSubscriptions(){return this.subscriptions}}const Gn=new Ck(ie);class Rk{constructor(t){this.debts=JSON.parse(localStorage.getItem("debts"))||[],this.transactionStore=t}addDebt(t){this.debts.push(t),this.save()}repayDebt(t,e){const i=this.debts.find(s=>s.id===t);i&&(i.balance-=e,i.balance<0&&(i.balance=0),this.transactionStore.addTransaction({id:crypto.randomUUID(),date:Fe(new Date,"yyyy-MM-dd"),title:`: ${i.name}`,amount:e,type:"expense",category:"other"}),this.save())}removeDebt(t){this.debts=this.debts.filter(e=>e.id!==t),this.save()}save(){localStorage.setItem("debts",JSON.stringify(this.debts)),b_(),na()}getTotalDebt(){return this.debts.reduce((t,e)=>t+Number(e.balance),0)}}const fn=new Rk(ie);function vn(n){return new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(n)}function kk(n){return{food:"#e17055",daily:"#00b894",transport:"#0984e3",entertainment:"#6c5ce7",fixed:"#d63031",salary:"#fdcb6e",other:"#636e72"}[n]||"#636e72"}function Dk(){const{income:n,expense:t,totalBalance:e}=ie.getMonthlyStats();document.getElementById("total-balance").textContent=vn(e),document.getElementById("month-income").textContent=vn(n),document.getElementById("month-expense").textContent=vn(t);const i=document.getElementById("balance-trend");e>=0?(i.innerHTML='<i class="fa-solid fa-arrow-up"></i> ',i.className="trend up"):(i.innerHTML='<i class="fa-solid fa-arrow-down"></i> ',i.className="trend down")}function b_(){const n=document.getElementById("debt-list");if(!n)return;n.innerHTML="";const t=fn.getTotalDebt();document.getElementById("total-debt").textContent=vn(t),fn.debts.forEach(e=>{const i=`
      <div class="transaction-item" style="background: rgba(255,255,255,0.05);">
        <div class="t-icon" style="background: #d63031; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
          <i class="fa-solid fa-building-columns" style="color: #fff;"></i>
        </div>
        <div class="t-details">
          <h4>${e.name}</h4>
          <p>: ${vn(e.balance)}</p>
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
             <button class="glass-btn-sm repay-btn" data-id="${e.id}" style="font-size: 0.8rem; padding: 5px 10px; background: rgba(0, 184, 148, 0.2); color: #00b894; border: 1px solid #00b894;">
            
          </button>
          <button class="glass-btn-sm delete-debt-btn" data-id="${e.id}" style="border: none; background: transparent; color: #ff7675;">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    `;n.insertAdjacentHTML("beforeend",i)}),document.querySelectorAll(".repay-btn").forEach(e=>{e.addEventListener("click",i=>{const s=i.currentTarget.dataset.id,r=prompt(":");r&&!isNaN(r)&&(fn.repayDebt(s,Number(r)),alert(""))})}),document.querySelectorAll(".delete-debt-btn").forEach(e=>{e.addEventListener("click",i=>{confirm("")&&fn.removeDebt(i.currentTarget.dataset.id)})})}function Mk(){const n=document.getElementById("transaction-list");n.innerHTML="",ie.getTransactions().slice(0,5).forEach(e=>{const i=e.type==="income",s=i?"positive":"negative",r=i?"+":"-";let o="fa-circle",a="#fff",c="#333";switch(e.category){case"food":o="fa-utensils",c="#e17055";break;case"daily":o="fa-basket-shopping",c="#00b894";break;case"transport":o="fa-train",c="#0984e3";break;case"entertainment":o="fa-gamepad",c="#6c5ce7";break;case"fixed":o="fa-house",c="#d63031";break;case"salary":o="fa-money-bill-wave",c="#fdcb6e",a="#000";break;default:o="fa-tag",c="#636e72"}const u=`
      <div class="transaction-item">
        <div class="t-icon" style="background: ${c}; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
          <i class="fa-solid ${o}" style="color: ${a};"></i>
        </div>
        <div class="t-details">
          <h4>${e.title}</h4>
          <p>${Fe(xs(e.date),"yyyy/MM/dd")}  ${v_(e.category)}</p>
        </div>
        <div class="t-amount ${s}">
          ${r}${vn(e.amount)}
        </div>
        <button class="glass-btn-sm delete-btn" data-id="${e.id}" style="margin-left: 10px; border: none; background: transparent; color: #ff7675;">
          <i class="fa-solid fa-trash"></i>
        </button>
      </div>
    `;n.insertAdjacentHTML("beforeend",u)}),document.querySelectorAll(".delete-btn").forEach(e=>{e.addEventListener("click",i=>{const s=i.currentTarget.dataset.id;confirm("")&&ie.removeTransaction(s)})})}function v_(n){return{food:"",daily:"",transport:"",entertainment:"",fixed:"",salary:"",other:""}[n]||n}let Zr,vi;function Ok(){const n=document.getElementById("revenueChart").getContext("2d"),t=n.createLinearGradient(0,0,0,400);t.addColorStop(0,"rgba(108, 92, 231, 0.5)"),t.addColorStop(1,"rgba(108, 92, 231, 0.0)"),Zr=new Vo(n,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:t,borderColor:"#6c5ce7",borderWidth:2,pointBackgroundColor:"#ffffff",pointBorderColor:"#6c5ce7",pointRadius:4,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(255, 255, 255, 0.9)",titleColor:"#000",bodyColor:"#000",borderColor:"rgba(0,0,0,0.1)",borderWidth:1,padding:10,displayColors:!1,callbacks:{label:function(e){return": "+vn(e.parsed.y)}}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.7)"}},y:{grid:{color:"rgba(255,255,255,0.1)",drawBorder:!1},ticks:{color:"rgba(255,255,255,0.7)"}}}}})}function Vk(){const n=document.getElementById("categoryChart").getContext("2d");vi=new Vo(n,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderWidth:0,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#fff"}},tooltip:{callbacks:{label:function(t){return t.label+": "+vn(t.parsed)}}}}}})}function Nk(){const{labels:n,data:t}=ie.getChartData();Zr.data.labels=n,Zr.data.datasets[0].data=t,Zr.update()}function Nc(n="current"){if(!vi)return;const{labels:t,data:e,bgColors:i}=ie.getCategoryStats(n);vi.data.labels=t,vi.data.datasets[0].data=e,vi.data.datasets[0].backgroundColor=i,vi.update()}function Lc(){Dk(),Mk(),Nk(),Nc(document.getElementById("analytics-period")?.value||"current"),b_()}function Fc(){const n=document.getElementById("subscription-list");n&&(n.innerHTML="",Gn.subscriptions.forEach(t=>{const e=`
      <div class="fixed-cost-item" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); border-radius: 8px;">
        <div>
          <div style="font-size: 0.9rem;">${t.title}</div>
          <div style="font-size: 0.75rem; color: var(--text-muted);"> ${t.day}</div>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <span>${t.amount.toLocaleString()}</span>
          <button class="glass-btn-sm delete-sub-btn" data-id="${t.id}" style="border: none; background: transparent; color: #ff7675; cursor: pointer;">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    `;n.insertAdjacentHTML("beforeend",e)}),document.querySelectorAll(".delete-sub-btn").forEach(t=>{t.addEventListener("click",e=>{confirm("")&&Gn.removeSubscription(e.currentTarget.dataset.id)})}))}document.addEventListener("DOMContentLoaded",()=>{Ok(),Vk(),Gn.checkAndGenerate(),Lc(),Fc();const n=document.getElementById("sub-day");for(let x=1;x<=31;x++){const S=document.createElement("option");S.value=x,S.textContent=x+"",n.appendChild(S)}document.getElementById("analytics-period")?.addEventListener("change",x=>{Nc(x.target.value)});const t=document.querySelectorAll(".nav-item"),e=document.querySelectorAll(".page-section");t.forEach(x=>{x.addEventListener("click",S=>{S.preventDefault(),t.forEach(I=>I.classList.remove("active")),x.classList.add("active");const A=x.dataset.target+"-section";e.forEach(I=>{I.id===A?(I.style.display="grid",A==="analytics-section"&&Nc(document.getElementById("analytics-period").value)):I.style.display="none"})})});const i=document.getElementById("modal"),s=document.getElementById("add-btn"),r=document.getElementById("close-modal"),o=document.getElementById("transaction-form"),a=document.getElementById("sub-modal"),c=document.getElementById("add-sub-btn"),u=document.getElementById("close-sub-modal"),h=document.getElementById("subscription-form"),d=document.getElementById("debt-modal"),g=document.getElementById("add-debt-btn"),m=document.getElementById("close-debt-modal"),y=document.getElementById("debt-form");s.addEventListener("click",()=>{i.classList.add("active"),document.getElementById("date").valueAsDate=new Date}),r.addEventListener("click",()=>{i.classList.remove("active")}),c.addEventListener("click",()=>{a.classList.add("active")}),u.addEventListener("click",()=>{a.classList.remove("active")}),g&&g.addEventListener("click",()=>{d.classList.add("active")}),m&&m.addEventListener("click",()=>{d.classList.remove("active")}),window.addEventListener("click",x=>{x.target===i&&i.classList.remove("active"),x.target===a&&a.classList.remove("active"),x.target===d&&d.classList.remove("active")}),o.addEventListener("submit",x=>{x.preventDefault();const S=new FormData(o),A={id:crypto.randomUUID(),type:S.get("type"),date:S.get("date"),title:S.get("title"),amount:Number(S.get("amount")),category:S.get("category")};ie.addTransaction(A),o.reset(),i.classList.remove("active")}),h.addEventListener("submit",x=>{x.preventDefault();const S=document.getElementById("sub-title").value,A=document.getElementById("sub-amount").value,I=document.getElementById("sub-day").value;Gn.addSubscription({id:crypto.randomUUID(),title:S,amount:Number(A),day:Number(I)}),h.reset(),a.classList.remove("active"),alert("")}),y&&y.addEventListener("submit",x=>{x.preventDefault();const S=document.getElementById("debt-name").value,A=document.getElementById("debt-balance").value,I=document.getElementById("debt-payment").value;fn.addDebt({id:crypto.randomUUID(),name:S,balance:Number(A),monthlyPayment:Number(I)}),y.reset(),d.classList.remove("active")}),document.getElementById("clear-data-btn").addEventListener("click",()=>{confirm("")&&ie.clearAll()});const v=document.getElementById("scan-btn"),w=document.getElementById("receipt-input"),P=document.getElementById("scan-status");v&&v.addEventListener("click",()=>{w.click()}),w&&w.addEventListener("change",async x=>{const S=x.target.files[0];if(S){P.textContent="... ()",v.disabled=!0;try{const A=await J_(()=>import("./index-9JLLdIp4.js").then(it=>it.i),[],import.meta.url);P.textContent="...";const nt=(await A.recognize(S,"jpn",{logger:it=>{it.status==="recognizing text"&&(P.textContent=`... ${Math.round(it.progress*100)}%`)}})).data.text;console.log("OCR Result:",nt);const G=C(nt);G.date&&(document.getElementById("date").value=G.date),G.title&&(document.getElementById("title").value=G.title),G.amount&&(document.getElementById("amount").value=G.amount),document.getElementById("type-expense").checked=!0,P.textContent="",P.style.color="#00b894"}catch(A){console.error(A),P.textContent="",P.style.color="#ff7675"}finally{v.disabled=!1,w.value=""}}});const C=x=>parseReceiptTextRef?parseReceiptTextRef(x):{date:"",title:"",amount:""},D=document.getElementById("login-btn"),O=document.getElementById("logout-btn"),M=document.getElementById("login-area"),L=document.getElementById("user-area"),E=document.getElementById("user-avatar"),b=document.getElementById("user-name"),T=document.getElementById("auth-text");D&&D.addEventListener("click",()=>{dA(Za,Ak).then(x=>{console.log("Logged in:",x.user)}).catch(x=>{console.error("Login failed",x),alert(": "+x.message)})}),O&&O.addEventListener("click",()=>{qS(Za).then(()=>{console.log("Logged out"),location.reload()})}),$S(Za,async x=>{if(Vc=x,x){M.style.display="none",L.style.display="flex",E.src=x.photoURL,b.textContent=x.displayName,T&&(T.textContent="");try{const S=o_(y_,"users",x.uid),A=await wk(S);if(A.exists()){console.log("Loading data from cloud...");const I=A.data();I.transactions&&(ie.transactions=I.transactions),I.subscriptions&&(Gn.subscriptions=I.subscriptions),I.debts&&(fn.debts=I.debts),localStorage.setItem("transactions",JSON.stringify(ie.transactions)),localStorage.setItem("subscriptions",JSON.stringify(Gn.subscriptions)),localStorage.setItem("debts",JSON.stringify(fn.debts)),Lc(),Fc(),alert("")}else console.log("No cloud data found. Uploading local data..."),na()}catch(S){console.error("Error loading cloud data",S)}}else M.style.display="block",L.style.display="none",T&&(T.textContent="")})});
