(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const ey="modulepreload",ny=function(n,t){return new URL(n,t).href},Ku={},iy=function(t,e,i){let s=Promise.resolve();if(e&&e.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");s=u(e.map(h=>{if(h=ny(h,i),h in Ku)return;Ku[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(i)for(let y=o.length-1;y>=0;y--){const v=o[y];if(v.href===h&&(!d||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":ey,d||(m.as="script"),m.crossOrigin="",m.href=h,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((y,v)=>{m.addEventListener("load",y),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})};function Js(n){return n+.5|0}const cn=(n,t,e)=>Math.max(Math.min(n,e),t);function ps(n){return cn(Js(n*2.55),0,255)}function gn(n){return cn(Js(n*255),0,255)}function Oe(n){return cn(Js(n/2.55)/100,0,1)}function Xu(n){return cn(Js(n*100),0,100)}const ne={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},sc=[..."0123456789ABCDEF"],sy=n=>sc[n&15],ry=n=>sc[(n&240)>>4]+sc[n&15],Tr=n=>(n&240)>>4===(n&15),oy=n=>Tr(n.r)&&Tr(n.g)&&Tr(n.b)&&Tr(n.a);function ay(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&ne[n[1]]*17,g:255&ne[n[2]]*17,b:255&ne[n[3]]*17,a:t===5?ne[n[4]]*17:255}:(t===7||t===9)&&(e={r:ne[n[1]]<<4|ne[n[2]],g:ne[n[3]]<<4|ne[n[4]],b:ne[n[5]]<<4|ne[n[6]],a:t===9?ne[n[7]]<<4|ne[n[8]]:255})),e}const cy=(n,t)=>n<255?t(n):"";function ly(n){var t=oy(n)?sy:ry;return n?"#"+t(n.r)+t(n.g)+t(n.b)+cy(n.a,t):void 0}const uy=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Kf(n,t,e){const i=t*Math.min(e,1-e),s=(r,o=(r+n/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function hy(n,t,e){const i=(s,r=(s+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function dy(n,t,e){const i=Kf(n,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)i[s]*=1-t-e,i[s]+=t;return i}function fy(n,t,e,i,s){return n===s?(t-e)/i+(t<e?6:0):t===s?(e-n)/i+2:(n-t)/i+4}function Hc(n){const e=n.r/255,i=n.g/255,s=n.b/255,r=Math.max(e,i,s),o=Math.min(e,i,s),a=(r+o)/2;let c,u,h;return r!==o&&(h=r-o,u=a>.5?h/(2-r-o):h/(r+o),c=fy(e,i,s,h,r),c=c*60+.5),[c|0,u||0,a]}function $c(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(gn)}function qc(n,t,e){return $c(Kf,n,t,e)}function gy(n,t,e){return $c(dy,n,t,e)}function py(n,t,e){return $c(hy,n,t,e)}function Xf(n){return(n%360+360)%360}function my(n){const t=uy.exec(n);let e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?ps(+t[5]):gn(+t[5]));const s=Xf(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=gy(s,r,o):t[1]==="hsv"?i=py(s,r,o):i=qc(s,r,o),{r:i[0],g:i[1],b:i[2],a:e}}function _y(n,t){var e=Hc(n);e[0]=Xf(e[0]+t),e=qc(e),n.r=e[0],n.g=e[1],n.b=e[2]}function yy(n){if(!n)return;const t=Hc(n),e=t[0],i=Xu(t[1]),s=Xu(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${s}%, ${Oe(n.a)})`:`hsl(${e}, ${i}%, ${s}%)`}const Qu={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Ju={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function by(){const n={},t=Object.keys(Ju),e=Object.keys(Qu);let i,s,r,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],s=0;s<e.length;s++)r=e[s],a=a.replace(r,Qu[r]);r=parseInt(Ju[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let Ir;function vy(n){Ir||(Ir=by(),Ir.transparent=[0,0,0,0]);const t=Ir[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const wy=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Ey(n){const t=wy.exec(n);let e=255,i,s,r;if(t){if(t[7]!==i){const o=+t[7];e=t[8]?ps(o):cn(o*255,0,255)}return i=+t[1],s=+t[3],r=+t[5],i=255&(t[2]?ps(i):cn(i,0,255)),s=255&(t[4]?ps(s):cn(s,0,255)),r=255&(t[6]?ps(r):cn(r,0,255)),{r:i,g:s,b:r,a:e}}}function Ty(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Oe(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const ka=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,gi=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Iy(n,t,e){const i=gi(Oe(n.r)),s=gi(Oe(n.g)),r=gi(Oe(n.b));return{r:gn(ka(i+e*(gi(Oe(t.r))-i))),g:gn(ka(s+e*(gi(Oe(t.g))-s))),b:gn(ka(r+e*(gi(Oe(t.b))-r))),a:n.a+e*(t.a-n.a)}}function Sr(n,t,e){if(n){let i=Hc(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=qc(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function Qf(n,t){return n&&Object.assign(t||{},n)}function Zu(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=gn(n[3]))):(t=Qf(n,{r:0,g:0,b:0,a:1}),t.a=gn(t.a)),t}function Sy(n){return n.charAt(0)==="r"?Ey(n):my(n)}class Ns{constructor(t){if(t instanceof Ns)return t;const e=typeof t;let i;e==="object"?i=Zu(t):e==="string"&&(i=ay(t)||vy(t)||Sy(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Qf(this._rgb);return t&&(t.a=Oe(t.a)),t}set rgb(t){this._rgb=Zu(t)}rgbString(){return this._valid?Ty(this._rgb):void 0}hexString(){return this._valid?ly(this._rgb):void 0}hslString(){return this._valid?yy(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,c=i.a-s.a,u=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;r=1-u,i.r=255&u*i.r+r*s.r+.5,i.g=255&u*i.g+r*s.g+.5,i.b=255&u*i.b+r*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=Iy(this._rgb,t._rgb,e)),this}clone(){return new Ns(this.rgb)}alpha(t){return this._rgb.a=gn(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Js(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Sr(this._rgb,2,t),this}darken(t){return Sr(this._rgb,2,-t),this}saturate(t){return Sr(this._rgb,1,t),this}desaturate(t){return Sr(this._rgb,1,-t),this}rotate(t){return _y(this._rgb,t),this}}function Re(){}const xy=(()=>{let n=0;return()=>n++})();function Q(n){return n==null}function ft(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function nt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function vt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Jt(n,t){return vt(n)?n:t}function G(n,t){return typeof n>"u"?t:n}const Ay=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,Jf=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function lt(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function at(n,t,e,i){let s,r,o;if(ft(n))for(r=n.length,s=0;s<r;s++)t.call(e,n[s],s);else if(nt(n))for(o=Object.keys(n),r=o.length,s=0;s<r;s++)t.call(e,n[o[s]],o[s])}function so(n,t){let e,i,s,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(s=n[e],r=t[e],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function ro(n){if(ft(n))return n.map(ro);if(nt(n)){const t=Object.create(null),e=Object.keys(n),i=e.length;let s=0;for(;s<i;++s)t[e[s]]=ro(n[e[s]]);return t}return n}function Zf(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Py(n,t,e,i){if(!Zf(n))return;const s=t[n],r=e[n];nt(s)&&nt(r)?Vs(s,r,i):t[n]=ro(r)}function Vs(n,t,e){const i=ft(t)?t:[t],s=i.length;if(!nt(n))return n;e=e||{};const r=e.merger||Py;let o;for(let a=0;a<s;++a){if(o=i[a],!nt(o))continue;const c=Object.keys(o);for(let u=0,h=c.length;u<h;++u)r(c[u],n,o,e)}return n}function Ts(n,t){return Vs(n,t,{merger:Cy})}function Cy(n,t,e){if(!Zf(n))return;const i=t[n],s=e[n];nt(i)&&nt(s)?Ts(i,s):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=ro(s))}const th={"":n=>n,x:n=>n.x,y:n=>n.y};function ky(n){const t=n.split("."),e=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function Ry(n){const t=ky(n);return e=>{for(const i of t){if(i==="")break;e=e&&e[i]}return e}}function wn(n,t){return(th[t]||(th[t]=Ry(t)))(n)}function Gc(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Ls=n=>typeof n<"u",En=n=>typeof n=="function",eh=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function Dy(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const st=Math.PI,dt=2*st,My=dt+st,oo=Number.POSITIVE_INFINITY,Oy=st/180,Et=st/2,Ln=st/4,nh=st*2/3,ln=Math.log10,ve=Math.sign;function Is(n,t,e){return Math.abs(n-t)<e}function ih(n){const t=Math.round(n);n=Is(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(ln(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function Ny(n){const t=[],e=Math.sqrt(n);let i;for(i=1;i<e;i++)n%i===0&&(t.push(i),t.push(n/i));return e===(e|0)&&t.push(e),t.sort((s,r)=>s-r).pop(),t}function Vy(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Pi(n){return!Vy(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function Ly(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function tg(n,t,e){let i,s,r;for(i=0,s=n.length;i<s;i++)r=n[i][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function le(n){return n*(st/180)}function Yc(n){return n*(180/st)}function sh(n){if(!vt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function eg(n,t){const e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);let r=Math.atan2(i,e);return r<-.5*st&&(r+=dt),{angle:r,distance:s}}function rc(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function Fy(n,t){return(n-t+My)%dt-st}function zt(n){return(n%dt+dt)%dt}function Fs(n,t,e,i){const s=zt(n),r=zt(t),o=zt(e),a=zt(r-s),c=zt(o-s),u=zt(s-r),h=zt(s-o);return s===r||s===o||i&&r===o||a>c&&u<h}function Rt(n,t,e){return Math.max(t,Math.min(e,n))}function By(n){return Rt(n,-32768,32767)}function Ve(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function Kc(n,t,e){e=e||(o=>n[o]<t);let i=n.length-1,s=0,r;for(;i-s>1;)r=s+i>>1,e(r)?s=r:i=r;return{lo:s,hi:i}}const Le=(n,t,e,i)=>Kc(n,e,i?s=>{const r=n[s][t];return r<e||r===e&&n[s+1][t]===e}:s=>n[s][t]<e),Uy=(n,t,e)=>Kc(n,e,i=>n[i][t]>=e);function zy(n,t,e){let i=0,s=n.length;for(;i<s&&n[i]<t;)i++;for(;s>i&&n[s-1]>e;)s--;return i>0||s<n.length?n.slice(i,s):n}const ng=["push","pop","shift","splice","unshift"];function Wy(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),ng.forEach(e=>{const i="_onData"+Gc(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...r)}),o}})})}function rh(n,t){const e=n._chartjs;if(!e)return;const i=e.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(ng.forEach(r=>{delete n[r]}),delete n._chartjs)}function ig(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const sg=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function rg(n,t){let e=[],i=!1;return function(...s){e=s,i||(i=!0,sg.call(window,()=>{i=!1,n.apply(t,e)}))}}function jy(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}const Xc=n=>n==="start"?"left":n==="end"?"right":"center",Bt=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,Hy=(n,t,e,i)=>n===(i?"left":"right")?e:n==="center"?(t+e)/2:t;function og(n,t,e){const i=t.length;let s=0,r=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:c}=n,u=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:d,max:g,minDefined:m,maxDefined:y}=o.getUserBounds();if(m){if(s=Math.min(Le(c,h,d).lo,e?i:Le(t,h,o.getPixelForValue(d)).lo),u){const v=c.slice(0,s+1).reverse().findIndex(w=>!Q(w[a.axis]));s-=Math.max(0,v)}s=Rt(s,0,i-1)}if(y){let v=Math.max(Le(c,o.axis,g,!0).hi+1,e?0:Le(t,h,o.getPixelForValue(g),!0).hi+1);if(u){const w=c.slice(v-1).findIndex(P=>!Q(P[a.axis]));v+=Math.max(0,w)}r=Rt(v,s,i)-s}else r=i-s}return{start:s,count:r}}function ag(n){const{xScale:t,yScale:e,_scaleRanges:i}=n,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=s,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,s),r}const xr=n=>n===0||n===1,oh=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*dt/e)),ah=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*dt/e)+1,Ss={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Et)+1,easeOutSine:n=>Math.sin(n*Et),easeInOutSine:n=>-.5*(Math.cos(st*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>xr(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>xr(n)?n:oh(n,.075,.3),easeOutElastic:n=>xr(n)?n:ah(n,.075,.3),easeInOutElastic(n){return xr(n)?n:n<.5?.5*oh(n*2,.1125,.45):.5+.5*ah(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Ss.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Ss.easeInBounce(n*2)*.5:Ss.easeOutBounce(n*2-1)*.5+.5};function Qc(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ch(n){return Qc(n)?n:new Ns(n)}function Ra(n){return Qc(n)?n:new Ns(n).saturate(.5).darken(.1).hexString()}const $y=["x","y","borderWidth","radius","tension"],qy=["color","borderColor","backgroundColor"];function Gy(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:qy},numbers:{type:"number",properties:$y}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Yy(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const lh=new Map;function Ky(n,t){t=t||{};const e=n+JSON.stringify(t);let i=lh.get(e);return i||(i=new Intl.NumberFormat(n,t),lh.set(e,i)),i}function Zs(n,t,e){return Ky(t,e).format(n)}const cg={values(n){return ft(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const i=this.chart.options.locale;let s,r=n;if(e.length>1){const u=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(u<1e-4||u>1e15)&&(s="scientific"),r=Xy(n,e)}const o=ln(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Zs(n,i,c)},logarithmic(n,t,e){if(n===0)return"0";const i=e[t].significand||n/Math.pow(10,Math.floor(ln(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?cg.numeric.call(this,n,t,e):""}};function Xy(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var No={formatters:cg};function Qy(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:No.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Zn=Object.create(null),oc=Object.create(null);function xs(n,t){if(!t)return n;const e=t.split(".");for(let i=0,s=e.length;i<s;++i){const r=e[i];n=n[r]||(n[r]=Object.create(null))}return n}function Da(n,t,e){return typeof t=="string"?Vs(xs(n,t),e):Vs(xs(n,""),t)}class Jy{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>Ra(s.backgroundColor),this.hoverBorderColor=(i,s)=>Ra(s.borderColor),this.hoverColor=(i,s)=>Ra(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Da(this,t,e)}get(t){return xs(this,t)}describe(t,e){return Da(oc,t,e)}override(t,e){return Da(Zn,t,e)}route(t,e,i,s){const r=xs(this,t),o=xs(this,i),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const c=this[a],u=o[s];return nt(c)?Object.assign({},u,c):G(c,u)},set(c){this[a]=c}}})}apply(t){t.forEach(e=>e(this))}}var gt=new Jy({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Gy,Yy,Qy]);function Zy(n){return!n||Q(n.size)||Q(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function ao(n,t,e,i,s){let r=t[s];return r||(r=t[s]=n.measureText(s).width,e.push(s)),r>i&&(i=r),i}function tb(n,t,e,i){i=i||{};let s=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},r=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let o=0;const a=e.length;let c,u,h,d,g;for(c=0;c<a;c++)if(d=e[c],d!=null&&!ft(d))o=ao(n,s,r,o,d);else if(ft(d))for(u=0,h=d.length;u<h;u++)g=d[u],g!=null&&!ft(g)&&(o=ao(n,s,r,o,g));n.restore();const m=r.length/2;if(m>e.length){for(c=0;c<m;c++)delete s[r[c]];r.splice(0,m)}return o}function Fn(n,t,e){const i=n.currentDevicePixelRatio,s=e!==0?Math.max(e/2,.5):0;return Math.round((t-s)*i)/i+s}function uh(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function ac(n,t,e,i){lg(n,t,e,i,null)}function lg(n,t,e,i,s){let r,o,a,c,u,h,d,g;const m=t.pointStyle,y=t.rotation,v=t.radius;let w=(y||0)*Oy;if(m&&typeof m=="object"&&(r=m.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,i),n.rotate(w),n.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),m){default:s?n.ellipse(e,i,s/2,v,0,0,dt):n.arc(e,i,v,0,dt),n.closePath();break;case"triangle":h=s?s/2:v,n.moveTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=nh,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=nh,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),n.closePath();break;case"rectRounded":u=v*.516,c=v-u,o=Math.cos(w+Ln)*c,d=Math.cos(w+Ln)*(s?s/2-u:c),a=Math.sin(w+Ln)*c,g=Math.sin(w+Ln)*(s?s/2-u:c),n.arc(e-d,i-a,u,w-st,w-Et),n.arc(e+g,i-o,u,w-Et,w),n.arc(e+d,i+a,u,w,w+Et),n.arc(e-g,i+o,u,w+Et,w+st),n.closePath();break;case"rect":if(!y){c=Math.SQRT1_2*v,h=s?s/2:c,n.rect(e-h,i-c,2*h,2*c);break}w+=Ln;case"rectRot":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+g,i-o),n.lineTo(e+d,i+a),n.lineTo(e-g,i+o),n.closePath();break;case"crossRot":w+=Ln;case"cross":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"star":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o),w+=Ln,d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"line":o=s?s/2:Math.cos(w)*v,a=Math.sin(w)*v,n.moveTo(e-o,i-a),n.lineTo(e+o,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(w)*(s?s/2:v),i+Math.sin(w)*v);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function Fe(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function Vo(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Lo(n){n.restore()}function eb(n,t,e,i,s){if(!t)return n.lineTo(e.x,e.y);if(s==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else s==="after"!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function nb(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function ib(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Q(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function sb(n,t,e,i,s){if(s.strikethrough||s.underline){const r=n.measureText(i),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,c=e-r.actualBoundingBoxAscent,u=e+r.actualBoundingBoxDescent,h=s.strikethrough?(c+u)/2:u;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function rb(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function ti(n,t,e,i,s,r={}){const o=ft(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let c,u;for(n.save(),n.font=s.string,ib(n,r),c=0;c<o.length;++c)u=o[c],r.backdrop&&rb(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Q(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(u,e,i,r.maxWidth)),n.fillText(u,e,i,r.maxWidth),sb(n,e,i,u,r),i+=Number(s.lineHeight);n.restore()}function Bs(n,t){const{x:e,y:i,w:s,h:r,radius:o}=t;n.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*st,st,!0),n.lineTo(e,i+r-o.bottomLeft),n.arc(e+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,st,Et,!0),n.lineTo(e+s-o.bottomRight,i+r),n.arc(e+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,Et,0,!0),n.lineTo(e+s,i+o.topRight),n.arc(e+s-o.topRight,i+o.topRight,o.topRight,0,-Et,!0),n.lineTo(e+o.topLeft,i)}const ob=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ab=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function cb(n,t){const e=(""+n).match(ob);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const lb=n=>+n||0;function Jc(n,t){const e={},i=nt(t),s=i?Object.keys(t):t,r=nt(n)?i?o=>G(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of s)e[o]=lb(r(o));return e}function ug(n){return Jc(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Kn(n){return Jc(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ht(n){const t=ug(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function At(n,t){n=n||{},t=t||gt.font;let e=G(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=G(n.style,t.style);i&&!(""+i).match(ab)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:G(n.family,t.family),lineHeight:cb(G(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:G(n.weight,t.weight),string:""};return s.string=Zy(s),s}function ms(n,t,e,i){let s,r,o;for(s=0,r=n.length;s<r;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function ub(n,t,e){const{min:i,max:s}=n,r=Jf(t,(s-i)/2),o=(a,c)=>e&&a===0?0:a+c;return{min:o(i,-Math.abs(r)),max:o(s,r)}}function Cn(n,t){return Object.assign(Object.create(n),t)}function Zc(n,t=[""],e,i,s=()=>n[0]){const r=e||n;typeof i>"u"&&(i=gg("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:i,_getTarget:s,override:a=>Zc([a,...n],t,r,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return dg(a,c,()=>yb(c,t,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return dh(a).includes(c)},ownKeys(a){return dh(a)},set(a,c,u){const h=a._storage||(a._storage=s());return a[c]=h[c]=u,delete a._keys,!0}})}function Ci(n,t,e,i){const s={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:hg(n,i),setContext:r=>Ci(n,r,e,i),override:r=>Ci(n.override(r),t,e,i)};return new Proxy(s,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return dg(r,o,()=>db(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function hg(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=n;return{allKeys:s,scriptable:e,indexable:i,isScriptable:En(e)?e:()=>e,isIndexable:En(i)?i:()=>i}}const hb=(n,t)=>n?n+Gc(t):t,tl=(n,t)=>nt(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function dg(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const i=e();return n[t]=i,i}function db(n,t,e){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=n;let a=i[t];return En(a)&&o.isScriptable(t)&&(a=fb(t,a,n,e)),ft(a)&&a.length&&(a=gb(t,a,n,o.isIndexable)),tl(t,a)&&(a=Ci(a,s,r&&r[t],o)),a}function fb(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=t(r,o||i);return a.delete(n),tl(n,c)&&(c=el(s._scopes,s,n,c)),c}function gb(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&i(n))return t[r.index%t.length];if(nt(t[0])){const c=t,u=s._scopes.filter(h=>h!==c);t=[];for(const h of c){const d=el(u,s,n,h);t.push(Ci(d,r,o&&o[n],a))}}return t}function fg(n,t,e){return En(n)?n(t,e):n}const pb=(n,t)=>n===!0?t:typeof n=="string"?wn(t,n):void 0;function mb(n,t,e,i,s){for(const r of t){const o=pb(e,r);if(o){n.add(o);const a=fg(o._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(o===!1&&typeof i<"u"&&e!==i)return null}return!1}function el(n,t,e,i){const s=t._rootScopes,r=fg(t._fallback,e,i),o=[...n,...s],a=new Set;a.add(i);let c=hh(a,o,e,r||e,i);return c===null||typeof r<"u"&&r!==e&&(c=hh(a,o,r,c,i),c===null)?!1:Zc(Array.from(a),[""],s,r,()=>_b(t,e,i))}function hh(n,t,e,i,s){for(;e;)e=mb(n,t,e,i,s);return e}function _b(n,t,e){const i=n._getTarget();t in i||(i[t]={});const s=i[t];return ft(s)&&nt(e)?e:s||{}}function yb(n,t,e,i){let s;for(const r of t)if(s=gg(hb(r,n),e),typeof s<"u")return tl(n,s)?el(e,i,n,s):s}function gg(n,t){for(const e of t){if(!e)continue;const i=e[n];if(typeof i<"u")return i}}function dh(n){let t=n._keys;return t||(t=n._keys=bb(n._scopes)),t}function bb(n){const t=new Set;for(const e of n)for(const i of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function pg(n,t,e,i){const{iScale:s}=n,{key:r="r"}=this._parsing,o=new Array(i);let a,c,u,h;for(a=0,c=i;a<c;++a)u=a+e,h=t[u],o[a]={r:s.parse(wn(h,r),u)};return o}const vb=Number.EPSILON||1e-14,ki=(n,t)=>t<n.length&&!n[t].skip&&n[t],mg=n=>n==="x"?"y":"x";function wb(n,t,e,i){const s=n.skip?t:n,r=t,o=e.skip?t:e,a=rc(r,s),c=rc(o,r);let u=a/(a+c),h=c/(a+c);u=isNaN(u)?0:u,h=isNaN(h)?0:h;const d=i*u,g=i*h;return{previous:{x:r.x-d*(o.x-s.x),y:r.y-d*(o.y-s.y)},next:{x:r.x+g*(o.x-s.x),y:r.y+g*(o.y-s.y)}}}function Eb(n,t,e){const i=n.length;let s,r,o,a,c,u=ki(n,0);for(let h=0;h<i-1;++h)if(c=u,u=ki(n,h+1),!(!c||!u)){if(Is(t[h],0,vb)){e[h]=e[h+1]=0;continue}s=e[h]/t[h],r=e[h+1]/t[h],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=s*o*t[h],e[h+1]=r*o*t[h])}}function Tb(n,t,e="x"){const i=mg(e),s=n.length;let r,o,a,c=ki(n,0);for(let u=0;u<s;++u){if(o=a,a=c,c=ki(n,u+1),!a)continue;const h=a[e],d=a[i];o&&(r=(h-o[e])/3,a[`cp1${e}`]=h-r,a[`cp1${i}`]=d-r*t[u]),c&&(r=(c[e]-h)/3,a[`cp2${e}`]=h+r,a[`cp2${i}`]=d+r*t[u])}}function Ib(n,t="x"){const e=mg(t),i=n.length,s=Array(i).fill(0),r=Array(i);let o,a,c,u=ki(n,0);for(o=0;o<i;++o)if(a=c,c=u,u=ki(n,o+1),!!c){if(u){const h=u[t]-c[t];s[o]=h!==0?(u[e]-c[e])/h:0}r[o]=a?u?ve(s[o-1])!==ve(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}Eb(n,s,r),Tb(n,r,t)}function Ar(n,t,e){return Math.max(Math.min(n,e),t)}function Sb(n,t){let e,i,s,r,o,a=Fe(n[0],t);for(e=0,i=n.length;e<i;++e)o=r,r=a,a=e<i-1&&Fe(n[e+1],t),r&&(s=n[e],o&&(s.cp1x=Ar(s.cp1x,t.left,t.right),s.cp1y=Ar(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=Ar(s.cp2x,t.left,t.right),s.cp2y=Ar(s.cp2y,t.top,t.bottom)))}function xb(n,t,e,i,s){let r,o,a,c;if(t.spanGaps&&(n=n.filter(u=>!u.skip)),t.cubicInterpolationMode==="monotone")Ib(n,s);else{let u=i?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],c=wb(u,a,n[Math.min(r+1,o-(i?0:1))%o],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,u=a}t.capBezierPoints&&Sb(n,e)}function nl(){return typeof window<"u"&&typeof document<"u"}function il(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function co(n,t,e){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=n,i}const Fo=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Ab(n,t){return Fo(n).getPropertyValue(t)}const Pb=["top","right","bottom","left"];function Xn(n,t,e){const i={};e=e?"-"+e:"";for(let s=0;s<4;s++){const r=Pb[s];i[r]=parseFloat(n[t+"-"+r+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Cb=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function kb(n,t){const e=n.touches,i=e&&e.length?e[0]:n,{offsetX:s,offsetY:r}=i;let o=!1,a,c;if(Cb(s,r,n.target))a=s,c=r;else{const u=t.getBoundingClientRect();a=i.clientX-u.left,c=i.clientY-u.top,o=!0}return{x:a,y:c,box:o}}function zn(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:i}=t,s=Fo(e),r=s.boxSizing==="border-box",o=Xn(s,"padding"),a=Xn(s,"border","width"),{x:c,y:u,box:h}=kb(n,e),d=o.left+(h&&a.left),g=o.top+(h&&a.top);let{width:m,height:y}=t;return r&&(m-=o.width+a.width,y-=o.height+a.height),{x:Math.round((c-d)/m*e.width/i),y:Math.round((u-g)/y*e.height/i)}}function Rb(n,t,e){let i,s;if(t===void 0||e===void 0){const r=n&&il(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=Fo(r),c=Xn(a,"border","width"),u=Xn(a,"padding");t=o.width-u.width-c.width,e=o.height-u.height-c.height,i=co(a.maxWidth,r,"clientWidth"),s=co(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:i||oo,maxHeight:s||oo}}const un=n=>Math.round(n*10)/10;function Db(n,t,e,i){const s=Fo(n),r=Xn(s,"margin"),o=co(s.maxWidth,n,"clientWidth")||oo,a=co(s.maxHeight,n,"clientHeight")||oo,c=Rb(n,t,e);let{width:u,height:h}=c;if(s.boxSizing==="content-box"){const g=Xn(s,"border","width"),m=Xn(s,"padding");u-=m.width+g.width,h-=m.height+g.height}return u=Math.max(0,u-r.width),h=Math.max(0,i?u/i:h-r.height),u=un(Math.min(u,o,c.maxWidth)),h=un(Math.min(h,a,c.maxHeight)),u&&!h&&(h=un(u/2)),(t!==void 0||e!==void 0)&&i&&c.height&&h>c.height&&(h=c.height,u=un(Math.floor(h*i))),{width:u,height:h}}function fh(n,t,e){const i=t||1,s=un(n.height*i),r=un(n.width*i);n.height=un(n.height),n.width=un(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==s||o.width!==r?(n.currentDevicePixelRatio=i,o.height=s,o.width=r,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const Mb=(function(){let n=!1;try{const t={get passive(){return n=!0,!1}};nl()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n})();function gh(n,t){const e=Ab(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Wn(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function Ob(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:i==="middle"?e<.5?n.y:t.y:i==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function Nb(n,t,e,i){const s={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Wn(n,s,e),a=Wn(s,r,e),c=Wn(r,t,e),u=Wn(o,a,e),h=Wn(a,c,e);return Wn(u,h,e)}const Vb=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},Lb=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function Ei(n,t,e){return n?Vb(t,e):Lb()}function _g(n,t){let e,i;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function yg(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function bg(n){return n==="angle"?{between:Fs,compare:Fy,normalize:zt}:{between:Ve,compare:(t,e)=>t-e,normalize:t=>t}}function ph({start:n,end:t,count:e,loop:i,style:s}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e===0,style:s}}function Fb(n,t,e){const{property:i,start:s,end:r}=e,{between:o,normalize:a}=bg(i),c=t.length;let{start:u,end:h,loop:d}=n,g,m;if(d){for(u+=c,h+=c,g=0,m=c;g<m&&o(a(t[u%c][i]),s,r);++g)u--,h--;u%=c,h%=c}return h<u&&(h+=c),{start:u,end:h,loop:d,style:n.style}}function vg(n,t,e){if(!e)return[n];const{property:i,start:s,end:r}=e,o=t.length,{compare:a,between:c,normalize:u}=bg(i),{start:h,end:d,loop:g,style:m}=Fb(n,t,e),y=[];let v=!1,w=null,P,C,D;const O=()=>c(s,D,P)&&a(s,D)!==0,M=()=>a(r,P)===0||c(r,D,P),L=()=>v||O(),I=()=>!v||M();for(let b=h,T=h;b<=d;++b)C=t[b%o],!C.skip&&(P=u(C[i]),P!==D&&(v=c(P,s,r),w===null&&L()&&(w=a(P,s)===0?b:T),w!==null&&I()&&(y.push(ph({start:w,end:b,loop:g,count:o,style:m})),w=null),T=b,D=P));return w!==null&&y.push(ph({start:w,end:d,loop:g,count:o,style:m})),y}function wg(n,t){const e=[],i=n.segments;for(let s=0;s<i.length;s++){const r=vg(i[s],n.points,t);r.length&&e.push(...r)}return e}function Bb(n,t,e,i){let s=0,r=t-1;if(e&&!i)for(;s<t&&!n[s].skip;)s++;for(;s<t&&n[s].skip;)s++;for(s%=t,e&&(r+=s);r>s&&n[r%t].skip;)r--;return r%=t,{start:s,end:r}}function Ub(n,t,e,i){const s=n.length,r=[];let o=t,a=n[t],c;for(c=t+1;c<=e;++c){const u=n[c%s];u.skip||u.stop?a.skip||(i=!1,r.push({start:t%s,end:(c-1)%s,loop:i}),t=o=u.stop?c:null):(o=c,a.skip&&(t=c)),a=u}return o!==null&&r.push({start:t%s,end:o%s,loop:i}),r}function zb(n,t){const e=n.points,i=n.options.spanGaps,s=e.length;if(!s)return[];const r=!!n._loop,{start:o,end:a}=Bb(e,s,r,i);if(i===!0)return mh(n,[{start:o,end:a,loop:r}],e,t);const c=a<o?a+s:a,u=!!n._fullLoop&&o===0&&a===s-1;return mh(n,Ub(e,o,c,u),e,t)}function mh(n,t,e,i){return!i||!i.setContext||!e?t:Wb(n,t,e,i)}function Wb(n,t,e,i){const s=n._chart.getContext(),r=_h(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=e.length,u=[];let h=r,d=t[0].start,g=d;function m(y,v,w,P){const C=a?-1:1;if(y!==v){for(y+=c;e[y%c].skip;)y-=C;for(;e[v%c].skip;)v+=C;y%c!==v%c&&(u.push({start:y%c,end:v%c,loop:w,style:P}),h=P,d=v%c)}}for(const y of t){d=a?d:y.start;let v=e[d%c],w;for(g=d+1;g<=y.end;g++){const P=e[g%c];w=_h(i.setContext(Cn(s,{type:"segment",p0:v,p1:P,p0DataIndex:(g-1)%c,p1DataIndex:g%c,datasetIndex:o}))),jb(w,h)&&m(d,g-1,y.loop,h),v=P,h=w}d<g-1&&m(d,g-1,y.loop,h)}return u}function _h(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function jb(n,t){if(!t)return!1;const e=[],i=function(s,r){return Qc(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,i)!==JSON.stringify(t,i)}function Pr(n,t,e){return n.options.clip?n[e]:t[e]}function Hb(n,t){const{xScale:e,yScale:i}=n;return e&&i?{left:Pr(e,t,"left"),right:Pr(e,t,"right"),top:Pr(i,t,"top"),bottom:Pr(i,t,"bottom")}:t}function Eg(n,t){const e=t._clip;if(e.disabled)return!1;const i=Hb(t,n.chartArea);return{left:e.left===!1?0:i.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:i.right+(e.right===!0?0:e.right),top:e.top===!1?0:i.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:i.bottom+(e.bottom===!0?0:e.bottom)}}class $b{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const r=e.listeners[s],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=sg.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const r=i.items;let o=r.length-1,a=!1,c;for(;o>=0;--o)c=r[o],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),r.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var De=new $b;const yh="transparent",qb={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const i=ch(n||yh),s=i.valid&&ch(t||yh);return s&&s.valid?s.mix(i,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class Gb{constructor(t,e,i,s){const r=e[i];s=ms([t.to,s,r,t.from]);const o=ms([t.from,r,s]);this._active=!0,this._fn=t.fn||qb[t.type||typeof o],this._easing=Ss[t.easing]||Ss.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=ms([t.to,e,s,t.from]),this._from=ms([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let c;if(this._active=r!==a&&(o||e<i),!this._active){this._target[s]=a,this._notify(!0);return}if(e<0){this._target[s]=r;return}c=e/i%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(r,a,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][e]()}}class Tg{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!nt(t))return;const e=Object.keys(gt.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const r=t[s];if(!nt(r))return;const o={};for(const a of e)o[a]=r[a];(ft(r.properties)&&r.properties||[s]).forEach(a=>{(a===s||!i.has(a))&&i.set(a,o)})})}_animateOptions(t,e){const i=e.options,s=Kb(t,i);if(!s)return[];const r=this._createAnimations(s,i);return i.$shared&&Yb(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,e){const i=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){s.push(...this._animateOptions(t,e));continue}const h=e[u];let d=r[u];const g=i.get(u);if(d)if(g&&d.active()){d.update(g,h,a);continue}else d.cancel();if(!g||!g.duration){t[u]=h;continue}r[u]=d=new Gb(g,t,u,h),s.push(d)}return s}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const i=this._createAnimations(t,e);if(i.length)return De.add(this._chart,i),!0}}function Yb(n,t){const e=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const r=n[i[s]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function Kb(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function bh(n,t){const e=n&&n.options||{},i=e.reverse,s=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:i?r:s,end:i?s:r}}function Xb(n,t,e){if(e===!1)return!1;const i=bh(n,e),s=bh(t,e);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function Qb(n){let t,e,i,s;return nt(n)?(t=n.top,e=n.right,i=n.bottom,s=n.left):t=e=i=s=n,{top:t,right:e,bottom:i,left:s,disabled:n===!1}}function Ig(n,t){const e=[],i=n._getSortedDatasetMetas(t);let s,r;for(s=0,r=i.length;s<r;++s)e.push(i[s].index);return e}function vh(n,t,e,i={}){const s=n.keys,r=i.mode==="single";let o,a,c,u;if(t===null)return;let h=!1;for(o=0,a=s.length;o<a;++o){if(c=+s[o],c===e){if(h=!0,i.all)continue;break}u=n.values[c],vt(u)&&(r||t===0||ve(t)===ve(u))&&(t+=u)}return!h&&!i.all?0:t}function Jb(n,t){const{iScale:e,vScale:i}=t,s=e.axis==="x"?"x":"y",r=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let c,u,h;for(c=0,u=o.length;c<u;++c)h=o[c],a[c]={[s]:h,[r]:n[h]};return a}function Ma(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function Zb(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function tv(n){const{min:t,max:e,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}function ev(n,t,e){const i=n[t]||(n[t]={});return i[e]||(i[e]={})}function wh(n,t,e,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const r=n[s.index];if(e&&r>0||!e&&r<0)return s.index}return null}function Eh(n,t){const{chart:e,_cachedMeta:i}=n,s=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=i,c=r.axis,u=o.axis,h=Zb(r,o,i),d=t.length;let g;for(let m=0;m<d;++m){const y=t[m],{[c]:v,[u]:w}=y,P=y._stacks||(y._stacks={});g=P[u]=ev(s,h,v),g[a]=w,g._top=wh(g,o,!0,i.type),g._bottom=wh(g,o,!1,i.type);const C=g._visualValues||(g._visualValues={});C[a]=w}}function Oa(n,t){const e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function nv(n,t){return Cn(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function iv(n,t,e){return Cn(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function ls(n,t){const e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(const s of t){const r=s._stacks;if(!r||r[i]===void 0||r[i][e]===void 0)return;delete r[i][e],r[i]._visualValues!==void 0&&r[i]._visualValues[e]!==void 0&&delete r[i]._visualValues[e]}}}const Na=n=>n==="reset"||n==="none",Th=(n,t)=>t?n:Object.assign({},n),sv=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:Ig(e,!0),values:null};class kn{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ma(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&ls(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),s=(d,g,m,y)=>d==="x"?g:d==="r"?y:m,r=e.xAxisID=G(i.xAxisID,Oa(t,"x")),o=e.yAxisID=G(i.yAxisID,Oa(t,"y")),a=e.rAxisID=G(i.rAxisID,Oa(t,"r")),c=e.indexAxis,u=e.iAxisID=s(c,r,o,a),h=e.vAxisID=s(c,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(u),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&rh(this._data,this),t._stacked&&ls(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(nt(e)){const s=this._cachedMeta;this._data=Jb(e,s)}else if(i!==e){if(i){rh(i,this);const s=this._cachedMeta;ls(s),s._parsed=[]}e&&Object.isExtensible(e)&&Wy(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const r=e._stacked;e._stacked=Ma(e.vScale,e),e.stack!==i.stack&&(s=!0,ls(e),e.stack=i.stack),this._resyncElements(t),(s||r!==e._stacked)&&(Eh(this,e._parsed),e._stacked=Ma(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:s}=this,{iScale:r,_stacked:o}=i,a=r.axis;let c=t===0&&e===s.length?!0:i._sorted,u=t>0&&i._parsed[t-1],h,d,g;if(this._parsing===!1)i._parsed=s,i._sorted=!0,g=s;else{ft(s[t])?g=this.parseArrayData(i,s,t,e):nt(s[t])?g=this.parseObjectData(i,s,t,e):g=this.parsePrimitiveData(i,s,t,e);const m=()=>d[a]===null||u&&d[a]<u[a];for(h=0;h<e;++h)i._parsed[h+t]=d=g[h],c&&(m()&&(c=!1),u=d);i._sorted=c}o&&Eh(this,g)}parsePrimitiveData(t,e,i,s){const{iScale:r,vScale:o}=t,a=r.axis,c=o.axis,u=r.getLabels(),h=r===o,d=new Array(s);let g,m,y;for(g=0,m=s;g<m;++g)y=g+i,d[g]={[a]:h||r.parse(u[y],y),[c]:o.parse(e[y],y)};return d}parseArrayData(t,e,i,s){const{xScale:r,yScale:o}=t,a=new Array(s);let c,u,h,d;for(c=0,u=s;c<u;++c)h=c+i,d=e[h],a[c]={x:r.parse(d[0],h),y:o.parse(d[1],h)};return a}parseObjectData(t,e,i,s){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,u=new Array(s);let h,d,g,m;for(h=0,d=s;h<d;++h)g=h+i,m=e[g],u[h]={x:r.parse(wn(m,a),g),y:o.parse(wn(m,c),g)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const s=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:Ig(s,!0),values:e._stacks[t.axis]._visualValues};return vh(a,o,r.index,{mode:i})}updateRangeFromParsed(t,e,i,s){const r=i[e.axis];let o=r===null?NaN:r;const a=s&&i._stacks[e.axis];s&&a&&(s.values=a,o=vh(s,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const i=this._cachedMeta,s=i._parsed,r=i._sorted&&t===i.iScale,o=s.length,a=this._getOtherScale(t),c=sv(e,i,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=tv(a);let g,m;function y(){m=s[g];const v=m[a.axis];return!vt(m[t.axis])||h>v||d<v}for(g=0;g<o&&!(!y()&&(this.updateRangeFromParsed(u,t,m,c),r));++g);if(r){for(g=o-1;g>=0;--g)if(!y()){this.updateRangeFromParsed(u,t,m,c);break}}return u}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let s,r,o;for(s=0,r=e.length;s<r;++s)o=e[s][t.axis],vt(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,s=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Qb(G(this.options.clip,Xb(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,s=i.data||[],r=e.chartArea,o=[],a=this._drawStart||0,c=this._drawCount||s.length-a,u=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,r,a,c),h=a;h<a+c;++h){const d=s[h];d.hidden||(d.active&&u?o.push(d):d.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const s=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=iv(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=s.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=nv(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const s=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],c=this.enableOptionSharing&&Ls(i);if(a)return Th(a,c);const u=this.chart.config,h=u.datasetElementScopeKeys(this._type,t),d=s?[`${t}Hover`,"hover",t,""]:[t,""],g=u.getOptionScopes(this.getDataset(),h),m=Object.keys(gt.elements[t]),y=()=>this.getContext(i,s,e),v=u.resolveNamedOptions(g,m,y,d);return v.$shared&&(v.$shared=c,r[o]=Object.freeze(Th(v,c))),v}_resolveAnimations(t,e,i){const s=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let c;if(s.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,e),g=h.getOptionScopes(this.getDataset(),d);c=h.createResolver(g,this.getContext(t,i,e))}const u=new Tg(s,c&&c.animations);return c&&c._cacheable&&(r[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Na(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),s=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(e,r)||r!==s;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:o}}updateElement(t,e,i,s){Na(s)?Object.assign(t,i):this._resolveAnimations(e,s).update(t,i)}updateSharedOptions(t,e,i){t&&!Na(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,s){t.active=s;const r=this.getStyle(e,s);this._resolveAnimations(e,i,s).update(t,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[a,c,u]of this._syncList)this[a](c,u);this._syncList=[];const s=i.length,r=e.length,o=Math.min(r,s);o&&this.parse(0,o),r>s?this._insertElements(s,r-s,t):r<s&&this._removeElements(r,s-r)}_insertElements(t,e,i=!0){const s=this._cachedMeta,r=s.data,o=t+e;let a;const c=u=>{for(u.length+=e,a=u.length-1;a>=o;a--)u[a]=u[a-e]};for(c(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,s){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,e);i._stacked&&ls(i,s)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,s]=t;this[e](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function rv(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let i=[];for(let s=0,r=e.length;s<r;s++)i=i.concat(e[s].controller.getAllParsedValues(n));n._cache.$bar=ig(i.sort((s,r)=>s-r))}return n._cache.$bar}function ov(n){const t=n.iScale,e=rv(t,n.type);let i=t._length,s,r,o,a;const c=()=>{o===32767||o===-32768||(Ls(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(s=0,r=e.length;s<r;++s)o=t.getPixelForValue(e[s]),c();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),c();return i}function av(n,t,e,i){const s=e.barThickness;let r,o;return Q(s)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[n]-r/2}}function cv(n,t,e,i){const s=t.pixels,r=s[n];let o=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const c=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const u=r-(r-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:e.barPercentage,start:u}}function lv(n,t,e,i){const s=e.parse(n[0],i),r=e.parse(n[1],i),o=Math.min(s,r),a=Math.max(s,r);let c=o,u=a;Math.abs(o)>Math.abs(a)&&(c=a,u=o),t[e.axis]=u,t._custom={barStart:c,barEnd:u,start:s,end:r,min:o,max:a}}function Sg(n,t,e,i){return ft(n)?lv(n,t,e,i):t[e.axis]=e.parse(n,i),t}function Ih(n,t,e,i){const s=n.iScale,r=n.vScale,o=s.getLabels(),a=s===r,c=[];let u,h,d,g;for(u=e,h=e+i;u<h;++u)g=t[u],d={},d[s.axis]=a||s.parse(o[u],u),c.push(Sg(g,d,r,u));return c}function Va(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function uv(n,t,e){return n!==0?ve(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function hv(n){let t,e,i,s,r;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(s="end",r="start"):(s="start",r="end"),{start:e,end:i,reverse:t,top:s,bottom:r}}function dv(n,t,e,i){let s=t.borderSkipped;const r={};if(!s){n.borderSkipped=r;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:c,top:u,bottom:h}=hv(n);s==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?s=u:(e._bottom||0)===i?s=h:(r[Sh(h,o,a,c)]=!0,s=u)),r[Sh(s,o,a,c)]=!0,n.borderSkipped=r}function Sh(n,t,e,i){return i?(n=fv(n,t,e),n=xh(n,e,t)):n=xh(n,t,e),n}function fv(n,t,e){return n===t?e:n===e?t:n}function xh(n,t,e){return n==="start"?t:n==="end"?e:n}function gv(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class pv extends kn{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,s){return Ih(t,e,i,s)}parseArrayData(t,e,i,s){return Ih(t,e,i,s)}parseObjectData(t,e,i,s){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,u=r.axis==="x"?a:c,h=o.axis==="x"?a:c,d=[];let g,m,y,v;for(g=i,m=i+s;g<m;++g)v=e[g],y={},y[r.axis]=r.parse(wn(v,u),g),d.push(Sg(wn(v,h),y,o,g));return d}updateRangeFromParsed(t,e,i,s){super.updateRangeFromParsed(t,e,i,s);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:s}=e,r=this.getParsed(t),o=r._custom,a=Va(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(r[s.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,s){const r=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,c=a.getBasePixel(),u=a.isHorizontal(),h=this._getRuler(),{sharedOptions:d,includeOptions:g}=this._getSharedOptions(e,s);for(let m=e;m<e+i;m++){const y=this.getParsed(m),v=r||Q(y[a.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),w=this._calculateBarIndexPixels(m,h),P=(y._stacks||{})[a.axis],C={horizontal:u,base:v.base,enableBorderRadius:!P||Va(y._custom)||o===P._top||o===P._bottom,x:u?v.head:w.center,y:u?w.center:v.head,height:u?w.size:Math.abs(v.size),width:u?Math.abs(v.size):w.size};g&&(C.options=d||this.resolveDataElementOptions(m,t[m].active?"active":s));const D=C.options||t[m].options;dv(C,D,P,o),gv(C,D,h.ratio),this.updateElement(t[m],m,C,s)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),c=a&&a[i.axis],u=h=>{const d=h._parsed.find(m=>m[i.axis]===c),g=d&&d[h.vScale.axis];if(Q(g)||isNaN(g))return!0};for(const h of s)if(!(e!==void 0&&u(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[G(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,i){const s=this._getStacks(t,i),r=e!==void 0?s.indexOf(e):-1;return r===-1?s.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,s=[];let r,o;for(r=0,o=e.data.length;r<o;++r)s.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||ov(e),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:s},options:{base:r,minBarLength:o}}=this,a=r||0,c=this.getParsed(t),u=c._custom,h=Va(u);let d=c[e.axis],g=0,m=i?this.applyStack(e,c,i):d,y,v;m!==d&&(g=m-d,m=d),h&&(d=u.barStart,m=u.barEnd-u.barStart,d!==0&&ve(d)!==ve(u.barEnd)&&(g=0),g+=d);const w=!Q(r)&&!h?r:g;let P=e.getPixelForValue(w);if(this.chart.getDataVisibility(t)?y=e.getPixelForValue(g+m):y=P,v=y-P,Math.abs(v)<o){v=uv(v,e,a)*o,d===a&&(P-=v/2);const C=e.getPixelForDecimal(0),D=e.getPixelForDecimal(1),O=Math.min(C,D),M=Math.max(C,D);P=Math.max(Math.min(P,M),O),y=P+v,i&&!h&&(c._stacks[e.axis]._visualValues[s]=e.getValueForPixel(y)-e.getValueForPixel(P))}if(P===e.getPixelForValue(a)){const C=ve(v)*e.getLineWidthForValue(a)/2;P+=C,v-=C}return{size:v,base:P,head:y,center:y+v/2}}_calculateBarIndexPixels(t,e){const i=e.scale,s=this.options,r=s.skipNull,o=G(s.maxBarThickness,1/0);let a,c;const u=this._getAxisCount();if(e.grouped){const h=r?this._getStackCount(t):e.stackCount,d=s.barThickness==="flex"?cv(t,e,s,h*u):av(t,e,s,h*u),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf(G(g,this.getFirstScaleIdForIndexAxis())),y=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+m;a=d.start+d.chunk*y+d.chunk/2,c=Math.min(o,d.chunk*d.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),c=Math.min(o,e.min*e.ratio);return{base:a-c/2,head:a+c/2,center:a,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,s=i.length;let r=0;for(;r<s;++r)this.getParsed(r)[e.axis]!==null&&!i[r].hidden&&i[r].draw(this._ctx)}}class mv extends kn{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,s){const r=super.parsePrimitiveData(t,e,i,s);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+i).radius;return r}parseArrayData(t,e,i,s){const r=super.parseArrayData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=G(a[2],this.resolveDataElementOptions(o+i).radius)}return r}parseObjectData(t,e,i,s){const r=super.parseObjectData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=G(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y),u=o._custom;return{label:i[t]||"",value:"("+a+", "+c+(u?", "+u:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(e,s),h=o.axis,d=a.axis;for(let g=e;g<e+i;g++){const m=t[g],y=!r&&this.getParsed(g),v={},w=v[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(y[h]),P=v[d]=r?a.getBasePixel():a.getPixelForValue(y[d]);v.skip=isNaN(w)||isNaN(P),u&&(v.options=c||this.resolveDataElementOptions(g,m.active?"active":s),r&&(v.options.radius=0)),this.updateElement(m,g,v,s)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const r=s.radius;return e!=="active"&&(s.radius=0),s.radius+=G(i&&i._custom,r),s}}function _v(n,t,e){let i=1,s=1,r=0,o=0;if(t<dt){const a=n,c=a+t,u=Math.cos(a),h=Math.sin(a),d=Math.cos(c),g=Math.sin(c),m=(D,O,M)=>Fs(D,a,c,!0)?1:Math.max(O,O*e,M,M*e),y=(D,O,M)=>Fs(D,a,c,!0)?-1:Math.min(O,O*e,M,M*e),v=m(0,u,d),w=m(Et,h,g),P=y(st,u,d),C=y(st+Et,h,g);i=(v-P)/2,s=(w-C)/2,r=-(v+P)/2,o=-(w+C)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}class sl extends kn{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((c,u)=>{const d=t.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(u),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:s,pointStyle:i,borderRadius:o&&(a||d.borderRadius),index:u}}):[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let r=c=>+i[c];if(nt(i[t])){const{key:c="value"}=this._parsing;r=u=>+wn(i[u],c)}let o,a;for(o=t,a=t+e;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return le(this.options.rotation-90)}_getCircumference(){return le(this.options.circumference)}_getRotationExtents(){let t=dt,e=-dt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const s=this.chart.getDatasetMeta(i).controller,r=s._getRotation(),o=s._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,s=this._cachedMeta,r=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),c=Math.min(Ay(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:g,ratioY:m,offsetX:y,offsetY:v}=_v(d,h,c),w=(i.width-o)/g,P=(i.height-o)/m,C=Math.max(Math.min(w,P)/2,0),D=Jf(this.options.radius,C),O=Math.max(D*c,0),M=(D-O)/this._getVisibleDatasetWeightTotal();this.offsetX=y*D,this.offsetY=v*D,s.total=this.calculateTotal(),this.outerRadius=D-M*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-M*u,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const i=this.options,s=this._cachedMeta,r=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*r/dt)}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,h=(a.left+a.right)/2,d=(a.top+a.bottom)/2,g=r&&u.animateScale,m=g?0:this.innerRadius,y=g?0:this.outerRadius,{sharedOptions:v,includeOptions:w}=this._getSharedOptions(e,s);let P=this._getRotation(),C;for(C=0;C<e;++C)P+=this._circumference(C,r);for(C=e;C<e+i;++C){const D=this._circumference(C,r),O=t[C],M={x:h+this.offsetX,y:d+this.offsetY,startAngle:P,endAngle:P+D,circumference:D,outerRadius:y,innerRadius:m};w&&(M.options=v||this.resolveDataElementOptions(C,O.active?"active":s)),P+=D,this.updateElement(O,C,M,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i=0,s;for(s=0;s<e.length;s++){const r=t._parsed[s];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(s)&&!e[s].hidden&&(i+=Math.abs(r))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?dt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Zs(e._parsed[t],i.options.locale);return{label:s[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const i=this.chart;let s,r,o,a,c;if(!t){for(s=0,r=i.data.datasets.length;s<r;++s)if(i.isDatasetVisible(s)){o=i.getDatasetMeta(s),t=o.data,a=o.controller;break}}if(!t)return 0;for(s=0,r=t.length;s<r;++s)c=a.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(e=Math.max(e,c.borderWidth||0,c.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,s=t.length;i<s;++i){const r=this.resolveDataElementOptions(i);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max(G(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class yv extends kn{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:s=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:c}=og(e,s,o);this._drawStart=a,this._drawCount=c,ag(e)&&(a=0,c=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=s;const u=this.resolveDatasetElementOptions(t);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:u},t),this.updateElements(s,a,c,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,s),g=o.axis,m=a.axis,{spanGaps:y,segment:v}=this.options,w=Pi(y)?y:Number.POSITIVE_INFINITY,P=this.chart._animationsDisabled||r||s==="none",C=e+i,D=t.length;let O=e>0&&this.getParsed(e-1);for(let M=0;M<D;++M){const L=t[M],I=P?L:{};if(M<e||M>=C){I.skip=!0;continue}const b=this.getParsed(M),T=Q(b[m]),A=I[g]=o.getPixelForValue(b[g],M),x=I[m]=r||T?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,b,c):b[m],M);I.skip=isNaN(A)||isNaN(x)||T,I.stop=M>0&&Math.abs(b[g]-O[g])>w,v&&(I.parsed=b,I.raw=u.data[M]),d&&(I.options=h||this.resolveDataElementOptions(M,L.active?"active":s)),P||this.updateElement(L,M,I,s),O=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const r=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class xg extends kn{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const c=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:s,lineWidth:c.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Zs(e._parsed[t].r,i.options.locale);return{label:s[t]||"",value:r}}parseObjectData(t,e,i,s){return pg.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const r=this.getParsed(s).r;!isNaN(r)&&this.chart.getDataVisibility(s)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(s/2,0),o=Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,c=o.options.animation,u=this._cachedMeta.rScale,h=u.xCenter,d=u.yCenter,g=u.getIndexAngle(0)-.5*st;let m=g,y;const v=360/this.countVisibleElements();for(y=0;y<e;++y)m+=this._computeAngle(y,s,v);for(y=e;y<e+i;y++){const w=t[y];let P=m,C=m+this._computeAngle(y,s,v),D=o.getDataVisibility(y)?u.getDistanceFromCenterForValue(this.getParsed(y).r):0;m=C,r&&(c.animateScale&&(D=0),c.animateRotate&&(P=C=g));const O={x:h,y:d,innerRadius:0,outerRadius:D,startAngle:P,endAngle:C,options:this.resolveDataElementOptions(y,w.active?"active":s)};this.updateElement(w,y,O,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&e++}),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?le(this.resolveDataElementOptions(t,e).angle||i):0}}class bv extends sl{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class vv extends kn{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,s){return pg.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta,i=e.dataset,s=e.data||[],r=e.iScale.getLabels();if(i.points=s,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===s.length,options:o};this.updateElement(i,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,i,s){const r=this._cachedMeta.rScale,o=s==="reset";for(let a=e;a<e+i;a++){const c=t[a],u=this.resolveDataElementOptions(a,c.active?"active":s),h=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:h.x,g=o?r.yCenter:h.y,m={x:d,y:g,angle:h.angle,skip:isNaN(d)||isNaN(g),options:u};this.updateElement(c,a,m,s)}}}class wv extends kn{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y);return{label:i[t]||"",value:"("+a+", "+c+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,s=this.chart._animationsDisabled;let{start:r,count:o}=og(e,i,s);if(this._drawStart=r,this._drawCount=o,ag(e)&&(r=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:c}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!c._decimated,a.points=i;const u=this.resolveDatasetElementOptions(t);u.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:u},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:u}=this._cachedMeta,h=this.resolveDataElementOptions(e,s),d=this.getSharedOptions(h),g=this.includeOptions(s,d),m=o.axis,y=a.axis,{spanGaps:v,segment:w}=this.options,P=Pi(v)?v:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||r||s==="none";let D=e>0&&this.getParsed(e-1);for(let O=e;O<e+i;++O){const M=t[O],L=this.getParsed(O),I=C?M:{},b=Q(L[y]),T=I[m]=o.getPixelForValue(L[m],O),A=I[y]=r||b?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,L,c):L[y],O);I.skip=isNaN(T)||isNaN(A)||b,I.stop=O>0&&Math.abs(L[m]-D[m])>P,w&&(I.parsed=L,I.raw=u.data[O]),g&&(I.options=d||this.resolveDataElementOptions(O,M.active?"active":s)),C||this.updateElement(M,O,I,s),D=L}this.updateSharedOptions(d,s,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let c=e.length-1;c>=0;--c)a=Math.max(a,e[c].size(this.resolveDataElementOptions(c))/2);return a>0&&a}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!e.length)return s;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,r,o)/2}}var Ev=Object.freeze({__proto__:null,BarController:pv,BubbleController:mv,DoughnutController:sl,LineController:yv,PieController:bv,PolarAreaController:xg,RadarController:vv,ScatterController:wv});function Bn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class rl{static override(t){Object.assign(rl.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Bn()}parse(){return Bn()}format(){return Bn()}add(){return Bn()}diff(){return Bn()}startOf(){return Bn()}endOf(){return Bn()}}var Tv={_date:rl};function Iv(n,t,e,i){const{controller:s,data:r,_sorted:o}=n,a=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const u=a._reversePixels?Uy:Le;if(i){if(s._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(t);if(d){const g=u(r,t,e-d),m=u(r,t,e+d);return{lo:g.lo,hi:m.hi}}}}else{const h=u(r,t,e);if(c){const{vScale:d}=s._cachedMeta,{_parsed:g}=n,m=g.slice(0,h.lo+1).reverse().findIndex(v=>!Q(v[d.axis]));h.lo-=Math.max(0,m);const y=g.slice(h.hi).findIndex(v=>!Q(v[d.axis]));h.hi+=Math.max(0,y)}return h}}return{lo:0,hi:r.length-1}}function Bo(n,t,e,i,s){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,c=r.length;a<c;++a){const{index:u,data:h}=r[a],{lo:d,hi:g}=Iv(r[a],t,o,s);for(let m=d;m<=g;++m){const y=h[m];y.skip||i(y,u,m)}}}function Sv(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(i,s){const r=t?Math.abs(i.x-s.x):0,o=e?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function La(n,t,e,i,s){const r=[];return!s&&!n.isPointInArea(t)||Bo(n,e,t,function(a,c,u){!s&&!Fe(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&r.push({element:a,datasetIndex:c,index:u})},!0),r}function xv(n,t,e,i){let s=[];function r(o,a,c){const{startAngle:u,endAngle:h}=o.getProps(["startAngle","endAngle"],i),{angle:d}=eg(o,{x:t.x,y:t.y});Fs(d,u,h)&&s.push({element:o,datasetIndex:a,index:c})}return Bo(n,e,t,r),s}function Av(n,t,e,i,s,r){let o=[];const a=Sv(e);let c=Number.POSITIVE_INFINITY;function u(h,d,g){const m=h.inRange(t.x,t.y,s);if(i&&!m)return;const y=h.getCenterPoint(s);if(!(!!r||n.isPointInArea(y))&&!m)return;const w=a(t,y);w<c?(o=[{element:h,datasetIndex:d,index:g}],c=w):w===c&&o.push({element:h,datasetIndex:d,index:g})}return Bo(n,e,t,u),o}function Fa(n,t,e,i,s,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!i?xv(n,t,e,s):Av(n,t,e,i,s,r)}function Ah(n,t,e,i,s){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return Bo(n,e,t,(c,u,h)=>{c[o]&&c[o](t[e],s)&&(r.push({element:c,datasetIndex:u,index:h}),a=a||c.inRange(t.x,t.y,s))}),i&&!a?[]:r}var Pv={modes:{index(n,t,e,i){const s=zn(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?La(n,s,r,i,o):Fa(n,s,r,!1,i,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(u=>{const h=a[0].index,d=u.data[h];d&&!d.skip&&c.push({element:d,datasetIndex:u.index,index:h})}),c):[]},dataset(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?La(n,s,r,i,o):Fa(n,s,r,!1,i,o);if(a.length>0){const c=a[0].datasetIndex,u=n.getDatasetMeta(c).data;a=[];for(let h=0;h<u.length;++h)a.push({element:u[h],datasetIndex:c,index:h})}return a},point(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return La(n,s,r,i,o)},nearest(n,t,e,i){const s=zn(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Fa(n,s,r,e.intersect,i,o)},x(n,t,e,i){const s=zn(t,n);return Ah(n,s,"x",e.intersect,i)},y(n,t,e,i){const s=zn(t,n);return Ah(n,s,"y",e.intersect,i)}}};const Ag=["left","top","right","bottom"];function us(n,t){return n.filter(e=>e.pos===t)}function Ph(n,t){return n.filter(e=>Ag.indexOf(e.pos)===-1&&e.box.axis===t)}function hs(n,t){return n.sort((e,i)=>{const s=t?i:e,r=t?e:i;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function Cv(n){const t=[];let e,i,s,r,o,a;for(e=0,i=(n||[]).length;e<i;++e)s=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=s,t.push({index:e,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}function kv(n){const t={};for(const e of n){const{stack:i,pos:s,stackWeight:r}=e;if(!i||!Ag.includes(s))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function Rv(n,t){const e=kv(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:c}=a.box,u=e[a.stack],h=u&&a.stackWeight/u.weight;a.horizontal?(a.width=h?h*i:c&&t.availableWidth,a.height=s):(a.width=i,a.height=h?h*s:c&&t.availableHeight)}return e}function Dv(n){const t=Cv(n),e=hs(t.filter(u=>u.box.fullSize),!0),i=hs(us(t,"left"),!0),s=hs(us(t,"right")),r=hs(us(t,"top"),!0),o=hs(us(t,"bottom")),a=Ph(t,"x"),c=Ph(t,"y");return{fullSize:e,leftAndTop:i.concat(r),rightAndBottom:s.concat(c).concat(o).concat(a),chartArea:us(t,"chartArea"),vertical:i.concat(s).concat(c),horizontal:r.concat(o).concat(a)}}function Ch(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function Pg(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function Mv(n,t,e,i){const{pos:s,box:r}=e,o=n.maxPadding;if(!nt(s)){e.size&&(n[s]-=e.size);const d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[s]+=e.size}r.getPadding&&Pg(o,r.getPadding());const a=Math.max(0,t.outerWidth-Ch(o,n,"left","right")),c=Math.max(0,t.outerHeight-Ch(o,n,"top","bottom")),u=a!==n.w,h=c!==n.h;return n.w=a,n.h=c,e.horizontal?{same:u,other:h}:{same:h,other:u}}function Ov(n){const t=n.maxPadding;function e(i){const s=Math.max(t[i]-n[i],0);return n[i]+=s,s}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function Nv(n,t){const e=t.maxPadding;function i(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return i(n?["left","right"]:["top","bottom"])}function _s(n,t,e,i){const s=[];let r,o,a,c,u,h;for(r=0,o=n.length,u=0;r<o;++r){a=n[r],c=a.box,c.update(a.width||t.w,a.height||t.h,Nv(a.horizontal,t));const{same:d,other:g}=Mv(t,e,a,i);u|=d&&s.length,h=h||g,c.fullSize||s.push(a)}return u&&_s(s,t,e,i)||h}function Cr(n,t,e,i,s){n.top=e,n.left=t,n.right=t+i,n.bottom=e+s,n.width=i,n.height=s}function kh(n,t,e,i){const s=e.padding;let{x:r,y:o}=t;for(const a of n){const c=a.box,u=i[a.stack]||{placed:0,weight:1},h=a.stackWeight/u.weight||1;if(a.horizontal){const d=t.w*h,g=u.size||c.height;Ls(u.start)&&(o=u.start),c.fullSize?Cr(c,s.left,o,e.outerWidth-s.right-s.left,g):Cr(c,t.left+u.placed,o,d,g),u.start=o,u.placed+=d,o=c.bottom}else{const d=t.h*h,g=u.size||c.width;Ls(u.start)&&(r=u.start),c.fullSize?Cr(c,r,s.top,g,e.outerHeight-s.bottom-s.top):Cr(c,r,t.top+u.placed,g,d),u.start=r,u.placed+=d,r=c.right}}t.x=r,t.y=o}var jt={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;const s=Ht(n.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(e-s.height,0),a=Dv(n.boxes),c=a.vertical,u=a.horizontal;at(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const h=c.reduce((v,w)=>w.box.options&&w.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),g=Object.assign({},s);Pg(g,Ht(i));const m=Object.assign({maxPadding:g,w:r,h:o,x:s.left,y:s.top},s),y=Rv(c.concat(u),d);_s(a.fullSize,m,d,y),_s(c,m,d,y),_s(u,m,d,y)&&_s(c,m,d,y),Ov(m),kh(a.leftAndTop,m,d,y),m.x+=m.w,m.y+=m.h,kh(a.rightAndBottom,m,d,y),n.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},at(a.chartArea,v=>{const w=v.box;Object.assign(w,n.chartArea),w.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Cg{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class Vv extends Cg{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const jr="$chartjs",Lv={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Rh=n=>n===null||n==="";function Fv(n,t){const e=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[jr]={initial:{height:i,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Rh(s)){const r=gh(n,"width");r!==void 0&&(n.width=r)}if(Rh(i))if(n.style.height==="")n.height=n.width/(t||2);else{const r=gh(n,"height");r!==void 0&&(n.height=r)}return n}const kg=Mb?{passive:!0}:!1;function Bv(n,t,e){n&&n.addEventListener(t,e,kg)}function Uv(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,kg)}function zv(n,t){const e=Lv[n.type]||n.type,{x:i,y:s}=zn(n,t);return{type:e,chart:t,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function lo(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function Wv(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||lo(a.addedNodes,i),o=o&&!lo(a.removedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function jv(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||lo(a.removedNodes,i),o=o&&!lo(a.addedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const Us=new Map;let Dh=0;function Rg(){const n=window.devicePixelRatio;n!==Dh&&(Dh=n,Us.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function Hv(n,t){Us.size||window.addEventListener("resize",Rg),Us.set(n,t)}function $v(n){Us.delete(n),Us.size||window.removeEventListener("resize",Rg)}function qv(n,t,e){const i=n.canvas,s=i&&il(i);if(!s)return;const r=rg((a,c)=>{const u=s.clientWidth;e(a,c),u<s.clientWidth&&e()},window),o=new ResizeObserver(a=>{const c=a[0],u=c.contentRect.width,h=c.contentRect.height;u===0&&h===0||r(u,h)});return o.observe(s),Hv(n,r),o}function Ba(n,t,e){e&&e.disconnect(),t==="resize"&&$v(n)}function Gv(n,t,e){const i=n.canvas,s=rg(r=>{n.ctx!==null&&e(zv(r,n))},n);return Bv(i,t,s),s}class Yv extends Cg{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(Fv(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[jr])return!1;const i=e[jr].initial;["height","width"].forEach(r=>{const o=i[r];Q(o)?e.removeAttribute(r):e.setAttribute(r,o)});const s=i.style||{};return Object.keys(s).forEach(r=>{e.style[r]=s[r]}),e.width=e.width,delete e[jr],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),o={attach:Wv,detach:jv,resize:qv}[e]||Gv;s[e]=o(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];if(!s)return;({attach:Ba,detach:Ba,resize:Ba}[e]||Uv)(t,e,s),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return Db(t,e,i,s)}isAttached(t){const e=t&&il(t);return!!(e&&e.isConnected)}}function Kv(n){return!nl()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?Vv:Yv}class qe{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return Pi(this.x)&&Pi(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach(r=>{s[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),s}}function Xv(n,t){const e=n.options.ticks,i=Qv(n),s=Math.min(e.maxTicksLimit||i,i),r=e.major.enabled?Zv(t):[],o=r.length,a=r[0],c=r[o-1],u=[];if(o>s)return tw(t,u,r,o/s),u;const h=Jv(r,t,s);if(o>0){let d,g;const m=o>1?Math.round((c-a)/(o-1)):null;for(kr(t,u,h,Q(m)?0:a-m,a),d=0,g=o-1;d<g;d++)kr(t,u,h,r[d],r[d+1]);return kr(t,u,h,c,Q(m)?t.length:c+m),u}return kr(t,u,h),u}function Qv(n){const t=n.options.offset,e=n._tickSize(),i=n._length/e+(t?0:1),s=n._maxLength/e;return Math.floor(Math.min(i,s))}function Jv(n,t,e){const i=ew(n),s=t.length/e;if(!i)return Math.max(s,1);const r=Ny(i);for(let o=0,a=r.length-1;o<a;o++){const c=r[o];if(c>s)return c}return Math.max(s,1)}function Zv(n){const t=[];let e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}function tw(n,t,e,i){let s=0,r=e[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===r&&(t.push(n[o]),s++,r=e[s*i])}function kr(n,t,e,i,s){const r=G(i,0),o=Math.min(G(s,n.length),n.length);let a=0,c,u,h;for(e=Math.ceil(e),s&&(c=s-i,e=c/Math.floor(c/e)),h=r;h<0;)a++,h=Math.round(r+a*e);for(u=Math.max(r,0);u<o;u++)u===h&&(t.push(n[u]),a++,h=Math.round(r+a*e))}function ew(n){const t=n.length;let e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}const nw=n=>n==="left"?"right":n==="right"?"left":n,Mh=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,Oh=(n,t)=>Math.min(t||n,n);function Nh(n,t){const e=[],i=n.length/t,s=n.length;let r=0;for(;r<s;r+=i)e.push(n[Math.floor(r)]);return e}function iw(n,t,e){const i=n.ticks.length,s=Math.min(t,i-1),r=n._startPixel,o=n._endPixel,a=1e-6;let c=n.getPixelForTick(s),u;if(!(e&&(i===1?u=Math.max(c-r,o-c):t===0?u=(n.getPixelForTick(1)-c)/2:u=(c-n.getPixelForTick(s-1))/2,c+=s<t?u:-u,c<r-a||c>o+a)))return c}function sw(n,t){at(n,e=>{const i=e.gc,s=i.length/2;let r;if(s>t){for(r=0;r<s;++r)delete e.data[i[r]];i.splice(0,s)}})}function ds(n){return n.drawTicks?n.tickLength:0}function Vh(n,t){if(!n.display)return 0;const e=At(n.font,t),i=Ht(n.padding);return(ft(n.text)?n.text.length:1)*e.lineHeight+i.height}function rw(n,t){return Cn(n,{scale:t,type:"scale"})}function ow(n,t,e){return Cn(n,{tick:e,index:t,type:"tick"})}function aw(n,t,e){let i=Xc(n);return(e&&t!=="right"||!e&&t==="right")&&(i=nw(i)),i}function cw(n,t,e,i){const{top:s,left:r,bottom:o,right:a,chart:c}=n,{chartArea:u,scales:h}=c;let d=0,g,m,y;const v=o-s,w=a-r;if(n.isHorizontal()){if(m=Bt(i,r,a),nt(e)){const P=Object.keys(e)[0],C=e[P];y=h[P].getPixelForValue(C)+v-t}else e==="center"?y=(u.bottom+u.top)/2+v-t:y=Mh(n,e,t);g=a-r}else{if(nt(e)){const P=Object.keys(e)[0],C=e[P];m=h[P].getPixelForValue(C)-w+t}else e==="center"?m=(u.left+u.right)/2-w+t:m=Mh(n,e,t);y=Bt(i,o,s),d=e==="left"?-Et:Et}return{titleX:m,titleY:y,maxWidth:g,rotation:d}}class oi extends qe{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=Jt(t,Number.POSITIVE_INFINITY),e=Jt(e,Number.NEGATIVE_INFINITY),i=Jt(i,Number.POSITIVE_INFINITY),s=Jt(s,Number.NEGATIVE_INFINITY),{min:Jt(t,i),max:Jt(e,s),minDefined:vt(t),maxDefined:vt(e)}}getMinMax(t){let{min:e,max:i,minDefined:s,maxDefined:r}=this.getUserBounds(),o;if(s&&r)return{min:e,max:i};const a=this.getMatchingVisibleMetas();for(let c=0,u=a.length;c<u;++c)o=a[c].controller.getMinMax(this,t),s||(e=Math.min(e,o.min)),r||(i=Math.max(i,o.max));return e=r&&e>i?i:e,i=s&&e>i?e:i,{min:Jt(e,Jt(i,e)),max:Jt(i,Jt(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){lt(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=ub(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=a<this.ticks.length;this._convertTicksToLabels(c?Nh(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Xv(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){lt(this.options.afterUpdate,[this])}beforeSetDimensions(){lt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){lt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),lt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){lt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i],r.label=lt(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){lt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){lt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Oh(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,r=e.maxRotation;let o=s,a,c,u;if(!this._isVisible()||!e.display||s>=r||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),d=h.widest.width,g=h.highest.height,m=Rt(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/i:m/(i-1),d+6>a&&(a=m/(i-(t.offset?.5:1)),c=this.maxHeight-ds(t.grid)-e.padding-Vh(t.title,this.chart.options.font),u=Math.sqrt(d*d+g*g),o=Yc(Math.min(Math.asin(Rt((h.highest.height+6)/a,-1,1)),Math.asin(Rt(c/u,-1,1))-Math.asin(Rt(g/u,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){lt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){lt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const c=Vh(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=ds(r)+c):(t.height=this.maxHeight,t.width=ds(r)+c),i.display&&this.ticks.length){const{first:u,last:h,widest:d,highest:g}=this._getLabelSizes(),m=i.padding*2,y=le(this.labelRotation),v=Math.cos(y),w=Math.sin(y);if(a){const P=i.mirror?0:w*d.width+v*g.height;t.height=Math.min(this.maxHeight,t.height+P+m)}else{const P=i.mirror?0:v*d.width+w*g.height;t.width=Math.min(this.maxWidth,t.width+P+m)}this._calculatePadding(u,h,w,v)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:r,padding:o},position:a}=this.options,c=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,m=0;c?u?(g=s*t.width,m=i*e.height):(g=i*t.height,m=s*e.width):r==="start"?m=e.width:r==="end"?g=t.width:r!=="inner"&&(g=t.width/2,m=e.width/2),this.paddingLeft=Math.max((g-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((m-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;r==="start"?(h=0,d=t.height):r==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){lt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)Q(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=Nh(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:r}=this,o=[],a=[],c=Math.floor(e/Oh(e,i));let u=0,h=0,d,g,m,y,v,w,P,C,D,O,M;for(d=0;d<e;d+=c){if(y=t[d].label,v=this._resolveTickFontOptions(d),s.font=w=v.string,P=r[w]=r[w]||{data:{},gc:[]},C=v.lineHeight,D=O=0,!Q(y)&&!ft(y))D=ao(s,P.data,P.gc,D,y),O=C;else if(ft(y))for(g=0,m=y.length;g<m;++g)M=y[g],!Q(M)&&!ft(M)&&(D=ao(s,P.data,P.gc,D,M),O+=C);o.push(D),a.push(O),u=Math.max(D,u),h=Math.max(O,h)}sw(r,e);const L=o.indexOf(u),I=a.indexOf(h),b=T=>({width:o[T]||0,height:a[T]||0});return{first:b(0),last:b(e-1),widest:b(L),highest:b(I),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return By(this._alignToPixels?Fn(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=ow(this.getContext(),t,i))}return this.$context||(this.$context=rw(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=le(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,c=r?r.highest.height+o:0;return this.isHorizontal()?c*i>a*s?a/i:c/s:c*s<a*i?c/i:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:r,position:o,border:a}=s,c=r.offset,u=this.isHorizontal(),d=this.ticks.length+(c?1:0),g=ds(r),m=[],y=a.setContext(this.getContext()),v=y.display?y.width:0,w=v/2,P=function(X){return Fn(i,X,v)};let C,D,O,M,L,I,b,T,A,x,S,E;if(o==="top")C=P(this.bottom),I=this.bottom-g,T=C-w,x=P(t.top)+w,E=t.bottom;else if(o==="bottom")C=P(this.top),x=t.top,E=P(t.bottom)-w,I=C+w,T=this.top+g;else if(o==="left")C=P(this.right),L=this.right-g,b=C-w,A=P(t.left)+w,S=t.right;else if(o==="right")C=P(this.left),A=t.left,S=P(t.right)-w,L=C+w,b=this.left+g;else if(e==="x"){if(o==="center")C=P((t.top+t.bottom)/2+.5);else if(nt(o)){const X=Object.keys(o)[0],J=o[X];C=P(this.chart.scales[X].getPixelForValue(J))}x=t.top,E=t.bottom,I=C+w,T=I+g}else if(e==="y"){if(o==="center")C=P((t.left+t.right)/2);else if(nt(o)){const X=Object.keys(o)[0],J=o[X];C=P(this.chart.scales[X].getPixelForValue(J))}L=C-w,b=L-g,A=t.left,S=t.right}const j=G(s.ticks.maxTicksLimit,d),U=Math.max(1,Math.ceil(d/j));for(D=0;D<d;D+=U){const X=this.getContext(D),J=r.setContext(X),pt=a.setContext(X),mt=J.lineWidth,Ye=J.color,Rn=pt.dash||[],Ce=pt.dashOffset,Ke=J.tickWidth,ee=J.tickColor,ke=J.tickBorderDash||[],ae=J.tickBorderDashOffset;O=iw(this,D,c),O!==void 0&&(M=Fn(i,O,mt),u?L=b=A=S=M:I=T=x=E=M,m.push({tx1:L,ty1:I,tx2:b,ty2:T,x1:A,y1:x,x2:S,y2:E,width:mt,color:Ye,borderDash:Rn,borderDashOffset:Ce,tickWidth:Ke,tickColor:ee,tickBorderDash:ke,tickBorderDashOffset:ae}))}return this._ticksLength=d,this._borderValue=C,m}_computeLabelItems(t){const e=this.axis,i=this.options,{position:s,ticks:r}=i,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:u,padding:h,mirror:d}=r,g=ds(i.grid),m=g+h,y=d?-h:m,v=-le(this.labelRotation),w=[];let P,C,D,O,M,L,I,b,T,A,x,S,E="middle";if(s==="top")L=this.bottom-y,I=this._getXAxisLabelAlignment();else if(s==="bottom")L=this.top+y,I=this._getXAxisLabelAlignment();else if(s==="left"){const U=this._getYAxisLabelAlignment(g);I=U.textAlign,M=U.x}else if(s==="right"){const U=this._getYAxisLabelAlignment(g);I=U.textAlign,M=U.x}else if(e==="x"){if(s==="center")L=(t.top+t.bottom)/2+m;else if(nt(s)){const U=Object.keys(s)[0],X=s[U];L=this.chart.scales[U].getPixelForValue(X)+m}I=this._getXAxisLabelAlignment()}else if(e==="y"){if(s==="center")M=(t.left+t.right)/2-m;else if(nt(s)){const U=Object.keys(s)[0],X=s[U];M=this.chart.scales[U].getPixelForValue(X)}I=this._getYAxisLabelAlignment(g).textAlign}e==="y"&&(c==="start"?E="top":c==="end"&&(E="bottom"));const j=this._getLabelSizes();for(P=0,C=a.length;P<C;++P){D=a[P],O=D.label;const U=r.setContext(this.getContext(P));b=this.getPixelForTick(P)+r.labelOffset,T=this._resolveTickFontOptions(P),A=T.lineHeight,x=ft(O)?O.length:1;const X=x/2,J=U.color,pt=U.textStrokeColor,mt=U.textStrokeWidth;let Ye=I;o?(M=b,I==="inner"&&(P===C-1?Ye=this.options.reverse?"left":"right":P===0?Ye=this.options.reverse?"right":"left":Ye="center"),s==="top"?u==="near"||v!==0?S=-x*A+A/2:u==="center"?S=-j.highest.height/2-X*A+A:S=-j.highest.height+A/2:u==="near"||v!==0?S=A/2:u==="center"?S=j.highest.height/2-X*A:S=j.highest.height-x*A,d&&(S*=-1),v!==0&&!U.showLabelBackdrop&&(M+=A/2*Math.sin(v))):(L=b,S=(1-x)*A/2);let Rn;if(U.showLabelBackdrop){const Ce=Ht(U.backdropPadding),Ke=j.heights[P],ee=j.widths[P];let ke=S-Ce.top,ae=0-Ce.left;switch(E){case"middle":ke-=Ke/2;break;case"bottom":ke-=Ke;break}switch(I){case"center":ae-=ee/2;break;case"right":ae-=ee;break;case"inner":P===C-1?ae-=ee:P>0&&(ae-=ee/2);break}Rn={left:ae,top:ke,width:ee+Ce.width,height:Ke+Ce.height,color:U.backdropColor}}w.push({label:O,font:T,textOffset:S,options:{rotation:v,color:J,strokeColor:pt,strokeWidth:mt,textAlign:Ye,textBaseline:E,translation:[M,L],backdrop:Rn}})}return w}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-le(this.labelRotation))return t==="top"?"left":"right";let s="center";return e.align==="start"?s="left":e.align==="end"?s="right":e.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,c=o.widest.width;let u,h;return e==="left"?s?(h=this.right+r,i==="near"?u="left":i==="center"?(u="center",h+=c/2):(u="right",h+=c)):(h=this.right-a,i==="near"?u="right":i==="center"?(u="center",h-=c/2):(u="left",h=this.left)):e==="right"?s?(h=this.left+r,i==="near"?u="right":i==="center"?(u="center",h-=c/2):(u="left",h-=c)):(h=this.left+a,i==="near"?u="left":i==="center"?(u="center",h+=c/2):(u="right",h=this.right)):u="right",{textAlign:u,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(c,u,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(u.x,u.y),i.stroke(),i.restore())};if(e.display)for(r=0,o=s.length;r<o;++r){const c=s[r];e.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),e.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:s}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,h,d,g;this.isHorizontal()?(u=Fn(t,this.left,o)-o/2,h=Fn(t,this.right,a)+a/2,d=g=c):(d=Fn(t,this.top,o)-o/2,g=Fn(t,this.bottom,a)+a/2,u=h=c),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(u,d),e.lineTo(h,g),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Vo(i,s);const r=this.getLabelItems(t);for(const o of r){const a=o.options,c=o.font,u=o.label,h=o.textOffset;ti(i,u,0,h,c,a)}s&&Lo(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:s}}=this;if(!i.display)return;const r=At(i.font),o=Ht(i.padding),a=i.align;let c=r.lineHeight/2;e==="bottom"||e==="center"||nt(e)?(c+=o.bottom,ft(i.text)&&(c+=r.lineHeight*(i.text.length-1))):c+=o.top;const{titleX:u,titleY:h,maxWidth:d,rotation:g}=cw(this,c,e,a);ti(t,i.text,0,0,r,{color:i.color,maxWidth:d,rotation:g,textAlign:aw(a,e,s),textBaseline:"middle",translation:[u,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=G(t.grid&&t.grid.z,-1),s=G(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==oi.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return At(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Rr{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;hw(e)&&(i=this.register(e));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,lw(t,o,i),this.override&&gt.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in gt[s]&&(delete gt[s][i],this.override&&delete Zn[i])}}function lw(n,t,e){const i=Vs(Object.create(null),[e?gt.get(e):{},gt.get(t),n.defaults]);gt.set(t,i),n.defaultRoutes&&uw(t,n.defaultRoutes),n.descriptors&&gt.describe(t,n.descriptors)}function uw(n,t){Object.keys(t).forEach(e=>{const i=e.split("."),s=i.pop(),r=[n].concat(i).join("."),o=t[e].split("."),a=o.pop(),c=o.join(".");gt.route(r,s,c,a)})}function hw(n){return"id"in n&&"defaults"in n}class dw{constructor(){this.controllers=new Rr(kn,"datasets",!0),this.elements=new Rr(qe,"elements"),this.plugins=new Rr(Object,"plugins"),this.scales=new Rr(oi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(s=>{const r=i||this._getRegistryForType(s);i||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):at(s,o=>{const a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,i){const s=Gc(t);lt(i["before"+s],[],i),e[t](i),lt(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var me=new dw;class fw{constructor(){this._init=void 0}notify(t,e,i,s){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,e,i);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,i,s){s=s||{};for(const r of t){const o=r.plugin,a=o[i],c=[e,s,r.options];if(lt(a,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){Q(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=G(i.options&&i.options.plugins,{}),r=gw(i);return s===!1&&!e?[]:mw(t,r,s,e)}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(r,o)=>r.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function gw(n){const t={},e=[],i=Object.keys(me.plugins.items);for(let r=0;r<i.length;r++)e.push(me.getPlugin(i[r]));const s=n.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function pw(n,t){return!t&&n===!1?null:n===!0?{}:n}function mw(n,{plugins:t,localIds:e},i,s){const r=[],o=n.getContext();for(const a of t){const c=a.id,u=pw(i[c],s);u!==null&&r.push({plugin:a,options:_w(n.config,{plugin:a,local:e[c]},u,o)})}return r}function _w(n,{plugin:t,local:e},i,s){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(i,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cc(n,t){const e=gt.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function yw(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function bw(n,t){return n===t?"_index_":"_value_"}function Lh(n){if(n==="x"||n==="y"||n==="r")return n}function vw(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function lc(n,...t){if(Lh(n))return n;for(const e of t){const i=e.axis||vw(e.position)||n.length>1&&Lh(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Fh(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function ww(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return Fh(n,"x",e[0])||Fh(n,"y",e[0])}return{}}function Ew(n,t){const e=Zn[n.type]||{scales:{}},i=t.scales||{},s=cc(n.type,t),r=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!nt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=lc(o,a,ww(o,n),gt.scales[a.type]),u=bw(c,s),h=e.scales||{};r[o]=Ts(Object.create(null),[{axis:c},a,h[c],h[u]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,c=o.indexAxis||cc(a,t),h=(Zn[a]||{}).scales||{};Object.keys(h).forEach(d=>{const g=yw(d,c),m=o[g+"AxisID"]||g;r[m]=r[m]||Object.create(null),Ts(r[m],[{axis:g},i[m],h[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];Ts(a,[gt.scales[a.type],gt.scale])}),r}function Dg(n){const t=n.options||(n.options={});t.plugins=G(t.plugins,{}),t.scales=Ew(n,t)}function Mg(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Tw(n){return n=n||{},n.data=Mg(n.data),Dg(n),n}const Bh=new Map,Og=new Set;function Dr(n,t){let e=Bh.get(n);return e||(e=t(),Bh.set(n,e),Og.add(e)),e}const fs=(n,t,e)=>{const i=wn(t,e);i!==void 0&&n.add(i)};class Iw{constructor(t){this._config=Tw(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Mg(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Dg(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Dr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Dr(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Dr(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,i=this.type;return Dr(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return(!s||e)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:r}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const c=new Set;e.forEach(h=>{t&&(c.add(t),h.forEach(d=>fs(c,t,d))),h.forEach(d=>fs(c,s,d)),h.forEach(d=>fs(c,Zn[r]||{},d)),h.forEach(d=>fs(c,gt,d)),h.forEach(d=>fs(c,oc,d))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),Og.has(e)&&o.set(e,u),u}chartOptionScopes(){const{options:t,type:e}=this;return[t,Zn[e]||{},gt.datasets[e]||{},{type:e},gt,oc]}resolveNamedOptions(t,e,i,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=Uh(this._resolverCache,t,s);let c=o;if(xw(o,e)){r.$shared=!1,i=En(i)?i():i;const u=this.createResolver(t,i,a);c=Ci(o,i,u)}for(const u of e)r[u]=c[u];return r}createResolver(t,e,i=[""],s){const{resolver:r}=Uh(this._resolverCache,t,i);return nt(e)?Ci(r,e,void 0,s):r}}function Uh(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));const s=e.join();let r=i.get(s);return r||(r={resolver:Zc(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,r)),r}const Sw=n=>nt(n)&&Object.getOwnPropertyNames(n).some(t=>En(n[t]));function xw(n,t){const{isScriptable:e,isIndexable:i}=hg(n);for(const s of t){const r=e(s),o=i(s),a=(o||r)&&n[s];if(r&&(En(a)||Sw(a))||o&&ft(a))return!0}return!1}var Aw="4.5.1";const Pw=["top","bottom","left","right","chartArea"];function zh(n,t){return n==="top"||n==="bottom"||Pw.indexOf(n)===-1&&t==="x"}function Wh(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function jh(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),lt(e&&e.onComplete,[n],t)}function Cw(n){const t=n.chart,e=t.options.animation;lt(e&&e.onProgress,[n],t)}function Ng(n){return nl()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Hr={},Hh=n=>{const t=Ng(n);return Object.values(Hr).filter(e=>e.canvas===t).pop()};function kw(n,t,e){const i=Object.keys(n);for(const s of i){const r=+s;if(r>=t){const o=n[s];delete n[s],(e>0||r>t)&&(n[r+e]=o)}}}function Rw(n,t,e,i){return!e||n.type==="mouseout"?null:i?t:n}class Uo{static defaults=gt;static instances=Hr;static overrides=Zn;static registry=me;static version=Aw;static getChart=Hh;static register(...t){me.add(...t),$h()}static unregister(...t){me.remove(...t),$h()}constructor(t,e){const i=this.config=new Iw(e),s=Ng(t),r=Hh(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||Kv(s)),this.platform.updateConfig(i);const a=this.platform.acquireContext(s,o.aspectRatio),c=a&&a.canvas,u=c&&c.height,h=c&&c.width;if(this.id=xy(),this.ctx=a,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new fw,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=jy(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Hr[this.id]=this,!a||!c){console.error("Failed to create chart: can't acquire context from the given item");return}De.listen(this,"complete",jh),De.listen(this,"progress",Cw),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:s,_aspectRatio:r}=this;return Q(t)?e&&r?r:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return me}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():fh(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return uh(this.canvas,this.ctx),this}stop(){return De.stop(this),this}resize(t,e){De.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,s=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,e,r),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,fh(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),lt(i.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};at(e,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,s=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],c=lc(o,a),u=c==="r",h=c==="x";return{options:a,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),at(r,o=>{const a=o.options,c=a.id,u=lc(c,a),h=G(a.type,o.dtype);(a.position===void 0||zh(a.position,u)!==zh(o.dposition))&&(a.position=o.dposition),s[c]=!0;let d=null;if(c in i&&i[c].type===h)d=i[c];else{const g=me.getScale(h);d=new g({id:c,type:h,ctx:this.ctx,chart:this}),i[d.id]=d}d.init(a,t)}),at(s,(o,a)=>{o||delete i[a]}),at(i,o=>{jt.configure(this,o,o.options),jt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((s,r)=>s.index-r.index),i>e){for(let s=e;s<i;++s)this._destroyDatasetMeta(s);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(Wh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((i,s)=>{e.filter(r=>r===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=e.length;i<s;i++){const r=e[i];let o=this.getDatasetMeta(i);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=r.indexAxis||cc(a,this.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const c=me.getController(a),{datasetElementType:u,dataElementType:h}=gt.datasets[a];Object.assign(c,{dataElementType:me.getElement(h),datasetElementType:u&&me.getElement(u)}),o.controller=new c(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){at(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){const{controller:d}=this.getDatasetMeta(u),g=!s&&r.indexOf(d)===-1;d.buildOrUpdateElements(g),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),s||at(r,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Wh("z","_idx"));const{_active:a,_lastEvent:c}=this;c?this._eventHandler(c,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){at(this.scales,t=>{jt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!eh(e,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:r}of e){const o=i==="_removeElements"?-r:r;kw(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),s=i(0);for(let r=1;r<e;r++)if(!eh(s,i(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;jt.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],at(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,i=this.data.datasets.length;e<i;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,En(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(De.has(this)?this.attached&&!De.running(this)&&De.start(this):(this.draw(),jh({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let s,r;for(s=0,r=e.length;s<r;++s){const o=e[s];(!t||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i={meta:t,index:t.index,cancelable:!0},s=Eg(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(s&&Vo(e,s),t.controller.draw(),s&&Lo(e),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return Fe(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,s){const r=Pv.modes[e];return typeof r=="function"?r(this,t,i,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let s=i.filter(r=>r&&r._dataset===e).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=Cn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!e.hidden}setDatasetVisibility(t,e){const i=this.getDatasetMeta(t);i.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const s=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,s);Ls(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),De.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),uh(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Hr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},s=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};at(this.options.events,r=>i(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(c,u)=>{e.addEventListener(this,c,u),t[c]=u},s=(c,u)=>{t[c]&&(e.removeEventListener(this,c,u),delete t[c])},r=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",r),i("detach",o)};o=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){at(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},at(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const s=i?"set":"remove";let r,o,a,c;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),a=0,c=t.length;a<c;++a){o=t[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!so(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,i){const s=this.options.hover,r=(c,u)=>c.filter(h=>!u.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),o=r(e,t),a=i?t:r(t,e);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:s=[],options:r}=this,o=e,a=this._getActiveElements(t,s,i,o),c=Dy(t),u=Rw(t,this._lastEvent,i,c);i&&(this._lastEvent=null,lt(r.onHover,[t,a,this],this),c&&lt(r.onClick,[t,a,this],this));const h=!so(a,s);return(h||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=u,h}_getActiveElements(t,e,i,s){if(t.type==="mouseout")return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,s)}}function $h(){return at(Uo.instances,n=>n._plugins.invalidate())}function Dw(n,t,e){const{startAngle:i,x:s,y:r,outerRadius:o,innerRadius:a,options:c}=t,{borderWidth:u,borderJoinStyle:h}=c,d=Math.min(u/o,zt(i-e));if(n.beginPath(),n.arc(s,r,o-u/2,i+d/2,e-d/2),a>0){const g=Math.min(u/a,zt(i-e));n.arc(s,r,a+u/2,e-g/2,i+g/2,!0)}else{const g=Math.min(u/2,o*zt(i-e));if(h==="round")n.arc(s,r,g,e-st/2,i+st/2,!0);else if(h==="bevel"){const m=2*g*g,y=-m*Math.cos(e+st/2)+s,v=-m*Math.sin(e+st/2)+r,w=m*Math.cos(i+st/2)+s,P=m*Math.sin(i+st/2)+r;n.lineTo(y,v),n.lineTo(w,P)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function Mw(n,t,e){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:c}=t;let u=s/a;n.beginPath(),n.arc(r,o,a,i-u,e+u),c>s?(u=s/c,n.arc(r,o,c,e+u,i-u,!0)):n.arc(r,o,s,e+Et,i-Et),n.closePath(),n.clip()}function Ow(n){return Jc(n,["outerStart","outerEnd","innerStart","innerEnd"])}function Nw(n,t,e,i){const s=Ow(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,i*t/2),a=c=>{const u=(e-Math.min(r,c))*i/2;return Rt(c,0,Math.min(r,u))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Rt(s.innerStart,0,o),innerEnd:Rt(s.innerEnd,0,o)}}function pi(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function uo(n,t,e,i,s,r){const{x:o,y:a,startAngle:c,pixelMargin:u,innerRadius:h}=t,d=Math.max(t.outerRadius+i+e-u,0),g=h>0?h+i+e+u:0;let m=0;const y=s-c;if(i){const U=h>0?h-i:0,X=d>0?d-i:0,J=(U+X)/2,pt=J!==0?y*J/(J+i):y;m=(y-pt)/2}const v=Math.max(.001,y*d-e/st)/d,w=(y-v)/2,P=c+w+m,C=s-w-m,{outerStart:D,outerEnd:O,innerStart:M,innerEnd:L}=Nw(t,g,d,C-P),I=d-D,b=d-O,T=P+D/I,A=C-O/b,x=g+M,S=g+L,E=P+M/x,j=C-L/S;if(n.beginPath(),r){const U=(T+A)/2;if(n.arc(o,a,d,T,U),n.arc(o,a,d,U,A),O>0){const mt=pi(b,A,o,a);n.arc(mt.x,mt.y,O,A,C+Et)}const X=pi(S,C,o,a);if(n.lineTo(X.x,X.y),L>0){const mt=pi(S,j,o,a);n.arc(mt.x,mt.y,L,C+Et,j+Math.PI)}const J=(C-L/g+(P+M/g))/2;if(n.arc(o,a,g,C-L/g,J,!0),n.arc(o,a,g,J,P+M/g,!0),M>0){const mt=pi(x,E,o,a);n.arc(mt.x,mt.y,M,E+Math.PI,P-Et)}const pt=pi(I,P,o,a);if(n.lineTo(pt.x,pt.y),D>0){const mt=pi(I,T,o,a);n.arc(mt.x,mt.y,D,P-Et,T)}}else{n.moveTo(o,a);const U=Math.cos(T)*d+o,X=Math.sin(T)*d+a;n.lineTo(U,X);const J=Math.cos(A)*d+o,pt=Math.sin(A)*d+a;n.lineTo(J,pt)}n.closePath()}function Vw(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let c=t.endAngle;if(r){uo(n,t,e,i,c,s);for(let u=0;u<r;++u)n.fill();isNaN(a)||(c=o+(a%dt||dt))}return uo(n,t,e,i,c,s),n.fill(),c}function Lw(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a,options:c}=t,{borderWidth:u,borderJoinStyle:h,borderDash:d,borderDashOffset:g,borderRadius:m}=c,y=c.borderAlign==="inner";if(!u)return;n.setLineDash(d||[]),n.lineDashOffset=g,y?(n.lineWidth=u*2,n.lineJoin=h||"round"):(n.lineWidth=u,n.lineJoin=h||"bevel");let v=t.endAngle;if(r){uo(n,t,e,i,v,s);for(let w=0;w<r;++w)n.stroke();isNaN(a)||(v=o+(a%dt||dt))}y&&Mw(n,t,v),c.selfJoin&&v-o>=st&&m===0&&h!=="miter"&&Dw(n,t,v),r||(uo(n,t,e,i,v,s),n.stroke())}class Fw extends qe{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.getProps(["x","y"],i),{angle:r,distance:o}=eg(s,{x:t,y:e}),{startAngle:a,endAngle:c,innerRadius:u,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),g=(this.options.spacing+this.options.borderWidth)/2,m=G(d,c-a),y=Fs(r,a,c)&&a!==c,v=m>=dt||y,w=Ve(o,u+g,h+g);return v&&w}getCenterPoint(t){const{x:e,y:i,startAngle:s,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:u}=this.options,h=(s+r)/2,d=(o+a+u+c)/2;return{x:e+Math.cos(h)*d,y:i+Math.sin(h)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,s=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=i>dt?Math.floor(i/dt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*s,Math.sin(a)*s);const c=1-Math.sin(Math.min(st,i||0)),u=s*c;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,Vw(t,this,u,r,o),Lw(t,this,u,r,o),t.restore()}}function Vg(n,t,e=t){n.lineCap=G(e.borderCapStyle,t.borderCapStyle),n.setLineDash(G(e.borderDash,t.borderDash)),n.lineDashOffset=G(e.borderDashOffset,t.borderDashOffset),n.lineJoin=G(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=G(e.borderWidth,t.borderWidth),n.strokeStyle=G(e.borderColor,t.borderColor)}function Bw(n,t,e){n.lineTo(e.x,e.y)}function Uw(n){return n.stepped?eb:n.tension||n.cubicInterpolationMode==="monotone"?nb:Bw}function Lg(n,t,e={}){const i=n.length,{start:s=0,end:r=i-1}=e,{start:o,end:a}=t,c=Math.max(s,o),u=Math.min(r,a),h=s<o&&r<o||s>a&&r>a;return{count:i,start:c,loop:t.loop,ilen:u<c&&!h?i+u-c:u-c}}function zw(n,t,e,i){const{points:s,options:r}=t,{count:o,start:a,loop:c,ilen:u}=Lg(s,e,i),h=Uw(r);let{move:d=!0,reverse:g}=i||{},m,y,v;for(m=0;m<=u;++m)y=s[(a+(g?u-m:m))%o],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):h(n,v,y,g,r.stepped),v=y);return c&&(y=s[(a+(g?u:0))%o],h(n,v,y,g,r.stepped)),!!c}function Ww(n,t,e,i){const s=t.points,{count:r,start:o,ilen:a}=Lg(s,e,i),{move:c=!0,reverse:u}=i||{};let h=0,d=0,g,m,y,v,w,P;const C=O=>(o+(u?a-O:O))%r,D=()=>{v!==w&&(n.lineTo(h,w),n.lineTo(h,v),n.lineTo(h,P))};for(c&&(m=s[C(0)],n.moveTo(m.x,m.y)),g=0;g<=a;++g){if(m=s[C(g)],m.skip)continue;const O=m.x,M=m.y,L=O|0;L===y?(M<v?v=M:M>w&&(w=M),h=(d*h+O)/++d):(D(),n.lineTo(O,M),y=L,d=0,v=w=M),P=M}D()}function uc(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?Ww:zw}function jw(n){return n.stepped?Ob:n.tension||n.cubicInterpolationMode==="monotone"?Nb:Wn}function Hw(n,t,e,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,i)&&s.closePath()),Vg(n,t.options),n.stroke(s)}function $w(n,t,e,i){const{segments:s,options:r}=t,o=uc(t);for(const a of s)Vg(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}const qw=typeof Path2D=="function";function Gw(n,t,e,i){qw&&!t.options.segment?Hw(n,t,e,i):$w(n,t,e,i)}class zo extends qe{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;xb(this._points,i,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zb(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,s=t[e],r=this.points,o=wg(this,{property:e,start:s,end:s});if(!o.length)return;const a=[],c=jw(i);let u,h;for(u=0,h=o.length;u<h;++u){const{start:d,end:g}=o[u],m=r[d],y=r[g];if(m===y){a.push(m);continue}const v=Math.abs((s-m[e])/(y[e]-m[e])),w=c(m,y,v,i.stepped);w[e]=t[e],a.push(w)}return a.length===1?a[0]:a}pathSegment(t,e,i){return uc(this)(t,this,e,i)}path(t,e,i){const s=this.segments,r=uc(this);let o=this._loop;e=e||0,i=i||this.points.length-e;for(const a of s)o&=r(t,this,a,{start:e,end:e+i-1});return!!o}draw(t,e,i,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),Gw(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function qh(n,t,e,i){const s=n.options,{[e]:r}=n.getProps([e],i);return Math.abs(t-r)<s.radius+s.hitRadius}class Yw extends qe{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.options,{x:r,y:o}=this.getProps(["x","y"],i);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,e){return qh(this,t,"x",e)}inYRange(t,e){return qh(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const i=e&&t.borderWidth||0;return(e+i)*2}draw(t,e){const i=this.options;this.skip||i.radius<.1||!Fe(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,ac(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function Fg(n,t){const{x:e,y:i,base:s,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,c,u,h,d;return n.horizontal?(d=o/2,a=Math.min(e,s),c=Math.max(e,s),u=i-d,h=i+d):(d=r/2,a=e-d,c=e+d,u=Math.min(i,s),h=Math.max(i,s)),{left:a,top:u,right:c,bottom:h}}function hn(n,t,e,i){return n?0:Rt(t,e,i)}function Kw(n,t,e){const i=n.options.borderWidth,s=n.borderSkipped,r=ug(i);return{t:hn(s.top,r.top,0,e),r:hn(s.right,r.right,0,t),b:hn(s.bottom,r.bottom,0,e),l:hn(s.left,r.left,0,t)}}function Xw(n,t,e){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,r=Kn(s),o=Math.min(t,e),a=n.borderSkipped,c=i||nt(s);return{topLeft:hn(!c||a.top||a.left,r.topLeft,0,o),topRight:hn(!c||a.top||a.right,r.topRight,0,o),bottomLeft:hn(!c||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:hn(!c||a.bottom||a.right,r.bottomRight,0,o)}}function Qw(n){const t=Fg(n),e=t.right-t.left,i=t.bottom-t.top,s=Kw(n,e/2,i/2),r=Xw(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function Ua(n,t,e,i){const s=t===null,r=e===null,a=n&&!(s&&r)&&Fg(n,i);return a&&(s||Ve(t,a.left,a.right))&&(r||Ve(e,a.top,a.bottom))}function Jw(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Zw(n,t){n.rect(t.x,t.y,t.w,t.h)}function za(n,t,e={}){const i=n.x!==e.x?-t:0,s=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-i,o=(n.y+n.h!==e.y+e.h?t:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+r,h:n.h+o,radius:n.radius}}class t0 extends qe{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:r,outer:o}=Qw(this),a=Jw(o.radius)?Bs:Zw;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,za(o,e,r)),t.clip(),a(t,za(r,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,za(r,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return Ua(this,t,e,i)}inXRange(t,e){return Ua(this,t,null,e)}inYRange(t,e){return Ua(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+s)/2:e,y:r?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var e0=Object.freeze({__proto__:null,ArcElement:Fw,BarElement:t0,LineElement:zo,PointElement:Yw});const hc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Gh=hc.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function Bg(n){return hc[n%hc.length]}function Ug(n){return Gh[n%Gh.length]}function n0(n,t){return n.borderColor=Bg(t),n.backgroundColor=Ug(t),++t}function i0(n,t){return n.backgroundColor=n.data.map(()=>Bg(t++)),t}function s0(n,t){return n.backgroundColor=n.data.map(()=>Ug(t++)),t}function r0(n){let t=0;return(e,i)=>{const s=n.getDatasetMeta(i).controller;s instanceof sl?t=i0(e,t):s instanceof xg?t=s0(e,t):s&&(t=n0(e,t))}}function Yh(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function o0(n){return n&&(n.borderColor||n.backgroundColor)}function a0(){return gt.borderColor!=="rgba(0,0,0,0.1)"||gt.backgroundColor!=="rgba(0,0,0,0.1)"}var c0={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:i},options:s}=n.config,{elements:r}=s,o=Yh(i)||o0(s)||r&&Yh(r)||a0();if(!e.forceOverride&&o)return;const a=r0(n);i.forEach(a)}};function l0(n,t,e,i,s){const r=s.samples||i;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let c=0;const u=t+e-1;let h=t,d,g,m,y,v;for(o[c++]=n[h],d=0;d<r-2;d++){let w=0,P=0,C;const D=Math.floor((d+1)*a)+1+t,O=Math.min(Math.floor((d+2)*a)+1,e)+t,M=O-D;for(C=D;C<O;C++)w+=n[C].x,P+=n[C].y;w/=M,P/=M;const L=Math.floor(d*a)+1+t,I=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:b,y:T}=n[h];for(m=y=-1,C=L;C<I;C++)y=.5*Math.abs((b-w)*(n[C].y-T)-(b-n[C].x)*(P-T)),y>m&&(m=y,g=n[C],v=C);o[c++]=g,h=v}return o[c++]=n[u],o}function u0(n,t,e,i){let s=0,r=0,o,a,c,u,h,d,g,m,y,v;const w=[],P=t+e-1,C=n[t].x,O=n[P].x-C;for(o=t;o<t+e;++o){a=n[o],c=(a.x-C)/O*i,u=a.y;const M=c|0;if(M===h)u<y?(y=u,d=o):u>v&&(v=u,g=o),s=(r*s+a.x)/++r;else{const L=o-1;if(!Q(d)&&!Q(g)){const I=Math.min(d,g),b=Math.max(d,g);I!==m&&I!==L&&w.push({...n[I],x:s}),b!==m&&b!==L&&w.push({...n[b],x:s})}o>0&&L!==m&&w.push(n[L]),w.push(a),h=M,r=0,y=v=u,d=g=m=o}}return w}function zg(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function Kh(n){n.data.datasets.forEach(t=>{zg(t)})}function h0(n,t){const e=t.length;let i=0,s;const{iScale:r}=n,{min:o,max:a,minDefined:c,maxDefined:u}=r.getUserBounds();return c&&(i=Rt(Le(t,r.axis,o).lo,0,e-1)),u?s=Rt(Le(t,r.axis,a).hi+1,i,e)-i:s=e-i,{start:i,count:s}}var d0={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){Kh(n);return}const i=n.width;n.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,c=n.getDatasetMeta(r),u=o||s.data;if(ms([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const h=n.scales[c.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:g}=h0(c,u);const m=e.threshold||4*i;if(g<=m){zg(s);return}Q(o)&&(s._data=u,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(v){this._data=v}}));let y;switch(e.algorithm){case"lttb":y=l0(u,d,g,i,e);break;case"min-max":y=u0(u,d,g,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=y})},destroy(n){Kh(n)}};function f0(n,t,e){const i=n.segments,s=n.points,r=t.points,o=[];for(const a of i){let{start:c,end:u}=a;u=Wo(c,u,s);const h=dc(e,s[c],s[u],a.loop);if(!t.segments){o.push({source:a,target:h,start:s[c],end:s[u]});continue}const d=wg(t,h);for(const g of d){const m=dc(e,r[g.start],r[g.end],g.loop),y=vg(a,s,m);for(const v of y)o.push({source:v,target:g,start:{[e]:Xh(h,m,"start",Math.max)},end:{[e]:Xh(h,m,"end",Math.min)}})}}return o}function dc(n,t,e,i){if(i)return;let s=t[n],r=e[n];return n==="angle"&&(s=zt(s),r=zt(r)),{property:n,start:s,end:r}}function g0(n,t){const{x:e=null,y:i=null}=n||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=Wo(o,a,s);const c=s[o],u=s[a];i!==null?(r.push({x:c.x,y:i}),r.push({x:u.x,y:i})):e!==null&&(r.push({x:e,y:c.y}),r.push({x:e,y:u.y}))}),r}function Wo(n,t,e){for(;t>n;t--){const i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function Xh(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function Wg(n,t){let e=[],i=!1;return ft(n)?(i=!0,e=n):e=g0(n,t),e.length?new zo({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function Qh(n){return n&&n.fill!==!1}function p0(n,t,e){let s=n[t].fill;const r=[t];let o;if(!e)return s;for(;s!==!1&&r.indexOf(s)===-1;){if(!vt(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function m0(n,t,e){const i=v0(n);if(nt(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return vt(s)&&Math.floor(s)===s?_0(i[0],t,s,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function _0(n,t,e,i){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=i?!1:e}function y0(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:nt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function b0(n,t,e){let i;return n==="start"?i=e:n==="end"?i=t.options.reverse?t.min:t.max:nt(n)?i=n.value:i=t.getBaseValue(),i}function v0(n){const t=n.options,e=t.fill;let i=G(e&&e.target,e);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function w0(n){const{scale:t,index:e,line:i}=n,s=[],r=i.segments,o=i.points,a=E0(t,e);a.push(Wg({x:null,y:t.bottom},i));for(let c=0;c<r.length;c++){const u=r[c];for(let h=u.start;h<=u.end;h++)T0(s,o[h],a)}return new zo({points:s,options:{}})}function E0(n,t){const e=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const r=i[s];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function T0(n,t,e){const i=[];for(let s=0;s<e.length;s++){const r=e[s],{first:o,last:a,point:c}=I0(r,t,"x");if(!(!c||o&&a)){if(o)i.unshift(c);else if(n.push(c),!a)break}}n.push(...i)}function I0(n,t,e){const i=n.interpolate(t,e);if(!i)return{};const s=i[e],r=n.segments,o=n.points;let a=!1,c=!1;for(let u=0;u<r.length;u++){const h=r[u],d=o[h.start][e],g=o[h.end][e];if(Ve(s,d,g)){a=s===d,c=s===g;break}}return{first:a,last:c,point:i}}class jg{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:r,radius:o}=this;return e=e||{start:0,end:dt},t.arc(s,r,o,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,r=t.angle;return{x:e+Math.cos(r)*s,y:i+Math.sin(r)*s,angle:r}}}function S0(n){const{chart:t,fill:e,line:i}=n;if(vt(e))return x0(t,e);if(e==="stack")return w0(n);if(e==="shape")return!0;const s=A0(n);return s instanceof jg?s:Wg(s,i)}function x0(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function A0(n){return(n.scale||{}).getPointPositionForValue?C0(n):P0(n)}function P0(n){const{scale:t={},fill:e}=n,i=y0(e,t);if(vt(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function C0(n){const{scale:t,fill:e}=n,i=t.options,s=t.getLabels().length,r=i.reverse?t.max:t.min,o=b0(e,t,r),a=[];if(i.grid.circular){const c=t.getPointPositionForValue(0,r);return new jg({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)a.push(t.getPointPositionForValue(c,o));return a}function Wa(n,t,e){const i=S0(t),{chart:s,index:r,line:o,scale:a,axis:c}=t,u=o.options,h=u.fill,d=u.backgroundColor,{above:g=d,below:m=d}=h||{},y=s.getDatasetMeta(r),v=Eg(s,y);i&&o.points.length&&(Vo(n,e),k0(n,{line:o,target:i,above:g,below:m,area:e,scale:a,axis:c,clip:v}),Lo(n))}function k0(n,t){const{line:e,target:i,above:s,below:r,area:o,scale:a,clip:c}=t,u=e._loop?"angle":t.axis;n.save();let h=r;r!==s&&(u==="x"?(Jh(n,i,o.top),ja(n,{line:e,target:i,color:s,scale:a,property:u,clip:c}),n.restore(),n.save(),Jh(n,i,o.bottom)):u==="y"&&(Zh(n,i,o.left),ja(n,{line:e,target:i,color:r,scale:a,property:u,clip:c}),n.restore(),n.save(),Zh(n,i,o.right),h=s)),ja(n,{line:e,target:i,color:h,scale:a,property:u,clip:c}),n.restore()}function Jh(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:u}=a,h=s[c],d=s[Wo(c,u,s)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function Zh(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:u}=a,h=s[c],d=s[Wo(c,u,s)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(e,h.y),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function ja(n,t){const{line:e,target:i,property:s,color:r,scale:o,clip:a}=t,c=f0(e,i,s);for(const{source:u,target:h,start:d,end:g}of c){const{style:{backgroundColor:m=r}={}}=u,y=i!==!0;n.save(),n.fillStyle=m,R0(n,o,a,y&&dc(s,d,g)),n.beginPath();const v=!!e.pathSegment(n,u);let w;if(y){v?n.closePath():td(n,i,g,s);const P=!!i.pathSegment(n,h,{move:v,reverse:!0});w=v&&P,w||td(n,i,d,s)}n.closePath(),n.fill(w?"evenodd":"nonzero"),n.restore()}}function R0(n,t,e,i){const s=t.chart.chartArea,{property:r,start:o,end:a}=i||{};if(r==="x"||r==="y"){let c,u,h,d;r==="x"?(c=o,u=s.top,h=a,d=s.bottom):(c=s.left,u=o,h=s.right,d=a),n.beginPath(),e&&(c=Math.max(c,e.left),h=Math.min(h,e.right),u=Math.max(u,e.top),d=Math.min(d,e.bottom)),n.rect(c,u,h-c,d-u),n.clip()}}function td(n,t,e,i){const s=t.interpolate(e,i);s&&n.lineTo(s.x,s.y)}var D0={id:"filler",afterDatasetsUpdate(n,t,e){const i=(n.data.datasets||[]).length,s=[];let r,o,a,c;for(o=0;o<i;++o)r=n.getDatasetMeta(o),a=r.dataset,c=null,a&&a.options&&a instanceof zo&&(c={visible:n.isDatasetVisible(o),index:o,fill:m0(a,o,i),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=c,s.push(c);for(o=0;o<i;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=p0(s,o,e.propagate))},beforeDraw(n,t,e){const i=e.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),i&&a.fill&&Wa(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const r=i[s].$filler;Qh(r)&&Wa(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const i=t.meta.$filler;!Qh(i)||e.drawTime!=="beforeDatasetDraw"||Wa(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ed=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},M0=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class nd extends qe{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=lt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=At(i.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=ed(i,r);let u,h;e.font=s.string,this.isHorizontal()?(u=this.maxWidth,h=this._fitRows(o,r,a,c)+10):(h=this.maxHeight,u=this._fitCols(o,s,a,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],h=s+a;let d=t;r.textAlign="left",r.textBaseline="middle";let g=-1,m=-h;return this.legendItems.forEach((y,v)=>{const w=i+e/2+r.measureText(y.text).width;(v===0||u[u.length-1]+w+2*a>o)&&(d+=h,u[u.length-(v>0?0:1)]=0,m+=h,g++),c[v]={left:0,top:m,row:g,width:w,height:s},u[u.length-1]+=w+a}),d}_fitCols(t,e,i,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],h=o-t;let d=a,g=0,m=0,y=0,v=0;return this.legendItems.forEach((w,P)=>{const{itemWidth:C,itemHeight:D}=O0(i,e,r,w,s);P>0&&m+D+2*a>h&&(d+=g+a,u.push({width:g,height:m}),y+=g+a,v++,g=m=0),c[P]={left:y,top:m,col:v,width:C,height:D},g=Math.max(g,C),m+=D+a}),d+=g,u.push({width:g,height:m}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:r}}=this,o=Ei(r,this.left,this.width);if(this.isHorizontal()){let a=0,c=Bt(i,this.left+s,this.right-this.lineWidths[a]);for(const u of e)a!==u.row&&(a=u.row,c=Bt(i,this.left+s,this.right-this.lineWidths[a])),u.top+=this.top+t+s,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+s}else{let a=0,c=Bt(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const u of e)u.col!==a&&(a=u.col,c=Bt(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),u.top=c,u.left+=this.left+s,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Vo(t,this),this._draw(),Lo(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:r,labels:o}=t,a=gt.color,c=Ei(t.rtl,this.left,this.width),u=At(o.font),{padding:h}=o,d=u.size,g=d/2;let m;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=u.string;const{boxWidth:y,boxHeight:v,itemHeight:w}=ed(o,d),P=function(L,I,b){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;s.save();const T=G(b.lineWidth,1);if(s.fillStyle=G(b.fillStyle,a),s.lineCap=G(b.lineCap,"butt"),s.lineDashOffset=G(b.lineDashOffset,0),s.lineJoin=G(b.lineJoin,"miter"),s.lineWidth=T,s.strokeStyle=G(b.strokeStyle,a),s.setLineDash(G(b.lineDash,[])),o.usePointStyle){const A={radius:v*Math.SQRT2/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:T},x=c.xPlus(L,y/2),S=I+g;lg(s,A,x,S,o.pointStyleWidth&&y)}else{const A=I+Math.max((d-v)/2,0),x=c.leftForLtr(L,y),S=Kn(b.borderRadius);s.beginPath(),Object.values(S).some(E=>E!==0)?Bs(s,{x,y:A,w:y,h:v,radius:S}):s.rect(x,A,y,v),s.fill(),T!==0&&s.stroke()}s.restore()},C=function(L,I,b){ti(s,b.text,L,I+w/2,u,{strikethrough:b.hidden,textAlign:c.textAlign(b.textAlign)})},D=this.isHorizontal(),O=this._computeTitleHeight();D?m={x:Bt(r,this.left+h,this.right-i[0]),y:this.top+h+O,line:0}:m={x:this.left+h,y:Bt(r,this.top+O+h,this.bottom-e[0].height),line:0},_g(this.ctx,t.textDirection);const M=w+h;this.legendItems.forEach((L,I)=>{s.strokeStyle=L.fontColor,s.fillStyle=L.fontColor;const b=s.measureText(L.text).width,T=c.textAlign(L.textAlign||(L.textAlign=o.textAlign)),A=y+g+b;let x=m.x,S=m.y;c.setWidth(this.width),D?I>0&&x+A+h>this.right&&(S=m.y+=M,m.line++,x=m.x=Bt(r,this.left+h,this.right-i[m.line])):I>0&&S+M>this.bottom&&(x=m.x=x+e[m.line].width+h,m.line++,S=m.y=Bt(r,this.top+O+h,this.bottom-e[m.line].height));const E=c.x(x);if(P(E,S,L),x=Hy(T,x+y+g,D?x+A:this.right,t.rtl),C(c.x(x),S,L),D)m.x+=A+h;else if(typeof L.text!="string"){const j=u.lineHeight;m.y+=Hg(L,j)+h}else m.y+=M}),yg(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=At(e.font),s=Ht(e.padding);if(!e.display)return;const r=Ei(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=i.size/2,u=s.top+c;let h,d=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),h=this.top+u,d=Bt(t.align,d,this.right-g);else{const y=this.columnSizes.reduce((v,w)=>Math.max(v,w.height),0);h=u+Bt(t.align,this.top,this.bottom-y-t.labels.padding-this._computeTitleHeight())}const m=Bt(a,d,d+g);o.textAlign=r.textAlign(Xc(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,ti(o,e.text,m,h,i)}_computeTitleHeight(){const t=this.options.title,e=At(t.font),i=Ht(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,r;if(Ve(t,this.left,this.right)&&Ve(e,this.top,this.bottom)){for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(s=r[i],Ve(t,s.left,s.left+s.width)&&Ve(e,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const e=this.options;if(!L0(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,r=M0(s,i);s&&!r&&lt(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!r&&lt(e.onHover,[t,i,this],this)}else i&&lt(e.onClick,[t,i,this],this)}}function O0(n,t,e,i,s){const r=N0(i,n,t,e),o=V0(s,i,t.lineHeight);return{itemWidth:r,itemHeight:o}}function N0(n,t,e,i){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+i.measureText(s).width}function V0(n,t,e){let i=n;return typeof t.text!="string"&&(i=Hg(t,e)),i}function Hg(n,t){const e=n.text?n.text.length:0;return t*e}function L0(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var F0={id:"legend",_element:nd,start(n,t,e){const i=n.legend=new nd({ctx:n.ctx,options:e,chart:n});jt.configure(n,i,e),jt.addBox(n,i)},stop(n){jt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const i=n.legend;jt.configure(n,i,e),i.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const i=t.datasetIndex,s=e.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(e?0:void 0),h=Ht(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:r,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:u.borderColor,pointStyle:i||u.pointStyle,rotation:u.rotation,textAlign:s||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class ol extends qe{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const s=ft(i.text)?i.text.length:1;this._padding=Ht(i.padding);const r=s*At(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:i,bottom:s,right:r,options:o}=this,a=o.align;let c=0,u,h,d;return this.isHorizontal()?(h=Bt(a,i,r),d=e+t,u=r-i):(o.position==="left"?(h=i+t,d=Bt(a,s,e),c=st*-.5):(h=r-t,d=Bt(a,e,s),c=st*.5),u=s-e),{titleX:h,titleY:d,maxWidth:u,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=At(e.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:u}=this._drawArgs(r);ti(t,e.text,0,0,i,{color:e.color,maxWidth:c,rotation:u,textAlign:Xc(e.align),textBaseline:"middle",translation:[o,a]})}}function B0(n,t){const e=new ol({ctx:n.ctx,options:t,chart:n});jt.configure(n,e,t),jt.addBox(n,e),n.titleBlock=e}var U0={id:"title",_element:ol,start(n,t,e){B0(n,e)},stop(n){const t=n.titleBlock;jt.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const i=n.titleBlock;jt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Mr=new WeakMap;var z0={id:"subtitle",start(n,t,e){const i=new ol({ctx:n.ctx,options:e,chart:n});jt.configure(n,i,e),jt.addBox(n,i),Mr.set(n,i)},stop(n){jt.removeBox(n,Mr.get(n)),Mr.delete(n)},beforeUpdate(n,t,e){const i=Mr.get(n);jt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ys={average(n){if(!n.length)return!1;let t,e,i=new Set,s=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const c=a.tooltipPosition();i.add(c.x),s+=c.y,++r}}return r===0||i.size===0?!1:{x:[...i].reduce((a,c)=>a+c)/i.size,y:s/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,i=t.y,s=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const c=n[r].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),h=rc(t,u);h<s&&(s=h,a=c)}}if(a){const c=a.tooltipPosition();e=c.x,i=c.y}return{x:e,y:i}}};function pe(n,t){return t&&(ft(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Me(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function W0(n,t){const{element:e,datasetIndex:i,index:s}=t,r=n.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:n,label:o,parsed:r.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:e}}function id(n,t){const e=n.chart.ctx,{body:i,footer:s,title:r}=n,{boxWidth:o,boxHeight:a}=t,c=At(t.bodyFont),u=At(t.titleFont),h=At(t.footerFont),d=r.length,g=s.length,m=i.length,y=Ht(t.padding);let v=y.height,w=0,P=i.reduce((O,M)=>O+M.before.length+M.lines.length+M.after.length,0);if(P+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*u.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),P){const O=t.displayColors?Math.max(a,c.lineHeight):c.lineHeight;v+=m*O+(P-m)*c.lineHeight+(P-1)*t.bodySpacing}g&&(v+=t.footerMarginTop+g*h.lineHeight+(g-1)*t.footerSpacing);let C=0;const D=function(O){w=Math.max(w,e.measureText(O).width+C)};return e.save(),e.font=u.string,at(n.title,D),e.font=c.string,at(n.beforeBody.concat(n.afterBody),D),C=t.displayColors?o+2+t.boxPadding:0,at(i,O=>{at(O.before,D),at(O.lines,D),at(O.after,D)}),C=0,e.font=h.string,at(n.footer,D),e.restore(),w+=y.width,{width:w,height:v}}function j0(n,t){const{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}function H0(n,t,e,i){const{x:s,width:r}=i,o=e.caretSize+e.caretPadding;if(n==="left"&&s+r+o>t.width||n==="right"&&s-r-o<0)return!0}function $0(n,t,e,i){const{x:s,width:r}=e,{width:o,chartArea:{left:a,right:c}}=n;let u="center";return i==="center"?u=s<=(a+c)/2?"left":"right":s<=r/2?u="left":s>=o-r/2&&(u="right"),H0(u,n,t,e)&&(u="center"),u}function sd(n,t,e){const i=e.yAlign||t.yAlign||j0(n,e);return{xAlign:e.xAlign||t.xAlign||$0(n,t,e,i),yAlign:i}}function q0(n,t){let{x:e,width:i}=n;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function G0(n,t,e){let{y:i,height:s}=n;return t==="top"?i+=e:t==="bottom"?i-=s+e:i-=s/2,i}function rd(n,t,e,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:c}=e,u=s+r,{topLeft:h,topRight:d,bottomLeft:g,bottomRight:m}=Kn(o);let y=q0(t,a);const v=G0(t,c,u);return c==="center"?a==="left"?y+=u:a==="right"&&(y-=u):a==="left"?y-=Math.max(h,g)+s:a==="right"&&(y+=Math.max(d,m)+s),{x:Rt(y,0,i.width-t.width),y:Rt(v,0,i.height-t.height)}}function Or(n,t,e){const i=Ht(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-i.right:n.x+i.left}function od(n){return pe([],Me(n))}function Y0(n,t,e){return Cn(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function ad(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const $g={beforeTitle:Re,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:Re,beforeBody:Re,beforeLabel:Re,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Q(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Re,afterBody:Re,beforeFooter:Re,footer:Re,afterFooter:Re};function Yt(n,t,e,i){const s=n[t].call(e,i);return typeof s>"u"?$g[t].call(e,i):s}class cd extends qe{static positioners=ys;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&e.options.animation&&i.animations,r=new Tg(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=Y0(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:i}=e,s=Yt(i,"beforeTitle",this,t),r=Yt(i,"title",this,t),o=Yt(i,"afterTitle",this,t);let a=[];return a=pe(a,Me(s)),a=pe(a,Me(r)),a=pe(a,Me(o)),a}getBeforeBody(t,e){return od(Yt(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,s=[];return at(t,r=>{const o={before:[],lines:[],after:[]},a=ad(i,r);pe(o.before,Me(Yt(a,"beforeLabel",this,r))),pe(o.lines,Yt(a,"label",this,r)),pe(o.after,Me(Yt(a,"afterLabel",this,r))),s.push(o)}),s}getAfterBody(t,e){return od(Yt(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,s=Yt(i,"beforeFooter",this,t),r=Yt(i,"footer",this,t),o=Yt(i,"afterFooter",this,t);let a=[];return a=pe(a,Me(s)),a=pe(a,Me(r)),a=pe(a,Me(o)),a}_createItems(t){const e=this._active,i=this.chart.data,s=[],r=[],o=[];let a=[],c,u;for(c=0,u=e.length;c<u;++c)a.push(W0(this.chart,e[c]));return t.filter&&(a=a.filter((h,d,g)=>t.filter(h,d,g,i))),t.itemSort&&(a=a.sort((h,d)=>t.itemSort(h,d,i))),at(a,h=>{const d=ad(t.callbacks,h);s.push(Yt(d,"labelColor",this,h)),r.push(Yt(d,"labelPointStyle",this,h)),o.push(Yt(d,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const i=this.options.setContext(this.getContext()),s=this._active;let r,o=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const a=ys[i.position].call(this,s,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const c=this._size=id(this,i),u=Object.assign({},a,c),h=sd(this.chart,i,u),d=rd(i,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:c.width,height:c.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,s){const r=this.getCaretPosition(t,i,s);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:s,yAlign:r}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:d}=Kn(a),{x:g,y:m}=t,{width:y,height:v}=e;let w,P,C,D,O,M;return r==="center"?(O=m+v/2,s==="left"?(w=g,P=w-o,D=O+o,M=O-o):(w=g+y,P=w+o,D=O-o,M=O+o),C=w):(s==="left"?P=g+Math.max(c,h)+o:s==="right"?P=g+y-Math.max(u,d)-o:P=this.caretX,r==="top"?(D=m,O=D-o,w=P-o,C=P+o):(D=m+v,O=D+o,w=P+o,C=P-o),M=D),{x1:w,x2:P,x3:C,y1:D,y2:O,y3:M}}drawTitle(t,e,i){const s=this.title,r=s.length;let o,a,c;if(r){const u=Ei(i.rtl,this.x,this.width);for(t.x=Or(this,i.titleAlign,i),e.textAlign=u.textAlign(i.titleAlign),e.textBaseline="middle",o=At(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,c=0;c<r;++c)e.fillText(s[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,c+1===r&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,s,r){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:c,boxWidth:u}=r,h=At(r.bodyFont),d=Or(this,"left",r),g=s.x(d),m=c<h.lineHeight?(h.lineHeight-c)/2:0,y=e.y+m;if(r.usePointStyle){const v={radius:Math.min(u,c)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},w=s.leftForLtr(g,u)+u/2,P=y+c/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,ac(t,v,w,P),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,ac(t,v,w,P)}else{t.lineWidth=nt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const v=s.leftForLtr(g,u),w=s.leftForLtr(s.xPlus(g,1),u-2),P=Kn(o.borderRadius);Object.values(P).some(C=>C!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Bs(t,{x:v,y,w:u,h:c,radius:P}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Bs(t,{x:w,y:y+1,w:u-2,h:c-2,radius:P}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(v,y,u,c),t.strokeRect(v,y,u,c),t.fillStyle=o.backgroundColor,t.fillRect(w,y+1,u-2,c-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:s}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:c,boxWidth:u,boxPadding:h}=i,d=At(i.bodyFont);let g=d.lineHeight,m=0;const y=Ei(i.rtl,this.x,this.width),v=function(b){e.fillText(b,y.x(t.x+m),t.y+g/2),t.y+=g+r},w=y.textAlign(o);let P,C,D,O,M,L,I;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=Or(this,w,i),e.fillStyle=i.bodyColor,at(this.beforeBody,v),m=a&&w!=="right"?o==="center"?u/2+h:u+2+h:0,O=0,L=s.length;O<L;++O){for(P=s[O],C=this.labelTextColors[O],e.fillStyle=C,at(P.before,v),D=P.lines,a&&D.length&&(this._drawColorBox(e,t,O,y,i),g=Math.max(d.lineHeight,c)),M=0,I=D.length;M<I;++M)v(D[M]),g=d.lineHeight;at(P.after,v)}m=0,g=d.lineHeight,at(this.afterBody,v),t.y-=r}drawFooter(t,e,i){const s=this.footer,r=s.length;let o,a;if(r){const c=Ei(i.rtl,this.x,this.width);for(t.x=Or(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=c.textAlign(i.footerAlign),e.textBaseline="middle",o=At(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(s[a],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,s){const{xAlign:r,yAlign:o}=this,{x:a,y:c}=t,{width:u,height:h}=i,{topLeft:d,topRight:g,bottomLeft:m,bottomRight:y}=Kn(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+d,c),o==="top"&&this.drawCaret(t,e,i,s),e.lineTo(a+u-g,c),e.quadraticCurveTo(a+u,c,a+u,c+g),o==="center"&&r==="right"&&this.drawCaret(t,e,i,s),e.lineTo(a+u,c+h-y),e.quadraticCurveTo(a+u,c+h,a+u-y,c+h),o==="bottom"&&this.drawCaret(t,e,i,s),e.lineTo(a+m,c+h),e.quadraticCurveTo(a,c+h,a,c+h-m),o==="center"&&r==="left"&&this.drawCaret(t,e,i,s),e.lineTo(a,c+d),e.quadraticCurveTo(a,c,a+d,c),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,s=i&&i.x,r=i&&i.y;if(s||r){const o=ys[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=id(this,t),c=Object.assign({},o,this._size),u=sd(e,t,c),h=rd(t,c,u,e);(s._to!==h.x||r._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=Ht(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,s,e),_g(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),yg(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,s=t.map(({datasetIndex:a,index:c})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[c],index:c}}),r=!so(i,s),o=this._positionChanged(s,e);(r||o)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,i),a=this._positionChanged(o,t),c=e||!so(o,r)||a;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),c}_getActiveElements(t,e,i,s){const r=this.options;if(t.type==="mouseout")return[];if(!s)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:i,caretY:s,options:r}=this,o=ys[r.position].call(this,t,e);return o!==!1&&(i!==o.x||s!==o.y)}}var K0={id:"tooltip",_element:cd,positioners:ys,afterInit(n,t,e){e&&(n.tooltip=new cd({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:$g},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},X0=Object.freeze({__proto__:null,Colors:c0,Decimation:d0,Filler:D0,Legend:F0,SubTitle:z0,Title:U0,Tooltip:K0});const Q0=(n,t,e,i)=>(typeof t=="string"?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function J0(n,t,e,i){const s=n.indexOf(t);if(s===-1)return Q0(n,t,e,i);const r=n.lastIndexOf(t);return s!==r?e:s}const Z0=(n,t)=>n===null?null:Rt(Math.round(n),0,t);function ld(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class tE extends oi{static id="category";static defaults={ticks:{callback:ld}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const i=this.getLabels();for(const{index:s,label:r}of e)i[s]===r&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Q(t))return null;const i=this.getLabels();return e=isFinite(e)&&i[e]===t?e:J0(i,t,G(e,t),this._addedLabels),Z0(e,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),e||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,s=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=t;o<=e;o++)s.push({value:o});return s}getLabelForValue(t){return ld.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function eE(n,t){const e=[],{bounds:s,step:r,min:o,max:a,precision:c,count:u,maxTicks:h,maxDigits:d,includeBounds:g}=n,m=r||1,y=h-1,{min:v,max:w}=t,P=!Q(o),C=!Q(a),D=!Q(u),O=(w-v)/(d+1);let M=ih((w-v)/y/m)*m,L,I,b,T;if(M<1e-14&&!P&&!C)return[{value:v},{value:w}];T=Math.ceil(w/M)-Math.floor(v/M),T>y&&(M=ih(T*M/y/m)*m),Q(c)||(L=Math.pow(10,c),M=Math.ceil(M*L)/L),s==="ticks"?(I=Math.floor(v/M)*M,b=Math.ceil(w/M)*M):(I=v,b=w),P&&C&&r&&Ly((a-o)/r,M/1e3)?(T=Math.round(Math.min((a-o)/M,h)),M=(a-o)/T,I=o,b=a):D?(I=P?o:I,b=C?a:b,T=u-1,M=(b-I)/T):(T=(b-I)/M,Is(T,Math.round(T),M/1e3)?T=Math.round(T):T=Math.ceil(T));const A=Math.max(sh(M),sh(I));L=Math.pow(10,Q(c)?A:c),I=Math.round(I*L)/L,b=Math.round(b*L)/L;let x=0;for(P&&(g&&I!==o?(e.push({value:o}),I<o&&x++,Is(Math.round((I+x*M)*L)/L,o,ud(o,O,n))&&x++):I<o&&x++);x<T;++x){const S=Math.round((I+x*M)*L)/L;if(C&&S>a)break;e.push({value:S})}return C&&g&&b!==a?e.length&&Is(e[e.length-1].value,a,ud(a,O,n))?e[e.length-1].value=a:e.push({value:a}):(!C||b===a)&&e.push({value:b}),e}function ud(n,t,{horizontal:e,minRotation:i}){const s=le(i),r=(e?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class ho extends oi{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Q(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this;const o=c=>s=e?s:c,a=c=>r=i?r:c;if(t){const c=ve(s),u=ve(r);c<0&&u<0?a(0):c>0&&u>0&&o(0)}if(s===r){let c=r===0?1:Math.abs(r*.05);a(r+c),t||o(s-c)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=eE(s,r);return t.bounds==="ticks"&&tg(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Zs(t,this.chart.options.locale,this.options.ticks.format)}}class nE extends ho{static id="linear";static defaults={ticks:{callback:No.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=vt(t)?t:0,this.max=vt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=le(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const zs=n=>Math.floor(ln(n)),Un=(n,t)=>Math.pow(10,zs(n)+t);function hd(n){return n/Math.pow(10,zs(n))===1}function dd(n,t,e){const i=Math.pow(10,e),s=Math.floor(n/i);return Math.ceil(t/i)-s}function iE(n,t){const e=t-n;let i=zs(e);for(;dd(n,t,i)>10;)i++;for(;dd(n,t,i)<10;)i--;return Math.min(i,zs(n))}function sE(n,{min:t,max:e}){t=Jt(n.min,t);const i=[],s=zs(t);let r=iE(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),c=s>r?Math.pow(10,s):0,u=Math.round((t-c)*o)/o,h=Math.floor((t-c)/a/10)*a*10;let d=Math.floor((u-h)/Math.pow(10,r)),g=Jt(n.min,Math.round((c+h+d*Math.pow(10,r))*o)/o);for(;g<e;)i.push({value:g,major:hd(g),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),g=Math.round((c+h+d*Math.pow(10,r))*o)/o;const m=Jt(n.max,g);return i.push({value:m,major:hd(m),significand:d}),i}class rE extends oi{static id="logarithmic";static defaults={ticks:{callback:No.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=ho.prototype.parse.apply(this,[t,e]);if(i===0){this._zero=!0;return}return vt(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=vt(t)?Math.max(0,t):null,this.max=vt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!vt(this._userMin)&&(this.min=t===Un(this.min,0)?Un(this.min,-1):Un(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const r=a=>i=t?i:a,o=a=>s=e?s:a;i===s&&(i<=0?(r(1),o(10)):(r(Un(i,-1)),o(Un(s,1)))),i<=0&&r(Un(s,-1)),s<=0&&o(Un(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},i=sE(e,this);return t.bounds==="ticks"&&tg(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Zs(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=ln(t),this._valueRange=ln(this.max)-ln(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(ln(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function fc(n){const t=n.ticks;if(t.display&&n.display){const e=Ht(t.backdropPadding);return G(t.font&&t.font.size,gt.font.size)+e.height}return 0}function oE(n,t,e){return e=ft(e)?e:[e],{w:tb(n,t.string,e),h:e.length*t.lineHeight}}function fd(n,t,e,i,s){return n===i||n===s?{start:t-e/2,end:t+e/2}:n<i||n>s?{start:t-e,end:t}:{start:t,end:t+e}}function aE(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],s=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?st/r:0;for(let c=0;c<r;c++){const u=o.setContext(n.getPointLabelContext(c));s[c]=u.padding;const h=n.getPointPosition(c,n.drawingArea+s[c],a),d=At(u.font),g=oE(n.ctx,d,n._pointLabels[c]);i[c]=g;const m=zt(n.getIndexAngle(c)+a),y=Math.round(Yc(m)),v=fd(y,h.x,g.w,0,180),w=fd(y,h.y,g.h,90,270);cE(e,t,m,v,w)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=hE(n,i,s)}function cE(n,t,e,i,s){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,c=0;i.start<t.l?(a=(t.l-i.start)/r,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),s.start<t.t?(c=(t.t-s.start)/o,n.t=Math.min(n.t,t.t-c)):s.end>t.b&&(c=(s.end-t.b)/o,n.b=Math.max(n.b,t.b+c))}function lE(n,t,e){const i=n.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=e,c=n.getPointPosition(t,i+s+o,r),u=Math.round(Yc(zt(c.angle+Et))),h=gE(c.y,a.h,u),d=dE(u),g=fE(c.x,a.w,d);return{visible:!0,x:c.x,y:h,textAlign:d,left:g,top:h,right:g+a.w,bottom:h+a.h}}function uE(n,t){if(!t)return!0;const{left:e,top:i,right:s,bottom:r}=n;return!(Fe({x:e,y:i},t)||Fe({x:e,y:r},t)||Fe({x:s,y:i},t)||Fe({x:s,y:r},t))}function hE(n,t,e){const i=[],s=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,c={extra:fc(r)/2,additionalAngle:o?st/s:0};let u;for(let h=0;h<s;h++){c.padding=e[h],c.size=t[h];const d=lE(n,h,c);i.push(d),a==="auto"&&(d.visible=uE(d,u),d.visible&&(u=d))}return i}function dE(n){return n===0||n===180?"center":n<180?"left":"right"}function fE(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function gE(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function pE(n,t,e){const{left:i,top:s,right:r,bottom:o}=e,{backdropColor:a}=t;if(!Q(a)){const c=Kn(t.borderRadius),u=Ht(t.backdropPadding);n.fillStyle=a;const h=i-u.left,d=s-u.top,g=r-i+u.width,m=o-s+u.height;Object.values(c).some(y=>y!==0)?(n.beginPath(),Bs(n,{x:h,y:d,w:g,h:m,radius:c}),n.fill()):n.fillRect(h,d,g,m)}}function mE(n,t){const{ctx:e,options:{pointLabels:i}}=n;for(let s=t-1;s>=0;s--){const r=n._pointLabelItems[s];if(!r.visible)continue;const o=i.setContext(n.getPointLabelContext(s));pE(e,o,r);const a=At(o.font),{x:c,y:u,textAlign:h}=r;ti(e,n._pointLabels[s],c,u+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function qg(n,t,e,i){const{ctx:s}=n;if(e)s.arc(n.xCenter,n.yCenter,t,0,dt);else{let r=n.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<i;o++)r=n.getPointPosition(o,t),s.lineTo(r.x,r.y)}}function _E(n,t,e,i,s){const r=n.ctx,o=t.circular,{color:a,lineWidth:c}=t;!o&&!i||!a||!c||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=c,r.setLineDash(s.dash||[]),r.lineDashOffset=s.dashOffset,r.beginPath(),qg(n,e,o,i),r.closePath(),r.stroke(),r.restore())}function yE(n,t,e){return Cn(n,{label:e,index:t,type:"pointLabel"})}class bE extends ho{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:No.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Ht(fc(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=vt(t)&&!isNaN(t)?t:0,this.max=vt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/fc(this.options))}generateTickLabels(t){ho.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{const s=lt(this.options.pointLabels.callback,[e,i],this);return s||s===0?s:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?aE(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){const e=dt/(this._pointLabels.length||1),i=this.options.startAngle||0;return zt(t*e+le(i))}getDistanceFromCenterForValue(t){if(Q(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Q(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return yE(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-Et+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:r}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),qg(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:s,border:r}=e,o=this._pointLabels.length;let a,c,u;if(e.pointLabels.display&&mE(this,o),s.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);const g=this.getContext(d),m=s.setContext(g),y=r.setContext(g);_E(this,m,c,o,y)}}),i.display){for(t.save(),a=o-1;a>=0;a--){const h=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:g}=h;!g||!d||(t.lineWidth=g,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),u=this.getPointPosition(a,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(u.x,u.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!e.reverse)return;const u=i.setContext(this.getContext(c)),h=At(u.font);if(r=this.getDistanceFromCenterForValue(this.ticks[c].value),u.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=u.backdropColor;const d=Ht(u.backdropPadding);t.fillRect(-o/2-d.left,-r-h.size/2-d.top,o+d.width,h.size+d.height)}ti(t,a.label,0,-r,h,{color:u.color,strokeColor:u.textStrokeColor,strokeWidth:u.textStrokeWidth})}),t.restore()}drawTitle(){}}const jo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Xt=Object.keys(jo);function gd(n,t){return n-t}function pd(n,t){if(Q(t))return null;const e=n._adapter,{parser:i,round:s,isoWeekday:r}=n._parseOpts;let o=t;return typeof i=="function"&&(o=i(o)),vt(o)||(o=typeof i=="string"?e.parse(o,i):e.parse(o)),o===null?null:(s&&(o=s==="week"&&(Pi(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,s)),+o)}function md(n,t,e,i){const s=Xt.length;for(let r=Xt.indexOf(n);r<s-1;++r){const o=jo[Xt[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=i)return Xt[r]}return Xt[s-1]}function vE(n,t,e,i,s){for(let r=Xt.length-1;r>=Xt.indexOf(e);r--){const o=Xt[r];if(jo[o].common&&n._adapter.diff(s,i,o)>=t-1)return o}return Xt[e?Xt.indexOf(e):0]}function wE(n){for(let t=Xt.indexOf(n)+1,e=Xt.length;t<e;++t)if(jo[Xt[t]].common)return Xt[t]}function _d(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:i,hi:s}=Kc(e,t),r=e[i]>=t?e[i]:e[s];n[r]=!0}}function EE(n,t,e,i){const s=n._adapter,r=+s.startOf(t[0].value,i),o=t[t.length-1].value;let a,c;for(a=r;a<=o;a=+s.add(a,1,i))c=e[a],c>=0&&(t[c].major=!0);return t}function yd(n,t,e){const i=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,i.push({value:a,major:!1});return r===0||!e?i:EE(n,i,s,e)}class gc extends oi{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),s=this._adapter=new Tv._date(t.adapters.date);s.init(e),Ts(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:pd(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:s,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(s=Math.min(s,u.min)),!a&&!isNaN(u.max)&&(r=Math.max(r,u.max))}(!o||!a)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=vt(s)&&!isNaN(s)?s:+e.startOf(Date.now(),i),r=vt(r)&&!isNaN(r)?r:+e.endOf(Date.now(),i)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,o=this.max,a=zy(s,r,o);return this._unit=e.unit||(i.autoSkip?md(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):vE(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:wE(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),yd(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,i=0,s,r;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?e=1-s:e=(this.getDecimalForValue(t[1])-s)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?i=r:i=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=Rt(e,0,o),i=Rt(i,0,o),this._offsets={start:e,end:i,factor:1/(e+1+i)}}_generate(){const t=this._adapter,e=this.min,i=this.max,s=this.options,r=s.time,o=r.unit||md(r.minUnit,e,i,this._getLabelCapacity(e)),a=G(s.ticks.stepSize,1),c=o==="week"?r.isoWeekday:!1,u=Pi(c)||c===!0,h={};let d=e,g,m;if(u&&(d=+t.startOf(d,"isoWeek",c)),d=+t.startOf(d,u?"day":o),t.diff(i,e,o)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+o);const y=s.ticks.source==="data"&&this.getDataTimestamps();for(g=d,m=0;g<i;g=+t.add(g,a,o),m++)_d(h,g,y);return(g===i||s.bounds==="ticks"||m===1)&&_d(h,g,y),Object.keys(h).sort(gd).map(v=>+v)}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const s=this.options.time.displayFormats,r=this._unit,o=e||s[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,i,s){const r=this.options,o=r.ticks.callback;if(o)return lt(o,[t,e,i],this);const a=r.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&a[c],d=u&&a[u],g=i[e],m=u&&d&&g&&g.major;return this._adapter.format(t,s||(m?d:h))}generateTickLabels(t){let e,i,s;for(e=0,i=t.length;e<i;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,s=le(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*r+a*o,h:i*o+a*r}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,s=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,yd(this,[t],this._majorUnit),s),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(e=0,i=s.length;e<i;++e)t=t.concat(s[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const s=this.getLabels();for(e=0,i=s.length;e<i;++e)t.push(pd(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return ig(t.sort(gd))}}function Nr(n,t,e){let i=0,s=n.length-1,r,o,a,c;e?(t>=n[i].pos&&t<=n[s].pos&&({lo:i,hi:s}=Le(n,"pos",t)),{pos:r,time:a}=n[i],{pos:o,time:c}=n[s]):(t>=n[i].time&&t<=n[s].time&&({lo:i,hi:s}=Le(n,"time",t)),{time:r,pos:a}=n[i],{time:o,pos:c}=n[s]);const u=o-r;return u?a+(c-a)*(t-r)/u:a}class TE extends gc{static id="timeseries";static defaults=gc.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Nr(e,this.min),this._tableRange=Nr(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],r=[];let o,a,c,u,h;for(o=0,a=t.length;o<a;++o)u=t[o],u>=e&&u<=i&&s.push(u);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)h=s[o+1],c=s[o-1],u=s[o],Math.round((h+c)/2)!==u&&r.push({time:u,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((s,r)=>s-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Nr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return Nr(this._table,i*this._tableRange+this._minPos,!0)}}var IE=Object.freeze({__proto__:null,CategoryScale:tE,LinearScale:nE,LogarithmicScale:rE,RadialLinearScale:bE,TimeScale:gc,TimeSeriesScale:TE});const SE=[Ev,e0,X0,IE];Uo.register(...SE);const Gg=6048e5,xE=864e5,Yg=6e4,Kg=36e5,bd=Symbol.for("constructDateFrom");function te(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&bd in n?n[bd](t):n instanceof Date?new n.constructor(t):new Date(t)}function Nt(n,t){return te(t||n,n)}function Xg(n,t,e){const i=Nt(n,e?.in);if(isNaN(t))return te(n,NaN);if(!t)return i;const s=i.getDate(),r=te(n,i.getTime());r.setMonth(i.getMonth()+t+1,0);const o=r.getDate();return s>=o?r:(i.setFullYear(r.getFullYear(),r.getMonth(),s),i)}let AE={};function tr(){return AE}function Ri(n,t){const e=tr(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,s=Nt(n,t?.in),r=s.getDay(),o=(r<i?7:0)+r-i;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function fo(n,t){return Ri(n,{...t,weekStartsOn:1})}function Qg(n,t){const e=Nt(n,t?.in),i=e.getFullYear(),s=te(e,0);s.setFullYear(i+1,0,4),s.setHours(0,0,0,0);const r=fo(s),o=te(e,0);o.setFullYear(i,0,4),o.setHours(0,0,0,0);const a=fo(o);return e.getTime()>=r.getTime()?i+1:e.getTime()>=a.getTime()?i:i-1}function vd(n){const t=Nt(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function Ho(n,...t){const e=te.bind(null,t.find(i=>typeof i=="object"));return t.map(e)}function go(n,t){const e=Nt(n,t?.in);return e.setHours(0,0,0,0),e}function PE(n,t,e){const[i,s]=Ho(e?.in,n,t),r=go(i),o=go(s),a=+r-vd(r),c=+o-vd(o);return Math.round((a-c)/xE)}function CE(n,t){const e=Qg(n,t),i=te(n,0);return i.setFullYear(e,0,4),i.setHours(0,0,0,0),fo(i)}function kE(n,t,e){const[i,s]=Ho(e?.in,n,t);return+go(i)==+go(s)}function RE(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function DE(n){return!(!RE(n)&&typeof n!="number"||isNaN(+Nt(n)))}function ME(n,t){const e=Nt(n,t?.in),i=e.getMonth();return e.setFullYear(e.getFullYear(),i+1,0),e.setHours(23,59,59,999),e}function Jg(n,t){const[e,i]=Ho(n,t.start,t.end);return{start:e,end:i}}function OE(n,t){const{start:e,end:i}=Jg(t?.in,n);let s=+e>+i;const r=s?+e:+i,o=s?i:e;o.setHours(0,0,0,0);let a=1;const c=[];for(;+o<=r;)c.push(te(e,o)),o.setDate(o.getDate()+a),o.setHours(0,0,0,0);return s?c.reverse():c}function NE(n,t){const{start:e,end:i}=Jg(t?.in,n);let s=+e>+i;const r=s?+e:+i,o=s?i:e;o.setHours(0,0,0,0),o.setDate(1);let a=1;const c=[];for(;+o<=r;)c.push(te(e,o)),o.setMonth(o.getMonth()+a);return s?c.reverse():c}function VE(n,t){const e=Nt(n,t?.in);return e.setDate(1),e.setHours(0,0,0,0),e}function LE(n,t){const e=Nt(n,t?.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function FE(n,t){const e=tr(),i=e.weekStartsOn??e.locale?.options?.weekStartsOn??0,s=Nt(n,t?.in),r=s.getDay(),o=(r<i?-7:0)+6-(r-i);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const BE={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},UE=(n,t,e)=>{let i;const s=BE[n];return typeof s=="string"?i=s:t===1?i=s.one:i=s.other.replace("{{count}}",t.toString()),e?.addSuffix?e.comparison&&e.comparison>0?"in "+i:i+" ago":i};function Ti(n){return(t={})=>{const e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}const zE={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},WE={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jE={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},HE={date:Ti({formats:zE,defaultWidth:"full"}),time:Ti({formats:WE,defaultWidth:"full"}),dateTime:Ti({formats:jE,defaultWidth:"full"})},$E={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},qE=(n,t,e,i)=>$E[n];function ye(n){return(t,e)=>{const i=e?.context?String(e.context):"standalone";let s;if(i==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=e?.width?String(e.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=e?.width?String(e.width):n.defaultWidth;s=n.values[a]||n.values[o]}const r=n.argumentCallback?n.argumentCallback(t):t;return s[r]}}const GE={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},YE={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},KE={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XE={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},QE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},JE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ZE=(n,t)=>{const e=Number(n),i=e%100;if(i>20||i<10)switch(i%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},tT={ordinalNumber:ZE,era:ye({values:GE,defaultWidth:"wide"}),quarter:ye({values:YE,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ye({values:KE,defaultWidth:"wide"}),day:ye({values:XE,defaultWidth:"wide"}),dayPeriod:ye({values:QE,defaultWidth:"wide",formattingValues:JE,defaultFormattingWidth:"wide"})};function be(n){return(t,e={})=>{const i=e.width,s=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],r=t.match(s);if(!r)return null;const o=r[0],a=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?nT(a,d=>d.test(o)):eT(a,d=>d.test(o));let u;u=n.valueCallback?n.valueCallback(c):c,u=e.valueCallback?e.valueCallback(u):u;const h=t.slice(o.length);return{value:u,rest:h}}}function eT(n,t){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function nT(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function Zg(n){return(t,e={})=>{const i=t.match(n.matchPattern);if(!i)return null;const s=i[0],r=t.match(n.parsePattern);if(!r)return null;let o=n.valueCallback?n.valueCallback(r[0]):r[0];o=e.valueCallback?e.valueCallback(o):o;const a=t.slice(s.length);return{value:o,rest:a}}}const iT=/^(\d+)(th|st|nd|rd)?/i,sT=/\d+/i,rT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oT={any:[/^b/i,/^(a|c)/i]},aT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cT={any:[/1/i,/2/i,/3/i,/4/i]},lT={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},dT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},pT={ordinalNumber:Zg({matchPattern:iT,parsePattern:sT,valueCallback:n=>parseInt(n,10)}),era:be({matchPatterns:rT,defaultMatchWidth:"wide",parsePatterns:oT,defaultParseWidth:"any"}),quarter:be({matchPatterns:aT,defaultMatchWidth:"wide",parsePatterns:cT,defaultParseWidth:"any",valueCallback:n=>n+1}),month:be({matchPatterns:lT,defaultMatchWidth:"wide",parsePatterns:uT,defaultParseWidth:"any"}),day:be({matchPatterns:hT,defaultMatchWidth:"wide",parsePatterns:dT,defaultParseWidth:"any"}),dayPeriod:be({matchPatterns:fT,defaultMatchWidth:"any",parsePatterns:gT,defaultParseWidth:"any"})},mT={code:"en-US",formatDistance:UE,formatLong:HE,formatRelative:qE,localize:tT,match:pT,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _T(n,t){const e=Nt(n,t?.in);return PE(e,LE(e))+1}function yT(n,t){const e=Nt(n,t?.in),i=+fo(e)-+CE(e);return Math.round(i/Gg)+1}function tp(n,t){const e=Nt(n,t?.in),i=e.getFullYear(),s=tr(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=te(t?.in||n,0);o.setFullYear(i+1,0,r),o.setHours(0,0,0,0);const a=Ri(o,t),c=te(t?.in||n,0);c.setFullYear(i,0,r),c.setHours(0,0,0,0);const u=Ri(c,t);return+e>=+a?i+1:+e>=+u?i:i-1}function bT(n,t){const e=tr(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??e.firstWeekContainsDate??e.locale?.options?.firstWeekContainsDate??1,s=tp(n,t),r=te(t?.in||n,0);return r.setFullYear(s,0,i),r.setHours(0,0,0,0),Ri(r,t)}function vT(n,t){const e=Nt(n,t?.in),i=+Ri(e,t)-+bT(e,t);return Math.round(i/Gg)+1}function ot(n,t){const e=n<0?"-":"",i=Math.abs(n).toString().padStart(t,"0");return e+i}const nn={y(n,t){const e=n.getFullYear(),i=e>0?e:1-e;return ot(t==="yy"?i%100:i,t.length)},M(n,t){const e=n.getMonth();return t==="M"?String(e+1):ot(e+1,2)},d(n,t){return ot(n.getDate(),t.length)},a(n,t){const e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(n,t){return ot(n.getHours()%12||12,t.length)},H(n,t){return ot(n.getHours(),t.length)},m(n,t){return ot(n.getMinutes(),t.length)},s(n,t){return ot(n.getSeconds(),t.length)},S(n,t){const e=t.length,i=n.getMilliseconds(),s=Math.trunc(i*Math.pow(10,e-3));return ot(s,t.length)}},mi={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wd={G:function(n,t,e){const i=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(i,{width:"abbreviated"});case"GGGGG":return e.era(i,{width:"narrow"});case"GGGG":default:return e.era(i,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){const i=n.getFullYear(),s=i>0?i:1-i;return e.ordinalNumber(s,{unit:"year"})}return nn.y(n,t)},Y:function(n,t,e,i){const s=tp(n,i),r=s>0?s:1-s;if(t==="YY"){const o=r%100;return ot(o,2)}return t==="Yo"?e.ordinalNumber(r,{unit:"year"}):ot(r,t.length)},R:function(n,t){const e=Qg(n);return ot(e,t.length)},u:function(n,t){const e=n.getFullYear();return ot(e,t.length)},Q:function(n,t,e){const i=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return ot(i,2);case"Qo":return e.ordinalNumber(i,{unit:"quarter"});case"QQQ":return e.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(i,{width:"wide",context:"formatting"})}},q:function(n,t,e){const i=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return ot(i,2);case"qo":return e.ordinalNumber(i,{unit:"quarter"});case"qqq":return e.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(i,{width:"wide",context:"standalone"})}},M:function(n,t,e){const i=n.getMonth();switch(t){case"M":case"MM":return nn.M(n,t);case"Mo":return e.ordinalNumber(i+1,{unit:"month"});case"MMM":return e.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(i,{width:"wide",context:"formatting"})}},L:function(n,t,e){const i=n.getMonth();switch(t){case"L":return String(i+1);case"LL":return ot(i+1,2);case"Lo":return e.ordinalNumber(i+1,{unit:"month"});case"LLL":return e.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(i,{width:"wide",context:"standalone"})}},w:function(n,t,e,i){const s=vT(n,i);return t==="wo"?e.ordinalNumber(s,{unit:"week"}):ot(s,t.length)},I:function(n,t,e){const i=yT(n);return t==="Io"?e.ordinalNumber(i,{unit:"week"}):ot(i,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):nn.d(n,t)},D:function(n,t,e){const i=_T(n);return t==="Do"?e.ordinalNumber(i,{unit:"dayOfYear"}):ot(i,t.length)},E:function(n,t,e){const i=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(i,{width:"short",context:"formatting"});case"EEEE":default:return e.day(i,{width:"wide",context:"formatting"})}},e:function(n,t,e,i){const s=n.getDay(),r=(s-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return ot(r,2);case"eo":return e.ordinalNumber(r,{unit:"day"});case"eee":return e.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(s,{width:"short",context:"formatting"});case"eeee":default:return e.day(s,{width:"wide",context:"formatting"})}},c:function(n,t,e,i){const s=n.getDay(),r=(s-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return ot(r,t.length);case"co":return e.ordinalNumber(r,{unit:"day"});case"ccc":return e.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(s,{width:"narrow",context:"standalone"});case"cccccc":return e.day(s,{width:"short",context:"standalone"});case"cccc":default:return e.day(s,{width:"wide",context:"standalone"})}},i:function(n,t,e){const i=n.getDay(),s=i===0?7:i;switch(t){case"i":return String(s);case"ii":return ot(s,t.length);case"io":return e.ordinalNumber(s,{unit:"day"});case"iii":return e.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(i,{width:"short",context:"formatting"});case"iiii":default:return e.day(i,{width:"wide",context:"formatting"})}},a:function(n,t,e){const s=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,t,e){const i=n.getHours();let s;switch(i===12?s=mi.noon:i===0?s=mi.midnight:s=i/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,t,e){const i=n.getHours();let s;switch(i>=17?s=mi.evening:i>=12?s=mi.afternoon:i>=4?s=mi.morning:s=mi.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let i=n.getHours()%12;return i===0&&(i=12),e.ordinalNumber(i,{unit:"hour"})}return nn.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):nn.H(n,t)},K:function(n,t,e){const i=n.getHours()%12;return t==="Ko"?e.ordinalNumber(i,{unit:"hour"}):ot(i,t.length)},k:function(n,t,e){let i=n.getHours();return i===0&&(i=24),t==="ko"?e.ordinalNumber(i,{unit:"hour"}):ot(i,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):nn.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):nn.s(n,t)},S:function(n,t){return nn.S(n,t)},X:function(n,t,e){const i=n.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return Td(i);case"XXXX":case"XX":return jn(i);case"XXXXX":case"XXX":default:return jn(i,":")}},x:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"x":return Td(i);case"xxxx":case"xx":return jn(i);case"xxxxx":case"xxx":default:return jn(i,":")}},O:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ed(i,":");case"OOOO":default:return"GMT"+jn(i,":")}},z:function(n,t,e){const i=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ed(i,":");case"zzzz":default:return"GMT"+jn(i,":")}},t:function(n,t,e){const i=Math.trunc(+n/1e3);return ot(i,t.length)},T:function(n,t,e){return ot(+n,t.length)}};function Ed(n,t=""){const e=n>0?"-":"+",i=Math.abs(n),s=Math.trunc(i/60),r=i%60;return r===0?e+String(s):e+String(s)+t+ot(r,2)}function Td(n,t){return n%60===0?(n>0?"-":"+")+ot(Math.abs(n)/60,2):jn(n,t)}function jn(n,t=""){const e=n>0?"-":"+",i=Math.abs(n),s=ot(Math.trunc(i/60),2),r=ot(i%60,2);return e+s+t+r}const Id=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ep=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},wT=(n,t)=>{const e=n.match(/(P+)(p+)?/)||[],i=e[1],s=e[2];if(!s)return Id(n,t);let r;switch(i){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;case"PPPP":default:r=t.dateTime({width:"full"});break}return r.replace("{{date}}",Id(i,t)).replace("{{time}}",ep(s,t))},ET={p:ep,P:wT},TT=/^D+$/,IT=/^Y+$/,ST=["D","DD","YY","YYYY"];function xT(n){return TT.test(n)}function AT(n){return IT.test(n)}function PT(n,t,e){const i=CT(n,t,e);if(console.warn(i),ST.includes(n))throw new RangeError(i)}function CT(n,t,e){const i=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${i} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const kT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,DT=/^'([^]*?)'?$/,MT=/''/g,OT=/[a-zA-Z]/;function re(n,t,e){const i=tr(),s=e?.locale??i.locale??mT,r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=Nt(n,e?.in);if(!DE(a))throw new RangeError("Invalid time value");let c=t.match(RT).map(h=>{const d=h[0];if(d==="p"||d==="P"){const g=ET[d];return g(h,s.formatLong)}return h}).join("").match(kT).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const d=h[0];if(d==="'")return{isToken:!1,value:NT(h)};if(wd[d])return{isToken:!0,value:h};if(d.match(OT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(a,c));const u={firstWeekContainsDate:r,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const d=h.value;(!e?.useAdditionalWeekYearTokens&&AT(d)||!e?.useAdditionalDayOfYearTokens&&xT(d))&&PT(d,t,String(n));const g=wd[d[0]];return g(a,d,s.localize,u)}).join("")}function NT(n){const t=n.match(DT);return t?t[1].replace(MT,"'"):n}function $r(n,t,e){const[i,s]=Ho(e?.in,n,t);return i.getFullYear()===s.getFullYear()&&i.getMonth()===s.getMonth()}function As(n,t){const e=()=>te(t?.in,NaN),s=BT(n);let r;if(s.date){const u=UT(s.date,2);r=zT(u.restDateString,u.year)}if(!r||isNaN(+r))return e();const o=+r;let a=0,c;if(s.time&&(a=WT(s.time),isNaN(a)))return e();if(s.timezone){if(c=jT(s.timezone),isNaN(c))return e()}else{const u=new Date(o+a),h=Nt(0,t?.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Nt(o+a+c,t?.in)}const Vr={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},VT=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,LT=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,FT=/^([+-])(\d{2})(?::?(\d{2}))?$/;function BT(n){const t={},e=n.split(Vr.dateTimeDelimiter);let i;if(e.length>2)return t;if(/:/.test(e[0])?i=e[0]:(t.date=e[0],i=e[1],Vr.timeZoneDelimiter.test(t.date)&&(t.date=n.split(Vr.timeZoneDelimiter)[0],i=n.substr(t.date.length,n.length))),i){const s=Vr.timezone.exec(i);s?(t.time=i.replace(s[1],""),t.timezone=s[1]):t.time=i}return t}function UT(n,t){const e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=n.match(e);if(!i)return{year:NaN,restDateString:""};const s=i[1]?parseInt(i[1]):null,r=i[2]?parseInt(i[2]):null;return{year:r===null?s:r*100,restDateString:n.slice((i[1]||i[2]).length)}}function zT(n,t){if(t===null)return new Date(NaN);const e=n.match(VT);if(!e)return new Date(NaN);const i=!!e[4],s=gs(e[1]),r=gs(e[2])-1,o=gs(e[3]),a=gs(e[4]),c=gs(e[5])-1;if(i)return YT(t,a,c)?HT(t,a,c):new Date(NaN);{const u=new Date(0);return!qT(t,r,o)||!GT(t,s)?new Date(NaN):(u.setUTCFullYear(t,r,Math.max(s,o)),u)}}function gs(n){return n?parseInt(n):1}function WT(n){const t=n.match(LT);if(!t)return NaN;const e=Ha(t[1]),i=Ha(t[2]),s=Ha(t[3]);return KT(e,i,s)?e*Kg+i*Yg+s*1e3:NaN}function Ha(n){return n&&parseFloat(n.replace(",","."))||0}function jT(n){if(n==="Z")return 0;const t=n.match(FT);if(!t)return 0;const e=t[1]==="+"?-1:1,i=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return XT(i,s)?e*(i*Kg+s*Yg):NaN}function HT(n,t,e){const i=new Date(0);i.setUTCFullYear(n,0,4);const s=i.getUTCDay()||7,r=(t-1)*7+e+1-s;return i.setUTCDate(i.getUTCDate()+r),i}const $T=[31,null,31,30,31,30,31,31,30,31,30,31];function np(n){return n%400===0||n%4===0&&n%100!==0}function qT(n,t,e){return t>=0&&t<=11&&e>=1&&e<=($T[t]||(np(n)?29:28))}function GT(n,t){return t>=1&&t<=(np(n)?366:365)}function YT(n,t,e){return t>=1&&t<=53&&e>=0&&e<=6}function KT(n,t,e){return n===24?t===0&&e===0:e>=0&&e<60&&t>=0&&t<60&&n>=0&&n<25}function XT(n,t){return t>=0&&t<=59}function pc(n,t,e){return Xg(n,-t,e)}const QT={lessThanXSeconds:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:"1",other:"{{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:"1",other:"{{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:"1",other:"{{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:"1",other:"{{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1",other:"{{count}}"},almostXYears:{one:"1",other:"{{count}}"}},JT=(n,t,e)=>{e=e||{};let i;const s=QT[n];return typeof s=="string"?i=s:t===1?e.addSuffix&&s.oneWithSuffix?i=s.oneWithSuffix:i=s.one:e.addSuffix&&s.otherWithSuffix?i=s.otherWithSuffix.replace("{{count}}",String(t)):i=s.other.replace("{{count}}",String(t)),e.addSuffix?e.comparison&&e.comparison>0?i+"":i+"":i},ZT={full:"yMdEEEE",long:"yMd",medium:"y/MM/dd",short:"y/MM/dd"},tI={full:"Hmmss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},eI={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},nI={date:Ti({formats:ZT,defaultWidth:"full"}),time:Ti({formats:tI,defaultWidth:"full"}),dateTime:Ti({formats:eI,defaultWidth:"full"})},iI={lastWeek:"eeeep",yesterday:"p",today:"p",tomorrow:"p",nextWeek:"eeeep",other:"P"},sI=(n,t,e,i)=>iI[n],rI={narrow:["BC","AC"],abbreviated:["",""],wide:["",""]},oI={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},aI={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},cI={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},lI={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},uI={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},hI=(n,t)=>{const e=Number(n);switch(String(t?.unit)){case"year":return`${e}`;case"quarter":return`${e}`;case"month":return`${e}`;case"week":return`${e}`;case"date":return`${e}`;case"hour":return`${e}`;case"minute":return`${e}`;case"second":return`${e}`;default:return`${e}`}},dI={ordinalNumber:hI,era:ye({values:rI,defaultWidth:"wide"}),quarter:ye({values:oI,defaultWidth:"wide",argumentCallback:n=>Number(n)-1}),month:ye({values:aI,defaultWidth:"wide"}),day:ye({values:cI,defaultWidth:"wide"}),dayPeriod:ye({values:lI,defaultWidth:"wide",formattingValues:uI,defaultFormattingWidth:"wide"})},fI=/^?\d+(|||||||)?/i,gI=/\d+/i,pI={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^([]|)/i,wide:/^([]|)/i},mI={narrow:[/^B/i,/^A/i],any:[/^()/i,/^(|)/i]},_I={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^[1234]/i},yI={any:[/(1||)/i,/(2||)/i,/(3||)/i,/(4||)/i]},bI={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])/i,wide:/^([123456789]|1[012])/i},vI={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},wI={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},EI={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},TI={any:/^(AM|PM|||||||)/i},II={any:{am:/^(A|)/i,pm:/^(P|)/i,midnight:/^|/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},SI={ordinalNumber:Zg({matchPattern:fI,parsePattern:gI,valueCallback:function(n){return parseInt(n,10)}}),era:be({matchPatterns:pI,defaultMatchWidth:"wide",parsePatterns:mI,defaultParseWidth:"any"}),quarter:be({matchPatterns:_I,defaultMatchWidth:"wide",parsePatterns:yI,defaultParseWidth:"any",valueCallback:n=>n+1}),month:be({matchPatterns:bI,defaultMatchWidth:"wide",parsePatterns:vI,defaultParseWidth:"any"}),day:be({matchPatterns:wI,defaultMatchWidth:"wide",parsePatterns:EI,defaultParseWidth:"any"}),dayPeriod:be({matchPatterns:TI,defaultMatchWidth:"any",parsePatterns:II,defaultParseWidth:"any"})},ip={code:"ja",formatDistance:JT,formatLong:nI,formatRelative:sI,localize:dI,match:SI,options:{weekStartsOn:0,firstWeekContainsDate:1}},xI=()=>{};var Sd={};const sp=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},AI=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[e++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[e++],o=n[e++],a=n[e++],c=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(c&1023))}else{const r=n[e++],o=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},rp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let g=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(g=64)),i.push(e[h],e[d],e[g],e[m])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(sp(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):AI(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=e[n.charAt(s++)],a=s<n.length?e[n.charAt(s)]:0;++s;const u=s<n.length?e[n.charAt(s)]:64;++s;const d=s<n.length?e[n.charAt(s)]:64;if(++s,r==null||a==null||u==null||d==null)throw new PI;const g=r<<2|a>>4;if(i.push(g),u!==64){const m=a<<4&240|u>>2;if(i.push(m),d!==64){const y=u<<6&192|d;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CI=function(n){const t=sp(n);return rp.encodeByteArray(t,!0)},po=function(n){return CI(n).replace(/\./g,"")},op=function(n){try{return rp.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function kI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const RI=()=>kI().__FIREBASE_DEFAULTS__,DI=()=>{if(typeof process>"u"||typeof Sd>"u")return;const n=Sd.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},MI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&op(n[1]);return t&&JSON.parse(t)},$o=()=>{try{return xI()||RI()||DI()||MI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ap=n=>$o()?.emulatorHosts?.[n],OI=n=>{const t=ap(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},cp=()=>$o()?.config,lp=n=>$o()?.[`_${n}`];class NI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function Ui(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function up(n){return(await fetch(n,{credentials:"include"})).ok}function VI(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[po(JSON.stringify(e)),po(JSON.stringify(o)),""].join(".")}const Ps={};function LI(){const n={prod:[],emulator:[]};for(const t of Object.keys(Ps))Ps[t]?n.emulator.push(t):n.prod.push(t);return n}function FI(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let xd=!1;function hp(n,t){if(typeof window>"u"||typeof document>"u"||!Ui(window.location.host)||Ps[n]===t||Ps[n]||xd)return;Ps[n]=t;function e(g){return`__firebase__banner__${g}`}const i="__firebase__banner",r=LI().prod.length>0;function o(){const g=document.getElementById(i);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{xd=!0,o()},g}function h(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function d(){const g=FI(i),m=e("text"),y=document.getElementById(m)||document.createElement("span"),v=e("learnmore"),w=document.getElementById(v)||document.createElement("a"),P=e("preprendIcon"),C=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const D=g.element;a(D),h(w,v);const O=u();c(C,P),D.append(C,y,w,O),document.body.appendChild(D)}r?(y.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function $t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($t())}function UI(){const n=$o()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HI(){const n=$t();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $I(){return!UI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qI(){try{return typeof indexedDB=="object"}catch{return!1}}function GI(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}const YI="FirebaseError";class Ge extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=YI,Object.setPrototypeOf(this,Ge.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,er.prototype.create)}}class er{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?KI(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ge(s,a,i)}}function KI(n,t){return n.replace(XI,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const XI=/\{\$([^}]+)}/g;function QI(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function ei(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const r=n[s],o=t[s];if(Ad(r)&&Ad(o)){if(!ei(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function Ad(n){return n!==null&&typeof n=="object"}function nr(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function JI(n,t){const e=new ZI(n,t);return e.subscribe.bind(e)}class ZI{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let s;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");tS(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:i},s.next===void 0&&(s.next=$a),s.error===void 0&&(s.error=$a),s.complete===void 0&&(s.complete=$a);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tS(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function $a(){}function oe(n){return n&&n._delegate?n._delegate:n}class ni{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Hn="[DEFAULT]";class eS{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new NI;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(iS(t))try{this.getOrInitializeService({instanceIdentifier:Hn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Hn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Hn){return this.instances.has(t)}getOptions(t=Hn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(i)??new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:nS(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Hn){return this.component?this.component.multipleInstances?t:Hn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nS(n){return n===Hn?void 0:n}function iS(n){return n.instantiationMode==="EAGER"}class sS{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new eS(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Z;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Z||(Z={}));const rS={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},oS=Z.INFO,aS={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},cS=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=aS[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class al{constructor(t){this.name=t,this._logLevel=oS,this._logHandler=cS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Z))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?rS[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...t),this._logHandler(this,Z.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...t),this._logHandler(this,Z.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...t),this._logHandler(this,Z.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...t),this._logHandler(this,Z.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...t),this._logHandler(this,Z.ERROR,...t)}}const lS=(n,t)=>t.some(e=>n instanceof e);let Pd,Cd;function uS(){return Pd||(Pd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hS(){return Cd||(Cd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dp=new WeakMap,mc=new WeakMap,fp=new WeakMap,qa=new WeakMap,cl=new WeakMap;function dS(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(pn(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&dp.set(e,n)}).catch(()=>{}),cl.set(t,n),t}function fS(n){if(mc.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});mc.set(n,t)}let _c={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return mc.get(n);if(t==="objectStoreNames")return n.objectStoreNames||fp.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return pn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function gS(n){_c=n(_c)}function pS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(Ga(this),t,...e);return fp.set(i,t.sort?t.sort():[t]),pn(i)}:hS().includes(n)?function(...t){return n.apply(Ga(this),t),pn(dp.get(this))}:function(...t){return pn(n.apply(Ga(this),t))}}function mS(n){return typeof n=="function"?pS(n):(n instanceof IDBTransaction&&fS(n),lS(n,uS())?new Proxy(n,_c):n)}function pn(n){if(n instanceof IDBRequest)return dS(n);if(qa.has(n))return qa.get(n);const t=mS(n);return t!==n&&(qa.set(n,t),cl.set(t,n)),t}const Ga=n=>cl.get(n);function _S(n,t,{blocked:e,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,t),a=pn(o);return i&&o.addEventListener("upgradeneeded",c=>{i(pn(o.result),c.oldVersion,c.newVersion,pn(o.transaction),c)}),e&&o.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),a.then(c=>{r&&c.addEventListener("close",()=>r()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const yS=["get","getKey","getAll","getAllKeys","count"],bS=["put","add","delete","clear"],Ya=new Map;function kd(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Ya.get(t))return Ya.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=bS.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||yS.includes(e)))return;const r=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[e](...a),s&&c.done]))[0]};return Ya.set(t,r),r}gS(n=>({...n,get:(t,e,i)=>kd(t,e)||n.get(t,e,i),has:(t,e)=>!!kd(t,e)||n.has(t,e)}));class vS{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(wS(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function wS(n){return n.getComponent()?.type==="VERSION"}const yc="@firebase/app",Rd="0.14.6";const We=new al("@firebase/app"),ES="@firebase/app-compat",TS="@firebase/analytics-compat",IS="@firebase/analytics",SS="@firebase/app-check-compat",xS="@firebase/app-check",AS="@firebase/auth",PS="@firebase/auth-compat",CS="@firebase/database",kS="@firebase/data-connect",RS="@firebase/database-compat",DS="@firebase/functions",MS="@firebase/functions-compat",OS="@firebase/installations",NS="@firebase/installations-compat",VS="@firebase/messaging",LS="@firebase/messaging-compat",FS="@firebase/performance",BS="@firebase/performance-compat",US="@firebase/remote-config",zS="@firebase/remote-config-compat",WS="@firebase/storage",jS="@firebase/storage-compat",HS="@firebase/firestore",$S="@firebase/ai",qS="@firebase/firestore-compat",GS="firebase",YS="12.6.0";const bc="[DEFAULT]",KS={[yc]:"fire-core",[ES]:"fire-core-compat",[IS]:"fire-analytics",[TS]:"fire-analytics-compat",[xS]:"fire-app-check",[SS]:"fire-app-check-compat",[AS]:"fire-auth",[PS]:"fire-auth-compat",[CS]:"fire-rtdb",[kS]:"fire-data-connect",[RS]:"fire-rtdb-compat",[DS]:"fire-fn",[MS]:"fire-fn-compat",[OS]:"fire-iid",[NS]:"fire-iid-compat",[VS]:"fire-fcm",[LS]:"fire-fcm-compat",[FS]:"fire-perf",[BS]:"fire-perf-compat",[US]:"fire-rc",[zS]:"fire-rc-compat",[WS]:"fire-gcs",[jS]:"fire-gcs-compat",[HS]:"fire-fst",[qS]:"fire-fst-compat",[$S]:"fire-vertex","fire-js":"fire-js",[GS]:"fire-js-all"};const mo=new Map,XS=new Map,vc=new Map;function Dd(n,t){try{n.container.addComponent(t)}catch(e){We.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Di(n){const t=n.name;if(vc.has(t))return We.debug(`There were multiple attempts to register component ${t}.`),!1;vc.set(t,n);for(const e of mo.values())Dd(e,n);for(const e of XS.values())Dd(e,n);return!0}function ll(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function ce(n){return n==null?!1:n.settings!==void 0}const QS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},mn=new er("app","Firebase",QS);class JS{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw mn.create("app-deleted",{appName:this._name})}}const zi=YS;function gp(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i={name:bc,automaticDataCollectionEnabled:!0,...t},s=i.name;if(typeof s!="string"||!s)throw mn.create("bad-app-name",{appName:String(s)});if(e||(e=cp()),!e)throw mn.create("no-options");const r=mo.get(s);if(r){if(ei(e,r.options)&&ei(i,r.config))return r;throw mn.create("duplicate-app",{appName:s})}const o=new sS(s);for(const c of vc.values())o.addComponent(c);const a=new JS(e,i,o);return mo.set(s,a),a}function pp(n=bc){const t=mo.get(n);if(!t&&n===bc&&cp())return gp();if(!t)throw mn.create("no-app",{appName:n});return t}function _n(n,t,e){let i=KS[n]??n;e&&(i+=`-${e}`);const s=i.match(/\s|\//),r=t.match(/\s|\//);if(s||r){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),We.warn(o.join(" "));return}Di(new ni(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const ZS="firebase-heartbeat-database",tx=1,Ws="firebase-heartbeat-store";let Ka=null;function mp(){return Ka||(Ka=_S(ZS,tx,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Ws)}catch(e){console.warn(e)}}}}).catch(n=>{throw mn.create("idb-open",{originalErrorMessage:n.message})})),Ka}async function ex(n){try{const e=(await mp()).transaction(Ws),i=await e.objectStore(Ws).get(_p(n));return await e.done,i}catch(t){if(t instanceof Ge)We.warn(t.message);else{const e=mn.create("idb-get",{originalErrorMessage:t?.message});We.warn(e.message)}}}async function Md(n,t){try{const i=(await mp()).transaction(Ws,"readwrite");await i.objectStore(Ws).put(t,_p(n)),await i.done}catch(e){if(e instanceof Ge)We.warn(e.message);else{const i=mn.create("idb-set",{originalErrorMessage:e?.message});We.warn(i.message)}}}function _p(n){return`${n.name}!${n.options.appId}`}const nx=1024,ix=30;class sx{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new ox(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Od();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>ix){const s=ax(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){We.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Od(),{heartbeatsToSend:e,unsentEntries:i}=rx(this._heartbeatsCache.heartbeats),s=po(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return We.warn(t),""}}}function Od(){return new Date().toISOString().substring(0,10)}function rx(n,t=nx){const e=[];let i=n.slice();for(const s of n){const r=e.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Nd(e)>t){r.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Nd(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class ox{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qI()?GI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await ex(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Md(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Md(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Nd(n){return po(JSON.stringify({version:2,heartbeats:n})).length}function ax(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function cx(n){Di(new ni("platform-logger",t=>new vS(t),"PRIVATE")),Di(new ni("heartbeat",t=>new sx(t),"PRIVATE")),_n(yc,Rd,n),_n(yc,Rd,"esm2020"),_n("fire-js","")}cx("");var lx="firebase",ux="12.6.0";_n(lx,ux,"app");function yp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hx=yp,bp=new er("auth","Firebase",yp());const _o=new al("@firebase/auth");function dx(n,...t){_o.logLevel<=Z.WARN&&_o.warn(`Auth (${zi}): ${n}`,...t)}function qr(n,...t){_o.logLevel<=Z.ERROR&&_o.error(`Auth (${zi}): ${n}`,...t)}function xe(n,...t){throw hl(n,...t)}function de(n,...t){return hl(n,...t)}function ul(n,t,e){const i={...hx(),[t]:e};return new er("auth","Firebase",i).create(t,{appName:n.name})}function Qn(n){return ul(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fx(n,t,e){const i=e;if(!(t instanceof i))throw i.name!==t.constructor.name&&xe(n,"argument-error"),ul(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hl(n,...t){if(typeof n!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(e,...i)}return bp.create(n,...t)}function $(n,t,...e){if(!n)throw hl(t,...e)}function Be(n){const t="INTERNAL ASSERTION FAILED: "+n;throw qr(t),new Error(t)}function je(n,t){n||Be(t)}function wc(){return typeof self<"u"&&self.location?.href||""}function gx(){return Vd()==="http:"||Vd()==="https:"}function Vd(){return typeof self<"u"&&self.location?.protocol||null}function px(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gx()||WI()||"connection"in navigator)?navigator.onLine:!0}function mx(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ir{constructor(t,e){this.shortDelay=t,this.longDelay=e,je(e>t,"Short delay should be less than long delay!"),this.isMobile=BI()||jI()}get(){return px()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dl(n,t){je(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class vp{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Be("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Be("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Be("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _x={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const yx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bx=new ir(3e4,6e4);function fl(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Wi(n,t,e,i,s={}){return wp(n,s,async()=>{let r={},o={};i&&(t==="GET"?o=i:r={body:JSON.stringify(i)});const a=nr({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u={method:t,headers:c,...r};return zI()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Ui(n.emulatorConfig.host)&&(u.credentials="include"),vp.fetch()(await Ep(n,n.config.apiHost,e,a),u)})}async function wp(n,t,e){n._canInitEmulator=!1;const i={..._x,...t};try{const s=new wx(n),r=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Lr(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Lr(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Lr(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Lr(n,"user-disabled",o);const h=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw ul(n,h,u);xe(n,h)}}catch(s){if(s instanceof Ge)throw s;xe(n,"network-request-failed",{message:String(s)})}}async function vx(n,t,e,i,s={}){const r=await Wi(n,t,e,i,s);return"mfaPendingCredential"in r&&xe(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function Ep(n,t,e,i){const s=`${t}${e}?${i}`,r=n,o=r.config.emulator?dl(n.config,s):`${n.config.apiScheme}://${s}`;return yx.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class wx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(de(this.auth,"network-request-failed")),bx.get())})}}function Lr(n,t,e){const i={appName:n.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const s=de(n,t,i);return s.customData._tokenResponse=e,s}async function Ex(n,t){return Wi(n,"POST","/v1/accounts:delete",t)}async function yo(n,t){return Wi(n,"POST","/v1/accounts:lookup",t)}function Cs(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Tx(n,t=!1){const e=oe(n),i=await e.getIdToken(t),s=gl(i);$(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:i,authTime:Cs(Xa(s.auth_time)),issuedAtTime:Cs(Xa(s.iat)),expirationTime:Cs(Xa(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Xa(n){return Number(n)*1e3}function gl(n){const[t,e,i]=n.split(".");if(t===void 0||e===void 0||i===void 0)return qr("JWT malformed, contained fewer than 3 sections"),null;try{const s=op(e);return s?JSON.parse(s):(qr("Failed to decode base64 JWT payload"),null)}catch(s){return qr("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Ld(n){const t=gl(n);return $(t,"internal-error"),$(typeof t.exp<"u","internal-error"),$(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function js(n,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof Ge&&Ix(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Ix({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Sx{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ec{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cs(this.lastLoginAt),this.creationTime=Cs(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bo(n){const t=n.auth,e=await n.getIdToken(),i=await js(n,yo(t,{idToken:e}));$(i?.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const r=s.providerUserInfo?.length?Tp(s.providerUserInfo):[],o=Ax(n.providerData,r),a=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!o?.length,u=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ec(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function xx(n){const t=oe(n);await bo(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Ax(n,t){return[...n.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function Tp(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function Px(n,t){const e=await wp(n,{},async()=>{const i=nr({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=await Ep(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&Ui(n.emulatorConfig.host)&&(c.credentials="include"),vp.fetch()(o,c)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function Cx(n,t){return Wi(n,"POST","/v2/accounts:revokeToken",fl(n,t))}class Ii{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){$(t.idToken,"internal-error"),$(typeof t.idToken<"u","internal-error"),$(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Ld(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){$(t.length!==0,"internal-error");const e=Ld(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:s,expiresIn:r}=await Px(t,e);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:s,expirationTime:r}=e,o=new Ii;return i&&($(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),s&&($(typeof s=="string","internal-error",{appName:t}),o.accessToken=s),r&&($(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ii,this.toJSON())}_performRefresh(){return Be("not implemented")}}function sn(n,t){$(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class ue{constructor({uid:t,auth:e,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new Sx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ec(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await js(this,this.stsTokenManager.getToken(this.auth,t));return $(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return Tx(this,t)}reload(){return xx(this)}_assign(t){this!==t&&($(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new ue({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await bo(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ce(this.auth.app))return Promise.reject(Qn(this.auth));const t=await this.getIdToken();return await js(this,Ex(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const i=e.displayName??void 0,s=e.email??void 0,r=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,c=e._redirectEventId??void 0,u=e.createdAt??void 0,h=e.lastLoginAt??void 0,{uid:d,emailVerified:g,isAnonymous:m,providerData:y,stsTokenManager:v}=e;$(d&&v,t,"internal-error");const w=Ii.fromJSON(this.name,v);$(typeof d=="string",t,"internal-error"),sn(i,t.name),sn(s,t.name),$(typeof g=="boolean",t,"internal-error"),$(typeof m=="boolean",t,"internal-error"),sn(r,t.name),sn(o,t.name),sn(a,t.name),sn(c,t.name),sn(u,t.name),sn(h,t.name);const P=new ue({uid:d,auth:t,email:s,emailVerified:g,displayName:i,isAnonymous:m,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:w,createdAt:u,lastLoginAt:h});return y&&Array.isArray(y)&&(P.providerData=y.map(C=>({...C}))),c&&(P._redirectEventId=c),P}static async _fromIdTokenResponse(t,e,i=!1){const s=new Ii;s.updateFromServerResponse(e);const r=new ue({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await bo(r),r}static async _fromGetAccountInfoResponse(t,e,i){const s=e.users[0];$(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?Tp(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,a=new Ii;a.updateFromIdToken(i);const c=new ue({uid:s.localId,auth:t,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new Ec(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(c,u),c}}const Fd=new Map;function Ue(n){je(n instanceof Function,"Expected a class definition");let t=Fd.get(n);return t?(je(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Fd.set(n,t),t)}class Ip{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Ip.type="NONE";const Bd=Ip;function Gr(n,t,e){return`firebase:${n}:${t}:${e}`}class Si{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=Gr(this.userKey,s.apiKey,r),this.fullPersistenceKey=Gr("persistence",s.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await yo(this.auth,{idToken:t}).catch(()=>{});return e?ue._fromGetAccountInfoResponse(this.auth,e,t):null}return ue._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new Si(Ue(Bd),t,i);const s=(await Promise.all(e.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=s[0]||Ue(Bd);const o=Gr(i,t.config.apiKey,t.name);let a=null;for(const u of e)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const g=await yo(t,{idToken:h}).catch(()=>{});if(!g)break;d=await ue._fromGetAccountInfoResponse(t,g,h)}else d=ue._fromJSON(t,h);u!==r&&(a=d),r=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new Si(r,t,i):(r=c[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new Si(r,t,i))}}function Ud(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Pp(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Sp(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(kp(t))return"Blackberry";if(Rp(t))return"Webos";if(xp(t))return"Safari";if((t.includes("chrome/")||Ap(t))&&!t.includes("edge/"))return"Chrome";if(Cp(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(e);if(i?.length===2)return i[1]}return"Other"}function Sp(n=$t()){return/firefox\//i.test(n)}function xp(n=$t()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ap(n=$t()){return/crios\//i.test(n)}function Pp(n=$t()){return/iemobile/i.test(n)}function Cp(n=$t()){return/android/i.test(n)}function kp(n=$t()){return/blackberry/i.test(n)}function Rp(n=$t()){return/webos/i.test(n)}function pl(n=$t()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function kx(n=$t()){return pl(n)&&!!window.navigator?.standalone}function Rx(){return HI()&&document.documentMode===10}function Dp(n=$t()){return pl(n)||Cp(n)||Rp(n)||kp(n)||/windows phone/i.test(n)||Pp(n)}function Mp(n,t=[]){let e;switch(n){case"Browser":e=Ud($t());break;case"Worker":e=`${Ud($t())}-${n}`;break;default:e=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${zi}/${i}`}class Dx{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=r=>new Promise((o,a)=>{try{const c=t(r);o(c)}catch(c){a(c)}});i.onAbort=e,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Mx(n,t={}){return Wi(n,"GET","/v2/passwordPolicy",fl(n,t))}const Ox=6;class Nx{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??Ox,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class Vx{constructor(t,e,i,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zd(this),this.idTokenSubscription=new zd(this),this.beforeStateQueue=new Dx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Ue(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Si.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await yo(this,{idToken:t}),i=await ue._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(ce(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let i=e,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(t);(!r||r===o)&&a?.user&&(i=a.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await bo(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=mx()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ce(this.app))return Promise.reject(Qn(this));const e=t?oe(t):null;return e&&$(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&$(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return ce(this.app)?Promise.reject(Qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ce(this.app)?Promise.reject(Qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ue(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Mx(this),e=new Nx(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new er("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await Cx(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Ue(t)||this._popupRedirectResolver;$(e,this,"argument-error"),this.redirectPersistenceManager=await Si.create(this,[Ue(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,s){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if($(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const c=t.addObserver(e,i,s);return()=>{o=!0,c()}}else{const c=t.addObserver(e);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Mp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){if(ce(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&dx(`Error while retrieving App Check token: ${t.error}`),t?.token}}function qo(n){return oe(n)}class zd{constructor(t){this.auth=t,this.observer=null,this.addObserver=JI(e=>this.observer=e)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ml={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Lx(n){ml=n}function Fx(n){return ml.loadJS(n)}function Bx(){return ml.gapiScript}function Ux(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function zx(n,t){const e=ll(n,"auth");if(e.isInitialized()){const s=e.getImmediate(),r=e.getOptions();if(ei(r,t??{}))return s;xe(s,"already-initialized")}return e.initialize({options:t})}function Wx(n,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(Ue);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t?.popupRedirectResolver)}function jx(n,t,e){const i=qo(n);$(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,r=Op(t),{host:o,port:a}=Hx(t),c=a===null?"":`:${a}`,u={url:`${r}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){$(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),$(ei(u,i.config.emulator)&&ei(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,Ui(o)?(up(`${r}//${o}${c}`),hp("Auth",!0)):$x()}function Op(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function Hx(n){const t=Op(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:Wd(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:Wd(o)}}}function Wd(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function $x(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Np{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Be("not implemented")}_getIdTokenResponse(t){return Be("not implemented")}_linkToIdToken(t,e){return Be("not implemented")}_getReauthenticationResolver(t){return Be("not implemented")}}async function xi(n,t){return vx(n,"POST","/v1/accounts:signInWithIdp",fl(n,t))}const qx="http://localhost";class ii extends Np{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new ii(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):xe("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s,...r}=e;if(!i||!s)return null;const o=new ii(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return xi(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,xi(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,xi(t,e)}buildRequest(){const t={requestUri:qx,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=nr(e)}return t}}class _l{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class sr extends _l{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class rn extends sr{constructor(){super("facebook.com")}static credential(t){return ii._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return rn.credentialFromTaggedObject(t)}static credentialFromError(t){return rn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return rn.credential(t.oauthAccessToken)}catch{return null}}}rn.FACEBOOK_SIGN_IN_METHOD="facebook.com";rn.PROVIDER_ID="facebook.com";class Ne extends sr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return ii._fromParams({providerId:Ne.PROVIDER_ID,signInMethod:Ne.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Ne.credentialFromTaggedObject(t)}static credentialFromError(t){return Ne.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return Ne.credential(e,i)}catch{return null}}}Ne.GOOGLE_SIGN_IN_METHOD="google.com";Ne.PROVIDER_ID="google.com";class on extends sr{constructor(){super("github.com")}static credential(t){return ii._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return on.credentialFromTaggedObject(t)}static credentialFromError(t){return on.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return on.credential(t.oauthAccessToken)}catch{return null}}}on.GITHUB_SIGN_IN_METHOD="github.com";on.PROVIDER_ID="github.com";class an extends sr{constructor(){super("twitter.com")}static credential(t,e){return ii._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return an.credentialFromTaggedObject(t)}static credentialFromError(t){return an.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return an.credential(e,i)}catch{return null}}}an.TWITTER_SIGN_IN_METHOD="twitter.com";an.PROVIDER_ID="twitter.com";class Mi{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,s=!1){const r=await ue._fromIdTokenResponse(t,i,s),o=jd(i);return new Mi({user:r,providerId:o,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const s=jd(i);return new Mi({user:t,providerId:s,_tokenResponse:i,operationType:e})}}function jd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class vo extends Ge{constructor(t,e,i,s){super(e.code,e.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,vo.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,s){return new vo(t,e,i,s)}}function Vp(n,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?vo._fromErrorAndOperation(n,r,t,i):r})}async function Gx(n,t,e=!1){const i=await js(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Mi._forOperation(n,"link",i)}async function Yx(n,t,e=!1){const{auth:i}=n;if(ce(i.app))return Promise.reject(Qn(i));const s="reauthenticate";try{const r=await js(n,Vp(i,s,t,n),e);$(r.idToken,i,"internal-error");const o=gl(r.idToken);$(o,i,"internal-error");const{sub:a}=o;return $(n.uid===a,i,"user-mismatch"),Mi._forOperation(n,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&xe(i,"user-mismatch"),r}}async function Kx(n,t,e=!1){if(ce(n.app))return Promise.reject(Qn(n));const i="signIn",s=await Vp(n,i,t),r=await Mi._fromIdTokenResponse(n,i,s);return e||await n._updateCurrentUser(r.user),r}function Xx(n,t,e,i){return oe(n).onIdTokenChanged(t,e,i)}function Qx(n,t,e){return oe(n).beforeAuthStateChanged(t,e)}function Jx(n,t,e,i){return oe(n).onAuthStateChanged(t,e,i)}function Zx(n){return oe(n).signOut()}const wo="__sak";class Lp{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(wo,"1"),this.storage.removeItem(wo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const tA=1e3,eA=10;class Fp extends Lp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Dp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),s=this.localCache[e];i!==s&&t(e,s,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!e&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);Rx()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,eA):s()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},tA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Fp.type="LOCAL";const nA=Fp;class Bp extends Lp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Bp.type="SESSION";const Up=Bp;function iA(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Go{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const i=new Go(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:s,data:r}=e.data,o=this.handlersMap[s];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async u=>u(e.origin,r)),c=await iA(a);e.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Go.receivers=[];function yl(n="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return n+e}class sA{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,c)=>{const u=yl("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(d){const g=d;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(g.data.response);break;default:clearTimeout(h),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:u,data:e},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function we(){return window}function rA(n){we().location.href=n}function zp(){return typeof we().WorkerGlobalScope<"u"&&typeof we().importScripts=="function"}async function oA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function aA(){return navigator?.serviceWorker?.controller||null}function cA(){return zp()?self:null}const Wp="firebaseLocalStorageDb",lA=1,Eo="firebaseLocalStorage",jp="fbase_key";class rr{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Yo(n,t){return n.transaction([Eo],t?"readwrite":"readonly").objectStore(Eo)}function uA(){const n=indexedDB.deleteDatabase(Wp);return new rr(n).toPromise()}function Tc(){const n=indexedDB.open(Wp,lA);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Eo,{keyPath:jp})}catch(s){e(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Eo)?t(i):(i.close(),await uA(),t(await Tc()))})})}async function Hd(n,t,e){const i=Yo(n,!0).put({[jp]:t,value:e});return new rr(i).toPromise()}async function hA(n,t){const e=Yo(n,!1).get(t),i=await new rr(e).toPromise();return i===void 0?null:i.value}function $d(n,t){const e=Yo(n,!0).delete(t);return new rr(e).toPromise()}const dA=800,fA=3;class Hp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Tc(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>fA)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Go._getInstance(cA()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await oA(),!this.activeServiceWorker)return;this.sender=new sA(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||aA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Tc();return await Hd(t,wo,"1"),await $d(t,wo),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>Hd(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>hA(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>$d(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const r=Yo(s,!1).getAll();return new rr(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:r}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hp.type="LOCAL";const gA=Hp;new ir(3e4,6e4);function $p(n,t){return t?Ue(t):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class bl extends Np{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return xi(t,this._buildIdpRequest())}_linkToIdToken(t,e){return xi(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return xi(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function pA(n){return Kx(n.auth,new bl(n),n.bypassAuthState)}function mA(n){const{auth:t,user:e}=n;return $(e,t,"internal-error"),Yx(e,new bl(n),n.bypassAuthState)}async function _A(n){const{auth:t,user:e}=n;return $(e,t,"internal-error"),Gx(e,new bl(n),n.bypassAuthState)}class qp{constructor(t,e,i,s,r=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:e,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return pA;case"linkViaPopup":case"linkViaRedirect":return _A;case"reauthViaPopup":case"reauthViaRedirect":return mA;default:xe(this.auth,"internal-error")}}resolve(t){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yA=new ir(2e3,1e4);async function bA(n,t,e){if(ce(n.app))return Promise.reject(de(n,"operation-not-supported-in-this-environment"));const i=qo(n);fx(n,t,_l);const s=$p(i,e);return new qn(i,"signInViaPopup",t,s).executeNotNull()}class qn extends qp{constructor(t,e,i,s,r){super(t,e,s,r),this.provider=i,this.authWindow=null,this.pollId=null,qn.currentPopupAction&&qn.currentPopupAction.cancel(),qn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return $(t,this.auth,"internal-error"),t}async onExecution(){je(this.filter.length===1,"Popup operations only handle one event");const t=yl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(de(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(de(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qn.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(de(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,yA.get())};t()}}qn.currentPopupAction=null;const vA="pendingRedirect",Yr=new Map;class wA extends qp{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=Yr.get(this.auth._key());if(!t){try{const i=await EA(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}Yr.set(this.auth._key(),t)}return this.bypassAuthState||Yr.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function EA(n,t){const e=SA(t),i=IA(n);if(!await i._isAvailable())return!1;const s=await i._get(e)==="true";return await i._remove(e),s}function TA(n,t){Yr.set(n._key(),t)}function IA(n){return Ue(n._redirectPersistence)}function SA(n){return Gr(vA,n.config.apiKey,n.name)}async function xA(n,t,e=!1){if(ce(n.app))return Promise.reject(Qn(n));const i=qo(n),s=$p(i,t),o=await new wA(i,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}const AA=600*1e3;class PA{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!CA(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!Gp(t)){const i=t.error.code?.split("auth/")[1]||"internal-error";e.onError(de(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=AA&&this.cachedEventUids.clear(),this.cachedEventUids.has(qd(t))}saveEventToCache(t){this.cachedEventUids.add(qd(t)),this.lastProcessedEventTime=Date.now()}}function qd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Gp({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function CA(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gp(n);default:return!1}}async function kA(n,t={}){return Wi(n,"GET","/v1/projects",t)}const RA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DA=/^https?/;async function MA(n){if(n.config.emulator)return;const{authorizedDomains:t}=await kA(n);for(const e of t)try{if(OA(e))return}catch{}xe(n,"unauthorized-domain")}function OA(n){const t=wc(),{protocol:e,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===i}if(!DA.test(e))return!1;if(RA.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const NA=new ir(3e4,6e4);function Gd(){const n=we().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function VA(n){return new Promise((t,e)=>{function i(){Gd(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Gd(),e(de(n,"network-request-failed"))},timeout:NA.get()})}if(we().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(we().gapi?.load)i();else{const s=Ux("iframefcb");return we()[s]=()=>{gapi.load?i():e(de(n,"network-request-failed"))},Fx(`${Bx()}?onload=${s}`).catch(r=>e(r))}}).catch(t=>{throw Kr=null,t})}let Kr=null;function LA(n){return Kr=Kr||VA(n),Kr}const FA=new ir(5e3,15e3),BA="__/auth/iframe",UA="emulator/auth/iframe",zA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},WA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jA(n){const t=n.config;$(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?dl(t,UA):`https://${n.config.authDomain}/${BA}`,i={apiKey:t.apiKey,appName:n.name,v:zi},s=WA.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${e}?${nr(i).slice(1)}`}async function HA(n){const t=await LA(n),e=we().gapi;return $(e,n,"internal-error"),t.open({where:document.body,url:jA(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zA,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=de(n,"network-request-failed"),a=we().setTimeout(()=>{r(o)},FA.get());function c(){we().clearTimeout(a),s(i)}i.ping(c).then(c,()=>{r(o)})}))}const $A={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qA=500,GA=600,YA="_blank",KA="http://localhost";class Yd{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function XA(n,t,e,i=qA,s=GA){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...$A,width:i.toString(),height:s.toString(),top:r,left:o},u=$t().toLowerCase();e&&(a=Ap(u)?YA:e),Sp(u)&&(t=t||KA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(kx(u)&&a!=="_self")return QA(t||"",a),new Yd(null);const d=window.open(t||"",a,h);$(d,n,"popup-blocked");try{d.focus()}catch{}return new Yd(d)}function QA(n,t){const e=document.createElement("a");e.href=n,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const JA="__/auth/handler",ZA="emulator/auth/handler",tP=encodeURIComponent("fac");async function Kd(n,t,e,i,s,r){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:i,v:zi,eventId:s};if(t instanceof _l){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",QI(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(t instanceof sr){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await n._getAppCheckToken(),u=c?`#${tP}=${encodeURIComponent(c)}`:"";return`${eP(n)}?${nr(a).slice(1)}${u}`}function eP({config:n}){return n.emulator?dl(n,ZA):`https://${n.authDomain}/${JA}`}const Qa="webStorageSupport";class nP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Up,this._completeRedirectFn=xA,this._overrideRedirectResult=TA}async _openPopup(t,e,i,s){je(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const r=await Kd(t,e,i,wc(),s);return XA(t,r,yl())}async _openRedirect(t,e,i,s){await this._originValidation(t);const r=await Kd(t,e,i,wc(),s);return rA(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:r}=this.eventManagers[e];return s?Promise.resolve(s):(je(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await HA(t),i=new PA(t);return e.register("authEvent",s=>($(s?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Qa,{type:Qa},s=>{const r=s?.[0]?.[Qa];r!==void 0&&e(!!r),xe(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=MA(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Dp()||xp()||pl()}}const iP=nP;var Xd="@firebase/auth",Qd="1.11.1";class sP{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function rP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oP(n){Di(new ni("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Mp(n)},u=new Vx(i,s,r,c);return Wx(u,e),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),Di(new ni("auth-internal",t=>{const e=qo(t.getProvider("auth").getImmediate());return(i=>new sP(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),_n(Xd,Qd,rP(n)),_n(Xd,Qd,"esm2020")}const aP=300,cP=lp("authIdTokenMaxAge")||aP;let Jd=null;const lP=n=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>cP)return;const s=e?.token;Jd!==s&&(Jd=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function uP(n=pp()){const t=ll(n,"auth");if(t.isInitialized())return t.getImmediate();const e=zx(n,{popupRedirectResolver:iP,persistence:[gA,nA,Up]}),i=lp("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=lP(r.toString());Qx(e,o,()=>o(e.currentUser)),Xx(e,a=>o(a))}}const s=ap("auth");return s&&jx(e,`http://${s}`),e}function hP(){return document.getElementsByTagName("head")?.[0]??document}Lx({loadJS(n){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=s=>{const r=de("internal-error");r.customData=s,e(r)},i.type="text/javascript",i.charset="UTF-8",hP().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oP("Browser");var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var yn,Yp;(function(){var n;function t(I,b){function T(){}T.prototype=b.prototype,I.F=b.prototype,I.prototype=new T,I.prototype.constructor=I,I.D=function(A,x,S){for(var E=Array(arguments.length-2),j=2;j<arguments.length;j++)E[j-2]=arguments[j];return b.prototype[x].apply(A,E)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,e),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,b,T){T||(T=0);const A=Array(16);if(typeof b=="string")for(var x=0;x<16;++x)A[x]=b.charCodeAt(T++)|b.charCodeAt(T++)<<8|b.charCodeAt(T++)<<16|b.charCodeAt(T++)<<24;else for(x=0;x<16;++x)A[x]=b[T++]|b[T++]<<8|b[T++]<<16|b[T++]<<24;b=I.g[0],T=I.g[1],x=I.g[2];let S=I.g[3],E;E=b+(S^T&(x^S))+A[0]+3614090360&4294967295,b=T+(E<<7&4294967295|E>>>25),E=S+(x^b&(T^x))+A[1]+3905402710&4294967295,S=b+(E<<12&4294967295|E>>>20),E=x+(T^S&(b^T))+A[2]+606105819&4294967295,x=S+(E<<17&4294967295|E>>>15),E=T+(b^x&(S^b))+A[3]+3250441966&4294967295,T=x+(E<<22&4294967295|E>>>10),E=b+(S^T&(x^S))+A[4]+4118548399&4294967295,b=T+(E<<7&4294967295|E>>>25),E=S+(x^b&(T^x))+A[5]+1200080426&4294967295,S=b+(E<<12&4294967295|E>>>20),E=x+(T^S&(b^T))+A[6]+2821735955&4294967295,x=S+(E<<17&4294967295|E>>>15),E=T+(b^x&(S^b))+A[7]+4249261313&4294967295,T=x+(E<<22&4294967295|E>>>10),E=b+(S^T&(x^S))+A[8]+1770035416&4294967295,b=T+(E<<7&4294967295|E>>>25),E=S+(x^b&(T^x))+A[9]+2336552879&4294967295,S=b+(E<<12&4294967295|E>>>20),E=x+(T^S&(b^T))+A[10]+4294925233&4294967295,x=S+(E<<17&4294967295|E>>>15),E=T+(b^x&(S^b))+A[11]+2304563134&4294967295,T=x+(E<<22&4294967295|E>>>10),E=b+(S^T&(x^S))+A[12]+1804603682&4294967295,b=T+(E<<7&4294967295|E>>>25),E=S+(x^b&(T^x))+A[13]+4254626195&4294967295,S=b+(E<<12&4294967295|E>>>20),E=x+(T^S&(b^T))+A[14]+2792965006&4294967295,x=S+(E<<17&4294967295|E>>>15),E=T+(b^x&(S^b))+A[15]+1236535329&4294967295,T=x+(E<<22&4294967295|E>>>10),E=b+(x^S&(T^x))+A[1]+4129170786&4294967295,b=T+(E<<5&4294967295|E>>>27),E=S+(T^x&(b^T))+A[6]+3225465664&4294967295,S=b+(E<<9&4294967295|E>>>23),E=x+(b^T&(S^b))+A[11]+643717713&4294967295,x=S+(E<<14&4294967295|E>>>18),E=T+(S^b&(x^S))+A[0]+3921069994&4294967295,T=x+(E<<20&4294967295|E>>>12),E=b+(x^S&(T^x))+A[5]+3593408605&4294967295,b=T+(E<<5&4294967295|E>>>27),E=S+(T^x&(b^T))+A[10]+38016083&4294967295,S=b+(E<<9&4294967295|E>>>23),E=x+(b^T&(S^b))+A[15]+3634488961&4294967295,x=S+(E<<14&4294967295|E>>>18),E=T+(S^b&(x^S))+A[4]+3889429448&4294967295,T=x+(E<<20&4294967295|E>>>12),E=b+(x^S&(T^x))+A[9]+568446438&4294967295,b=T+(E<<5&4294967295|E>>>27),E=S+(T^x&(b^T))+A[14]+3275163606&4294967295,S=b+(E<<9&4294967295|E>>>23),E=x+(b^T&(S^b))+A[3]+4107603335&4294967295,x=S+(E<<14&4294967295|E>>>18),E=T+(S^b&(x^S))+A[8]+1163531501&4294967295,T=x+(E<<20&4294967295|E>>>12),E=b+(x^S&(T^x))+A[13]+2850285829&4294967295,b=T+(E<<5&4294967295|E>>>27),E=S+(T^x&(b^T))+A[2]+4243563512&4294967295,S=b+(E<<9&4294967295|E>>>23),E=x+(b^T&(S^b))+A[7]+1735328473&4294967295,x=S+(E<<14&4294967295|E>>>18),E=T+(S^b&(x^S))+A[12]+2368359562&4294967295,T=x+(E<<20&4294967295|E>>>12),E=b+(T^x^S)+A[5]+4294588738&4294967295,b=T+(E<<4&4294967295|E>>>28),E=S+(b^T^x)+A[8]+2272392833&4294967295,S=b+(E<<11&4294967295|E>>>21),E=x+(S^b^T)+A[11]+1839030562&4294967295,x=S+(E<<16&4294967295|E>>>16),E=T+(x^S^b)+A[14]+4259657740&4294967295,T=x+(E<<23&4294967295|E>>>9),E=b+(T^x^S)+A[1]+2763975236&4294967295,b=T+(E<<4&4294967295|E>>>28),E=S+(b^T^x)+A[4]+1272893353&4294967295,S=b+(E<<11&4294967295|E>>>21),E=x+(S^b^T)+A[7]+4139469664&4294967295,x=S+(E<<16&4294967295|E>>>16),E=T+(x^S^b)+A[10]+3200236656&4294967295,T=x+(E<<23&4294967295|E>>>9),E=b+(T^x^S)+A[13]+681279174&4294967295,b=T+(E<<4&4294967295|E>>>28),E=S+(b^T^x)+A[0]+3936430074&4294967295,S=b+(E<<11&4294967295|E>>>21),E=x+(S^b^T)+A[3]+3572445317&4294967295,x=S+(E<<16&4294967295|E>>>16),E=T+(x^S^b)+A[6]+76029189&4294967295,T=x+(E<<23&4294967295|E>>>9),E=b+(T^x^S)+A[9]+3654602809&4294967295,b=T+(E<<4&4294967295|E>>>28),E=S+(b^T^x)+A[12]+3873151461&4294967295,S=b+(E<<11&4294967295|E>>>21),E=x+(S^b^T)+A[15]+530742520&4294967295,x=S+(E<<16&4294967295|E>>>16),E=T+(x^S^b)+A[2]+3299628645&4294967295,T=x+(E<<23&4294967295|E>>>9),E=b+(x^(T|~S))+A[0]+4096336452&4294967295,b=T+(E<<6&4294967295|E>>>26),E=S+(T^(b|~x))+A[7]+1126891415&4294967295,S=b+(E<<10&4294967295|E>>>22),E=x+(b^(S|~T))+A[14]+2878612391&4294967295,x=S+(E<<15&4294967295|E>>>17),E=T+(S^(x|~b))+A[5]+4237533241&4294967295,T=x+(E<<21&4294967295|E>>>11),E=b+(x^(T|~S))+A[12]+1700485571&4294967295,b=T+(E<<6&4294967295|E>>>26),E=S+(T^(b|~x))+A[3]+2399980690&4294967295,S=b+(E<<10&4294967295|E>>>22),E=x+(b^(S|~T))+A[10]+4293915773&4294967295,x=S+(E<<15&4294967295|E>>>17),E=T+(S^(x|~b))+A[1]+2240044497&4294967295,T=x+(E<<21&4294967295|E>>>11),E=b+(x^(T|~S))+A[8]+1873313359&4294967295,b=T+(E<<6&4294967295|E>>>26),E=S+(T^(b|~x))+A[15]+4264355552&4294967295,S=b+(E<<10&4294967295|E>>>22),E=x+(b^(S|~T))+A[6]+2734768916&4294967295,x=S+(E<<15&4294967295|E>>>17),E=T+(S^(x|~b))+A[13]+1309151649&4294967295,T=x+(E<<21&4294967295|E>>>11),E=b+(x^(T|~S))+A[4]+4149444226&4294967295,b=T+(E<<6&4294967295|E>>>26),E=S+(T^(b|~x))+A[11]+3174756917&4294967295,S=b+(E<<10&4294967295|E>>>22),E=x+(b^(S|~T))+A[2]+718787259&4294967295,x=S+(E<<15&4294967295|E>>>17),E=T+(S^(x|~b))+A[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(x+(E<<21&4294967295|E>>>11))&4294967295,I.g[2]=I.g[2]+x&4294967295,I.g[3]=I.g[3]+S&4294967295}i.prototype.v=function(I,b){b===void 0&&(b=I.length);const T=b-this.blockSize,A=this.C;let x=this.h,S=0;for(;S<b;){if(x==0)for(;S<=T;)s(this,I,S),S+=this.blockSize;if(typeof I=="string"){for(;S<b;)if(A[x++]=I.charCodeAt(S++),x==this.blockSize){s(this,A),x=0;break}}else for(;S<b;)if(A[x++]=I[S++],x==this.blockSize){s(this,A),x=0;break}}this.h=x,this.o+=b},i.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;b=this.o*8;for(var T=I.length-8;T<I.length;++T)I[T]=b&255,b/=256;for(this.v(I),I=Array(16),b=0,T=0;T<4;++T)for(let A=0;A<32;A+=8)I[b++]=this.g[T]>>>A&255;return I};function r(I,b){var T=a;return Object.prototype.hasOwnProperty.call(T,I)?T[I]:T[I]=b(I)}function o(I,b){this.h=b;const T=[];let A=!0;for(let x=I.length-1;x>=0;x--){const S=I[x]|0;A&&S==b||(T[x]=S,A=!1)}this.g=T}var a={};function c(I){return-128<=I&&I<128?r(I,function(b){return new o([b|0],b<0?-1:0)}):new o([I|0],I<0?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return d;if(I<0)return w(u(-I));const b=[];let T=1;for(let A=0;I>=T;A++)b[A]=I/T|0,T*=4294967296;return new o(b,0)}function h(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return w(h(I.substring(1),b));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=u(Math.pow(b,8));let A=d;for(let S=0;S<I.length;S+=8){var x=Math.min(8,I.length-S);const E=parseInt(I.substring(S,S+x),b);x<8?(x=u(Math.pow(b,x)),A=A.j(x).add(u(E))):(A=A.j(T),A=A.add(u(E)))}return A}var d=c(0),g=c(1),m=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let I=0,b=1;for(let T=0;T<this.g.length;T++){const A=this.i(T);I+=(A>=0?A:4294967296+A)*b,b*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(v(this))return"-"+w(this).toString(I);const b=u(Math.pow(I,6));var T=this;let A="";for(;;){const x=O(T,b).g;T=P(T,x.j(b));let S=((T.g.length>0?T.g[0]:T.h)>>>0).toString(I);if(T=x,y(T))return S+A;for(;S.length<6;)S="0"+S;A=S+A}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(let b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function v(I){return I.h==-1}n.l=function(I){return I=P(this,I),v(I)?-1:y(I)?0:1};function w(I){const b=I.g.length,T=[];for(let A=0;A<b;A++)T[A]=~I.g[A];return new o(T,~I.h).add(g)}n.abs=function(){return v(this)?w(this):this},n.add=function(I){const b=Math.max(this.g.length,I.g.length),T=[];let A=0;for(let x=0;x<=b;x++){let S=A+(this.i(x)&65535)+(I.i(x)&65535),E=(S>>>16)+(this.i(x)>>>16)+(I.i(x)>>>16);A=E>>>16,S&=65535,E&=65535,T[x]=E<<16|S}return new o(T,T[T.length-1]&-2147483648?-1:0)};function P(I,b){return I.add(w(b))}n.j=function(I){if(y(this)||y(I))return d;if(v(this))return v(I)?w(this).j(w(I)):w(w(this).j(I));if(v(I))return w(this.j(w(I)));if(this.l(m)<0&&I.l(m)<0)return u(this.m()*I.m());const b=this.g.length+I.g.length,T=[];for(var A=0;A<2*b;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(let x=0;x<I.g.length;x++){const S=this.i(A)>>>16,E=this.i(A)&65535,j=I.i(x)>>>16,U=I.i(x)&65535;T[2*A+2*x]+=E*U,C(T,2*A+2*x),T[2*A+2*x+1]+=S*U,C(T,2*A+2*x+1),T[2*A+2*x+1]+=E*j,C(T,2*A+2*x+1),T[2*A+2*x+2]+=S*j,C(T,2*A+2*x+2)}for(I=0;I<b;I++)T[I]=T[2*I+1]<<16|T[2*I];for(I=b;I<2*b;I++)T[I]=0;return new o(T,0)};function C(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function D(I,b){this.g=I,this.h=b}function O(I,b){if(y(b))throw Error("division by zero");if(y(I))return new D(d,d);if(v(I))return b=O(w(I),b),new D(w(b.g),w(b.h));if(v(b))return b=O(I,w(b)),new D(w(b.g),b.h);if(I.g.length>30){if(v(I)||v(b))throw Error("slowDivide_ only works with positive integers.");for(var T=g,A=b;A.l(I)<=0;)T=M(T),A=M(A);var x=L(T,1),S=L(A,1);for(A=L(A,2),T=L(T,2);!y(A);){var E=S.add(A);E.l(I)<=0&&(x=x.add(T),S=E),A=L(A,1),T=L(T,1)}return b=P(I,x.j(b)),new D(x,b)}for(x=d;I.l(b)>=0;){for(T=Math.max(1,Math.floor(I.m()/b.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),S=u(T),E=S.j(b);v(E)||E.l(I)>0;)T-=A,S=u(T),E=S.j(b);y(S)&&(S=g),x=x.add(S),I=P(I,E)}return new D(x,I)}n.B=function(I){return O(this,I).h},n.and=function(I){const b=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<b;A++)T[A]=this.i(A)&I.i(A);return new o(T,this.h&I.h)},n.or=function(I){const b=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<b;A++)T[A]=this.i(A)|I.i(A);return new o(T,this.h|I.h)},n.xor=function(I){const b=Math.max(this.g.length,I.g.length),T=[];for(let A=0;A<b;A++)T[A]=this.i(A)^I.i(A);return new o(T,this.h^I.h)};function M(I){const b=I.g.length+1,T=[];for(let A=0;A<b;A++)T[A]=I.i(A)<<1|I.i(A-1)>>>31;return new o(T,I.h)}function L(I,b){const T=b>>5;b%=32;const A=I.g.length-T,x=[];for(let S=0;S<A;S++)x[S]=b>0?I.i(S+T)>>>b|I.i(S+T+1)<<32-b:I.i(S+T);return new o(x,I.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Yp=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,yn=o}).apply(typeof Zd<"u"?Zd:typeof self<"u"?self:typeof window<"u"?window:{});var Fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Kp,bs,Xp,Xr,Ic,Qp,Jp,Zp;(function(){var n,t=Object.defineProperty;function e(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fr=="object"&&Fr];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var i=e(this);function s(l,f){if(f)t:{var p=i;l=l.split(".");for(var _=0;_<l.length-1;_++){var k=l[_];if(!(k in p))break t;p=p[k]}l=l[l.length-1],_=p[l],f=f(_),f!=_&&f!=null&&t(p,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});var r=r||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,p){return l.call.apply(l.bind,arguments)}function u(l,f,p){return u=c,u.apply(null,arguments)}function h(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function d(l,f){function p(){}p.prototype=f.prototype,l.Z=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(_,k,R){for(var F=Array(arguments.length-2),K=2;K<arguments.length;K++)F[K-2]=arguments[K];return f.prototype[k].apply(_,F)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function m(l){const f=l.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=l[_];return p}return[]}function y(l,f){for(let _=1;_<arguments.length;_++){const k=arguments[_];var p=typeof k;if(p=p!="object"?p:k?Array.isArray(k)?"array":p:"null",p=="array"||p=="object"&&typeof k.length=="number"){p=l.length||0;const R=k.length||0;l.length=p+R;for(let F=0;F<R;F++)l[p+F]=k[F]}else l.push(k)}}class v{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function w(l){o.setTimeout(()=>{throw l},0)}function P(){var l=I;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class C{constructor(){this.h=this.g=null}add(f,p){const _=D.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var D=new v(()=>new O,l=>l.reset());class O{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let M,L=!1,I=new C,b=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(T)}};function T(){for(var l;l=P();){try{l.h.call(l.g)}catch(p){w(p)}var f=D;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}L=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function x(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}x.prototype.h=function(){this.defaultPrevented=!0};var S=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return l})();function E(l){return/^[\s\xa0]*$/.test(l)}function j(l,f){x.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}d(j,x),j.prototype.init=function(l,f){const p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&j.Z.h.call(this)},j.prototype.h=function(){j.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),X=0;function J(l,f,p,_,k){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=k,this.key=++X,this.da=this.fa=!1}function pt(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function mt(l,f,p){for(const _ in l)f.call(p,l[_],_,l)}function Ye(l,f){for(const p in l)f.call(void 0,l[p],p,l)}function Rn(l){const f={};for(const p in l)f[p]=l[p];return f}const Ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ke(l,f){let p,_;for(let k=1;k<arguments.length;k++){_=arguments[k];for(p in _)l[p]=_[p];for(let R=0;R<Ce.length;R++)p=Ce[R],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function ee(l){this.src=l,this.g={},this.h=0}ee.prototype.add=function(l,f,p,_,k){const R=l.toString();l=this.g[R],l||(l=this.g[R]=[],this.h++);const F=ae(l,f,_,k);return F>-1?(f=l[F],p||(f.fa=!1)):(f=new J(f,this.src,R,!!_,k),f.fa=p,l.push(f)),f};function ke(l,f){const p=f.type;if(p in l.g){var _=l.g[p],k=Array.prototype.indexOf.call(_,f,void 0),R;(R=k>=0)&&Array.prototype.splice.call(_,k,1),R&&(pt(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function ae(l,f,p,_){for(let k=0;k<l.length;++k){const R=l[k];if(!R.da&&R.listener==f&&R.capture==!!p&&R.ha==_)return k}return-1}var ca="closure_lm_"+(Math.random()*1e6|0),la={};function Ql(l,f,p,_,k){if(Array.isArray(f)){for(let R=0;R<f.length;R++)Ql(l,f[R],p,_,k);return null}return p=tu(p),l&&l[U]?l.J(f,p,a(_)?!!_.capture:!1,k):x_(l,f,p,!1,_,k)}function x_(l,f,p,_,k,R){if(!f)throw Error("Invalid event type");const F=a(k)?!!k.capture:!!k;let K=ha(l);if(K||(l[ca]=K=new ee(l)),p=K.add(f,p,_,F,R),p.proxy)return p;if(_=A_(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)S||(k=F),k===void 0&&(k=!1),l.addEventListener(f.toString(),_,k);else if(l.attachEvent)l.attachEvent(Zl(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function A_(){function l(p){return f.call(l.src,l.listener,p)}const f=P_;return l}function Jl(l,f,p,_,k){if(Array.isArray(f))for(var R=0;R<f.length;R++)Jl(l,f[R],p,_,k);else _=a(_)?!!_.capture:!!_,p=tu(p),l&&l[U]?(l=l.i,R=String(f).toString(),R in l.g&&(f=l.g[R],p=ae(f,p,_,k),p>-1&&(pt(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete l.g[R],l.h--)))):l&&(l=ha(l))&&(f=l.g[f.toString()],l=-1,f&&(l=ae(f,p,_,k)),(p=l>-1?f[l]:null)&&ua(p))}function ua(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[U])ke(f.i,l);else{var p=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(p,_,l.capture):f.detachEvent?f.detachEvent(Zl(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=ha(f))?(ke(p,l),p.h==0&&(p.src=null,f[ca]=null)):pt(l)}}}function Zl(l){return l in la?la[l]:la[l]="on"+l}function P_(l,f){if(l.da)l=!0;else{f=new j(f,this);const p=l.listener,_=l.ha||l.src;l.fa&&ua(l),l=p.call(_,f)}return l}function ha(l){return l=l[ca],l instanceof ee?l:null}var da="__closure_events_fn_"+(Math.random()*1e9>>>0);function tu(l){return typeof l=="function"?l:(l[da]||(l[da]=function(f){return l.handleEvent(f)}),l[da])}function Lt(){A.call(this),this.i=new ee(this),this.M=this,this.G=null}d(Lt,A),Lt.prototype[U]=!0,Lt.prototype.removeEventListener=function(l,f,p,_){Jl(this,l,f,p,_)};function qt(l,f){var p,_=l.G;if(_)for(p=[];_;_=_.G)p.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new x(f,l);else if(f instanceof x)f.target=f.target||l;else{var k=f;f=new x(_,l),Ke(f,k)}k=!0;let R,F;if(p)for(F=p.length-1;F>=0;F--)R=f.g=p[F],k=hr(R,_,!0,f)&&k;if(R=f.g=l,k=hr(R,_,!0,f)&&k,k=hr(R,_,!1,f)&&k,p)for(F=0;F<p.length;F++)R=f.g=p[F],k=hr(R,_,!1,f)&&k}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const p=l.g[f];for(let _=0;_<p.length;_++)pt(p[_]);delete l.g[f],l.h--}}this.G=null},Lt.prototype.J=function(l,f,p,_){return this.i.add(String(l),f,!1,p,_)},Lt.prototype.K=function(l,f,p,_){return this.i.add(String(l),f,!0,p,_)};function hr(l,f,p,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let k=!0;for(let R=0;R<f.length;++R){const F=f[R];if(F&&!F.da&&F.capture==p){const K=F.listener,St=F.ha||F.src;F.fa&&ke(l.i,F),k=K.call(St,_)!==!1&&k}}return k&&!_.defaultPrevented}function C_(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=u(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function eu(l){l.g=C_(()=>{l.g=null,l.i&&(l.i=!1,eu(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class k_ extends A{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:eu(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gi(l){A.call(this),this.h=l,this.g={}}d(Gi,A);var nu=[];function iu(l){mt(l.g,function(f,p){this.g.hasOwnProperty(p)&&ua(f)},l),l.g={}}Gi.prototype.N=function(){Gi.Z.N.call(this),iu(this)},Gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fa=o.JSON.stringify,R_=o.JSON.parse,D_=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function su(){}function ru(){}var Yi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ga(){x.call(this,"d")}d(ga,x);function pa(){x.call(this,"c")}d(pa,x);var Dn={},ou=null;function dr(){return ou=ou||new Lt}Dn.Ia="serverreachability";function au(l){x.call(this,Dn.Ia,l)}d(au,x);function Ki(l){const f=dr();qt(f,new au(f))}Dn.STAT_EVENT="statevent";function cu(l,f){x.call(this,Dn.STAT_EVENT,l),this.stat=f}d(cu,x);function Gt(l){const f=dr();qt(f,new cu(f,l))}Dn.Ja="timingevent";function lu(l,f){x.call(this,Dn.Ja,l),this.size=f}d(lu,x);function Xi(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function Qi(){this.g=!0}Qi.prototype.ua=function(){this.g=!1};function M_(l,f,p,_,k,R){l.info(function(){if(l.g)if(R){var F="",K=R.split("&");for(let ct=0;ct<K.length;ct++){var St=K[ct].split("=");if(St.length>1){const Ct=St[0];St=St[1];const ge=Ct.split("_");F=ge.length>=2&&ge[1]=="type"?F+(Ct+"="+St+"&"):F+(Ct+"=redacted&")}}}else F=null;else F=R;return"XMLHTTP REQ ("+_+") [attempt "+k+"]: "+f+`
`+p+`
`+F})}function O_(l,f,p,_,k,R,F){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+k+"]: "+f+`
`+p+`
`+R+" "+F})}function hi(l,f,p,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+V_(l,p)+(_?" "+_:"")})}function N_(l,f){l.info(function(){return"TIMEOUT: "+f})}Qi.prototype.info=function(){};function V_(l,f){if(!l.g)return f;if(!f)return null;try{const R=JSON.parse(f);if(R){for(l=0;l<R.length;l++)if(Array.isArray(R[l])){var p=R[l];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var k=_[0];if(k!="noop"&&k!="stop"&&k!="close")for(let F=1;F<_.length;F++)_[F]=""}}}}return fa(R)}catch{return f}}var fr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},uu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hu;function ma(){}d(ma,su),ma.prototype.g=function(){return new XMLHttpRequest},hu=new ma;function Ji(l){return encodeURIComponent(String(l))}function L_(l){var f=1;l=l.split(":");const p=[];for(;f>0&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function Xe(l,f,p,_){this.j=l,this.i=f,this.l=p,this.S=_||1,this.V=new Gi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new du}function du(){this.i=null,this.g="",this.h=!1}var fu={},_a={};function ya(l,f,p){l.M=1,l.A=pr(fe(f)),l.u=p,l.R=!0,gu(l,null)}function gu(l,f){l.F=Date.now(),gr(l),l.B=fe(l.A);var p=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),Au(p.i,"t",_),l.C=0,p=l.j.L,l.h=new du,l.g=$u(l.j,p?f:null,!l.u),l.P>0&&(l.O=new k_(u(l.Y,l,l.g),l.P)),f=l.V,p=l.g,_=l.ba;var k="readystatechange";Array.isArray(k)||(k&&(nu[0]=k.toString()),k=nu);for(let R=0;R<k.length;R++){const F=Ql(p,k[R],_||f.handleEvent,!1,f.h||f);if(!F)break;f.g[F.key]=F}f=l.J?Rn(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),Ki(),M_(l.i,l.v,l.B,l.l,l.S,l.u)}Xe.prototype.ba=function(l){l=l.target;const f=this.O;f&&Ze(l)==3?f.j():this.Y(l)},Xe.prototype.Y=function(l){try{if(l==this.g)t:{const K=Ze(this.g),St=this.g.ya(),ct=this.g.ca();if(!(K<3)&&(K!=3||this.g&&(this.h.h||this.g.la()||Ou(this.g)))){this.K||K!=4||St==7||(St==8||ct<=0?Ki(3):Ki(2)),ba(this);var f=this.g.ca();this.X=f;var p=F_(this);if(this.o=f==200,O_(this.i,this.v,this.B,this.l,this.S,K,f),this.o){if(this.U&&!this.L){e:{if(this.g){var _,k=this.g;if((_=k.g?k.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(_)){var R=_;break e}}R=null}if(l=R)hi(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,va(this,l);else{this.o=!1,this.m=3,Gt(12),Mn(this),Zi(this);break t}}if(this.R){l=!0;let Ct;for(;!this.K&&this.C<p.length;)if(Ct=B_(this,p),Ct==_a){K==4&&(this.m=4,Gt(14),l=!1),hi(this.i,this.l,null,"[Incomplete Response]");break}else if(Ct==fu){this.m=4,Gt(15),hi(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else hi(this.i,this.l,Ct,null),va(this,Ct);if(pu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),K!=4||p.length!=0||this.h.h||(this.m=1,Gt(16),l=!1),this.o=this.o&&l,!l)hi(this.i,this.l,p,"[Invalid Chunked Response]"),Mn(this),Zi(this);else if(p.length>0&&!this.W){this.W=!0;var F=this.j;F.g==this&&F.aa&&!F.P&&(F.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Pa(F),F.P=!0,Gt(11))}}else hi(this.i,this.l,p,null),va(this,p);K==4&&Mn(this),this.o&&!this.K&&(K==4?zu(this.j,this):(this.o=!1,gr(this)))}else Z_(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,Gt(12)):(this.m=0,Gt(13)),Mn(this),Zi(this)}}}catch{}finally{}};function F_(l){if(!pu(l))return l.g.la();const f=Ou(l.g);if(f==="")return"";let p="";const _=f.length,k=Ze(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Mn(l),Zi(l),"";l.h.i=new o.TextDecoder}for(let R=0;R<_;R++)l.h.h=!0,p+=l.h.i.decode(f[R],{stream:!(k&&R==_-1)});return f.length=0,l.h.g+=p,l.C=0,l.h.g}function pu(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function B_(l,f){var p=l.C,_=f.indexOf(`
`,p);return _==-1?_a:(p=Number(f.substring(p,_)),isNaN(p)?fu:(_+=1,_+p>f.length?_a:(f=f.slice(_,_+p),l.C=_+p,f)))}Xe.prototype.cancel=function(){this.K=!0,Mn(this)};function gr(l){l.T=Date.now()+l.H,mu(l,l.H)}function mu(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Xi(u(l.aa,l),f)}function ba(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Xe.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(N_(this.i,this.B),this.M!=2&&(Ki(),Gt(17)),Mn(this),this.m=2,Zi(this)):mu(this,this.T-l)};function Zi(l){l.j.I==0||l.K||zu(l.j,l)}function Mn(l){ba(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,iu(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function va(l,f){try{var p=l.j;if(p.I!=0&&(p.g==l||wa(p.h,l))){if(!l.L&&wa(p.h,l)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var k=_;if(k[0]==0){t:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)vr(p),yr(p);else break t;Aa(p),Gt(18)}}else p.xa=k[1],0<p.xa-p.K&&k[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Xi(u(p.Va,p),6e3));bu(p.h)<=1&&p.ta&&(p.ta=void 0)}else Nn(p,11)}else if((l.L||p.g==l)&&vr(p),!E(f))for(k=p.Ba.g.parse(f),f=0;f<k.length;f++){let ct=k[f];const Ct=ct[0];if(!(Ct<=p.K))if(p.K=Ct,ct=ct[1],p.I==2)if(ct[0]=="c"){p.M=ct[1],p.ba=ct[2];const ge=ct[3];ge!=null&&(p.ka=ge,p.j.info("VER="+p.ka));const Vn=ct[4];Vn!=null&&(p.za=Vn,p.j.info("SVER="+p.za));const tn=ct[5];tn!=null&&typeof tn=="number"&&tn>0&&(_=1.5*tn,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const en=l.g;if(en){const Er=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Er){var R=_.h;R.g||Er.indexOf("spdy")==-1&&Er.indexOf("quic")==-1&&Er.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Ea(R,R.h),R.h=null))}if(_.G){const Ca=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;Ca&&(_.wa=Ca,ut(_.J,_.G,Ca))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var F=l;if(_.na=Hu(_,_.L?_.ba:null,_.W),F.L){vu(_.h,F);var K=F,St=_.O;St&&(K.H=St),K.D&&(ba(K),gr(K)),_.g=F}else Bu(_);p.i.length>0&&br(p)}else ct[0]!="stop"&&ct[0]!="close"||Nn(p,7);else p.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Nn(p,7):xa(p):ct[0]!="noop"&&p.l&&p.l.qa(ct),p.A=0)}}Ki(4)}catch{}}var U_=class{constructor(l,f){this.g=l,this.map=f}};function _u(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function yu(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function bu(l){return l.h?1:l.g?l.g.size:0}function wa(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Ea(l,f){l.g?l.g.add(f):l.h=f}function vu(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}_u.prototype.cancel=function(){if(this.i=wu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function wu(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const p of l.g.values())f=f.concat(p.G);return f}return m(l.i)}var Eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function z_(l,f){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const _=l[p].indexOf("=");let k,R=null;_>=0?(k=l[p].substring(0,_),R=l[p].substring(_+1)):k=l[p],f(k,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Qe(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Qe?(this.l=l.l,ts(this,l.j),this.o=l.o,this.g=l.g,es(this,l.u),this.h=l.h,Ta(this,Pu(l.i)),this.m=l.m):l&&(f=String(l).match(Eu))?(this.l=!1,ts(this,f[1]||"",!0),this.o=ns(f[2]||""),this.g=ns(f[3]||"",!0),es(this,f[4]),this.h=ns(f[5]||"",!0),Ta(this,f[6]||"",!0),this.m=ns(f[7]||"")):(this.l=!1,this.i=new ss(null,this.l))}Qe.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(is(f,Tu,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(is(f,Tu,!0),"@"),l.push(Ji(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(is(p,p.charAt(0)=="/"?H_:j_,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",is(p,q_)),l.join("")},Qe.prototype.resolve=function(l){const f=fe(this);let p=!!l.j;p?ts(f,l.j):p=!!l.o,p?f.o=l.o:p=!!l.g,p?f.g=l.g:p=l.u!=null;var _=l.h;if(p)es(f,l.u);else if(p=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var k=f.h.lastIndexOf("/");k!=-1&&(_=f.h.slice(0,k+1)+_)}if(k=_,k==".."||k==".")_="";else if(k.indexOf("./")!=-1||k.indexOf("/.")!=-1){_=k.lastIndexOf("/",0)==0,k=k.split("/");const R=[];for(let F=0;F<k.length;){const K=k[F++];K=="."?_&&F==k.length&&R.push(""):K==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),_&&F==k.length&&R.push("")):(R.push(K),_=!0)}_=R.join("/")}else _=k}return p?f.h=_:p=l.i.toString()!=="",p?Ta(f,Pu(l.i)):p=!!l.m,p&&(f.m=l.m),f};function fe(l){return new Qe(l)}function ts(l,f,p){l.j=p?ns(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function es(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function Ta(l,f,p){f instanceof ss?(l.i=f,G_(l.i,l.l)):(p||(f=is(f,$_)),l.i=new ss(f,l.l))}function ut(l,f,p){l.i.set(f,p)}function pr(l){return ut(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ns(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function is(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,W_),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function W_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Tu=/[#\/\?@]/g,j_=/[#\?:]/g,H_=/[#\?]/g,$_=/[#\?@]/g,q_=/#/g;function ss(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function On(l){l.g||(l.g=new Map,l.h=0,l.i&&z_(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=ss.prototype,n.add=function(l,f){On(this),this.i=null,l=di(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function Iu(l,f){On(l),f=di(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Su(l,f){return On(l),f=di(l,f),l.g.has(f)}n.forEach=function(l,f){On(this),this.g.forEach(function(p,_){p.forEach(function(k){l.call(f,k,_,this)},this)},this)};function xu(l,f){On(l);let p=[];if(typeof f=="string")Su(l,f)&&(p=p.concat(l.g.get(di(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)p=p.concat(l[f]);return p}n.set=function(l,f){return On(this),this.i=null,l=di(this,l),Su(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=xu(this,l),l.length>0?String(l[0]):f):f};function Au(l,f,p){Iu(l,f),p.length>0&&(l.i=null,l.g.set(di(l,f),m(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const k=Ji(p);p=xu(this,p);for(let R=0;R<p.length;R++){let F=k;p[R]!==""&&(F+="="+Ji(p[R])),l.push(F)}}return this.i=l.join("&")};function Pu(l){const f=new ss;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function di(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function G_(l,f){f&&!l.j&&(On(l),l.i=null,l.g.forEach(function(p,_){const k=_.toLowerCase();_!=k&&(Iu(this,_),Au(this,k,p))},l)),l.j=f}function Y_(l,f){const p=new Qi;if(o.Image){const _=new Image;_.onload=h(Je,p,"TestLoadImage: loaded",!0,f,_),_.onerror=h(Je,p,"TestLoadImage: error",!1,f,_),_.onabort=h(Je,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=h(Je,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function K_(l,f){const p=new Qi,_=new AbortController,k=setTimeout(()=>{_.abort(),Je(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(R=>{clearTimeout(k),R.ok?Je(p,"TestPingServer: ok",!0,f):Je(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(k),Je(p,"TestPingServer: error",!1,f)})}function Je(l,f,p,_,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),_(p)}catch{}}function X_(){this.g=new D_}function Ia(l){this.i=l.Sb||null,this.h=l.ab||!1}d(Ia,su),Ia.prototype.g=function(){return new mr(this.i,this.h)};function mr(l,f){Lt.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(mr,Lt),n=mr.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,os(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,rs(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,os(this)),this.g&&(this.readyState=3,os(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cu(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cu(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?rs(this):os(this),this.readyState==3&&Cu(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,rs(this))},n.Na=function(l){this.g&&(this.response=l,rs(this))},n.ga=function(){this.g&&rs(this)};function rs(l){l.readyState=4,l.l=null,l.j=null,l.B=null,os(l)}n.setRequestHeader=function(l,f){this.A.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function os(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(mr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function ku(l){let f="";return mt(l,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function Sa(l,f,p){t:{for(_ in p){var _=!1;break t}_=!0}_||(p=ku(p),typeof l=="string"?p!=null&&Ji(p):ut(l,f,p))}function bt(l){Lt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(bt,Lt);var Q_=/^https?$/i,J_=["POST","PUT"];n=bt.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hu.g(),this.g.onreadystatechange=g(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(R){Ru(this,R);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var k in _)p.set(k,_[k]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const R of _.keys())p.set(R,_.get(R));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(R=>R.toLowerCase()=="content-type"),k=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(J_,f,void 0)>=0)||_||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,F]of p)this.g.setRequestHeader(R,F);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(R){Ru(this,R)}};function Ru(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Du(l),_r(l)}function Du(l){l.A||(l.A=!0,qt(l,"complete"),qt(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,qt(this,"complete"),qt(this,"abort"),_r(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_r(this,!0)),bt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Mu(this):this.Xa())},n.Xa=function(){Mu(this)};function Mu(l){if(l.h&&typeof r<"u"){if(l.v&&Ze(l)==4)setTimeout(l.Ca.bind(l),0);else if(qt(l,"readystatechange"),Ze(l)==4){l.h=!1;try{const R=l.ca();t:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var p;if(!(p=f)){var _;if(_=R===0){let F=String(l.D).match(Eu)[1]||null;!F&&o.self&&o.self.location&&(F=o.self.location.protocol.slice(0,-1)),_=!Q_.test(F?F.toLowerCase():"")}p=_}if(p)qt(l,"complete"),qt(l,"success");else{l.o=6;try{var k=Ze(l)>2?l.g.statusText:""}catch{k=""}l.l=k+" ["+l.ca()+"]",Du(l)}}finally{_r(l)}}}}function _r(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,f||qt(l,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ze(l){return l.g?l.g.readyState:0}n.ca=function(){try{return Ze(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),R_(f)}};function Ou(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Z_(l){const f={};l=(l.g&&Ze(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(E(l[_]))continue;var p=L_(l[_]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const R=f[k]||[];f[k]=R,R.push(p)}Ye(f,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function as(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function Nu(l){this.za=0,this.i=[],this.j=new Qi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=as("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=as("baseRetryDelayMs",5e3,l),this.Za=as("retryDelaySeedMs",1e4,l),this.Ta=as("forwardChannelMaxRetries",2,l),this.va=as("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new _u(l&&l.concurrentRequestLimit),this.Ba=new X_,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Nu.prototype,n.ka=8,n.I=1,n.connect=function(l,f,p,_){Gt(0),this.W=l,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=Hu(this,null,this.W),br(this)};function xa(l){if(Vu(l),l.I==3){var f=l.V++,p=fe(l.J);if(ut(p,"SID",l.M),ut(p,"RID",f),ut(p,"TYPE","terminate"),cs(l,p),f=new Xe(l,l.j,f),f.M=2,f.A=pr(fe(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=$u(f.j,null),f.g.ea(f.A)),f.F=Date.now(),gr(f)}ju(l)}function yr(l){l.g&&(Pa(l),l.g.cancel(),l.g=null)}function Vu(l){yr(l),l.v&&(o.clearTimeout(l.v),l.v=null),vr(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function br(l){if(!yu(l.h)&&!l.m){l.m=!0;var f=l.Ea;M||b(),L||(M(),L=!0),I.add(f,l),l.D=0}}function ty(l,f){return bu(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Xi(u(l.Ea,l,f),Wu(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const k=new Xe(this,this.j,l);let R=this.o;if(this.U&&(R?(R=Rn(R),Ke(R,this.U)):R=this.U),this.u!==null||this.R||(k.J=R,R=null),this.S)t:{for(var f=0,p=0;p<this.i.length;p++){e:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break e}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break t}if(f===4096||p===this.i.length-1){f=p+1;break t}}f=1e3}else f=1e3;f=Fu(this,k,f),p=fe(this.J),ut(p,"RID",l),ut(p,"CVER",22),this.G&&ut(p,"X-HTTP-Session-Id",this.G),cs(this,p),R&&(this.R?f="headers="+Ji(ku(R))+"&"+f:this.u&&Sa(p,this.u,R)),Ea(this.h,k),this.Ra&&ut(p,"TYPE","init"),this.S?(ut(p,"$req",f),ut(p,"SID","null"),k.U=!0,ya(k,p,null)):ya(k,p,f),this.I=2}}else this.I==3&&(l?Lu(this,l):this.i.length==0||yu(this.h)||Lu(this))};function Lu(l,f){var p;f?p=f.l:p=l.V++;const _=fe(l.J);ut(_,"SID",l.M),ut(_,"RID",p),ut(_,"AID",l.K),cs(l,_),l.u&&l.o&&Sa(_,l.u,l.o),p=new Xe(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Fu(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Ea(l.h,p),ya(p,_,f)}function cs(l,f){l.H&&mt(l.H,function(p,_){ut(f,_,p)}),l.l&&mt({},function(p,_){ut(f,_,p)})}function Fu(l,f,p){p=Math.min(l.i.length,p);const _=l.l?u(l.l.Ka,l.l,l):null;t:{var k=l.i;let K=-1;for(;;){const St=["count="+p];K==-1?p>0?(K=k[0].g,St.push("ofs="+K)):K=0:St.push("ofs="+K);let ct=!0;for(let Ct=0;Ct<p;Ct++){var R=k[Ct].g;const ge=k[Ct].map;if(R-=K,R<0)K=Math.max(0,k[Ct].g-100),ct=!1;else try{R="req"+R+"_"||"";try{var F=ge instanceof Map?ge:Object.entries(ge);for(const[Vn,tn]of F){let en=tn;a(tn)&&(en=fa(tn)),St.push(R+Vn+"="+encodeURIComponent(en))}}catch(Vn){throw St.push(R+"type="+encodeURIComponent("_badmap")),Vn}}catch{_&&_(ge)}}if(ct){F=St.join("&");break t}}F=void 0}return l=l.i.splice(0,p),f.G=l,F}function Bu(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;M||b(),L||(M(),L=!0),I.add(f,l),l.A=0}}function Aa(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Xi(u(l.Da,l),Wu(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,Uu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Xi(u(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Gt(10),yr(this),Uu(this))};function Pa(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Uu(l){l.g=new Xe(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=fe(l.na);ut(f,"RID","rpc"),ut(f,"SID",l.M),ut(f,"AID",l.K),ut(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&ut(f,"TO",l.ia),ut(f,"TYPE","xmlhttp"),cs(l,f),l.u&&l.o&&Sa(f,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=pr(fe(f)),p.u=null,p.R=!0,gu(p,l)}n.Va=function(){this.C!=null&&(this.C=null,yr(this),Aa(this),Gt(19))};function vr(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function zu(l,f){var p=null;if(l.g==f){vr(l),Pa(l),l.g=null;var _=2}else if(wa(l.h,f))p=f.G,vu(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var k=l.D;_=dr(),qt(_,new lu(_,p)),br(l)}else Bu(l);else if(k=f.m,k==3||k==0&&f.X>0||!(_==1&&ty(l,f)||_==2&&Aa(l)))switch(p&&p.length>0&&(f=l.h,f.i=f.i.concat(p)),k){case 1:Nn(l,5);break;case 4:Nn(l,10);break;case 3:Nn(l,6);break;default:Nn(l,2)}}}function Wu(l,f){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*f}function Nn(l,f){if(l.j.info("Error code "+f),f==2){var p=u(l.bb,l),_=l.Ua;const k=!_;_=new Qe(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ts(_,"https"),pr(_),k?Y_(_.toString(),p):K_(_.toString(),p)}else Gt(2);l.I=0,l.l&&l.l.pa(f),ju(l),Vu(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function ju(l){if(l.I=0,l.ja=[],l.l){const f=wu(l.h);(f.length!=0||l.i.length!=0)&&(y(l.ja,f),y(l.ja,l.i),l.h.i.length=0,m(l.i),l.i.length=0),l.l.oa()}}function Hu(l,f,p){var _=p instanceof Qe?fe(p):new Qe(p);if(_.g!="")f&&(_.g=f+"."+_.g),es(_,_.u);else{var k=o.location;_=k.protocol,f=f?f+"."+k.hostname:k.hostname,k=+k.port;const R=new Qe(null);_&&ts(R,_),f&&(R.g=f),k&&es(R,k),p&&(R.h=p),_=R}return p=l.G,f=l.wa,p&&f&&ut(_,p,f),ut(_,"VER",l.ka),cs(l,_),_}function $u(l,f,p){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new bt(new Ia({ab:p})):new bt(l.ma),f.Fa(l.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function qu(){}n=qu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function wr(){}wr.prototype.g=function(l,f){return new Qt(l,f)};function Qt(l,f){Lt.call(this),this.g=new Nu(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!E(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!E(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new fi(this)}d(Qt,Lt),Qt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){xa(this.g)},Qt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=fa(l),l=p);f.i.push(new U_(f.Ya++,l)),f.I==3&&br(f)},Qt.prototype.N=function(){this.g.l=null,delete this.j,xa(this.g),delete this.g,Qt.Z.N.call(this)};function Gu(l){ga.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){t:{for(const p in f){l=p;break t}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}d(Gu,ga);function Yu(){pa.call(this),this.status=1}d(Yu,pa);function fi(l){this.g=l}d(fi,qu),fi.prototype.ra=function(){qt(this.g,"a")},fi.prototype.qa=function(l){qt(this.g,new Gu(l))},fi.prototype.pa=function(l){qt(this.g,new Yu)},fi.prototype.oa=function(){qt(this.g,"b")},wr.prototype.createWebChannel=wr.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,Zp=function(){return new wr},Jp=function(){return dr()},Qp=Dn,Ic={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,Xr=fr,uu.COMPLETE="complete",Xp=uu,ru.EventType=Yi,Yi.OPEN="a",Yi.CLOSE="b",Yi.ERROR="c",Yi.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,bs=ru,bt.prototype.listenOnce=bt.prototype.K,bt.prototype.getLastError=bt.prototype.Ha,bt.prototype.getLastErrorCode=bt.prototype.ya,bt.prototype.getStatus=bt.prototype.ca,bt.prototype.getResponseJson=bt.prototype.La,bt.prototype.getResponseText=bt.prototype.la,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Fa,Kp=bt}).apply(typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{});const tf="@firebase/firestore",ef="4.9.2";class Ut{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");let ji="12.3.0";const si=new al("@firebase/firestore");function _i(){return si.logLevel}function B(n,...t){if(si.logLevel<=Z.DEBUG){const e=t.map(vl);si.debug(`Firestore (${ji}): ${n}`,...e)}}function He(n,...t){if(si.logLevel<=Z.ERROR){const e=t.map(vl);si.error(`Firestore (${ji}): ${n}`,...e)}}function Oi(n,...t){if(si.logLevel<=Z.WARN){const e=t.map(vl);si.warn(`Firestore (${ji}): ${n}`,...e)}}function vl(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function H(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,tm(n,i,e)}function tm(n,t,e){let i=`FIRESTORE (${ji}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw He(i),new Error(i)}function rt(n,t,e,i){let s="Unexpected state";typeof e=="string"?s=e:i=e,n||tm(t,s,i)}function Y(n,t){return n}const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends Ge{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class bn{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class em{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class dP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Ut.UNAUTHENTICATED)))}shutdown(){}}class fP{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class gP{constructor(t){this.t=t,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){rt(this.o===void 0,42304);let i=this.i;const s=c=>this.i!==i?(i=this.i,e(c)):Promise.resolve();let r=new bn;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new bn,t.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const c=r;t.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new bn)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((i=>this.i!==t?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(rt(typeof i.accessToken=="string",31837,{l:i}),new em(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return rt(t===null||typeof t=="string",2055,{h:t}),new Ut(t)}}class pP{constructor(t,e,i){this.P=t,this.T=e,this.I=i,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mP{constructor(t,e,i){this.P=t,this.T=e,this.I=i}getToken(){return Promise.resolve(new pP(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Ut.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _P{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ce(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){rt(this.o===void 0,3512);const i=r=>{r.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable((()=>i(r)))};const s=r=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(rt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new nf(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function yP(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class wl{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=yP(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<e&&(i+=t.charAt(s[r]%62))}return i}}function tt(n,t){return n<t?-1:n>t?1:0}function Sc(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++){const s=n.charAt(i),r=t.charAt(i);if(s!==r)return Ja(s)===Ja(r)?tt(s,r):Ja(s)?1:-1}return tt(n.length,t.length)}const bP=55296,vP=57343;function Ja(n){const t=n.charCodeAt(0);return t>=bP&&t<=vP}function Ni(n,t,e){return n.length===t.length&&n.every(((i,s)=>e(i,t[s])))}const sf="__name__";class _e{constructor(t,e,i){e===void 0?e=0:e>t.length&&H(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&H(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return _e.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof _e?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let s=0;s<i;s++){const r=_e.compareSegments(t.get(s),e.get(s));if(r!==0)return r}return tt(t.length,e.length)}static compareSegments(t,e){const i=_e.isNumericId(t),s=_e.isNumericId(e);return i&&!s?-1:!i&&s?1:i&&s?_e.extractNumericId(t).compare(_e.extractNumericId(e)):Sc(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return yn.fromString(t.substring(4,t.length-2))}}class _t extends _e{construct(t,e,i){return new _t(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new z(V.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((s=>s.length>0)))}return new _t(e)}static emptyPath(){return new _t([])}}const wP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ot extends _e{construct(t,e,i){return new Ot(t,e,i)}static isValidIdentifier(t){return wP.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ot.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sf}static keyField(){return new Ot([sf])}static fromServerFormat(t){const e=[];let i="",s=0;const r=()=>{if(i.length===0)throw new z(V.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new z(V.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new z(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new z(V.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ot(e)}static emptyPath(){return new Ot([])}}class W{constructor(t){this.path=t}static fromPath(t){return new W(_t.fromString(t))}static fromName(t){return new W(_t.fromString(t).popFirst(5))}static empty(){return new W(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return _t.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new W(new _t(t.slice()))}}function EP(n,t,e){if(!e)throw new z(V.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function TP(n,t,e,i){if(t===!0&&i===!0)throw new z(V.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function rf(n){if(!W.isDocumentKey(n))throw new z(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nm(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function El(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":H(12329,{type:typeof n})}function Hs(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new z(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=El(n);throw new z(V.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function It(n,t){const e={typeString:n};return t&&(e.value=t),e}function or(n,t){if(!nm(n))throw new z(V.INVALID_ARGUMENT,"JSON must be an object");let e;for(const i in t)if(t[i]){const s=t[i].typeString,r="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const o=n[i];if(s&&typeof o!==s){e=`JSON field '${i}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){e=`Expected '${i}' field to equal '${r.value}'`;break}}if(e)throw new z(V.INVALID_ARGUMENT,e);return!0}const of=-62135596800,af=1e6;class ht{static now(){return ht.fromMillis(Date.now())}static fromDate(t){return ht.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*af);return new ht(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new z(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new z(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<of)throw new z(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new z(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/af}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ht._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(or(t,ht._jsonSchema))return new ht(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-of;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ht._jsonSchemaVersion="firestore/timestamp/1.0",ht._jsonSchema={type:It("string",ht._jsonSchemaVersion),seconds:It("number"),nanoseconds:It("number")};class q{static fromTimestamp(t){return new q(t)}static min(){return new q(new ht(0,0))}static max(){return new q(new ht(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const $s=-1;function IP(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=q.fromTimestamp(i===1e9?new ht(e+1,0):new ht(e,i));return new Tn(s,W.empty(),t)}function SP(n){return new Tn(n.readTime,n.key,$s)}class Tn{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Tn(q.min(),W.empty(),$s)}static max(){return new Tn(q.max(),W.empty(),$s)}}function xP(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=W.comparator(n.documentKey,t.documentKey),e!==0?e:tt(n.largestBatchId,t.largestBatchId))}const AP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Hi(n){if(n.code!==V.FAILED_PRECONDITION||n.message!==AP)throw n;B("LocalStore","Unexpectedly lost primary lease")}class N{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&H(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new N(((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(e,r).next(i,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof N?e:N.resolve(e)}catch(e){return N.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):N.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):N.reject(e)}static resolve(t){return new N(((e,i)=>{e(t)}))}static reject(t){return new N(((e,i)=>{i(t)}))}static waitFor(t){return new N(((e,i)=>{let s=0,r=0,o=!1;t.forEach((a=>{++s,a.next((()=>{++r,o&&r===s&&e()}),(c=>i(c)))})),o=!0,r===s&&e()}))}static or(t){let e=N.resolve(!1);for(const i of t)e=e.next((s=>s?N.resolve(s):i()));return e}static forEach(t,e){const i=[];return t.forEach(((s,r)=>{i.push(e.call(this,s,r))})),this.waitFor(i)}static mapArray(t,e){return new N(((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let c=0;c<r;c++){const u=c;e(t[u]).next((h=>{o[u]=h,++a,a===r&&i(o)}),(h=>s(h)))}}))}static doWhile(t,e){return new N(((i,s)=>{const r=()=>{t()===!0?e().next((()=>{r()}),s):i()};r()}))}}function CP(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function $i(n){return n.name==="IndexedDbTransactionError"}class Ko{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>e.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Ko.ce=-1;const Tl=-1;function Xo(n){return n==null}function To(n){return n===0&&1/n==-1/0}function kP(n){return typeof n=="number"&&Number.isInteger(n)&&!To(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const im="";function RP(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=cf(t)),t=DP(n.get(e),t);return cf(t)}function DP(n,t){let e=t;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":e+="";break;case im:e+="";break;default:e+=r}}return e}function cf(n){return n+im+""}function lf(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function ai(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function sm(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class yt{constructor(t,e){this.comparator=t,this.root=e||Mt.EMPTY}insert(t,e){return new yt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Mt.BLACK,null,null))}remove(t){return new yt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Mt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return e+i.left.size;s<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Br(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Br(this.root,t,this.comparator,!1)}getReverseIterator(){return new Br(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Br(this.root,t,this.comparator,!0)}}class Br{constructor(t,e,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?i(t.key,e):1,e&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Mt{constructor(t,e,i,s,r){this.key=t,this.value=e,this.color=i??Mt.RED,this.left=s??Mt.EMPTY,this.right=r??Mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,s,r){return new Mt(t??this.key,e??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,e,i),null):r===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Mt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return Mt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw H(43730,{key:this.key,value:this.value});if(this.right.isRed())throw H(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw H(27949);return t+(this.isRed()?0:1)}}Mt.EMPTY=null,Mt.RED=!0,Mt.BLACK=!1;Mt.EMPTY=new class{constructor(){this.size=0}get key(){throw H(57766)}get value(){throw H(16141)}get color(){throw H(16727)}get left(){throw H(29726)}get right(){throw H(36894)}copy(t,e,i,s,r){return this}insert(t,e,i){return new Mt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pt{constructor(t){this.comparator=t,this.data=new yt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new uf(this.data.getIterator())}getIteratorFrom(t){return new uf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof Pt)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Pt(this.comparator);return e.data=t,e}}class uf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class he{constructor(t){this.fields=t,t.sort(Ot.comparator)}static empty(){return new he([])}unionWith(t){let e=new Pt(Ot.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new he(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ni(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class rm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Vt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new rm("Invalid base64 string: "+r):r}})(t);return new Vt(e)}static fromUint8Array(t){const e=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(t);return new Vt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const MP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function In(n){if(rt(!!n,39018),typeof n=="string"){let t=0;const e=MP.exec(n);if(rt(!!e,46558,{timestamp:n}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:wt(n.seconds),nanos:wt(n.nanos)}}function wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Sn(n){return typeof n=="string"?Vt.fromBase64String(n):Vt.fromUint8Array(n)}const om="server_timestamp",am="__type__",cm="__previous_value__",lm="__local_write_time__";function Il(n){return(n?.mapValue?.fields||{})[am]?.stringValue===om}function Qo(n){const t=n.mapValue.fields[cm];return Il(t)?Qo(t):t}function qs(n){const t=In(n.mapValue.fields[lm].timestampValue);return new ht(t.seconds,t.nanos)}class OP{constructor(t,e,i,s,r,o,a,c,u,h){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const Io="(default)";class Gs{constructor(t,e){this.projectId=t,this.database=e||Io}static empty(){return new Gs("","")}get isDefaultDatabase(){return this.database===Io}isEqual(t){return t instanceof Gs&&t.projectId===this.projectId&&t.database===this.database}}const um="__type__",NP="__max__",Ur={mapValue:{}},hm="__vector__",So="value";function xn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Il(n)?4:LP(n)?9007199254740991:VP(n)?10:11:H(28295,{value:n})}function Ae(n,t){if(n===t)return!0;const e=xn(n);if(e!==xn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return qs(n).isEqual(qs(t));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=In(s.timestampValue),a=In(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(s,r){return Sn(s.bytesValue).isEqual(Sn(r.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(s,r){return wt(s.geoPointValue.latitude)===wt(r.geoPointValue.latitude)&&wt(s.geoPointValue.longitude)===wt(r.geoPointValue.longitude)})(n,t);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return wt(s.integerValue)===wt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=wt(s.doubleValue),a=wt(r.doubleValue);return o===a?To(o)===To(a):isNaN(o)&&isNaN(a)}return!1})(n,t);case 9:return Ni(n.arrayValue.values||[],t.arrayValue.values||[],Ae);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(lf(o)!==lf(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Ae(o[c],a[c])))return!1;return!0})(n,t);default:return H(52216,{left:n})}}function Ys(n,t){return(n.values||[]).find((e=>Ae(e,t)))!==void 0}function Vi(n,t){if(n===t)return 0;const e=xn(n),i=xn(t);if(e!==i)return tt(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return tt(n.booleanValue,t.booleanValue);case 2:return(function(r,o){const a=wt(r.integerValue||r.doubleValue),c=wt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,t);case 3:return hf(n.timestampValue,t.timestampValue);case 4:return hf(qs(n),qs(t));case 5:return Sc(n.stringValue,t.stringValue);case 6:return(function(r,o){const a=Sn(r),c=Sn(o);return a.compareTo(c)})(n.bytesValue,t.bytesValue);case 7:return(function(r,o){const a=r.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const h=tt(a[u],c[u]);if(h!==0)return h}return tt(a.length,c.length)})(n.referenceValue,t.referenceValue);case 8:return(function(r,o){const a=tt(wt(r.latitude),wt(o.latitude));return a!==0?a:tt(wt(r.longitude),wt(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return df(n.arrayValue,t.arrayValue);case 10:return(function(r,o){const a=r.fields||{},c=o.fields||{},u=a[So]?.arrayValue,h=c[So]?.arrayValue,d=tt(u?.values?.length||0,h?.values?.length||0);return d!==0?d:df(u,h)})(n.mapValue,t.mapValue);case 11:return(function(r,o){if(r===Ur.mapValue&&o===Ur.mapValue)return 0;if(r===Ur.mapValue)return 1;if(o===Ur.mapValue)return-1;const a=r.fields||{},c=Object.keys(a),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const g=Sc(c[d],h[d]);if(g!==0)return g;const m=Vi(a[c[d]],u[h[d]]);if(m!==0)return m}return tt(c.length,h.length)})(n.mapValue,t.mapValue);default:throw H(23264,{he:e})}}function hf(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return tt(n,t);const e=In(n),i=In(t),s=tt(e.seconds,i.seconds);return s!==0?s:tt(e.nanos,i.nanos)}function df(n,t){const e=n.values||[],i=t.values||[];for(let s=0;s<e.length&&s<i.length;++s){const r=Vi(e[s],i[s]);if(r)return r}return tt(e.length,i.length)}function Li(n){return xc(n)}function xc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const i=In(e);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return Sn(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return W.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let i="[",s=!0;for(const r of e.values||[])s?s=!1:i+=",",i+=xc(r);return i+"]"})(n.arrayValue):"mapValue"in n?(function(e){const i=Object.keys(e.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${xc(e.fields[o])}`;return s+"}"})(n.mapValue):H(61005,{value:n})}function Qr(n){switch(xn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Qo(n);return t?16+Qr(t):16;case 5:return 2*n.stringValue.length;case 6:return Sn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,r)=>s+Qr(r)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return ai(i.fields,((r,o)=>{s+=r.length+Qr(o)})),s})(n.mapValue);default:throw H(13486,{value:n})}}function Ac(n){return!!n&&"integerValue"in n}function Sl(n){return!!n&&"arrayValue"in n}function ff(n){return!!n&&"nullValue"in n}function gf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jr(n){return!!n&&"mapValue"in n}function VP(n){return(n?.mapValue?.fields||{})[um]?.stringValue===hm}function ks(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return ai(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=ks(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ks(n.arrayValue.values[e]);return t}return{...n}}function LP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===NP}class ie{constructor(t){this.value=t}static empty(){return new ie({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Jr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ks(e)}setAll(t){let e=Ot.emptyPath(),i={},s=[];t.forEach(((o,a)=>{if(!e.isImmediateParentOf(a)){const c=this.getFieldsMap(e);this.applyChanges(c,i,s),i={},s=[],e=a.popLast()}o?i[a.lastSegment()]=ks(o):s.push(a.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,i,s)}delete(t){const e=this.field(t.popLast());Jr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ae(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=e.mapValue.fields[t.get(i)];Jr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,i){ai(e,((s,r)=>t[s]=r));for(const s of i)delete t[s]}clone(){return new ie(ks(this.value))}}function dm(n){const t=[];return ai(n.fields,((e,i)=>{const s=new Ot([e]);if(Jr(i)){const r=dm(i.mapValue).fields;if(r.length===0)t.push(s);else for(const o of r)t.push(s.child(o))}else t.push(s)})),new he(t)}class Wt{constructor(t,e,i,s,r,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Wt(t,0,q.min(),q.min(),q.min(),ie.empty(),0)}static newFoundDocument(t,e,i,s){return new Wt(t,1,e,q.min(),i,s,0)}static newNoDocument(t,e){return new Wt(t,2,e,q.min(),q.min(),ie.empty(),0)}static newUnknownDocument(t,e){return new Wt(t,3,e,q.min(),q.min(),ie.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ie.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ie.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Wt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xo{constructor(t,e){this.position=t,this.inclusive=e}}function pf(n,t,e){let i=0;for(let s=0;s<n.position.length;s++){const r=t[s],o=n.position[s];if(r.field.isKeyField()?i=W.comparator(W.fromName(o.referenceValue),e.key):i=Vi(o,e.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function mf(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Ae(n.position[e],t.position[e]))return!1;return!0}class Ao{constructor(t,e="asc"){this.field=t,this.dir=e}}function FP(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class fm{}class xt extends fm{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new UP(t,e,i):e==="array-contains"?new jP(t,i):e==="in"?new HP(t,i):e==="not-in"?new $P(t,i):e==="array-contains-any"?new qP(t,i):new xt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new zP(t,i):new WP(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Vi(e,this.value)):e!==null&&xn(this.value)===xn(e)&&this.matchesComparison(Vi(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return H(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends fm{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Pe(t,e)}matches(t){return gm(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gm(n){return n.op==="and"}function pm(n){return BP(n)&&gm(n)}function BP(n){for(const t of n.filters)if(t instanceof Pe)return!1;return!0}function Pc(n){if(n instanceof xt)return n.field.canonicalString()+n.op.toString()+Li(n.value);if(pm(n))return n.filters.map((t=>Pc(t))).join(",");{const t=n.filters.map((e=>Pc(e))).join(",");return`${n.op}(${t})`}}function mm(n,t){return n instanceof xt?(function(i,s){return s instanceof xt&&i.op===s.op&&i.field.isEqual(s.field)&&Ae(i.value,s.value)})(n,t):n instanceof Pe?(function(i,s){return s instanceof Pe&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((r,o,a)=>r&&mm(o,s.filters[a])),!0):!1})(n,t):void H(19439)}function _m(n){return n instanceof xt?(function(e){return`${e.field.canonicalString()} ${e.op} ${Li(e.value)}`})(n):n instanceof Pe?(function(e){return e.op.toString()+" {"+e.getFilters().map(_m).join(" ,")+"}"})(n):"Filter"}class UP extends xt{constructor(t,e,i){super(t,e,i),this.key=W.fromName(i.referenceValue)}matches(t){const e=W.comparator(t.key,this.key);return this.matchesComparison(e)}}class zP extends xt{constructor(t,e){super(t,"in",e),this.keys=ym("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class WP extends xt{constructor(t,e){super(t,"not-in",e),this.keys=ym("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ym(n,t){return(t.arrayValue?.values||[]).map((e=>W.fromName(e.referenceValue)))}class jP extends xt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Sl(e)&&Ys(e.arrayValue,this.value)}}class HP extends xt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Ys(this.value.arrayValue,e)}}class $P extends xt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ys(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Ys(this.value.arrayValue,e)}}class qP extends xt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Sl(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>Ys(this.value.arrayValue,i)))}}class GP{constructor(t,e=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function _f(n,t=null,e=[],i=[],s=null,r=null,o=null){return new GP(n,t,e,i,s,r,o)}function xl(n){const t=Y(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((i=>Pc(i))).join(","),e+="|ob:",e+=t.orderBy.map((i=>(function(r){return r.field.canonicalString()+r.dir})(i))).join(","),Xo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((i=>Li(i))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((i=>Li(i))).join(",")),t.Te=e}return t.Te}function Al(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!FP(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!mm(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!mf(n.startAt,t.startAt)&&mf(n.endAt,t.endAt)}function Cc(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Jo{constructor(t,e=null,i=[],s=[],r=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function YP(n,t,e,i,s,r,o,a){return new Jo(n,t,e,i,s,r,o,a)}function Pl(n){return new Jo(n)}function yf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KP(n){return n.collectionGroup!==null}function Rs(n){const t=Y(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Pt(Ot.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(a=a.add(u.field))}))})),a})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Ao(r,i))})),e.has(Ot.keyField().canonicalString())||t.Ie.push(new Ao(Ot.keyField(),i))}return t.Ie}function Ee(n){const t=Y(n);return t.Ee||(t.Ee=XP(t,Rs(n))),t.Ee}function XP(n,t){if(n.limitType==="F")return _f(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new Ao(s.field,r)}));const e=n.endAt?new xo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new xo(n.startAt.position,n.startAt.inclusive):null;return _f(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function kc(n,t,e){return new Jo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Zo(n,t){return Al(Ee(n),Ee(t))&&n.limitType===t.limitType}function bm(n){return`${xl(Ee(n))}|lt:${n.limitType}`}function yi(n){return`Query(target=${(function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map((s=>_m(s))).join(", ")}]`),Xo(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((s=>Li(s))).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((s=>Li(s))).join(",")),`Target(${i})`})(Ee(n))}; limitType=${n.limitType})`}function ta(n,t){return t.isFoundDocument()&&(function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):W.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)})(n,t)&&(function(i,s){for(const r of Rs(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(n,t)&&(function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0})(n,t)&&(function(i,s){return!(i.startAt&&!(function(o,a,c){const u=pf(o,a,c);return o.inclusive?u<=0:u<0})(i.startAt,Rs(i),s)||i.endAt&&!(function(o,a,c){const u=pf(o,a,c);return o.inclusive?u>=0:u>0})(i.endAt,Rs(i),s))})(n,t)}function QP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vm(n){return(t,e)=>{let i=!1;for(const s of Rs(n)){const r=JP(s,t,e);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function JP(n,t,e){const i=n.field.isKeyField()?W.comparator(t.key,e.key):(function(r,o,a){const c=o.data.field(r),u=a.data.field(r);return c!==null&&u!==null?Vi(c,u):H(42886)})(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return H(19790,{direction:n.dir})}}class ci{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[e]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){ai(this.inner,((e,i)=>{for(const[s,r]of i)t(s,r)}))}isEmpty(){return sm(this.inner)}size(){return this.innerSize}}const ZP=new yt(W.comparator);function $e(){return ZP}const wm=new yt(W.comparator);function vs(...n){let t=wm;for(const e of n)t=t.insert(e.key,e);return t}function Em(n){let t=wm;return n.forEach(((e,i)=>t=t.insert(e,i.overlayedDocument))),t}function Gn(){return Ds()}function Tm(){return Ds()}function Ds(){return new ci((n=>n.toString()),((n,t)=>n.isEqual(t)))}const tC=new yt(W.comparator),eC=new Pt(W.comparator);function et(...n){let t=eC;for(const e of n)t=t.add(e);return t}const nC=new Pt(tt);function iC(){return nC}function Cl(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:To(t)?"-0":t}}function Im(n){return{integerValue:""+n}}function sC(n,t){return kP(t)?Im(t):Cl(n,t)}class ea{constructor(){this._=void 0}}function rC(n,t,e){return n instanceof Po?(function(s,r){const o={fields:{[am]:{stringValue:om},[lm]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&Il(r)&&(r=Qo(r)),r&&(o.fields[cm]=r),{mapValue:o}})(e,t):n instanceof Ks?xm(n,t):n instanceof Xs?Am(n,t):(function(s,r){const o=Sm(s,r),a=bf(o)+bf(s.Ae);return Ac(o)&&Ac(s.Ae)?Im(a):Cl(s.serializer,a)})(n,t)}function oC(n,t,e){return n instanceof Ks?xm(n,t):n instanceof Xs?Am(n,t):e}function Sm(n,t){return n instanceof Co?(function(i){return Ac(i)||(function(r){return!!r&&"doubleValue"in r})(i)})(t)?t:{integerValue:0}:null}class Po extends ea{}class Ks extends ea{constructor(t){super(),this.elements=t}}function xm(n,t){const e=Pm(t);for(const i of n.elements)e.some((s=>Ae(s,i)))||e.push(i);return{arrayValue:{values:e}}}class Xs extends ea{constructor(t){super(),this.elements=t}}function Am(n,t){let e=Pm(t);for(const i of n.elements)e=e.filter((s=>!Ae(s,i)));return{arrayValue:{values:e}}}class Co extends ea{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function bf(n){return wt(n.integerValue||n.doubleValue)}function Pm(n){return Sl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function aC(n,t){return n.field.isEqual(t.field)&&(function(i,s){return i instanceof Ks&&s instanceof Ks||i instanceof Xs&&s instanceof Xs?Ni(i.elements,s.elements,Ae):i instanceof Co&&s instanceof Co?Ae(i.Ae,s.Ae):i instanceof Po&&s instanceof Po})(n.transform,t.transform)}class cC{constructor(t,e){this.version=t,this.transformResults=e}}class ze{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ze}static exists(t){return new ze(void 0,t)}static updateTime(t){return new ze(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Zr(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class na{}function Cm(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Rm(n.key,ze.none()):new ar(n.key,n.data,ze.none());{const e=n.data,i=ie.empty();let s=new Pt(Ot.comparator);for(let r of t.fields)if(!s.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new li(n.key,i,new he(s.toArray()),ze.none())}}function lC(n,t,e){n instanceof ar?(function(s,r,o){const a=s.value.clone(),c=wf(s.fieldTransforms,r,o.transformResults);a.setAll(c),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,t,e):n instanceof li?(function(s,r,o){if(!Zr(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=wf(s.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(km(s)),c.setAll(a),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,t,e):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function Ms(n,t,e,i){return n instanceof ar?(function(r,o,a,c){if(!Zr(r.precondition,o))return a;const u=r.value.clone(),h=Ef(r.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(n,t,e,i):n instanceof li?(function(r,o,a,c){if(!Zr(r.precondition,o))return a;const u=Ef(r.fieldTransforms,c,o),h=o.data;return h.setAll(km(r)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((d=>d.field)))})(n,t,e,i):(function(r,o,a){return Zr(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,t,e)}function uC(n,t){let e=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),r=Sm(i.transform,s||null);r!=null&&(e===null&&(e=ie.empty()),e.set(i.field,r))}return e||null}function vf(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Ni(i,s,((r,o)=>aC(r,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class ar extends na{constructor(t,e,i,s=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class li extends na{constructor(t,e,i,s,r=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function km(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}})),t}function wf(n,t,e){const i=new Map;rt(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let s=0;s<e.length;s++){const r=n[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,oC(o,a,e[s]))}return i}function Ef(n,t,e){const i=new Map;for(const s of n){const r=s.transform,o=e.data.field(s.field);i.set(s.field,rC(r,o,t))}return i}class Rm extends na{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hC extends na{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dC{constructor(t,e,i,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&lC(r,t,i[s])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Ms(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Ms(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=Tm();return this.mutations.forEach((s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(s.key)?null:a;const c=Cm(o,a);c!==null&&i.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(q.min())})),i}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),et())}isEqual(t){return this.batchId===t.batchId&&Ni(this.mutations,t.mutations,((e,i)=>vf(e,i)))&&Ni(this.baseMutations,t.baseMutations,((e,i)=>vf(e,i)))}}class kl{constructor(t,e,i,s){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=s}static from(t,e,i){rt(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let s=(function(){return tC})();const r=t.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new kl(t,e,i,s)}}class fC{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gC{constructor(t,e){this.count=t,this.unchangedNames=e}}var Tt,it;function pC(n){switch(n){case V.OK:return H(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return H(15467,{code:n})}}function Dm(n){if(n===void 0)return He("GRPC error has no .code"),V.UNKNOWN;switch(n){case Tt.OK:return V.OK;case Tt.CANCELLED:return V.CANCELLED;case Tt.UNKNOWN:return V.UNKNOWN;case Tt.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Tt.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Tt.INTERNAL:return V.INTERNAL;case Tt.UNAVAILABLE:return V.UNAVAILABLE;case Tt.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Tt.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Tt.NOT_FOUND:return V.NOT_FOUND;case Tt.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Tt.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Tt.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Tt.ABORTED:return V.ABORTED;case Tt.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Tt.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Tt.DATA_LOSS:return V.DATA_LOSS;default:return H(39323,{code:n})}}(it=Tt||(Tt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";function mC(){return new TextEncoder}const _C=new yn([4294967295,4294967295],0);function Tf(n){const t=mC().encode(n),e=new Yp;return e.update(t),new Uint8Array(e.digest())}function If(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new yn([e,i],0),new yn([s,r],0)]}class Rl{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new ws(`Invalid padding: ${e}`);if(i<0)throw new ws(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new ws(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new ws(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=yn.fromNumber(this.ge)}ye(t,e,i){let s=t.add(e.multiply(yn.fromNumber(i)));return s.compare(_C)===1&&(s=new yn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Tf(t),[i,s]=If(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);if(!this.we(o))return!1}return!0}static create(t,e,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new Rl(r,s,e);return i.forEach((a=>o.insert(a))),o}insert(t){if(this.ge===0)return;const e=Tf(t),[i,s]=If(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class ws extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ia{constructor(t,e,i,s,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const s=new Map;return s.set(t,cr.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new ia(q.min(),s,new yt(tt),$e(),et())}}class cr{constructor(t,e,i,s,r){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new cr(i,e,et(),et(),et())}}class to{constructor(t,e,i,s){this.be=t,this.removedTargetIds=e,this.key=i,this.De=s}}class Mm{constructor(t,e){this.targetId=t,this.Ce=e}}class Om{constructor(t,e,i=Vt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=s}}class Sf{constructor(){this.ve=0,this.Fe=xf(),this.Me=Vt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=et(),e=et(),i=et();return this.Fe.forEach(((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:i=i.add(s);break;default:H(38017,{changeType:r})}})),new cr(this.Me,this.xe,t,e,i)}qe(){this.Oe=!1,this.Fe=xf()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,rt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class yC{constructor(t){this.Ge=t,this.ze=new Map,this.je=$e(),this.Je=zr(),this.He=zr(),this.Ye=new yt(tt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const i=this.nt(e);switch(t.state){case 0:this.rt(e)&&i.Le(t.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(t.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(i.We(),i.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),i.Le(t.resumeToken));break;default:H(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((i,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,i=t.Ce.count,s=this.ot(e);if(s){const r=s.target;if(Cc(r))if(i===0){const o=new W(r.path);this.et(e,o,Wt.newNoDocument(o,q.min()))}else rt(i===1,20013,{expectedCount:i});else{const o=this._t(e);if(o!==i){const a=this.ut(t),c=a?this.ct(a,t,o):1;if(c!==0){this.it(e);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,u)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=e;let o,a;try{o=Sn(i).toUint8Array()}catch(c){if(c instanceof rm)return Oi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Rl(o,s,r)}catch(c){return Oi(c instanceof ws?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(t,e,i){return e.Ce.count===i-this.Pt(t,e.targetId)?0:2}Pt(t,e){const i=this.Ge.getRemoteKeysForTarget(e);let s=0;return i.forEach((r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.et(e,r,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((r,o)=>{const a=this.ot(o);if(a){if(r.current&&Cc(a.target)){const c=new W(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Wt.newNoDocument(c,t))}r.Be&&(e.set(o,r.ke()),r.qe())}}));let i=et();this.He.forEach(((r,o)=>{let a=!0;o.forEachWhile((c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(t)));const s=new ia(t,e,this.Ye,this.je,i);return this.je=$e(),this.Je=zr(),this.He=zr(),this.Ye=new yt(tt),s}Xe(t,e){if(!this.rt(t))return;const i=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,i),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,i){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),i&&(this.je=this.je.insert(e,i))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Sf,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new Pt(tt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new Pt(tt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||B("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Sf),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function zr(){return new yt(W.comparator)}function xf(){return new yt(W.comparator)}const bC={asc:"ASCENDING",desc:"DESCENDING"},vC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wC={and:"AND",or:"OR"};class EC{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Rc(n,t){return n.useProto3Json||Xo(t)?t:{value:t}}function ko(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Nm(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function TC(n,t){return ko(n,t.toTimestamp())}function Te(n){return rt(!!n,49232),q.fromTimestamp((function(e){const i=In(e);return new ht(i.seconds,i.nanos)})(n))}function Dl(n,t){return Dc(n,t).canonicalString()}function Dc(n,t){const e=(function(s){return new _t(["projects",s.projectId,"databases",s.database])})(n).child("documents");return t===void 0?e:e.child(t)}function Vm(n){const t=_t.fromString(n);return rt(zm(t),10190,{key:t.toString()}),t}function Mc(n,t){return Dl(n.databaseId,t.path)}function Za(n,t){const e=Vm(t);if(e.get(1)!==n.databaseId.projectId)throw new z(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new z(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new W(Fm(e))}function Lm(n,t){return Dl(n.databaseId,t)}function IC(n){const t=Vm(n);return t.length===4?_t.emptyPath():Fm(t)}function Oc(n){return new _t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Fm(n){return rt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Af(n,t,e){return{name:Mc(n,t),fields:e.value.mapValue.fields}}function SC(n,t){let e;if("targetChange"in t){t.targetChange;const i=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:H(39313,{state:u})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=(function(u,h){return u.useProto3Json?(rt(h===void 0||typeof h=="string",58123),Vt.fromBase64String(h||"")):(rt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Vt.fromUint8Array(h||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&(function(u){const h=u.code===void 0?V.UNKNOWN:Dm(u.code);return new z(h,u.message||"")})(o);e=new Om(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=Za(n,i.document.name),r=Te(i.document.updateTime),o=i.document.createTime?Te(i.document.createTime):q.min(),a=new ie({mapValue:{fields:i.document.fields}}),c=Wt.newFoundDocument(s,r,o,a),u=i.targetIds||[],h=i.removedTargetIds||[];e=new to(u,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=Za(n,i.document),r=i.readTime?Te(i.readTime):q.min(),o=Wt.newNoDocument(s,r),a=i.removedTargetIds||[];e=new to([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=Za(n,i.document),r=i.removedTargetIds||[];e=new to([],r,s,null)}else{if(!("filter"in t))return H(11601,{Rt:t});{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new gC(s,r),a=i.targetId;e=new Mm(a,o)}}return e}function xC(n,t){let e;if(t instanceof ar)e={update:Af(n,t.key,t.value)};else if(t instanceof Rm)e={delete:Mc(n,t.key)};else if(t instanceof li)e={update:Af(n,t.key,t.data),updateMask:NC(t.fieldMask)};else{if(!(t instanceof hC))return H(16599,{Vt:t.type});e={verify:Mc(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(r,o){const a=o.transform;if(a instanceof Po)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ks)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Xs)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Co)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw H(20930,{transform:o.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:TC(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:H(27497)})(n,t.precondition)),e}function AC(n,t){return n&&n.length>0?(rt(t!==void 0,14353),n.map((e=>(function(s,r){let o=s.updateTime?Te(s.updateTime):Te(r);return o.isEqual(q.min())&&(o=Te(r)),new cC(o,s.transformResults||[])})(e,t)))):[]}function PC(n,t){return{documents:[Lm(n,t.path)]}}function CC(n,t){const e={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=Lm(n,s);const r=(function(u){if(u.length!==0)return Um(Pe.create(u,"and"))})(t.filters);r&&(e.structuredQuery.where=r);const o=(function(u){if(u.length!==0)return u.map((h=>(function(g){return{field:bi(g.field),direction:DC(g.dir)}})(h)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=Rc(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(t.endAt)),{ft:e,parent:s}}function kC(n){let t=IC(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let s=null;if(i>0){rt(i===1,65062);const h=e.from[0];h.allDescendants?s=h.collectionId:t=t.child(h.collectionId)}let r=[];e.where&&(r=(function(d){const g=Bm(d);return g instanceof Pe&&pm(g)?g.getFilters():[g]})(e.where));let o=[];e.orderBy&&(o=(function(d){return d.map((g=>(function(y){return new Ao(vi(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(g)))})(e.orderBy));let a=null;e.limit&&(a=(function(d){let g;return g=typeof d=="object"?d.value:d,Xo(g)?null:g})(e.limit));let c=null;e.startAt&&(c=(function(d){const g=!!d.before,m=d.values||[];return new xo(m,g)})(e.startAt));let u=null;return e.endAt&&(u=(function(d){const g=!d.before,m=d.values||[];return new xo(m,g)})(e.endAt)),YP(t,s,o,r,a,"F",c,u)}function RC(n,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function Bm(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=vi(e.unaryFilter.field);return xt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=vi(e.unaryFilter.field);return xt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=vi(e.unaryFilter.field);return xt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=vi(e.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return H(61313);default:return H(60726)}})(n):n.fieldFilter!==void 0?(function(e){return xt.create(vi(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return H(58110);default:return H(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return Pe.create(e.compositeFilter.filters.map((i=>Bm(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return H(1026)}})(e.compositeFilter.op))})(n):H(30097,{filter:n})}function DC(n){return bC[n]}function MC(n){return vC[n]}function OC(n){return wC[n]}function bi(n){return{fieldPath:n.canonicalString()}}function vi(n){return Ot.fromServerFormat(n.fieldPath)}function Um(n){return n instanceof xt?(function(e){if(e.op==="=="){if(gf(e.value))return{unaryFilter:{field:bi(e.field),op:"IS_NAN"}};if(ff(e.value))return{unaryFilter:{field:bi(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(gf(e.value))return{unaryFilter:{field:bi(e.field),op:"IS_NOT_NAN"}};if(ff(e.value))return{unaryFilter:{field:bi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bi(e.field),op:MC(e.op),value:e.value}}})(n):n instanceof Pe?(function(e){const i=e.getFilters().map((s=>Um(s)));return i.length===1?i[0]:{compositeFilter:{op:OC(e.op),filters:i}}})(n):H(54877,{filter:n})}function NC(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function zm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class dn{constructor(t,e,i,s,r=q.min(),o=q.min(),a=Vt.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new dn(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class VC{constructor(t){this.yt=t}}function LC(n){const t=kC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?kc(t,t.limit,"L"):t}class FC{constructor(){this.Cn=new BC}addToCollectionParentIndex(t,e){return this.Cn.add(e),N.resolve()}getCollectionParents(t,e){return N.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return N.resolve()}deleteFieldIndex(t,e){return N.resolve()}deleteAllFieldIndexes(t){return N.resolve()}createTargetIndexes(t,e){return N.resolve()}getDocumentsMatchingTarget(t,e){return N.resolve(null)}getIndexType(t,e){return N.resolve(0)}getFieldIndexes(t,e){return N.resolve([])}getNextCollectionGroupToUpdate(t){return N.resolve(null)}getMinOffset(t,e){return N.resolve(Tn.min())}getMinOffsetFromCollectionGroup(t,e){return N.resolve(Tn.min())}updateCollectionGroup(t,e,i){return N.resolve()}updateIndexEntries(t,e){return N.resolve()}}class BC{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e]||new Pt(_t.comparator),r=!s.has(i);return this.index[e]=s.add(i),r}has(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e];return s&&s.has(i)}getEntries(t){return(this.index[t]||new Pt(_t.comparator)).toArray()}}const Pf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wm=41943040;class Kt{static withCacheSize(t){return new Kt(t,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}}Kt.DEFAULT_COLLECTION_PERCENTILE=10,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kt.DEFAULT=new Kt(Wm,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kt.DISABLED=new Kt(-1,0,0);class Fi{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Fi(0)}static cr(){return new Fi(-1)}}const Cf="LruGarbageCollector",UC=1048576;function kf([n,t],[e,i]){const s=tt(n,e);return s===0?tt(t,i):s}class zC{constructor(t){this.Ir=t,this.buffer=new Pt(kf),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();kf(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class WC{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){B(Cf,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){$i(e)?B(Cf,"Ignoring IndexedDB error during garbage collection: ",e):await Hi(e)}await this.Vr(3e5)}))}}class jC{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((i=>Math.floor(e/100*i)))}nthSequenceNumber(t,e){if(e===0)return N.resolve(Ko.ce);const i=new zC(e);return this.mr.forEachTarget(t,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(t,e,i){return this.mr.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Pf)):this.getCacheSize(t).next((i=>i<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pf):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let i,s,r,o,a,c,u;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(t,s)))).next((d=>(i=d,a=Date.now(),this.removeTargets(t,i,e)))).next((d=>(r=d,c=Date.now(),this.removeOrphanedDocuments(t,i)))).next((d=>(u=Date.now(),_i()<=Z.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:d}))))}}function HC(n,t){return new jC(n,t)}class $C{constructor(){this.changes=new ci((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Wt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?N.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class qC{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class GC{constructor(t,e,i,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(i=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(i!==null&&Ms(i.mutation,s,he.empty(),ht.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.getLocalViewOfDocuments(t,i,et()).next((()=>i))))}getLocalViewOfDocuments(t,e,i=et()){const s=Gn();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,i).next((r=>{let o=vs();return r.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const i=Gn();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,et())))}populateOverlays(t,e,i){const s=[];return i.forEach((r=>{e.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(t,s).next((r=>{r.forEach(((o,a)=>{e.set(o,a)}))}))}computeViews(t,e,i,s){let r=$e();const o=Ds(),a=(function(){return Ds()})();return e.forEach(((c,u)=>{const h=i.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof li)?r=r.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Ms(h.mutation,u,h.mutation.getFieldMask(),ht.now())):o.set(u.key,he.empty())})),this.recalculateAndSaveOverlays(t,r).next((c=>(c.forEach(((u,h)=>o.set(u,h))),e.forEach(((u,h)=>a.set(u,new qC(h,o.get(u)??null)))),a)))}recalculateAndSaveOverlays(t,e){const i=Ds();let s=new yt(((o,a)=>o-a)),r=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const a of o)a.keys().forEach((c=>{const u=e.get(c);if(u===null)return;let h=i.get(c)||he.empty();h=a.applyToLocalView(u,h),i.set(c,h);const d=(s.get(a.batchId)||et()).add(c);s=s.insert(a.batchId,d)}))})).next((()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,d=Tm();h.forEach((g=>{if(!r.has(g)){const m=Cm(e.get(g),i.get(g));m!==null&&d.set(g,m),r=r.add(g)}})),o.push(this.documentOverlayCache.saveOverlays(t,u,d))}return N.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.recalculateAndSaveOverlays(t,i)))}getDocumentsMatchingQuery(t,e,i,s){return(function(o){return W.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):KP(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,s):this.getDocumentsMatchingCollectionQuery(t,e,i,s)}getNextDocuments(t,e,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,s-r.size):N.resolve(Gn());let a=$s,c=r;return o.next((u=>N.forEach(u,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(h)?N.resolve():this.remoteDocumentCache.getEntry(t,h).next((g=>{c=c.insert(h,g)}))))).next((()=>this.populateOverlays(t,u,r))).next((()=>this.computeViews(t,c,u,et()))).next((h=>({batchId:a,changes:Em(h)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new W(e)).next((i=>{let s=vs();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,i,s){const r=e.collectionGroup;let o=vs();return this.indexManager.getCollectionParents(t,r).next((a=>N.forEach(a,(c=>{const u=(function(d,g){return new Jo(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(e,c.child(r));return this.getDocumentsMatchingCollectionQuery(t,u,i,s).next((h=>{h.forEach(((d,g)=>{o=o.insert(d,g)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,r,s)))).next((o=>{r.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,Wt.newInvalidDocument(h)))}));let a=vs();return o.forEach(((c,u)=>{const h=r.get(c);h!==void 0&&Ms(h.mutation,u,he.empty(),ht.now()),ta(e,u)&&(a=a.insert(c,u))})),a}))}}class YC{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return N.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:Te(s.createTime)}})(e)),N.resolve()}getNamedQuery(t,e){return N.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:LC(s.bundledQuery),readTime:Te(s.readTime)}})(e)),N.resolve()}}class KC{constructor(){this.overlays=new yt(W.comparator),this.qr=new Map}getOverlay(t,e){return N.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Gn();return N.forEach(e,(s=>this.getOverlay(t,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(t,e,i){return i.forEach(((s,r)=>{this.St(t,e,r)})),N.resolve()}removeOverlaysForBatchId(t,e,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.qr.delete(i)),N.resolve()}getOverlaysForCollection(t,e,i){const s=Gn(),r=e.length+1,o=new W(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!e.isPrefixOf(u.path))break;u.path.length===r&&c.largestBatchId>i&&s.set(c.getKey(),c)}return N.resolve(s)}getOverlaysForCollectionGroup(t,e,i,s){let r=new yt(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===e&&u.largestBatchId>i){let h=r.get(u.largestBatchId);h===null&&(h=Gn(),r=r.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Gn(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>a.set(u,h))),!(a.size()>=s)););return N.resolve(a)}St(t,e,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new fC(e,i));let r=this.qr.get(e);r===void 0&&(r=et(),this.qr.set(e,r)),this.qr.set(e,r.add(i.key))}}class XC{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(t){return N.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,N.resolve()}}class Ml{constructor(){this.Qr=new Pt(kt.$r),this.Ur=new Pt(kt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const i=new kt(t,e);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(t,e){t.forEach((i=>this.addReference(i,e)))}removeReference(t,e){this.Gr(new kt(t,e))}zr(t,e){t.forEach((i=>this.removeReference(i,e)))}jr(t){const e=new W(new _t([])),i=new kt(e,t),s=new kt(e,t+1),r=[];return this.Ur.forEachInRange([i,s],(o=>{this.Gr(o),r.push(o.key)})),r}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new W(new _t([])),i=new kt(e,t),s=new kt(e,t+1);let r=et();return this.Ur.forEachInRange([i,s],(o=>{r=r.add(o.key)})),r}containsKey(t){const e=new kt(t,0),i=this.Qr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class kt{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return W.comparator(t.key,e.key)||tt(t.Yr,e.Yr)}static Kr(t,e){return tt(t.Yr,e.Yr)||W.comparator(t.key,e.key)}}class QC{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new Pt(kt.$r)}checkEmpty(t){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new dC(r,e,i,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new kt(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(t,e){return N.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,s=this.ei(i),r=s<0?0:s;return N.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Tl:this.tr-1)}getAllMutationBatches(t){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new kt(e,0),s=new kt(e,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([i,s],(o=>{const a=this.Xr(o.Yr);r.push(a)})),N.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Pt(tt);return e.forEach((s=>{const r=new kt(s,0),o=new kt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],(a=>{i=i.add(a.Yr)}))})),N.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,s=i.length+1;let r=i;W.isDocumentKey(r)||(r=r.child(""));const o=new kt(new W(r),0);let a=new Pt(tt);return this.Zr.forEachWhile((c=>{const u=c.key.path;return!!i.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.Yr)),!0)}),o),N.resolve(this.ti(a))}ti(t){const e=[];return t.forEach((i=>{const s=this.Xr(i);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){rt(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return N.forEach(e.mutations,(s=>{const r=new kt(s.key,e.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=i}))}ir(t){}containsKey(t,e){const i=new kt(e,0),s=this.Zr.firstAfterOrEqual(i);return N.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,N.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class JC{constructor(t){this.ri=t,this.docs=(function(){return new yt(W.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,s=this.docs.get(i),r=s?s.size:0,o=this.ri(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return N.resolve(i?i.document.mutableCopy():Wt.newInvalidDocument(e))}getEntries(t,e){let i=$e();return e.forEach((s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():Wt.newInvalidDocument(s))})),N.resolve(i)}getDocumentsMatchingQuery(t,e,i,s){let r=$e();const o=e.path,a=new W(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||xP(SP(h),i)<=0||(s.has(h.key)||ta(e,h))&&(r=r.insert(h.key,h.mutableCopy()))}return N.resolve(r)}getAllFromCollectionGroup(t,e,i,s){H(9500)}ii(t,e){return N.forEach(this.docs,(i=>e(i)))}newChangeBuffer(t){return new ZC(this)}getSize(t){return N.resolve(this.size)}}class ZC extends $C{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(i)})),N.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class tk{constructor(t){this.persistence=t,this.si=new ci((e=>xl(e)),Al),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new Ml,this.targetCount=0,this.ai=Fi.ur()}forEachTarget(t,e){return this.si.forEach(((i,s)=>e(s))),N.resolve()}getLastRemoteSnapshotVersion(t){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return N.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.oi&&(this.oi=e),N.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Fi(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,N.resolve()}updateTargetData(t,e){return this.Pr(e),N.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,N.resolve()}removeTargets(t,e,i){let s=0;const r=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=e&&i.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)})),N.waitFor(r).next((()=>s))}getTargetCount(t){return N.resolve(this.targetCount)}getTargetData(t,e){const i=this.si.get(e)||null;return N.resolve(i)}addMatchingKeys(t,e,i){return this._i.Wr(e,i),N.resolve()}removeMatchingKeys(t,e,i){this._i.zr(e,i);const s=this.persistence.referenceDelegate,r=[];return s&&e.forEach((o=>{r.push(s.markPotentiallyOrphaned(t,o))})),N.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),N.resolve()}getMatchingKeysForTargetId(t,e){const i=this._i.Hr(e);return N.resolve(i)}containsKey(t,e){return N.resolve(this._i.containsKey(e))}}class jm{constructor(t,e){this.ui={},this.overlays={},this.ci=new Ko(0),this.li=!1,this.li=!0,this.hi=new XC,this.referenceDelegate=t(this),this.Pi=new tk(this),this.indexManager=new FC,this.remoteDocumentCache=(function(s){return new JC(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new VC(e),this.Ii=new YC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new KC,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.ui[t.toKey()];return i||(i=new QC(e,this.referenceDelegate),this.ui[t.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,i){B("MemoryPersistence","Starting transaction:",t);const s=new ek(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((r=>this.referenceDelegate.di(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ai(t,e){return N.or(Object.values(this.ui).map((i=>()=>i.containsKey(t,e))))}}class ek extends PP{constructor(t){super(),this.currentSequenceNumber=t}}class Ol{constructor(t){this.persistence=t,this.Ri=new Ml,this.Vi=null}static mi(t){return new Ol(t)}get fi(){if(this.Vi)return this.Vi;throw H(60996)}addReference(t,e,i){return this.Ri.addReference(i,e),this.fi.delete(i.toString()),N.resolve()}removeReference(t,e,i){return this.Ri.removeReference(i,e),this.fi.add(i.toString()),N.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),N.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((r=>this.fi.add(r.toString())))})).next((()=>i.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,(i=>{const s=W.fromPath(i);return this.gi(t,s).next((r=>{r||e.removeEntry(s,q.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((i=>{i?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return N.or([()=>N.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Ro{constructor(t,e){this.persistence=t,this.pi=new ci((i=>RP(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=HC(this,e)}static mi(t,e){return new Ro(t,e)}Ei(){}di(t){return N.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((i=>e.next((s=>i+s))))}wr(t){let e=0;return this.pr(t,(i=>{e++})).next((()=>e))}pr(t,e){return N.forEach(this.pi,((i,s)=>this.br(t,i,s).next((r=>r?N.resolve():e(s)))))}removeTargets(t,e,i){return this.persistence.getTargetCache().removeTargets(t,e,i)}removeOrphanedDocuments(t,e){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(t,(o=>this.br(t,o,e).next((a=>{a||(i++,r.removeEntry(o,q.min()))})))).next((()=>r.apply(t))).next((()=>i))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),N.resolve()}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),N.resolve()}removeReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),N.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),N.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Qr(t.data.value)),e}br(t,e,i){return N.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return N.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Nl{constructor(t,e,i,s){this.targetId=t,this.fromCache=e,this.Es=i,this.ds=s}static As(t,e){let i=et(),s=et();for(const r of e.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new Nl(t,e.fromCache,i,s)}}class nk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class ik{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return $I()?8:CP($t())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,i,s){const r={result:null};return this.ys(t,e).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ws(t,e,s,i).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new nk;return this.Ss(t,e,o).next((a=>{if(r.result=a,this.Vs)return this.bs(t,e,o,a.size)}))})).next((()=>r.result))}bs(t,e,i,s){return i.documentReadCount<this.fs?(_i()<=Z.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",yi(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(_i()<=Z.DEBUG&&B("QueryEngine","Query:",yi(e),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(_i()<=Z.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",yi(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ee(e))):N.resolve())}ys(t,e){if(yf(e))return N.resolve(null);let i=Ee(e);return this.indexManager.getIndexType(t,i).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=kc(e,null,"F"),i=Ee(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next((r=>{const o=et(...r);return this.ps.getDocuments(t,o).next((a=>this.indexManager.getMinOffset(t,i).next((c=>{const u=this.Ds(e,a);return this.Cs(e,u,o,c.readTime)?this.ys(t,kc(e,null,"F")):this.vs(t,u,e,c)}))))})))))}ws(t,e,i,s){return yf(e)||s.isEqual(q.min())?N.resolve(null):this.ps.getDocuments(t,i).next((r=>{const o=this.Ds(e,r);return this.Cs(e,o,i,s)?N.resolve(null):(_i()<=Z.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),yi(e)),this.vs(t,o,e,IP(s,$s)).next((a=>a)))}))}Ds(t,e){let i=new Pt(vm(t));return e.forEach(((s,r)=>{ta(t,r)&&(i=i.add(r))})),i}Cs(t,e,i,s){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(t,e,i){return _i()<=Z.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",yi(e)),this.ps.getDocumentsMatchingQuery(t,e,Tn.min(),i)}vs(t,e,i,s){return this.ps.getDocumentsMatchingQuery(t,i,s).next((r=>(e.forEach((o=>{r=r.insert(o.key,o)})),r)))}}const Vl="LocalStore",sk=3e8;class rk{constructor(t,e,i,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new yt(tt),this.xs=new ci((r=>xl(r)),Al),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(i)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new GC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function ok(n,t,e,i){return new rk(n,t,e,i)}async function Hm(n,t){const e=Y(n);return await e.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return e.mutationQueue.getAllMutationBatches(i).next((r=>(s=r,e.Bs(t),e.mutationQueue.getAllMutationBatches(i)))).next((r=>{const o=[],a=[];let c=et();for(const u of s){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of r){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return e.localDocuments.getDocuments(i,c).next((u=>({Ls:u,removedBatchIds:o,addedBatchIds:a})))}))}))}function ak(n,t){const e=Y(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=t.batch.keys(),r=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,u,h){const d=u.batch,g=d.keys();let m=N.resolve();return g.forEach((y=>{m=m.next((()=>h.getEntry(c,y))).next((v=>{const w=u.docVersions.get(y);rt(w!==null,48541),v.version.compareTo(w)<0&&(d.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),h.addEntry(v)))}))})),m.next((()=>a.mutationQueue.removeMutationBatch(c,d)))})(e,i,t,r).next((()=>r.apply(i))).next((()=>e.mutationQueue.performConsistencyCheck(i))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=et();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c})(t)))).next((()=>e.localDocuments.getDocuments(i,s)))}))}function $m(n){const t=Y(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function ck(n,t){const e=Y(n),i=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const a=[];t.targetChanges.forEach(((h,d)=>{const g=s.get(d);if(!g)return;a.push(e.Pi.removeMatchingKeys(r,h.removedDocuments,d).next((()=>e.Pi.addMatchingKeys(r,h.addedDocuments,d))));let m=g.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Vt.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,i)),s=s.insert(d,m),(function(v,w,P){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=sk?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(g,m,h)&&a.push(e.Pi.updateTargetData(r,m))}));let c=$e(),u=et();if(t.documentUpdates.forEach((h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,h))})),a.push(lk(r,o,t.documentUpdates).next((h=>{c=h.ks,u=h.qs}))),!i.isEqual(q.min())){const h=e.Pi.getLastRemoteSnapshotVersion(r).next((d=>e.Pi.setTargetsMetadata(r,r.currentSequenceNumber,i)));a.push(h)}return N.waitFor(a).next((()=>o.apply(r))).next((()=>e.localDocuments.getLocalViewOfDocuments(r,c,u))).next((()=>c))})).then((r=>(e.Ms=s,r)))}function lk(n,t,e){let i=et(),s=et();return e.forEach((r=>i=i.add(r))),t.getEntries(n,i).next((r=>{let o=$e();return e.forEach(((a,c)=>{const u=r.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(q.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):B(Vl,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)})),{ks:o,qs:s}}))}function uk(n,t){const e=Y(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(i=>(t===void 0&&(t=Tl),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t))))}function hk(n,t){const e=Y(n);return e.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return e.Pi.getTargetData(i,t).next((r=>r?(s=r,N.resolve(s)):e.Pi.allocateTargetId(i).next((o=>(s=new dn(t,o,"TargetPurposeListen",i.currentSequenceNumber),e.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=e.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(i.targetId,i),e.xs.set(t,i.targetId)),i}))}async function Nc(n,t,e){const i=Y(n),s=i.Ms.get(t),r=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",r,(o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!$i(o))throw o;B(Vl,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ms=i.Ms.remove(t),i.xs.delete(s.target)}function Rf(n,t,e){const i=Y(n);let s=q.min(),r=et();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,u,h){const d=Y(c),g=d.xs.get(h);return g!==void 0?N.resolve(d.Ms.get(g)):d.Pi.getTargetData(u,h)})(i,o,Ee(t)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{r=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,t,e?s:q.min(),e?r:et()))).next((a=>(dk(i,QP(t),a),{documents:a,Qs:r})))))}function dk(n,t,e){let i=n.Os.get(t)||q.min();e.forEach(((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)})),n.Os.set(t,i)}class Df{constructor(){this.activeTargetIds=iC()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class fk{constructor(){this.Mo=new Df,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,i){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Df,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class gk{Oo(t){}shutdown(){}}const Mf="ConnectivityMonitor";class Of{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){B(Mf,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){B(Mf,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Wr=null;function Vc(){return Wr===null?Wr=(function(){return 268435456+Math.round(2147483648*Math.random())})():Wr++,"0x"+Wr.toString(16)}const tc="RestConnection",pk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class mk{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Io?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(t,e,i,s,r){const o=Vc(),a=this.zo(t,e.toUriEncodedString());B(tc,`Sending RPC '${t}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,r);const{host:u}=new URL(a),h=Ui(u);return this.Jo(t,a,c,i,h).then((d=>(B(tc,`Received RPC '${t}' ${o}: `,d),d)),(d=>{throw Oi(tc,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",i),d}))}Ho(t,e,i,s,r,o){return this.Go(t,e,i,s,r)}jo(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ji})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,r)=>t[r]=s)),i&&i.headers.forEach(((s,r)=>t[r]=s))}zo(t,e){const i=pk[t];return`${this.Uo}/v1/${e}:${i}`}terminate(){}}class _k{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const Ft="WebChannelConnection";class yk extends mk{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,i,s,r){const o=Vc();return new Promise(((a,c)=>{const u=new Kp;u.setWithCredentials(!0),u.listenOnce(Xp.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case Xr.NO_ERROR:const d=u.getResponseJson();B(Ft,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Xr.TIMEOUT:B(Ft,`RPC '${t}' ${o} timed out`),c(new z(V.DEADLINE_EXCEEDED,"Request time out"));break;case Xr.HTTP_ERROR:const g=u.getStatus();if(B(Ft,`RPC '${t}' ${o} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const v=(function(P){const C=P.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(C)>=0?C:V.UNKNOWN})(y.status);c(new z(v,y.message))}else c(new z(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new z(V.UNAVAILABLE,"Connection failed."));break;default:H(9055,{l_:t,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{B(Ft,`RPC '${t}' ${o} completed.`)}}));const h=JSON.stringify(s);B(Ft,`RPC '${t}' ${o} sending request:`,s),u.send(e,"POST",h,i,15)}))}T_(t,e,i){const s=Vc(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Zp(),a=Jp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,e,i),c.encodeInitMessageHeaders=!0;const h=r.join("");B(Ft,`Creating RPC '${t}' stream ${s}: ${h}`,c);const d=o.createWebChannel(h,c);this.I_(d);let g=!1,m=!1;const y=new _k({Yo:w=>{m?B(Ft,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(g||(B(Ft,`Opening RPC '${t}' stream ${s} transport.`),d.open(),g=!0),B(Ft,`RPC '${t}' stream ${s} sending:`,w),d.send(w))},Zo:()=>d.close()}),v=(w,P,C)=>{w.listen(P,(D=>{try{C(D)}catch(O){setTimeout((()=>{throw O}),0)}}))};return v(d,bs.EventType.OPEN,(()=>{m||(B(Ft,`RPC '${t}' stream ${s} transport opened.`),y.o_())})),v(d,bs.EventType.CLOSE,(()=>{m||(m=!0,B(Ft,`RPC '${t}' stream ${s} transport closed`),y.a_(),this.E_(d))})),v(d,bs.EventType.ERROR,(w=>{m||(m=!0,Oi(Ft,`RPC '${t}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new z(V.UNAVAILABLE,"The operation could not be completed")))})),v(d,bs.EventType.MESSAGE,(w=>{if(!m){const P=w.data[0];rt(!!P,16349);const C=P,D=C?.error||C[0]?.error;if(D){B(Ft,`RPC '${t}' stream ${s} received error:`,D);const O=D.status;let M=(function(b){const T=Tt[b];if(T!==void 0)return Dm(T)})(O),L=D.message;M===void 0&&(M=V.INTERNAL,L="Unknown error status: "+O+" with message "+D.message),m=!0,y.a_(new z(M,L)),d.close()}else B(Ft,`RPC '${t}' stream ${s} received:`,P),y.u_(P)}})),v(a,Qp.STAT_EVENT,(w=>{w.stat===Ic.PROXY?B(Ft,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===Ic.NOPROXY&&B(Ft,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function ec(){return typeof document<"u"?document:null}function sa(n){return new EC(n,!0)}class qm{constructor(t,e,i=1e3,s=1.5,r=6e4){this.Mi=t,this.timerId=e,this.d_=i,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-i);s>0&&B("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Nf="PersistentStream";class Gm{constructor(t,e,i,s,r,o,a,c){this.Mi=t,this.S_=i,this.b_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new qm(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===V.RESOURCE_EXHAUSTED?(He(e.toString()),He("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===e&&this.G_(i,s)}),(i=>{t((()=>{const s=new z(V.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(t,e){const i=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return B(Nf,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(B(Nf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bk extends Gm{constructor(t,e,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=SC(this.serializer,t),i=(function(r){if(!("targetChange"in r))return q.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?q.min():o.readTime?Te(o.readTime):q.min()})(t);return this.listener.H_(e,i)}Y_(t){const e={};e.database=Oc(this.serializer),e.addTarget=(function(r,o){let a;const c=o.target;if(a=Cc(c)?{documents:PC(r,c)}:{query:CC(r,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Nm(r,o.resumeToken);const u=Rc(r,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(q.min())>0){a.readTime=ko(r,o.snapshotVersion.toTimestamp());const u=Rc(r,o.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,t);const i=RC(this.serializer,t);i&&(e.labels=i),this.q_(e)}Z_(t){const e={};e.database=Oc(this.serializer),e.removeTarget=t,this.q_(e)}}class vk extends Gm{constructor(t,e,i,s,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return rt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,rt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){rt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=AC(t.writeResults,t.commitTime),i=Te(t.commitTime);return this.listener.na(i,e)}ra(){const t={};t.database=Oc(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((i=>xC(this.serializer,i)))};this.q_(e)}}class wk{}class Ek extends wk{constructor(t,e,i,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new z(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Go(t,Dc(e,i),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new z(V.UNKNOWN,r.toString())}))}Ho(t,e,i,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(t,Dc(e,i),s,o,a,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(V.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Tk{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(He(e),this.aa=!1):B("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ri="RemoteStore";class Ik{constructor(t,e,i,s,r){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{ui(this)&&(B(ri,"Restarting streams for network reachability change."),await(async function(c){const u=Y(c);u.Ea.add(4),await lr(u),u.Ra.set("Unknown"),u.Ea.delete(4),await ra(u)})(this))}))})),this.Ra=new Tk(i,s)}}async function ra(n){if(ui(n))for(const t of n.da)await t(!0)}async function lr(n){for(const t of n.da)await t(!1)}function Ym(n,t){const e=Y(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Ul(e)?Bl(e):qi(e).O_()&&Fl(e,t))}function Ll(n,t){const e=Y(n),i=qi(e);e.Ia.delete(t),i.O_()&&Km(e,t),e.Ia.size===0&&(i.O_()?i.L_():ui(e)&&e.Ra.set("Unknown"))}function Fl(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(q.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}qi(n).Y_(t)}function Km(n,t){n.Va.Ue(t),qi(n).Z_(t)}function Bl(n){n.Va=new yC({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),qi(n).start(),n.Ra.ua()}function Ul(n){return ui(n)&&!qi(n).x_()&&n.Ia.size>0}function ui(n){return Y(n).Ea.size===0}function Xm(n){n.Va=void 0}async function Sk(n){n.Ra.set("Online")}async function xk(n){n.Ia.forEach(((t,e)=>{Fl(n,t)}))}async function Ak(n,t){Xm(n),Ul(n)?(n.Ra.ha(t),Bl(n)):n.Ra.set("Unknown")}async function Pk(n,t,e){if(n.Ra.set("Online"),t instanceof Om&&t.state===2&&t.cause)try{await(async function(s,r){const o=r.cause;for(const a of r.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))})(n,t)}catch(i){B(ri,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Do(n,i)}else if(t instanceof to?n.Va.Ze(t):t instanceof Mm?n.Va.st(t):n.Va.tt(t),!e.isEqual(q.min()))try{const i=await $m(n.localStore);e.compareTo(i)>=0&&await(function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach(((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=r.Ia.get(u);h&&r.Ia.set(u,h.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,u)=>{const h=r.Ia.get(c);if(!h)return;r.Ia.set(c,h.withResumeToken(Vt.EMPTY_BYTE_STRING,h.snapshotVersion)),Km(r,c);const d=new dn(h.target,c,u,h.sequenceNumber);Fl(r,d)})),r.remoteSyncer.applyRemoteEvent(a)})(n,e)}catch(i){B(ri,"Failed to raise snapshot:",i),await Do(n,i)}}async function Do(n,t,e){if(!$i(t))throw t;n.Ea.add(1),await lr(n),n.Ra.set("Offline"),e||(e=()=>$m(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{B(ri,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await ra(n)}))}function Qm(n,t){return t().catch((e=>Do(n,e,t)))}async function oa(n){const t=Y(n),e=An(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Tl;for(;Ck(t);)try{const s=await uk(t.localStore,i);if(s===null){t.Ta.length===0&&e.L_();break}i=s.batchId,kk(t,s)}catch(s){await Do(t,s)}Jm(t)&&Zm(t)}function Ck(n){return ui(n)&&n.Ta.length<10}function kk(n,t){n.Ta.push(t);const e=An(n);e.O_()&&e.X_&&e.ea(t.mutations)}function Jm(n){return ui(n)&&!An(n).x_()&&n.Ta.length>0}function Zm(n){An(n).start()}async function Rk(n){An(n).ra()}async function Dk(n){const t=An(n);for(const e of n.Ta)t.ea(e.mutations)}async function Mk(n,t,e){const i=n.Ta.shift(),s=kl.from(i,t,e);await Qm(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await oa(n)}async function Ok(n,t){t&&An(n).X_&&await(async function(i,s){if((function(o){return pC(o)&&o!==V.ABORTED})(s.code)){const r=i.Ta.shift();An(i).B_(),await Qm(i,(()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s))),await oa(i)}})(n,t),Jm(n)&&Zm(n)}async function Vf(n,t){const e=Y(n);e.asyncQueue.verifyOperationInProgress(),B(ri,"RemoteStore received new credentials");const i=ui(e);e.Ea.add(3),await lr(e),i&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await ra(e)}async function Nk(n,t){const e=Y(n);t?(e.Ea.delete(2),await ra(e)):t||(e.Ea.add(2),await lr(e),e.Ra.set("Unknown"))}function qi(n){return n.ma||(n.ma=(function(e,i,s){const r=Y(e);return r.sa(),new bk(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:Sk.bind(null,n),t_:xk.bind(null,n),r_:Ak.bind(null,n),H_:Pk.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),Ul(n)?Bl(n):n.Ra.set("Unknown")):(await n.ma.stop(),Xm(n))}))),n.ma}function An(n){return n.fa||(n.fa=(function(e,i,s){const r=Y(e);return r.sa(),new vk(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Rk.bind(null,n),r_:Ok.bind(null,n),ta:Dk.bind(null,n),na:Mk.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await oa(n)):(await n.fa.stop(),n.Ta.length>0&&(B(ri,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class zl{constructor(t,e,i,s,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,s,r){const o=Date.now()+i,a=new zl(t,e,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(V.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wl(n,t){if(He("AsyncQueue",`${t}: ${n}`),$i(n))return new z(V.UNAVAILABLE,`${t}: ${n}`);throw n}class Ai{static emptySet(t){return new Ai(t.comparator)}constructor(t){this.comparator=t?(e,i)=>t(e,i)||W.comparator(e.key,i.key):(e,i)=>W.comparator(e.key,i.key),this.keyedMap=vs(),this.sortedSet=new yt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,i)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Ai)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new Ai;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class Lf{constructor(){this.ga=new yt(W.comparator)}track(t){const e=t.doc.key,i=this.ga.get(e);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(e,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(e):t.type===1&&i.type===2?this.ga=this.ga.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):H(63341,{Rt:t,pa:i}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,i)=>{t.push(i)})),t}}class Bi{constructor(t,e,i,s,r,o,a,c,u){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(t,e,i,s,r){const o=[];return e.forEach((a=>{o.push({type:0,doc:a})})),new Bi(t,e,Ai.emptySet(e),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Zo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==i[s].type||!e[s].doc.isEqual(i[s].doc))return!1;return!0}}class Vk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class Lk{constructor(){this.queries=Ff(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,i){const s=Y(e),r=s.queries;s.queries=Ff(),r.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new z(V.ABORTED,"Firestore shutting down"))}}function Ff(){return new ci((n=>bm(n)),Zo)}async function Fk(n,t){const e=Y(n);let i=3;const s=t.query;let r=e.queries.get(s);r?!r.ba()&&t.Da()&&(i=2):(r=new Vk,i=t.Da()?0:1);try{switch(i){case 0:r.wa=await e.onListen(s,!0);break;case 1:r.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(o){const a=Wl(o,`Initialization of query '${yi(t.query)}' failed`);return void t.onError(a)}e.queries.set(s,r),r.Sa.push(t),t.va(e.onlineState),r.wa&&t.Fa(r.wa)&&jl(e)}async function Bk(n,t){const e=Y(n),i=t.query;let s=3;const r=e.queries.get(i);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?s=t.Da()?0:1:!r.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function Uk(n,t){const e=Y(n);let i=!1;for(const s of t){const r=s.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Fa(s)&&(i=!0);o.wa=s}}i&&jl(e)}function zk(n,t,e){const i=Y(n),s=i.queries.get(t);if(s)for(const r of s.Sa)r.onError(e);i.queries.delete(t)}function jl(n){n.Ca.forEach((t=>{t.next()}))}var Lc,Bf;(Bf=Lc||(Lc={})).Ma="default",Bf.Cache="cache";class Wk{constructor(t,e,i){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Bi(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const i=e!=="Offline";return(!this.options.qa||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Bi.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Lc.Cache}}class t_{constructor(t){this.key=t}}class e_{constructor(t){this.key=t}}class jk{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=vm(t),this.tu=new Ai(this.eu)}get nu(){return this.Ya}ru(t,e){const i=e?e.iu:new Lf,s=e?e.tu:this.tu;let r=e?e.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((h,d)=>{const g=s.get(h),m=ta(this.query,d)?d:null,y=!!g&&this.mutatedKeys.has(g.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;g&&m?g.data.isEqual(m.data)?y!==v&&(i.track({type:3,doc:m}),w=!0):this.su(g,m)||(i.track({type:2,doc:m}),w=!0,(c&&this.eu(m,c)>0||u&&this.eu(m,u)<0)&&(a=!0)):!g&&m?(i.track({type:0,doc:m}),w=!0):g&&!m&&(i.track({type:1,doc:g}),w=!0,(c||u)&&(a=!0)),w&&(m?(o=o.add(m),r=v?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),i.track({type:1,doc:h})}return{tu:o,iu:i,Cs:a,mutatedKeys:r}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,s){const r=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((h,d)=>(function(m,y){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H(20277,{Rt:w})}};return v(m)-v(y)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(i),s=s??!1;const a=e&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new Bi(this.query,t.tu,r,o,t.mutatedKeys,c===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const e=[];return t.forEach((i=>{this.Xa.has(i)||e.push(new e_(i))})),this.Xa.forEach((i=>{t.has(i)||e.push(new t_(i))})),e}cu(t){this.Ya=t.Qs,this.Xa=et();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Bi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Hl="SyncEngine";class Hk{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class $k{constructor(t){this.key=t,this.hu=!1}}class qk{constructor(t,e,i,s,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ci((a=>bm(a)),Zo),this.Iu=new Map,this.Eu=new Set,this.du=new yt(W.comparator),this.Au=new Map,this.Ru=new Ml,this.Vu={},this.mu=new Map,this.fu=Fi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Gk(n,t,e=!0){const i=a_(n);let s;const r=i.Tu.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await n_(i,t,e,!0),s}async function Yk(n,t){const e=a_(n);await n_(e,t,!0,!1)}async function n_(n,t,e,i){const s=await hk(n.localStore,Ee(t)),r=s.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return i&&(a=await Kk(n,t,r,o==="current",s.resumeToken)),n.isPrimaryClient&&e&&Ym(n.remoteStore,s),a}async function Kk(n,t,e,i,s){n.pu=(d,g,m)=>(async function(v,w,P,C){let D=w.view.ru(P);D.Cs&&(D=await Rf(v.localStore,w.query,!1).then((({documents:I})=>w.view.ru(I,D))));const O=C&&C.targetChanges.get(w.targetId),M=C&&C.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(D,v.isPrimaryClient,O,M);return zf(v,w.targetId,L.au),L.snapshot})(n,d,g,m);const r=await Rf(n.localStore,t,!0),o=new jk(t,r.Qs),a=o.ru(r.documents),c=cr.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",s),u=o.applyChanges(a,n.isPrimaryClient,c);zf(n,e,u.au);const h=new Hk(t,e,o);return n.Tu.set(t,h),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),u.snapshot}async function Xk(n,t,e){const i=Y(n),s=i.Tu.get(t),r=i.Iu.get(s.targetId);if(r.length>1)return i.Iu.set(s.targetId,r.filter((o=>!Zo(o,t)))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Nc(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),e&&Ll(i.remoteStore,s.targetId),Fc(i,s.targetId)})).catch(Hi)):(Fc(i,s.targetId),await Nc(i.localStore,s.targetId,!0))}async function Qk(n,t){const e=Y(n),i=e.Tu.get(t),s=e.Iu.get(i.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),Ll(e.remoteStore,i.targetId))}async function Jk(n,t,e){const i=r1(n);try{const s=await(function(o,a){const c=Y(o),u=ht.now(),h=a.reduce(((m,y)=>m.add(y.key)),et());let d,g;return c.persistence.runTransaction("Locally write mutations","readwrite",(m=>{let y=$e(),v=et();return c.Ns.getEntries(m,h).next((w=>{y=w,y.forEach(((P,C)=>{C.isValidDocument()||(v=v.add(P))}))})).next((()=>c.localDocuments.getOverlayedDocuments(m,y))).next((w=>{d=w;const P=[];for(const C of a){const D=uC(C,d.get(C.key).overlayedDocument);D!=null&&P.push(new li(C.key,D,dm(D.value.mapValue),ze.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,P,a)})).next((w=>{g=w;const P=w.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(m,w.batchId,P)}))})).then((()=>({batchId:g.batchId,changes:Em(d)})))})(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),(function(o,a,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new yt(tt)),u=u.insert(a,c),o.Vu[o.currentUser.toKey()]=u})(i,s.batchId,e),await ur(i,s.changes),await oa(i.remoteStore)}catch(s){const r=Wl(s,"Failed to persist write");e.reject(r)}}async function i_(n,t){const e=Y(n);try{const i=await ck(e.localStore,t);t.targetChanges.forEach(((s,r)=>{const o=e.Au.get(r);o&&(rt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?rt(o.hu,14607):s.removedDocuments.size>0&&(rt(o.hu,42227),o.hu=!1))})),await ur(e,i,t)}catch(i){await Hi(i)}}function Uf(n,t,e){const i=Y(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const s=[];i.Tu.forEach(((r,o)=>{const a=o.view.va(t);a.snapshot&&s.push(a.snapshot)})),(function(o,a){const c=Y(o);c.onlineState=a;let u=!1;c.queries.forEach(((h,d)=>{for(const g of d.Sa)g.va(a)&&(u=!0)})),u&&jl(c)})(i.eventManager,t),s.length&&i.Pu.H_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Zk(n,t,e){const i=Y(n);i.sharedClientState.updateQueryState(t,"rejected",e);const s=i.Au.get(t),r=s&&s.key;if(r){let o=new yt(W.comparator);o=o.insert(r,Wt.newNoDocument(r,q.min()));const a=et().add(r),c=new ia(q.min(),new Map,new yt(tt),o,a);await i_(i,c),i.du=i.du.remove(r),i.Au.delete(t),$l(i)}else await Nc(i.localStore,t,!1).then((()=>Fc(i,t,e))).catch(Hi)}async function t1(n,t){const e=Y(n),i=t.batch.batchId;try{const s=await ak(e.localStore,t);r_(e,i,null),s_(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await ur(e,s)}catch(s){await Hi(s)}}async function e1(n,t,e){const i=Y(n);try{const s=await(function(o,a){const c=Y(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,a).next((d=>(rt(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(u,d)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(i.localStore,t);r_(i,t,e),s_(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await ur(i,s)}catch(s){await Hi(s)}}function s_(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function r_(n,t,e){const i=Y(n);let s=i.Vu[i.currentUser.toKey()];if(s){const r=s.get(t);r&&(e?r.reject(e):r.resolve(),s=s.remove(t)),i.Vu[i.currentUser.toKey()]=s}}function Fc(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Iu.get(t))n.Tu.delete(i),e&&n.Pu.yu(i,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((i=>{n.Ru.containsKey(i)||o_(n,i)}))}function o_(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Ll(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),$l(n))}function zf(n,t,e){for(const i of e)i instanceof t_?(n.Ru.addReference(i.key,t),n1(n,i)):i instanceof e_?(B(Hl,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,t),n.Ru.containsKey(i.key)||o_(n,i.key)):H(19791,{wu:i})}function n1(n,t){const e=t.key,i=e.path.canonicalString();n.du.get(e)||n.Eu.has(i)||(B(Hl,"New document in limbo: "+e),n.Eu.add(i),$l(n))}function $l(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new W(_t.fromString(t)),i=n.fu.next();n.Au.set(i,new $k(e)),n.du=n.du.insert(e,i),Ym(n.remoteStore,new dn(Ee(Pl(e.path)),i,"TargetPurposeLimboResolution",Ko.ce))}}async function ur(n,t,e){const i=Y(n),s=[],r=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,t,e).then((u=>{if((u||e)&&i.isPrimaryClient){const h=u?!u.fromCache:e?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=Nl.As(c.targetId,u);r.push(h)}})))})),await Promise.all(o),i.Pu.H_(s),await(async function(c,u){const h=Y(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>N.forEach(u,(g=>N.forEach(g.Es,(m=>h.persistence.referenceDelegate.addReference(d,g.targetId,m))).next((()=>N.forEach(g.ds,(m=>h.persistence.referenceDelegate.removeReference(d,g.targetId,m)))))))))}catch(d){if(!$i(d))throw d;B(Vl,"Failed to update sequence numbers: "+d)}for(const d of u){const g=d.targetId;if(!d.fromCache){const m=h.Ms.get(g),y=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(y);h.Ms=h.Ms.insert(g,v)}}})(i.localStore,r))}async function i1(n,t){const e=Y(n);if(!e.currentUser.isEqual(t)){B(Hl,"User change. New user:",t.toKey());const i=await Hm(e.localStore,t);e.currentUser=t,(function(r,o){r.mu.forEach((a=>{a.forEach((c=>{c.reject(new z(V.CANCELLED,o))}))})),r.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await ur(e,i.Ls)}}function s1(n,t){const e=Y(n),i=e.Au.get(t);if(i&&i.hu)return et().add(i.key);{let s=et();const r=e.Iu.get(t);if(!r)return s;for(const o of r){const a=e.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function a_(n){const t=Y(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=i_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=s1.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zk.bind(null,t),t.Pu.H_=Uk.bind(null,t.eventManager),t.Pu.yu=zk.bind(null,t.eventManager),t}function r1(n){const t=Y(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=t1.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=e1.bind(null,t),t}class Mo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=sa(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return ok(this.persistence,new ik,t.initialUser,this.serializer)}Cu(t){return new jm(Ol.mi,this.serializer)}Du(t){return new fk}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mo.provider={build:()=>new Mo};class o1 extends Mo{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){rt(this.persistence.referenceDelegate instanceof Ro,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new WC(i,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new jm((i=>Ro.mi(i,e)),this.serializer)}}class Bc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Uf(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=i1.bind(null,this.syncEngine),await Nk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Lk})()}createDatastore(t){const e=sa(t.databaseInfo.databaseId),i=(function(r){return new yk(r)})(t.databaseInfo);return(function(r,o,a,c){return new Ek(r,o,a,c)})(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return(function(i,s,r,o,a){return new Ik(i,s,r,o,a)})(this.localStore,this.datastore,t.asyncQueue,(e=>Uf(this.syncEngine,e,0)),(function(){return Of.v()?new Of:new gk})())}createSyncEngine(t,e){return(function(s,r,o,a,c,u,h){const d=new qk(s,r,o,a,c,u);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const i=Y(e);B(ri,"RemoteStore shutting down."),i.Ea.add(5),await lr(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Bc.provider={build:()=>new Bc};class a1{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):He("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const Pn="FirestoreClient";class c1{constructor(t,e,i,s,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=wl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,(async o=>{B(Pn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(B(Pn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=Wl(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}async function nc(n,t){n.asyncQueue.verifyOperationInProgress(),B(Pn,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await Hm(t.localStore,s),i=s)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function Wf(n,t){n.asyncQueue.verifyOperationInProgress();const e=await l1(n);B(Pn,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((i=>Vf(t.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>Vf(t.remoteStore,s))),n._onlineComponents=t}async function l1(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B(Pn,"Using user provided OfflineComponentProvider");try{await nc(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;Oi("Error using user provided cache. Falling back to memory cache: "+e),await nc(n,new Mo)}}else B(Pn,"Using default OfflineComponentProvider"),await nc(n,new o1(void 0));return n._offlineComponents}async function c_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B(Pn,"Using user provided OnlineComponentProvider"),await Wf(n,n._uninitializedComponentsProvider._online)):(B(Pn,"Using default OnlineComponentProvider"),await Wf(n,new Bc))),n._onlineComponents}function u1(n){return c_(n).then((t=>t.syncEngine))}async function h1(n){const t=await c_(n),e=t.eventManager;return e.onListen=Gk.bind(null,t.syncEngine),e.onUnlisten=Xk.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=Yk.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Qk.bind(null,t.syncEngine),e}function d1(n,t,e={}){const i=new bn;return n.asyncQueue.enqueueAndForget((async()=>(function(r,o,a,c,u){const h=new a1({next:g=>{h.Nu(),o.enqueueAndForget((()=>Bk(r,d)));const m=g.docs.has(a);!m&&g.fromCache?u.reject(new z(V.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&c&&c.source==="server"?u.reject(new z(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),d=new Wk(Pl(a.path),h,{includeMetadataChanges:!0,qa:!0});return Fk(r,d)})(await h1(n),n.asyncQueue,t,e,i))),i.promise}function l_(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const jf=new Map;const u_="firestore.googleapis.com",Hf=!0;class $f{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new z(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=u_,this.ssl=Hf}else this.host=t.host,this.ssl=t.ssl??Hf;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Wm;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<UC)throw new z(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}TP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l_(t.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new z(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ql{constructor(t,e,i,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $f({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new z(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $f(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new dP;switch(i.type){case"firstParty":return new mP(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new z(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=jf.get(e);i&&(B("ComponentProvider","Removing Datastore"),jf.delete(e),i.terminate())})(this),Promise.resolve()}}function f1(n,t,e,i={}){n=Hs(n,ql);const s=Ui(t),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;s&&(up(`https://${a}`),hp("Firestore",!0)),r.host!==u_&&r.host!==a&&Oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...r,host:a,ssl:s,emulatorOptions:i};if(!ei(c,o)&&(n._setSettings(c),i.mockUserToken)){let u,h;if(typeof i.mockUserToken=="string")u=i.mockUserToken,h=Ut.MOCK_USER;else{u=VI(i.mockUserToken,n._app?.options.projectId);const d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new z(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ut(d)}n._authCredentials=new fP(new em(u,h))}}class Gl{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Gl(this.firestore,t,this._query)}}class Dt{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Dt(this.firestore,t,this._key)}toJSON(){return{type:Dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(or(e,Dt._jsonSchema))return new Dt(t,i||null,new W(_t.fromString(e.referencePath)))}}Dt._jsonSchemaVersion="firestore/documentReference/1.0",Dt._jsonSchema={type:It("string",Dt._jsonSchemaVersion),referencePath:It("string")};class Qs extends Gl{constructor(t,e,i){super(t,e,Pl(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Dt(this.firestore,null,new W(t))}withConverter(t){return new Qs(this.firestore,t,this._path)}}function h_(n,t,...e){if(n=oe(n),arguments.length===1&&(t=wl.newId()),EP("doc","path",t),n instanceof ql){const i=_t.fromString(t,...e);return rf(i),new Dt(n,null,new W(i))}{if(!(n instanceof Dt||n instanceof Qs))throw new z(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(_t.fromString(t,...e));return rf(i),new Dt(n.firestore,n instanceof Qs?n.converter:null,new W(i))}}const qf="AsyncQueue";class Gf{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qm(this,"async_queue_retry"),this._c=()=>{const i=ec();i&&B(qf,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const e=ec();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=ec();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new bn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!$i(t))throw t;B(qf,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((i=>{throw this.nc=i,this.rc=!1,He("INTERNAL UNHANDLED ERROR: ",Yf(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=e,e}enqueueAfterDelay(t,e,i){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=zl.createAndSchedule(this,t,e,i,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&H(47125,{Pc:Yf(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,i)=>e.targetTimeMs-i.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function Yf(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class Yl extends ql{constructor(t,e,i,s){super(t,e,i,s),this.type="firestore",this._queue=new Gf,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Gf(t),this._firestoreClient=void 0,await t}}}function g1(n,t){const e=typeof n=="object"?n:pp(),i=typeof n=="string"?n:Io,s=ll(e,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=OI("firestore");r&&f1(s,...r)}return s}function d_(n){if(n._terminated)throw new z(V.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||p1(n),n._firestoreClient}function p1(n){const t=n._freezeSettings(),e=(function(s,r,o,a){return new OP(s,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,l_(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new c1(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}})(n._componentsProvider))}class se{constructor(t){this._byteString=t}static fromBase64String(t){try{return new se(Vt.fromBase64String(t))}catch(e){throw new z(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new se(Vt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:se._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(or(t,se._jsonSchema))return se.fromBase64String(t.bytes)}}se._jsonSchemaVersion="firestore/bytes/1.0",se._jsonSchema={type:It("string",se._jsonSchemaVersion),bytes:It("string")};class Kl{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new z(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ot(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class f_{constructor(t){this._methodName=t}}class Ie{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new z(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new z(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ie._jsonSchemaVersion}}static fromJSON(t){if(or(t,Ie._jsonSchema))return new Ie(t.latitude,t.longitude)}}Ie._jsonSchemaVersion="firestore/geoPoint/1.0",Ie._jsonSchema={type:It("string",Ie._jsonSchemaVersion),latitude:It("number"),longitude:It("number")};class Se{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Se._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(or(t,Se._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Se(t.vectorValues);throw new z(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Se._jsonSchemaVersion="firestore/vectorValue/1.0",Se._jsonSchema={type:It("string",Se._jsonSchemaVersion),vectorValues:It("object")};const m1=/^__.*__$/;class _1{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new li(t,this.data,this.fieldMask,e,this.fieldTransforms):new ar(t,this.data,e,this.fieldTransforms)}}function g_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H(40011,{Ac:n})}}class Xl{constructor(t,e,i,s,r,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new Xl({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.gc(t),i}yc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.Rc(),i}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Oo(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(g_(this.Ac)&&m1.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class y1{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||sa(t)}Cc(t,e,i,s=!1){return new Xl({Ac:t,methodName:e,Dc:i,path:Ot.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function b1(n){const t=n._freezeSettings(),e=sa(n._databaseId);return new y1(n._databaseId,!!t.ignoreUndefinedProperties,e)}function v1(n,t,e,i,s,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,t,e,s);y_("Data must be an object, but it was:",o,i);const a=m_(i,o);let c,u;if(r.merge)c=new he(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const d of r.mergeFields){const g=w1(t,d,e);if(!o.contains(g))throw new z(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);T1(h,g)||h.push(g)}c=new he(h),u=o.fieldTransforms.filter((d=>c.covers(d.field)))}else c=null,u=o.fieldTransforms;return new _1(new ie(a),c,u)}function p_(n,t){if(__(n=oe(n)))return y_("Unsupported field value:",t,n),m_(n,t);if(n instanceof f_)return(function(i,s){if(!g_(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(i,s){const r=[];let o=0;for(const a of i){let c=p_(a,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}})(n,t)}return(function(i,s){if((i=oe(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return sC(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=ht.fromDate(i);return{timestampValue:ko(s.serializer,r)}}if(i instanceof ht){const r=new ht(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:ko(s.serializer,r)}}if(i instanceof Ie)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof se)return{bytesValue:Nm(s.serializer,i._byteString)};if(i instanceof Dt){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Dl(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof Se)return(function(o,a){return{mapValue:{fields:{[um]:{stringValue:hm},[So]:{arrayValue:{values:o.toArray().map((u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return Cl(a.serializer,u)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${El(i)}`)})(n,t)}function m_(n,t){const e={};return sm(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ai(n,((i,s)=>{const r=p_(s,t.mc(i));r!=null&&(e[i]=r)})),{mapValue:{fields:e}}}function __(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ht||n instanceof Ie||n instanceof se||n instanceof Dt||n instanceof f_||n instanceof Se)}function y_(n,t,e){if(!__(e)||!nm(e)){const i=El(e);throw i==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+i)}}function w1(n,t,e){if((t=oe(t))instanceof Kl)return t._internalPath;if(typeof t=="string")return b_(n,t);throw Oo("Field path arguments must be of type string or ",n,!1,void 0,e)}const E1=new RegExp("[~\\*/\\[\\]]");function b_(n,t,e){if(t.search(E1)>=0)throw Oo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Kl(...t.split("."))._internalPath}catch{throw Oo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Oo(n,t,e,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new z(V.INVALID_ARGUMENT,a+n+c)}function T1(n,t){return n.some((e=>e.isEqual(t)))}class v_{constructor(t,e,i,s,r){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new I1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(w_("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class I1 extends v_{data(){return super.data()}}function w_(n,t){return typeof t=="string"?b_(n,t):t instanceof Kl?t._internalPath:t._delegate._internalPath}class S1{convertValue(t,e="none"){switch(xn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return wt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Sn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw H(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return ai(t,((s,r)=>{i[s]=this.convertValue(r,e)})),i}convertVectorValue(t){const e=t.fields?.[So].arrayValue?.values?.map((i=>wt(i.doubleValue)));return new Se(e)}convertGeoPoint(t){return new Ie(wt(t.latitude),wt(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=Qo(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(qs(t));default:return null}}convertTimestamp(t){const e=In(t);return new ht(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=_t.fromString(t);rt(zm(i),9688,{name:t});const s=new Gs(i.get(1),i.get(3)),r=new W(i.popFirst(5));return s.isEqual(e)||He(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function x1(n,t,e){let i;return i=n?n.toFirestore(t):t,i}class Es{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Jn extends v_{constructor(t,e,i,s,r,o){super(t,e,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new eo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(w_("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new z(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Jn._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Jn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jn._jsonSchema={type:It("string",Jn._jsonSchemaVersion),bundleSource:It("string","DocumentSnapshot"),bundleName:It("string"),bundle:It("string")};class eo extends Jn{data(t={}){return super.data(t)}}class Os{constructor(t,e,i,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new Es(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((i=>{t.call(e,new eo(this._firestore,this._userDataWriter,i.key,i,new Es(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new z(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((a=>{const c=new eo(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Es(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>r||a.type!==3)).map((a=>{const c=new eo(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Es(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:A1(a.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new z(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Os._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=wl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],i=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(e.push(r._document),i.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function A1(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H(61501,{type:n})}}function P1(n){n=Hs(n,Dt);const t=Hs(n.firestore,Yl);return d1(d_(t),n._key).then((e=>D1(t,n,e)))}Os._jsonSchemaVersion="firestore/querySnapshot/1.0",Os._jsonSchema={type:It("string",Os._jsonSchemaVersion),bundleSource:It("string","QuerySnapshot"),bundleName:It("string"),bundle:It("string")};class C1 extends S1{constructor(t){super(),this.firestore=t}convertBytes(t){return new se(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Dt(this.firestore,null,e)}}function k1(n,t,e){n=Hs(n,Dt);const i=Hs(n.firestore,Yl),s=x1(n.converter,t);return R1(i,[v1(b1(i),"setDoc",n._key,s,n.converter!==null,e).toMutation(n._key,ze.none())])}function R1(n,t){return(function(i,s){const r=new bn;return i.asyncQueue.enqueueAndForget((async()=>Jk(await u1(i),s,r))),r.promise})(d_(n),t)}function D1(n,t,e){const i=e.docs.get(t._key),s=new C1(n);return new Jn(n,s,t._key,i,new Es(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(s){ji=s})(zi),Di(new ni("firestore",((i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new Yl(new gP(i.getProvider("auth-internal")),new _P(o,i.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new z(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gs(u.options.projectId,h)})(o,s),o);return r={useFetchStreams:e,...r},a._setSettings(r),a}),"PUBLIC").setMultipleInstances(!0)),_n(tf,ef,t),_n(tf,ef,"esm2020")})();const M1={apiKey:"AIzaSyDc1-GKX0g26tazdRCFt9dvEjOwQzOQZFk",authDomain:"glassdash-20266.firebaseapp.com",projectId:"glassdash-20266",storageBucket:"glassdash-20266.firebasestorage.app",messagingSenderId:"926827534866",appId:"1:926827534866:web:142b30e53f31e8697716cb",measurementId:"G-8ZNTQEFQZ1"},E_=gp(M1),ic=uP(E_),T_=g1(E_),O1=new Ne;let Uc=null;async function aa(){if(Uc){console.log("Saving to cloud...");try{const n={transactions:Zt.transactions,subscriptions:Yn.subscriptions,debts:fn.debts,lastUpdated:new Date().toISOString()};await k1(h_(T_,"users",Uc.uid),n),console.log("Cloud save complete")}catch(n){console.error("Error saving to cloud:",n)}}}class N1{constructor(){this.transactions=JSON.parse(localStorage.getItem("transactions"))||[],this.transactions.length===0&&(this.transactions.push({id:crypto.randomUUID(),date:re(new Date,"yyyy-MM-dd"),title:": ",amount:3e5,type:"income",category:"salary"}),this.transactions.push({id:crypto.randomUUID(),date:re(new Date,"yyyy-MM-dd"),title:": ",amount:8e4,type:"expense",category:"fixed"}),localStorage.setItem("transactions",JSON.stringify(this.transactions)))}addTransaction(t){this.transactions.unshift(t),this.save()}removeTransaction(t){this.transactions=this.transactions.filter(e=>e.id!==t),this.save()}clearAll(){this.transactions=[],this.save()}save(){localStorage.setItem("transactions",JSON.stringify(this.transactions)),Wc(),aa()}getTransactions(){return this.transactions.sort((t,e)=>new Date(e.date)-new Date(t.date))}getMonthlyStats(){const t=new Date,e=this.transactions.filter(o=>$r(As(o.date),t)),i=e.filter(o=>o.type==="income").reduce((o,a)=>o+Number(a.amount),0),s=e.filter(o=>o.type==="expense").reduce((o,a)=>o+Number(a.amount),0),r=this.transactions.reduce((o,a)=>a.type==="income"?o+Number(a.amount):o-Number(a.amount),0);return{income:i,expense:s,totalBalance:r}}getChartData(t=6){const e=new Date,i=pc(e,t-1),s=NE({start:i,end:e}),r=s.map(a=>re(a,"M",{locale:ip})),o=s.map(a=>{const c=this.transactions.filter(d=>$r(As(d.date),a)),u=c.filter(d=>d.type==="income").reduce((d,g)=>d+Number(g.amount),0),h=c.filter(d=>d.type==="expense").reduce((d,g)=>d+Number(g.amount),0);return u-h});return{labels:r,data:o}}getCategoryStats(t="current"){const e=new Date;let i=e;t==="last"&&(i=pc(e,1));const s=this.transactions.filter(u=>$r(As(u.date),i)&&u.type==="expense"),r={};s.forEach(u=>{r[u.category]||(r[u.category]=0),r[u.category]+=Number(u.amount)});const o=Object.keys(r).map(u=>S_(u)),a=Object.values(r),c=Object.keys(r).map(u=>F1(u));return{labels:o,data:a,bgColors:c}}}const Zt=new N1;class V1{constructor(t){this.subscriptions=JSON.parse(localStorage.getItem("subscriptions"))||[],this.transactionStore=t,this.lastCheck=localStorage.getItem("lastSubscriptionCheck")||re(new Date,"yyyy-MM-dd"),this.subscriptions.length===0&&(this.subscriptions.push({id:crypto.randomUUID(),title:"",amount:8e4,day:27}),this.subscriptions.push({id:crypto.randomUUID(),title:"Netflix",amount:1490,day:15}),localStorage.setItem("subscriptions",JSON.stringify(this.subscriptions)))}addSubscription(t){this.subscriptions.push(t),this.save()}removeSubscription(t){this.subscriptions=this.subscriptions.filter(e=>e.id!==t),this.save()}save(){localStorage.setItem("subscriptions",JSON.stringify(this.subscriptions)),io(),aa()}checkAndGenerate(){const t=new Date,e=As(this.lastCheck);if(re(t,"yyyy-MM-dd")===this.lastCheck)return;let i=e;for(i.setDate(i.getDate()+1);i<=t;){const s=i.getDate();this.subscriptions.forEach(r=>{Number(r.day)===s&&this.transactionStore.addTransaction({id:crypto.randomUUID(),date:re(i,"yyyy-MM-dd"),title:r.title+" ()",amount:r.amount,type:"expense",category:"fixed"})}),i.setDate(i.getDate()+1)}this.lastCheck=re(t,"yyyy-MM-dd"),localStorage.setItem("lastSubscriptionCheck",this.lastCheck)}getSubscriptions(){return this.subscriptions}}const Yn=new V1(Zt);class L1{constructor(t){this.debts=JSON.parse(localStorage.getItem("debts"))||[],this.transactionStore=t}addDebt(t){this.debts.push(t),this.save()}repayDebt(t,e){const i=this.debts.find(s=>s.id===t);i&&(i.balance-=e,i.balance<0&&(i.balance=0),this.transactionStore.addTransaction({id:crypto.randomUUID(),date:re(new Date,"yyyy-MM-dd"),title:`: ${i.name}`,amount:e,type:"expense",category:"other"}),this.save())}removeDebt(t){this.debts=this.debts.filter(e=>e.id!==t),this.save()}save(){localStorage.setItem("debts",JSON.stringify(this.debts)),I_(),aa()}getTotalDebt(){return this.debts.reduce((t,e)=>t+Number(e.balance),0)}}const fn=new L1(Zt);function vn(n){return new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY"}).format(n)}function F1(n){return{food:"#e17055",daily:"#00b894",transport:"#0984e3",entertainment:"#6c5ce7",fixed:"#d63031",salary:"#fdcb6e",other:"#636e72"}[n]||"#636e72"}function B1(){const{income:n,expense:t,totalBalance:e}=Zt.getMonthlyStats();document.getElementById("total-balance").textContent=vn(e),document.getElementById("month-income").textContent=vn(n),document.getElementById("month-expense").textContent=vn(t);const i=document.getElementById("balance-trend");e>=0?(i.innerHTML='<i class="fa-solid fa-arrow-up"></i> ',i.className="trend up"):(i.innerHTML='<i class="fa-solid fa-arrow-down"></i> ',i.className="trend down")}function I_(){const n=document.getElementById("debt-list");if(!n)return;n.innerHTML="";const t=fn.getTotalDebt();document.getElementById("total-debt").textContent=vn(t),fn.debts.forEach(e=>{const i=`
      <div class="transaction-item" style="background: rgba(255,255,255,0.05);">
        <div class="t-icon" style="background: #d63031; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
          <i class="fa-solid fa-building-columns" style="color: #fff;"></i>
        </div>
        <div class="t-details">
          <h4>${e.name} <span style="font-size: 0.7rem; opacity: 0.7;">${e.rate?"( "+e.rate+"%)":""}</span></h4>
          <p>: ${vn(e.balance)}</p>
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
             <button class="glass-btn-sm repay-btn" data-id="${e.id}" style="font-size: 0.8rem; padding: 5px 10px; background: rgba(0, 184, 148, 0.2); color: #00b894; border: 1px solid #00b894;">
            
          </button>
          <button class="glass-btn-sm delete-debt-btn" data-id="${e.id}" style="border: none; background: transparent; color: #ff7675;">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    `;n.insertAdjacentHTML("beforeend",i)}),document.querySelectorAll(".repay-btn").forEach(e=>{e.addEventListener("click",i=>{const s=i.currentTarget.dataset.id,r=prompt(":");r&&!isNaN(r)&&(fn.repayDebt(s,Number(r)),alert(""))})}),document.querySelectorAll(".delete-debt-btn").forEach(e=>{e.addEventListener("click",i=>{confirm("")&&fn.removeDebt(i.currentTarget.dataset.id)})})}function U1(){const n=document.getElementById("transaction-list");n.innerHTML="",Zt.getTransactions().slice(0,5).forEach(e=>{const i=e.type==="income",s=i?"positive":"negative",r=i?"+":"-";let o="fa-circle",a="#fff",c="#333";switch(e.category){case"food":o="fa-utensils",c="#e17055";break;case"daily":o="fa-basket-shopping",c="#00b894";break;case"transport":o="fa-train",c="#0984e3";break;case"entertainment":o="fa-gamepad",c="#6c5ce7";break;case"fixed":o="fa-house",c="#d63031";break;case"salary":o="fa-money-bill-wave",c="#fdcb6e",a="#000";break;default:o="fa-tag",c="#636e72"}const u=`
      <div class="transaction-item">
        <div class="t-icon" style="background: ${c}; width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
          <i class="fa-solid ${o}" style="color: ${a};"></i>
        </div>
        <div class="t-details">
          <h4>${e.title}</h4>
          <p>${re(As(e.date),"yyyy/MM/dd")}  ${S_(e.category)}</p>
        </div>
        <div class="t-amount ${s}">
          ${r}${vn(e.amount)}
        </div>
        <button class="glass-btn-sm delete-btn" data-id="${e.id}" style="margin-left: 10px; border: none; background: transparent; color: #ff7675;">
          <i class="fa-solid fa-trash"></i>
        </button>
      </div>
    `;n.insertAdjacentHTML("beforeend",u)}),document.querySelectorAll(".delete-btn").forEach(e=>{e.addEventListener("click",i=>{const s=i.currentTarget.dataset.id;confirm("")&&Zt.removeTransaction(s)})})}function S_(n){return{food:"",daily:"",transport:"",entertainment:"",fixed:"",salary:"",other:""}[n]||n}let no,wi;function z1(){const n=document.getElementById("revenueChart").getContext("2d"),t=n.createLinearGradient(0,0,0,400);t.addColorStop(0,"rgba(108, 92, 231, 0.5)"),t.addColorStop(1,"rgba(108, 92, 231, 0.0)"),no=new Uo(n,{type:"line",data:{labels:[],datasets:[{label:"",data:[],backgroundColor:t,borderColor:"#6c5ce7",borderWidth:2,pointBackgroundColor:"#ffffff",pointBorderColor:"#6c5ce7",pointRadius:4,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(255, 255, 255, 0.9)",titleColor:"#000",bodyColor:"#000",borderColor:"rgba(0,0,0,0.1)",borderWidth:1,padding:10,displayColors:!1,callbacks:{label:function(e){return": "+vn(e.parsed.y)}}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.7)"}},y:{grid:{color:"rgba(255,255,255,0.1)",drawBorder:!1},ticks:{color:"rgba(255,255,255,0.7)"}}}}})}function W1(){const n=document.getElementById("categoryChart").getContext("2d");wi=new Uo(n,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderWidth:0,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#fff"}},tooltip:{callbacks:{label:function(t){return t.label+": "+vn(t.parsed)}}}}}})}function j1(){const{labels:n,data:t}=Zt.getChartData();no.data.labels=n,no.data.datasets[0].data=t,no.update()}function zc(n="current"){if(!wi)return;const{labels:t,data:e,bgColors:i}=Zt.getCategoryStats(n);wi.data.labels=t,wi.data.datasets[0].data=e,wi.data.datasets[0].backgroundColor=i,wi.update()}function Wc(){try{B1()}catch(n){console.error("updateStats failed",n)}try{U1()}catch(n){console.error("updateTransactionList failed",n)}try{j1()}catch(n){console.error("updateChart failed",n)}try{zc(document.getElementById("analytics-period")?.value||"current")}catch(n){console.error("updateCategoryChart failed",n)}try{I_()}catch(n){console.error("updateDebtUI failed",n)}try{jc($n)}catch(n){console.error("renderCalendar failed",n)}}let $n=new Date;function jc(n){const t=document.getElementById("calendar-grid"),e=document.getElementById("calendar-title");if(!t||!e)return;t.innerHTML="",e.textContent=re(n,"yyyy M",{locale:ip});const i=VE(n),s=ME(n),r=Ri(i),o=FE(s);OE({start:r,end:o}).forEach(c=>{const u=$r(c,n),h=re(c,"yyyy-MM-dd"),d=kE(c,new Date),g=Zt.transactions.filter(P=>P.date===h),m=g.filter(P=>P.type==="income").reduce((P,C)=>P+Number(C.amount),0),y=g.filter(P=>P.type==="expense").reduce((P,C)=>P+Number(C.amount),0),v=document.createElement("div");v.className="calendar-cell",u||v.classList.add("other-month"),d&&v.classList.add("today-cell");let w=`<div class="calendar-date">${re(c,"d")}</div>`;m>0&&(w+=`<div class="calendar-income">+${(m/1e3).toFixed(0)}k</div>`),y>0&&(w+=`<div class="calendar-expense">-${(y/1e3).toFixed(0)}k</div>`),v.innerHTML=w,v.addEventListener("click",()=>{}),t.appendChild(v)})}function io(){const n=document.getElementById("subscription-list");n&&(n.innerHTML="",Yn.subscriptions.forEach(t=>{const e=`
      <div class="fixed-cost-item" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); border-radius: 8px;">
        <div>
          <div style="font-size: 0.9rem;">${t.title}</div>
          <div style="font-size: 0.75rem; color: var(--text-muted);"> ${t.day}</div>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
          <span>${t.amount.toLocaleString()}</span>
          <button class="glass-btn-sm delete-sub-btn" data-id="${t.id}" style="border: none; background: transparent; color: #ff7675; cursor: pointer;">
            <i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    `;n.insertAdjacentHTML("beforeend",e)}),document.querySelectorAll(".delete-sub-btn").forEach(t=>{t.addEventListener("click",e=>{confirm("")&&Yn.removeSubscription(e.currentTarget.dataset.id)})}))}document.addEventListener("DOMContentLoaded",()=>{console.log("App initializing...");try{z1()}catch(S){console.error("initChart failed",S)}try{W1()}catch(S){console.error("initCategoryChart failed",S)}try{Yn.checkAndGenerate()}catch(S){console.error("subStore check failed",S)}try{Wc(),io()}catch(S){console.error("Initial UI update failed",S)}const n=document.getElementById("theme-toggle"),t=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",t),n&&(t==="light"&&(n.innerHTML='<i class="fa-solid fa-moon"></i> '),n.addEventListener("click",()=>{const E=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",E),localStorage.setItem("theme",E),E==="light"?n.innerHTML='<i class="fa-solid fa-moon"></i> ':n.innerHTML='<i class="fa-solid fa-sun"></i> '})),document.getElementById("prev-month")?.addEventListener("click",()=>{$n=pc($n,1),jc($n)}),document.getElementById("next-month")?.addEventListener("click",()=>{$n=Xg($n,1),jc($n)});const e=document.getElementById("sub-day");for(let S=1;S<=31;S++){const E=document.createElement("option");E.value=S,E.textContent=S+"",e.appendChild(E)}document.getElementById("analytics-period")?.addEventListener("change",S=>{zc(S.target.value)});const i=document.querySelectorAll(".nav-item"),s=document.querySelectorAll(".page-section");i.forEach(S=>{S.addEventListener("click",E=>{E.preventDefault(),i.forEach(U=>U.classList.remove("active")),S.classList.add("active");const j=S.dataset.target+"-section";s.forEach(U=>{U.id===j?(U.style.display="grid",j==="analytics-section"&&zc(document.getElementById("analytics-period").value)):U.style.display="none"})})});const r=document.getElementById("modal"),o=document.getElementById("add-btn"),a=document.getElementById("close-modal"),c=document.getElementById("transaction-form"),u=document.getElementById("sub-modal"),h=document.getElementById("add-sub-btn"),d=document.getElementById("close-sub-modal"),g=document.getElementById("subscription-form"),m=document.getElementById("debt-modal"),y=document.getElementById("add-debt-btn"),v=document.getElementById("close-debt-modal"),w=document.getElementById("debt-form");o.addEventListener("click",()=>{r.classList.add("active"),document.getElementById("date").valueAsDate=new Date}),a.addEventListener("click",()=>{r.classList.remove("active")}),h.addEventListener("click",()=>{u.classList.add("active")}),d.addEventListener("click",()=>{u.classList.remove("active")}),y&&y.addEventListener("click",()=>{m.classList.add("active")}),v&&v.addEventListener("click",()=>{m.classList.remove("active")}),window.addEventListener("click",S=>{S.target===r&&r.classList.remove("active"),S.target===u&&u.classList.remove("active"),S.target===m&&m.classList.remove("active")}),c.addEventListener("submit",S=>{S.preventDefault(),console.log("Form submitted");try{const E=new FormData(c),U={id:crypto.randomUUID?crypto.randomUUID():Date.now().toString()+Math.random().toString().slice(2),type:E.get("type"),date:E.get("date"),title:E.get("title"),amount:Number(E.get("amount")),category:E.get("category")};console.log("Adding transaction:",U),Zt.addTransaction(U),c.reset(),r.classList.remove("active")}catch(E){console.error("Error adding transaction:",E),alert(": "+E.message)}}),g.addEventListener("submit",S=>{S.preventDefault();try{const E=document.getElementById("sub-title").value,j=document.getElementById("sub-amount").value,U=document.getElementById("sub-day").value,X=crypto.randomUUID?crypto.randomUUID():Date.now().toString()+Math.random().toString().slice(2);Yn.addSubscription({id:X,title:E,amount:Number(j),day:Number(U)}),g.reset(),u.classList.remove("active"),alert("")}catch(E){console.error("Error adding subscription:",E),alert(": "+E.message)}}),w&&w.addEventListener("submit",S=>{S.preventDefault();try{const E=document.getElementById("debt-name").value,j=document.getElementById("debt-balance").value,U=document.getElementById("debt-payment").value,X=document.getElementById("debt-rate").value,J=crypto.randomUUID?crypto.randomUUID():Date.now().toString()+Math.random().toString().slice(2);fn.addDebt({id:J,name:E,balance:Number(j),monthlyPayment:Number(U),rate:X?Number(X):null}),w.reset(),m.classList.remove("active")}catch(E){console.error("Error adding debt:",E),alert(": "+E.message)}}),document.getElementById("clear-data-btn").addEventListener("click",()=>{confirm("")&&Zt.clearAll()});const P=document.getElementById("scan-btn"),C=document.getElementById("receipt-input"),D=document.getElementById("scan-status");P&&P.addEventListener("click",()=>{C.click()}),C&&C.addEventListener("change",async S=>{const E=S.target.files[0];if(E){D.textContent="... ()",P.disabled=!0;try{const j=await iy(()=>import("./index-9JLLdIp4.js").then(pt=>pt.i),[],import.meta.url);D.textContent="...";const X=(await j.recognize(E,"jpn",{logger:pt=>{pt.status==="recognizing text"&&(D.textContent=`... ${Math.round(pt.progress*100)}%`)}})).data.text;console.log("OCR Result:",X);const J=O(X);J.date&&(document.getElementById("date").value=J.date),J.title&&(document.getElementById("title").value=J.title),J.amount&&(document.getElementById("amount").value=J.amount),document.getElementById("type-expense").checked=!0,D.textContent="",D.style.color="#00b894"}catch(j){console.error(j),D.textContent="",D.style.color="#ff7675"}finally{P.disabled=!1,C.value=""}}});const O=S=>{const E={date:"",title:"",amount:""};if(!S)return E;try{const j=S.match(/(\d{4})(\d{1,2})(\d{1,2})/);if(j){const J=j[1],pt=j[2].padStart(2,"0"),mt=j[3].padStart(2,"0");E.date=`${J}-${pt}-${mt}`}const U=S.match(/\s*([0-9,]+)/)||S.match(/([0-9,]+)\s*/);U&&(E.amount=U[1].replace(/,/g,""));const X=S.split(`
`).filter(J=>J.trim()!=="");X.length>0&&(E.title=X[0].substring(0,20))}catch(j){console.warn("OCR Parse warning:",j)}return E},M=document.getElementById("login-btn"),L=document.getElementById("logout-btn"),I=document.getElementById("login-area"),b=document.getElementById("user-area"),T=document.getElementById("user-avatar"),A=document.getElementById("user-name"),x=document.getElementById("auth-text");M&&M.addEventListener("click",()=>{bA(ic,O1).then(S=>{console.log("Logged in:",S.user)}).catch(S=>{console.error("Login failed",S),alert(": "+S.message)})}),L&&L.addEventListener("click",()=>{Zx(ic).then(()=>{console.log("Logged out"),location.reload()})}),Jx(ic,async S=>{if(Uc=S,S){I.style.display="none",b.style.display="flex",T.src=S.photoURL,A.textContent=S.displayName,x&&(x.textContent="");try{const E=h_(T_,"users",S.uid),j=await P1(E);if(j.exists()){console.log("Loading data from cloud...");const U=j.data();U.transactions&&(Zt.transactions=U.transactions),U.subscriptions&&(Yn.subscriptions=U.subscriptions),U.debts&&(fn.debts=U.debts),localStorage.setItem("transactions",JSON.stringify(Zt.transactions)),localStorage.setItem("subscriptions",JSON.stringify(Yn.subscriptions)),localStorage.setItem("debts",JSON.stringify(fn.debts)),Wc(),io(),io(),console.log("Cloud data synced")}else console.log("No cloud data found. Uploading local data..."),aa()}catch(E){console.error("Error loading cloud data",E)}}else I.style.display="block",b.style.display="none",x&&(x.textContent="")})});
